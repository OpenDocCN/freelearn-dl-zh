- en: '*Chapter 11*: Using Chatbots for Querying Documents'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*第11章*：使用聊天机器人查询文档'
- en: Imagine if you could have a two-way conversation with the text data in your
    documents. Let's suppose you subscribe to a number of journals that send you research
    articles on technology trends. These articles may cover multiple industries and
    technologies, but you are interested in insights about a specific industry and
    technology. Traditionally, you would have a team of people combing through these
    documents to interpret, understand, and recommend the direction you need to take.
    What if you could get all the data and answers you need just by flipping open
    your phone and talking to a chatbot that gives you the answers from your document
    corpus? Wouldn't that be awesome? That's the power of combining **natural language
    processing** (**NLP**) technology with chatbots. You can literally talk to your
    documents, and get a response too.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 想象一下，如果你能够与文档中的文本数据进行双向对话。假设你订阅了多本期刊，定期收到关于技术趋势的研究文章。这些文章可能涵盖多个行业和技术，但你只对某个特定行业和技术的洞察感兴趣。传统上，你会有一支团队去翻阅这些文档，解读、理解，并推荐你需要采取的方向。如果你可以仅通过拿起手机，与一个聊天机器人对话，获得你需要的答案，而这些答案就来自你的文档库，岂不是太棒了吗？这就是将**自然语言处理**（**NLP**）技术与聊天机器人结合的力量。你可以真正和你的文档“对话”，并得到回答。
- en: In the previous chapter, we discussed how businesses were relying on technology
    to help them expand internationally, but traditional manual translation to localize
    customer-facing websites was both time- and cost-prohibitive. We then built a
    solution that utilized the potential of **machine learning** (**ML**) based translation
    capabilities with **Amazon** **Translate** to tackle website localization challenges
    efficiently.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们讨论了企业如何依靠技术帮助其国际化扩展，但传统的人工翻译以本地化客户网站既费时又昂贵。因此，我们构建了一个利用**机器学习**（**ML**）翻译能力与**Amazon**
    **Translate**相结合的解决方案，高效应对网站本地化挑战。
- en: 'In this chapter, as before, we will go back to our favorite banking corporation,
    *LiveRight Holdings*, and help them solve a unique use case with NLP and chatbots.
    But before we get to the challenge and the solution, let''s discuss the philosophy
    behind combining a conversational interface (aka the chatbot) with a text-based
    search for documents (more on this soon). Remember how we said the patterns that
    NLP can help uncover in seemingly unrelated documents is like the treasure in
    Ali Baba''s cave ([*Chapter 1*](B17528_01_Final_SB_ePub.xhtml#_idTextAnchor020),
    *NLP in the Business Context and Introduction to AWS AI Services* – we know, it
    feels like eons ago)? What if you had your own personal genie (as in the story
    of Aladdin) that could give you the insights you needed based on your questions?
    When we combine NLP and chatbots, it is like asking the genie to dole out treasures
    from Ali Baba''s cave, on-demand, at your convenience. If you recollect, we did
    cover how to create smart search indexing with NLP before, but the solution we
    will discuss in this chapter takes it one step further to make searching even
    more user-friendly. To learn how to build a chatbot for querying documents, we
    will navigate through the following sections:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，像之前一样，我们将回到我们最喜欢的银行公司，*LiveRight Holdings*，并帮助他们通过自然语言处理（NLP）和聊天机器人解决一个独特的使用案例。但在我们讨论挑战和解决方案之前，先来谈谈将对话界面（即聊天机器人）与基于文本的文档搜索结合的理念（稍后会详细讲解）。记得我们曾说过，NLP可以帮助揭示看似无关的文档中的模式，就像阿里巴巴洞中的宝藏一样（[*第1章*](B17528_01_Final_SB_ePub.xhtml#_idTextAnchor020)，*商业环境中的NLP与AWS
    AI服务简介*——我们知道，感觉像是很久以前的事情了）？如果你有一个像《阿拉丁神灯》中的神灯精灵，根据你的问题提供所需的洞察，岂不是很酷？当我们将NLP和聊天机器人结合起来时，就像是让神灯精灵随时按需从阿里巴巴的宝藏洞中分发宝藏。如果你还记得，我们之前确实讨论过如何通过NLP创建智能搜索索引，但本章中我们将讨论的解决方案更进一步，使得搜索更加用户友好。为了学习如何构建一个查询文档的聊天机器人，我们将通过以下几个部分进行讲解：
- en: Introducing the chatbot use case
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 介绍聊天机器人使用案例
- en: Creating an **Amazon** **Kendra** index with **Amazon** **S3** as a data source
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建一个以**Amazon** **S3** 为数据源的**Amazon** **Kendra** 索引
- en: Building an **Amazon** **Lex** chatbot
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建**Amazon** **Lex** 聊天机器人
- en: Deploying the solution with **AWS** **CloudFormation**
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用**AWS** **CloudFormation** 部署解决方案
- en: Technical requirements
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: For this chapter, you will need access to an **AWS** **Account**. Please make
    sure to follow the instructions specified in the *Technical requirements* section
    in [*Chapter 2*](B17528_02_Final_SB_ePub.xhtml#_idTextAnchor027), *Introducing
    Amazon Textract*, to create your AWS Account, and log in to the **AWS** **Management
    Console**. If you need to understand how to upload objects to Amazon S3 buckets,
    please refer to the *Creating an Amazon S3 bucket, a folder, and uploading objects*
    section. Please complete these tasks before trying the steps in *Building a chatbot
    for querying documents*.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 本章中，您需要拥有一个**AWS** **账户**。请确保按照[*第2章*](B17528_02_Final_SB_ePub.xhtml#_idTextAnchor027)《介绍Amazon
    Textract》部分中指定的*技术要求*，创建您的AWS账户，并登录到**AWS** **管理控制台**。如果您需要了解如何将对象上传到Amazon S3桶中，请参考*创建Amazon
    S3桶、文件夹以及上传对象*部分。在尝试*构建查询文档的聊天机器人*步骤之前，请完成这些任务。
- en: 'For this chapter, we will be performing all of our tasks using the AWS Management
    Console. The GitHub repository provides the input documents and the FAQ list we
    need for our solution, available here: [https://github.com/PacktPublishing/Natural-Language-Processing-with-AWS-AI-Services/tree/main/Chapter%2011](https://github.com/PacktPublishing/Natural-Language-Processing-with-AWS-AI-Services/tree/main/Chapter%2011).'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将通过AWS管理控制台完成所有任务。GitHub仓库提供了解决方案所需的输入文档和FAQ列表，您可以在此查看：[https://github.com/PacktPublishing/Natural-Language-Processing-with-AWS-AI-Services/tree/main/Chapter%2011](https://github.com/PacktPublishing/Natural-Language-Processing-with-AWS-AI-Services/tree/main/Chapter%2011)。
- en: Please use the instructions in the following sections to build the solution.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 请使用以下部分的指示来构建解决方案。
- en: Introducing the chatbot use case
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍聊天机器人用例
- en: Let's now discuss how using a chatbot with NLP can benefit businesses. Using
    an example is always helpful, so let's go back to our fictitious banking corporation
    **LiveRight Holdings Private Limited**. The **Mortgage Product Research** (**MPR**)
    department for LiveRight's mortgages business is an important entity within the
    organization, as their recommendations directly influence what mortgage products,
    features, and choices are offered to LiveRight's customers. This has a direct
    impact on LiveRight's revenues and profitability, as mortgage products are responsible
    for more than 40% of LiveRight's annual revenues. The MPR team receives hundreds
    of research documents incrementally on a monthly basis, both from mass subscription-based
    industry analysts and specialized independent researchers. Typically, the documents
    provide insights, trend reports, and detailed perspectives on what buyers look
    for in a home, the role of real estate agents, how home prices impact the sellers,
    and so on. These documents go to an Amazon S3 bucket that already has thousands
    of documents and is growing.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们讨论一下，使用具备自然语言处理（NLP）能力的聊天机器人如何为企业带来益处。通过举例说明总是有帮助的，因此我们回到我们虚构的银行公司**LiveRight
    Holdings Private Limited**。LiveRight公司中的**按揭产品研究**（**MPR**）部门对按揭业务至关重要，因为他们的建议直接影响着LiveRight提供给客户的按揭产品、特性和选择。这对LiveRight的收入和盈利能力有直接影响，因为按揭产品占LiveRight年收入的40%以上。MPR团队每月都会逐步收到数百份研究文档，这些文档既来自基于订阅的行业分析师，也来自专业的独立研究员。通常，这些文档提供了关于买家在购买房屋时的需求、房地产经纪人的角色、房价对卖家的影响等方面的洞察、趋势报告和详细视角。这些文档被存储到一个Amazon
    S3桶中，该桶已经包含了成千上万的文档，并且还在增长。
- en: A "day in the life of" scenario for the MPR team is to read these copious documents,
    analyze their content, identify areas, trends, and metrics of interest and categorize
    these facts, and eventually, these are collected, assessed together by the team
    as a whole in a day-long group meeting activity, compared with statistics from
    the past months, and finally, the recommendations are written down to be sent
    to executives, as well as fed into ML models for determining mortgage product
    features. Documents are received either at the end of the previous month or at
    the beginning of the month, and the team takes the whole month to read, analyze,
    categorize, discuss, and make recommendations. LiveRight's senior management has
    long suspected this, rightly, to be a very time-consuming and cost-prohibitive
    process, and as an organization that prides itself in being economical, wanted
    to automate the process to save time and reduce costs. Having seen how using NLP
    with AWS AI services has helped them in some of their other use cases, they reach
    out to you, the ML Enterprise Architect, to help them re-design this process and
    build an efficient solution. Additionally, senior management wanted to harness
    the potential of the very talented researchers in the MPR for new innovations
    rather than wasting their time on menial and repetitive tasks.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: MPR团队的“日常生活”场景是阅读这些大量的文档，分析其内容，识别感兴趣的领域、趋势和指标，并对这些事实进行分类，最终，这些信息会在一天的集体会议活动中被团队共同收集和评估，与过去几个月的统计数据进行比较，最终将建议写下来并发送给高层管理人员，同时将这些信息输入机器学习模型以确定抵押贷款产品特征。文档通常在前一个月的月底或月初收到，团队需要整个月的时间来阅读、分析、分类、讨论并做出建议。LiveRight的高层管理人员长期以来一直认为这一过程非常耗时且成本高昂，这种看法是正确的。作为一个以经济实用为荣的组织，他们希望通过自动化这一过程来节省时间并降低成本。在看到使用AWS
    AI服务中的NLP技术在其他用例中对他们的帮助后，他们联系了你，ML企业架构师，寻求帮助重新设计这一流程并构建一个高效的解决方案。此外，高层管理人员希望能够利用MPR团队中非常有才华的研究人员进行新的创新，而不是让他们浪费时间在琐碎和重复的任务上。
- en: You find this request from LiveRight both challenging and exciting, as it's
    a use case that's tailor-made for NLP and AI. You immediately decide that the
    best way to help the MPR team discuss and decide on their recommendations would
    be an **intelligent AI assistant** that participates in their meetings – listening
    to their questions and answering them for them. After some analysis, you decide
    to go with Amazon Lex ([https://aws.amazon.com/lex/](https://aws.amazon.com/lex/)),
    a fully managed AI service powered by ML models to build intelligent chatbots
    that can interact in both voice and text with continuous learning capabilities,
    and Amazon Kendra ([https://aws.amazon.com/kendra/](https://aws.amazon.com/kendra/)),
    a fully managed ML-powered enterprise search service that uses NLP to create intelligent
    indexes for your documents, accepts your queries in natural language, and returns
    responses which match the context accurately. You check the Amazon Lex pricing
    ([https://aws.amazon.com/lex/pricing/](https://aws.amazon.com/lex/pricing/)) and
    realize that, for 8,000 speech requests and 2,000 text request interactions with
    the chatbot in the US East (N. Virginia) region, it will cost you only $33.50
    a month. You check the Amazon Kendra pricing ([https://aws.amazon.com/kendra/pricing/](https://aws.amazon.com/kendra/pricing/))
    and see that the Developer Edition supports 10,000 documents and 4,000 queries
    per day, at a price of $1.125 per hour or $810 per month. You decide to use the
    Developer Edition for the pilot phase and move to the Enterprise Edition after
    user acceptance.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 你发现来自LiveRight的这个请求既具有挑战性又令人兴奋，因为它是一个完全为NLP和AI量身定制的用例。你立即决定，帮助MPR团队讨论并决定他们的建议的最佳方式是一个**智能AI助手**，它可以参与他们的会议——倾听他们的问题并为他们回答。在经过一些分析后，你决定使用Amazon
    Lex（[https://aws.amazon.com/lex/](https://aws.amazon.com/lex/)），这是一个完全托管的AI服务，通过机器学习模型来构建智能聊天机器人，能够进行语音和文本的互动，并具备持续学习的能力；以及Amazon
    Kendra（[https://aws.amazon.com/kendra/](https://aws.amazon.com/kendra/)），这也是一个完全托管的机器学习驱动的企业搜索服务，利用NLP技术为你的文档创建智能索引，接受自然语言查询，并返回精确匹配上下文的响应。你查看了Amazon
    Lex定价（[https://aws.amazon.com/lex/pricing/](https://aws.amazon.com/lex/pricing/)），发现对于美国东部（北弗吉尼亚）地区每月8,000个语音请求和2,000个文本请求与聊天机器人的交互，每月只需支付33.50美元。你再查看了Amazon
    Kendra定价（[https://aws.amazon.com/kendra/pricing/](https://aws.amazon.com/kendra/pricing/)），发现开发者版支持每天处理10,000个文档和4,000个查询，价格为每小时1.125美元或每月810美元。你决定在试点阶段使用开发者版，待用户验收后再升级到企业版。
- en: Note
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: These prices are correct at the time of writing. Please check the links for
    an up-to-date figure.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 这些价格截至撰写时是正确的。请检查链接以获取最新数据。
- en: You are now ready to build the solution. As mentioned before, we will be walking
    through this solution entirely using the AWS Management Console ([https://aws.amazon.com/console/](https://aws.amazon.com/console/)).
    If you do not have access to the AWS Management Console, please follow the detailed
    instructions in the *Technical requirements* section in [*Chapter 2*](B17528_02_Final_SB_ePub.xhtml#_idTextAnchor027),
    *Introducing Amazon Textract* of this book.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您已经准备好构建解决方案了。如前所述，我们将完全使用AWS管理控制台([https://aws.amazon.com/console/](https://aws.amazon.com/console/))来步行这个解决方案。如果您没有访问AWS管理控制台，请按照本书[*第2章*](B17528_02_Final_SB_ePub.xhtml#_idTextAnchor027)中*介绍Amazon
    Textract*部分中*技术要求*部分的详细说明进行操作。
- en: 'First, let''s complete the pre-requisites before we move on to the solution
    build:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，在我们继续解决方案构建之前，让我们完成前提条件：
- en: Download the sample home buyer research documents from our GitHub repository.
    From your local computer, open an internet browser (preferably **Google** **Chrome**
    *version* *9.1* and above) and go to [https://github.com/PacktPublishing/Natural-Language-Processing-with-AWS-AI-Services/tree/main/Chapter%2011](https://github.com/PacktPublishing/Natural-Language-Processing-with-AWS-AI-Services/tree/main/Chapter%2011).
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从我们的GitHub存储库下载样本家庭买家研究文档。从您的本地计算机打开一个互联网浏览器（最好是**Google** **Chrome** *版本* *9.1*及以上），并访问[https://github.com/PacktPublishing/Natural-Language-Processing-with-AWS-AI-Services/tree/main/Chapter%2011](https://github.com/PacktPublishing/Natural-Language-Processing-with-AWS-AI-Services/tree/main/Chapter%2011)。
- en: Download each of the four documents present by clicking the document name, one
    document at a time.
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 逐个点击文档名称下载每个四个文档。
- en: On the document page, click the **Download** button on the right to download
    the document to your computer.
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在文档页面上，点击右侧的**下载**按钮将文档下载到您的计算机上。
- en: Upload these downloaded documents to an Amazon S3 bucket, as per the instructions
    provided in the *Creating an Amazon S3 bucket, a folder, and uploading objects*
    section in [*Chapter 2*](B17528_02_Final_SB_ePub.xhtml#_idTextAnchor027), *Introducing
    Amazon Textract,* of this book. When creating the Amazon S3 folder in the bucket,
    please use the following folder/prefix paths – `chapter11/kendra-faq/faqs.csv`,
    `chapter11/kendra/2019-NAR-HBS.pdf`, `chapter11/kendra/2020-generational-trends-report-03-05-2020.pdf`,
    `chapter11/kendra/` `Zillow-home-buyers-report.pdf`.
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照本书[*第2章*](B17528_02_Final_SB_ePub.xhtml#_idTextAnchor027)中*创建Amazon S3桶、文件夹和上传对象*部分的说明，将这些下载的文档上传到Amazon
    S3桶。在创建桶中的Amazon S3文件夹时，请使用以下文件夹/前缀路径 – `chapter11/kendra-faq/faqs.csv`、`chapter11/kendra/2019-NAR-HBS.pdf`、`chapter11/kendra/2020-generational-trends-report-03-05-2020.pdf`、`chapter11/kendra/`
    `Zillow-home-buyers-report.pdf`。
- en: Now, you are ready to start building the solution.
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，你已经准备好开始构建解决方案了。
- en: In this section, we introduced the need for chatbots with NLP and the business
    benefits associated with this solution. In the next section, we will walk through
    the building of the solution step-by-step.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们介绍了使用NLP的聊天机器人的需求以及与此解决方案相关的商业利益。在接下来的部分中，我们将逐步介绍解决方案的构建过程。
- en: Creating an Amazon Kendra index with Amazon S3 as a data source
  id: totrans-26
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Amazon S3作为数据源创建Amazon Kendra索引
- en: In this section, we will first create an Amazon Kendra index and add the S3
    bucket to which we uploaded our sample research documents in the previous section,
    as an Amazon S3 data source.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将首先创建一个Amazon Kendra索引，并将我们在上一节中上传的样本研究文档的S3存储桶添加为Amazon S3数据源。
- en: Note
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Before you continue, please ensure you have executed the steps in the *Technical
    requirements* section and the pre-requisites mentioned in the *Introducing the
    chatbot use case* section.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在继续之前，请确保您已经执行了*技术要求*部分和*介绍聊天机器人使用案例*部分中提到的先决条件。
- en: 'Please execute the following steps to create your Amazon Kendra index:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 请执行以下步骤创建您的Amazon Kendra索引：
- en: If not already done, log in to your **AWS Management Console** as per the instructions
    in the *Technical requirements* section in [*Chapter 2*](B17528_02_Final_SB_ePub.xhtml#_idTextAnchor027),
    *Introducing Amazon Textract*.
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果尚未完成，请按照本书[*第2章*](B17528_02_Final_SB_ePub.xhtml#_idTextAnchor027)中*介绍Amazon
    Textract*部分中*技术要求*部分的详细说明登录到您的**AWS管理控制台**。
- en: Type `kendra` in the **Services** search bar in the top center of the page and
    select **Amazon Kendra** from the list. When the **Amazon Kendra** console opens
    up, click **Create an Index**, as shown here:![Figure 11.1 – Creating an Amazon
    Kendra index](img/B17528_11_01.jpg)
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在页面顶部中央的**服务**搜索栏中输入`kendra`并从列表中选择**Amazon Kendra**。当**Amazon Kendra**控制台打开时，点击**创建索引**，如图所示：![图
    11.1 – 创建 Amazon Kendra 索引](img/B17528_11_01.jpg)
- en: Figure 11.1 – Creating an Amazon Kendra index
  id: totrans-33
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.1 – 创建亚马逊 Kendra 索引
- en: In the **Specify index details** page, type a name for your index, add an optional
    description, select **Create a new role (Recommended)** from the **IAM role**
    list box, and type a **Role name**, as shown in the following screenshot. Then,
    click **Next** to continue:![Figure 11.2 – Specify index details
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**指定索引详细信息**页面中，输入索引的名称，添加可选描述，从**IAM 角色**列表框中选择**创建新角色（推荐）**，并输入**角色名称**，如下截图所示。然后点击**下一步**继续：![图
    11.2 – 指定索引详细信息
- en: '](img/B17528_11_02.jpg)'
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_02.jpg)'
- en: Figure 11.2 – Specify index details
  id: totrans-36
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.2 – 指定索引详细信息
- en: Leave the default selections in the **Configure user access control** page and
    click **Next** to continue.
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**配置用户访问控制**页面中保持默认选择，并点击**下一步**继续。
- en: Leave the default selection to point to **Developer edition** in the **Specify
    provisioning** page and click **Create**. Amazon Kendra will start the index creation
    job. It may take about 15 to 30 minutes, so feel free to grab some snacks and
    coffee/tea in the meantime.
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**指定配置**页面中，保持默认选择，指向**开发者版**，然后点击**创建**。亚马逊 Kendra 将开始创建索引的工作。可能需要大约 15 到
    30 分钟，因此您可以在此期间享用一些零食和咖啡/茶。
- en: When the index has been successfully created, click the **Add data sources**
    button to proceed.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 索引成功创建后，点击**添加数据源**按钮继续。
- en: In the **Add a data source connector to your Amazon Kendra index** page, scroll
    down and click **Add connector** in the **Amazon S3** card under **Select data
    source connector type**.
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**向 Amazon Kendra 索引添加数据源连接器**页面中，向下滚动并点击**添加连接器**，位于**选择数据源连接器类型**下的**Amazon
    S3**卡片中。
- en: In the **Specify data source details** page, type the **Data source name** and
    click **Next**.
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**指定数据源详细信息**页面中，输入**数据源名称**并点击**下一步**。
- en: In the `chapter11/kendra`, and click the **Add** button:![Figure 11.3 – Configure
    sync settings
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`chapter11/kendra`中，点击**添加**按钮：![图 11.3 – 配置同步设置
- en: '](img/B17528_11_03.jpg)'
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_03.jpg)'
- en: Figure 11.3 – Configure sync settings
  id: totrans-44
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.3 – 配置同步设置
- en: Now, scroll down a little in the page to the **IAM role** info and select **Create
    a new role (Recommended)** in the **IAM role** list box and type a **Role name**
    of your choice. In the **Sync Run Schedule** info, select **Run on demand** for
    **Frequency**. Click **Next** to continue.![Figure 11.4 – Data source sync settings
    IAM role and run schedule
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，向下滚动页面，找到**IAM 角色**信息，在**IAM 角色**列表框中选择**创建新角色（推荐）**并输入您选择的**角色名称**。在**同步运行计划**信息中，选择**按需运行**作为**频率**。点击**下一步**继续。![图
    11.4 – 数据源同步设置 IAM 角色和运行计划
- en: '](img/B17528_11_04.jpg)'
  id: totrans-46
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_04.jpg)'
- en: Figure 11.4 – Data source sync settings IAM role and run schedule
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.4 – 数据源同步设置 IAM 角色和运行计划
- en: Review your inputs and click **Add data source**. Amazon Kendra will first propagate
    the IAM role and then create the data source.
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 审核您的输入并点击**添加数据源**。亚马逊 Kendra 将首先传播 IAM 角色，然后创建数据源。
- en: After the data source has been created, click the **Sync now** button to index
    our documents for searching.
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 数据源创建后，点击**立即同步**按钮，开始为我们的文档建立索引，以便搜索。
- en: The sync will take about 30 minutes (time for your next break). After it completes,
    you can review the **Sync run history**.
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 同步大约需要 30 分钟（时间可以用来休息）。完成后，您可以查看**同步运行历史**。
- en: Now, we will add a few FAQs to the index to enable adding more context to the
    search. Select the **FAQs** option from the left pane under the **Data management**
    heading for your index and click **Add FAQ**.
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们将向索引添加一些常见问题解答（FAQ），以便为搜索添加更多背景信息。从左侧窗格中的**数据管理**标题下选择**常见问题解答**选项，然后点击**添加常见问题解答**。
- en: Type a `faqs.csv` file in the pre-requisite steps of the *Introducing the chatbot
    use case* section. In the **IAM role**, select **Create a new role (Recommended)**
    and type a **Role name** of your choice. Scroll down and click **Add**.
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在*介绍聊天机器人使用案例*部分的前提步骤中输入`faqs.csv`文件。在**IAM 角色**中，选择**创建新角色（推荐）**并输入您选择的**角色名称**。向下滚动并点击**添加**。
- en: Amazon Kendra will start the FAQ job which should complete in a few minutes.
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 亚马逊 Kendra 将开始 FAQ 任务，几分钟后应该完成。
- en: We have now completed the steps required to set up an intelligent search for
    our sample research documents using Amazon Kendra. In the next section, we will
    build the steps needed to create an Amazon Lex chatbot.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在已完成使用 Amazon Kendra 设置智能搜索所需的步骤。在下一部分，我们将构建创建 Amazon Lex 聊天机器人的步骤。
- en: Building an Amazon Lex chatbot
  id: totrans-55
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 构建 Amazon Lex 聊天机器人
- en: 'In this section, we will execute the steps needed to build an Amazon Lex chatbot
    and use a built-in *intent* (which is a task performed by the bot based on a user
    request) to integrate our chatbot with the Amazon Kendra index we created in the
    preceding section. Please execute the steps as follows:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将执行构建 Amazon Lex 聊天机器人的步骤，并使用内置的*意图*（这是机器人基于用户请求执行的任务）将我们的聊天机器人与前一节中创建的
    Amazon Kendra 索引集成。请按以下步骤执行：
- en: In the AWS Management Console, type `lex` in the **Services** search bar at
    the top center of the page and select **Amazon Lex** from the list to go to the
    Amazon Lex console. On the left pane of the Amazon Lex console, click the **Switch
    to the new Lex V2 console** link, as shown in the next screenshot:![Figure 11.5
    – Switch to the new Lex V2 console](img/B17528_11_05.jpg)
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 AWS 管理控制台中，在页面顶部中央的**服务**搜索框中输入`lex`，并从列表中选择**Amazon Lex**以进入 Amazon Lex 控制台。在
    Amazon Lex 控制台的左侧窗格中，点击**切换到新的 Lex V2 控制台**链接，如下图所示：![图 11.5 – 切换到新的 Lex V2 控制台](img/B17528_11_05.jpg)
- en: Figure 11.5 – Switch to the new Lex V2 console
  id: totrans-58
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.5 – 切换到新的 Lex V2 控制台
- en: On the Lex V2 console page, click **Create bot** on the right, as shown here:![Figure
    11.6 – Create bot
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Lex V2 控制台页面上，点击右侧的**创建机器人**，如图所示：![图 11.6 – 创建机器人
- en: '](img/B17528_11_06.jpg)'
  id: totrans-60
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_06.jpg)'
- en: Figure 11.6 – Create bot
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.6 – 创建机器人
- en: In the `HomeBuyerResearch` for the **Bot name**. In the **IAM permissions**
    section, select **Create a role with basic Amazon Lex permissions** for the **Runtime
    role**.![Figure 11.7 – Configure bot settings
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`HomeBuyerResearch`中，为**Bot 名称**，在**IAM 权限**部分，选择**创建具有基本 Amazon Lex 权限的角色**作为**运行时角色**。![图
    11.7 – 配置机器人设置
- en: '](img/B17528_11_07.jpg)'
  id: totrans-63
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_07.jpg)'
- en: Figure 11.7 – Configure bot settings
  id: totrans-64
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.7 – 配置机器人设置
- en: Scroll down to `5` and select **minute(s)** for the **Idle session timeout**,
    and click **Next** on the bottom right of the page.
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向下滚动至`5`，并为**空闲会话超时**选择**分钟数**，然后点击页面右下角的**下一步**。
- en: In the **Add language to bot** page, leave the **Select language** as **English
    (US)**, and select **Joanna** in the **Voice interaction** list box. Click **Done**
    on the bottom right of the page.
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**为机器人添加语言**页面，保持**选择语言**为**英语（美国）**，并在**语音交互**列表框中选择**Joanna**。点击页面右下角的**完成**。
- en: When the bot is created, Amazon Lex will automatically add an intent called
    `NewIntent` to start the bot building process.![Figure 11.8 – "NewIntent" added
    by Lex
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当机器人创建完成后，Amazon Lex 将自动添加一个名为`NewIntent`的意图来启动机器人构建过程。![图 11.8 – Lex 添加的 "NewIntent"
- en: '](img/B17528_11_08.jpg)'
  id: totrans-68
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_08.jpg)'
- en: Figure 11.8 – "NewIntent" added by Lex
  id: totrans-69
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.8 – Lex 添加的 "NewIntent"
- en: Scroll down to the `utterance for new intent` at the bottom, and click `NewIntent`
    a custom intent (that's mandatory for building the bot) unresolvable by providing
    an utterance that will not be used during our interaction with the bot. This will
    force the resolution to our Amazon Kendra built-in intent.
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向下滚动到页面底部的`新意图的发话内容`，点击`NewIntent`，这是一个自定义意图（在构建机器人时是必需的），并通过提供一个在与机器人交互时不会使用的发话内容来使其不可解析。这样可以强制将解析转到我们的
    Amazon Kendra 内置意图。
- en: Scroll down and click **Save Intent** at the bottom right of the page.
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向下滚动并点击页面右下角的**保存意图**。
- en: Now, let's go back to the intents list. Click **Back to intents list** on the
    top left pane under the **Amazon Lex** heading.
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们返回到意图列表。点击**返回到意图列表**，它位于**Amazon Lex**标题下的左上方。
- en: In the **Intents** page, click **Add intent** on the right, and select **Use
    built-in intent**, as shown in the following screenshot:![Figure 11.9 – Add built-in
    intent
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**意图**页面上，点击右侧的**添加意图**，并选择**使用内置意图**，如下图所示：![图 11.9 – 添加内置意图
- en: '](img/B17528_11_09.jpg)'
  id: totrans-74
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_09.jpg)'
- en: Figure 11.9 – Add built-in intent
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.9 – 添加内置意图
- en: In the `kendra` in the list box, and select **AMAZON.KendraSearchIntent**.![Figure
    11.10 – Amazon Kendra built-in intent for Lex
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在列表框中的`kendra`中，选择**AMAZON.KendraSearchIntent**。![图 11.10 – Amazon Kendra 为
    Lex 提供的内置意图
- en: '](img/B17528_11_10.jpg)'
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_10.jpg)'
- en: Figure 11.10 – Amazon Kendra built-in intent for Lex
  id: totrans-78
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.10 – Amazon Kendra 为 Lex 提供的内置意图
- en: In the `ResearchBuyers`, and in the `chapter11-houses-index` if you used the
    same name mentioned in the book), and click **Add**.
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`ResearchBuyers`中，以及在`chapter11-houses-index`中（如果你使用了书中提到的相同名称），点击**添加**。
- en: Scroll down to the `Here is what I found for your query:((x-amz-lex:kendra-search-response-answer-1))`
    in the **Message** field, and click on **Save Intent**. After the intent is saved,
    click on **More response options**.
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向下滚动到**消息**字段中的`Here is what I found for your query:((x-amz-lex:kendra-search-response-answer-1))`，点击**保存意图**。保存意图后，点击**更多响应选项**。
- en: 'In the `I found a FAQ question for you: ((x-amz-lex:kendra-search-response-question_answer-question-1))
    and the answer is ((x-amz-lex:kendra-search-response-question_answer-answer-1))`
    in the **Message** field, and click **Update responses**. Click **Save Intent**
    once again.![Figure 11.11 – Adding text message group'
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '在**消息**字段中的`I found a FAQ question for you: ((x-amz-lex:kendra-search-response-question_answer-question-1))
    and the answer is ((x-amz-lex:kendra-search-response-question_answer-answer-1))`，点击**更新响应**。再次点击**保存意图**。[图11.11
    – 添加文本消息组'
- en: '](img/B17528_11_11.jpg)'
  id: totrans-82
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_11.jpg)'
- en: Figure 11.11 – Adding text message group
  id: totrans-83
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图11.11 – 添加文本消息组
- en: 'Now, scroll to the top of the page and click **Language: English (US)** from
    the blue navigation links at the top of the page.'
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，滚动到页面顶部，点击蓝色导航链接中的**语言：英语（美国）**。
- en: Scroll down and click **Build** at the bottom right of the page. This should
    take about a couple of minutes, but not more.
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向下滚动并点击页面右下角的**构建**按钮。这大约需要几分钟时间，但不会超过。
- en: When the bot has been completely built, click the **Test** button next to the
    **Build** button at the bottom of the page.
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当机器人完全构建完成后，点击页面底部**构建**按钮旁边的**测试**按钮。
- en: The `Who is a first-time buyer?` in the input widget at the bottom and press
    **Enter**.
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在输入框中输入`Who is a first-time buyer?`，然后按**Enter**键。
- en: The bot responds with an answer from the documents we added to our Amazon Kendra
    index:![Figure 11.12 – Bot responding to the query with content from the sample
    research documents
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 机器人使用我们添加到亚马逊Kendra索引中的文档中的答案进行响应：[图11.12 – 机器人响应查询，内容来自示例研究文档
- en: '](img/B17528_11_12.jpg)'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_12.jpg)'
- en: Figure 11.12 – Bot responding to the query with content from the sample research
    documents
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图11.12 – 机器人响应查询，内容来自示例研究文档
- en: Now, scroll to the top of the page and click **Versions** on the blue navigation
    links.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，滚动到页面顶部，点击蓝色导航链接中的**版本**。
- en: On the **Versions** page, click the **Create version** button on the right.
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**版本**页面，点击右侧的**创建版本**按钮。
- en: Scroll down to the bottom of the page and click the **Create** button.
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向下滚动到页面底部，点击**创建**按钮。
- en: The new version is successfully created for our bot. Make a note of the version
    number created, as we will need this in the next few steps.
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 新版本已成功为我们的机器人创建。记下创建的版本号，我们在接下来的步骤中将需要它。
- en: Now, in the left pane under the **Deployment** heading, click on **Aliases**,
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，在左侧面板中找到**部署**标题，点击**别名**，
- en: Click on `hbr-web-ui`. Scroll down and choose the bot version you created in
    the preceding step by clicking **Choose an existing version** under **Associate
    with a version**, and click the **Create** button at the bottom right of the page.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击`hbr-web-ui`。向下滚动，选择在前一步创建的机器人版本，点击**选择一个现有版本**，然后点击页面右下角的**创建**按钮。
- en: Note
  id: totrans-97
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意
- en: If you are creating a version for the first time, please select the **Version
    1** that will be displayed for you
  id: totrans-98
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果你是第一次创建版本，请选择会显示给你的**版本1**。
- en: When the alias is created, please make a note of the **Alias ID** for our bot.
    This is required in the next section when we deploy the bot.
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建别名后，请记下我们的机器人**别名ID**。在下一节部署机器人时需要用到这个ID。
- en: Also, click your bot's name using the blue navigation links at the top of the
    page and make a note of your **Bot ID** – we will also need this for deployment.
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 同时，点击页面顶部蓝色导航链接中的机器人名称，并记下你的**机器人ID**——我们在部署时也需要这个。
- en: 'And that is a wrap for building our Amazon Lex chatbot. In the next section,
    we will use AWS CloudFormation ([https://aws.amazon.com/cloudformation/](https://aws.amazon.com/cloudformation/)),
    a managed service that provides the ability to write infrastructure-provisioning
    tasks as **JSON** or **YAML** template code, and thus automate the deployment
    of resources we need for building solutions in AWS. The Amazon Lex blog post,
    *Deploy a Web UI for Your Chatbot*, by Oliver Atoa and Bob Strahan, provides an
    AWS CloudFormation template example for integrating an Amazon Lex chatbot into
    a website: [https://aws.amazon.com/blogs/machine-learning/deploy-a-web-ui-for-your-chatbot/](https://aws.amazon.com/blogs/machine-learning/deploy-a-web-ui-for-your-chatbot/).'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是构建我们 Amazon Lex 聊天机器人的全部内容。在下一部分，我们将使用 AWS CloudFormation ([https://aws.amazon.com/cloudformation/](https://aws.amazon.com/cloudformation/))，这是一项托管服务，允许我们将基础设施配置任务写成**JSON**或**YAML**模板代码，从而自动化我们在
    AWS 上构建解决方案所需的资源部署。由 Oliver Atoa 和 Bob Strahan 撰写的 Amazon Lex 博客文章《*为你的聊天机器人部署
    Web 用户界面*》提供了一个 AWS CloudFormation 模板示例，用于将 Amazon Lex 聊天机器人集成到网站中：[https://aws.amazon.com/blogs/machine-learning/deploy-a-web-ui-for-your-chatbot/](https://aws.amazon.com/blogs/machine-learning/deploy-a-web-ui-for-your-chatbot/)。
- en: We will use this template to create a website in which we will embed our chatbot
    as a widget.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用此模板创建一个网站，并将聊天机器人嵌入为小部件。
- en: Deploying the solution with AWS CloudFormation
  id: totrans-103
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 AWS CloudFormation 部署解决方案
- en: 'In the preceding two sections, we saw a step-by-step account of how to create
    an index and associate documents from an Amazon S3 bucket as a data source using
    Amazon Kendra, and how to build an Amazon Lex chatbot and integrate that with
    our Amazon Kendra index using a built-in intent. This completes the majority of
    our solution build. In this section, we will use an AWS CloudFormation template
    sample from the accompanying repository for the blog post we mentioned in the
    previous section: [https://github.com/aws-samples/aws-lex-web-ui/tree/master/templates](https://github.com/aws-samples/aws-lex-web-ui/tree/master/templates).'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面两个部分中，我们逐步展示了如何使用 Amazon Kendra 创建索引并将来自 Amazon S3 存储桶的文档作为数据源，以及如何构建 Amazon
    Lex 聊天机器人并通过内置意图将其与我们的 Amazon Kendra 索引集成。这完成了我们解决方案构建的大部分内容。在这一部分，我们将使用来自附带仓库的
    AWS CloudFormation 模板示例，这个仓库是我们在上一部分中提到的博客文章：[https://github.com/aws-samples/aws-lex-web-ui/tree/master/templates](https://github.com/aws-samples/aws-lex-web-ui/tree/master/templates)。
- en: 'Let''s get started:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们开始吧：
- en: Click [https://github.com/aws-samples/aws-lex-web-ui/tree/master/templates](https://github.com/aws-samples/aws-lex-web-ui/tree/master/templates)
    and scroll down to the **Launch** section on the web page and click the first
    **Launch Stack** button for the **CodeBuild mode**.![Figure 11.13 – Launching
    AWS CloudFormation stack
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击[https://github.com/aws-samples/aws-lex-web-ui/tree/master/templates](https://github.com/aws-samples/aws-lex-web-ui/tree/master/templates)，并向下滚动到网页上的**Launch**部分，点击第一个**Launch
    Stack**按钮以启动**CodeBuild模式**。![图 11.13 – 启动 AWS CloudFormation 堆栈
- en: '](img/B17528_11_13.jpg)'
  id: totrans-107
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_13.jpg)'
- en: Figure 11.13 – Launching AWS CloudFormation stack
  id: totrans-108
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.13 – 启动 AWS CloudFormation 堆栈
- en: This action will open the AWS CloudFormation service in your AWS Management
    Console and take you to the **Create Stack** page. Click **Next**.
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 该操作将打开 AWS CloudFormation 服务，进入 AWS 管理控制台，并带你到**创建堆栈**页面。点击**下一步**。
- en: Type a name of your choice for the **Stack name** and the **CodeBuildName**.
    Or you can use the examples provided.
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为**堆栈名称**和**CodeBuildName**输入一个你选择的名称，或者使用提供的示例。
- en: Scroll down to the section named `en_US`.![Figure 11.14 – Creating stack, Lex
    V2 Bot Configuration Parameters
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向下滚动到名为`en_US`的部分。![图 11.14 – 创建堆栈，Lex V2 机器人配置参数
- en: '](img/B17528_11_14.jpg)'
  id: totrans-112
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_14.jpg)'
- en: Figure 11.14 – Creating stack, Lex V2 Bot Configuration Parameters
  id: totrans-113
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.14 – 创建堆栈，Lex V2 机器人配置参数
- en: Scroll down to `true`. This will force the users to sign up to **Amazon** **Cognito**
    ([https://aws.amazon.com/cognito/](https://aws.amazon.com/cognito/)), a fully
    managed user authentication and authorization service for web and mobile applications.
    Once they have signed up, they can use their credentials to log in to the website
    to access the chatbot.
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向下滚动到`true`。这将强制用户注册**Amazon** **Cognito** ([https://aws.amazon.com/cognito/](https://aws.amazon.com/cognito/))，这是一个完全托管的用户身份验证和授权服务，适用于
    Web 和移动应用程序。注册后，用户可以使用他们的凭证登录网站以访问聊天机器人。
- en: Scroll down a little and provide a name for the **CognitoIdentityPoolName**.
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向下滚动一点，提供一个**CognitoIdentityPoolName**的名称。
- en: Scroll down to the `You can ask me questions on home buyers. For example – what
    is important for home buyers?` in the `Say 'what is important for home buyers'
    to get started` in the **WebAppConfBotInitialSpeech** field. The bot will voice
    prompt the user with this message when the microphone icon is clicked.
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 滚动到`You can ask me questions on home buyers. For example – what is important
    for home buyers?`，该内容位于`Say 'what is important for home buyers' to get started`的**WebAppConfBotInitialSpeech**字段中。当点击麦克风图标时，机器人会通过语音提示用户这一信息。
- en: Scroll down a little to the `ResearchHomeBuyers`. Then, click **Next**.
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向下滚动一点，找到`ResearchHomeBuyers`。然后，点击**下一步**。
- en: On this page, leave the defaults as they are and click **Next** at the bottom
    of the page.
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在此页面上，保持默认设置不变，点击页面底部的**下一步**。
- en: Scroll down to the **Capabilities** section and select both the checkboxes to
    acknowledge the creation of IAM resources and that it may need the capability
    to auto expand. Click **Create Stack**.
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向下滚动到**功能**部分，选择两个复选框以确认创建 IAM 资源，并且可能需要自动扩展的能力。点击**创建堆栈**。
- en: 'It may take about 15 minutes to create all the resources we need for the solution.
    For details on the resources that will be created, please refer to the following:
    [https://github.com/aws-samples/aws-lex-web-ui/blob/master/templates/README.md#cloudformation-resources](https://github.com/aws-samples/aws-lex-web-ui/blob/master/templates/README.md#cloudformation-resources).'
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建我们所需的所有资源可能需要大约 15 分钟。有关将要创建的资源的详细信息，请参阅以下链接：[https://github.com/aws-samples/aws-lex-web-ui/blob/master/templates/README.md#cloudformation-resources](https://github.com/aws-samples/aws-lex-web-ui/blob/master/templates/README.md#cloudformation-resources)。
- en: When the status of the CloudFormation stack changes to `Create_Complete`, the
    resources we need have been provisioned. Before we bring up our website, we need
    to make a change to our parent website to ensure it is sending the right utterance
    to our chatbot. Click the **Outputs** tab of your CloudFormation stack to bring
    up the list of resources that were provisioned. Copy the value for the key called
    **WebAppBucket**. This is the name of the Amazon S3 bucket created to host your
    website:![Figure 11.15 – S3 bucket hosting our website
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当 CloudFormation 堆栈的状态更改为`Create_Complete`时，我们所需的资源已经配置完毕。在启动我们的网站之前，我们需要对父网站进行修改，以确保它发送正确的语言表达给我们的聊天机器人。点击您的
    CloudFormation 堆栈的**输出**标签，查看已配置资源的列表。复制名为**WebAppBucket**的键的值。这是用于托管您网站的 Amazon
    S3 存储桶的名称：![图 11.15 – 托管我们网站的 S3 存储桶
- en: '](img/B17528_11_15.jpg)'
  id: totrans-122
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_15.jpg)'
- en: Figure 11.15 – S3 bucket hosting our website
  id: totrans-123
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.15 – 托管我们网站的 S3 存储桶
- en: Now, go to your `S3`, and click `parent.html` from the list.
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，进入您的`S3`，并从列表中点击`parent.html`。
- en: In the `parent.html`, click the `parent.html` to your computer:![Figure 11.16
    – Downloading parent.html
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`parent.html`中，点击`parent.html`并将其下载到您的计算机：![图 11.16 – 下载 parent.html
- en: '](img/B17528_11_16.jpg)'
  id: totrans-126
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_16.jpg)'
- en: Figure 11.16 – Downloading parent.html
  id: totrans-127
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.16 – 下载 parent.html
- en: Open `parent.html` in your favorite text editor and change the value of the
    panel-heading tag to `Send "what is important for buyers" utterance to iframe`,
    as shown in the following screenshot. To bring this entry up, search for `Buy
    Flowers`.![Figure 11.17 – Changing the panel-heading tag in parent.html
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在您喜欢的文本编辑器中打开`parent.html`，并将panel-heading标签的值更改为`Send "what is important for
    buyers" utterance to iframe`，如以下截图所示。要找到该条目，请搜索`Buy Flowers`。![图 11.17 – 更改 parent.html
    中的 panel-heading 标签
- en: '](img/B17528_11_17.jpg)'
  id: totrans-129
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_17.jpg)'
- en: Figure 11.17 – Changing the panel-heading tag in parent.html
  id: totrans-130
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.17 – 更改 parent.html 中的 panel-heading 标签
- en: Continue to search for `Buy Flowers` and change the parameter for the `sendUtterance`
    function to `'what is important for buyers?'`, as shown in the following screenshot:![Figure
    11.18 – Changing the send utterance function input
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 继续搜索`Buy Flowers`，并将`sendUtterance`函数的参数更改为`'what is important for buyers?'`，如以下截图所示：![图
    11.18 – 更改发送语言表达函数输入
- en: '](img/B17528_11_18.jpg)'
  id: totrans-132
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_18.jpg)'
- en: Figure 11.18 – Changing the send utterance function input
  id: totrans-133
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.18 – 更改发送语言表达函数输入
- en: Now, go back to your Amazon S3 console, open the `parent.html` from, click **Upload**,
    and click on **Add files**.
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，返回您的 Amazon S3 控制台，打开`parent.html`，点击**上传**，然后点击**添加文件**。
- en: Select the modified `parent.html` from your local computer, scroll down, and
    click **Upload**.
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从您的本地计算机选择修改后的`parent.html`，向下滚动并点击**上传**。
- en: One of the resources that were provisioned by the CloudFormation stack was a
    CloudFront distribution. `CloudFront`, and click **CloudFront** in the list to
    go to the Amazon CloudFront console:![Figure 11.19 – Navigating to the Amazon
    CloudFront console](img/B17528_11_19.jpg)
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: CloudFormation 堆栈配置的资源之一是 CloudFront 分发。点击 **CloudFront**，在列表中点击 **CloudFront**
    以进入 Amazon CloudFront 控制台：![图 11.19 – 导航至 Amazon CloudFront 控制台](img/B17528_11_19.jpg)
- en: Figure 11.19 – Navigating to the Amazon CloudFront console
  id: totrans-137
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.19 – 导航至 Amazon CloudFront 控制台
- en: In the **CloudFront distributions** page, check the **Origin** field. You should
    see an entry here that matches the name of the **WebAppBucket** value you copied
    from the **Outputs** tab of your CloudFormation stack. Click the **ID** for this
    entry.
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 **CloudFront 分发** 页面中，检查 **Origin** 字段。您应该能在此看到一个条目，它的名称与您从 CloudFormation
    堆栈的 **Outputs** 选项卡中复制的 **WebAppBucket** 值匹配。点击此条目的 **ID**。
- en: In the details page for your CloudFront distribution, click the **Invalidations**
    tab to open it. Then, click the **Create Invalidation** button.![Figure 11.20
    – Creating invalidation for your CloudFront distribution
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 CloudFront 分发的详细信息页面中，点击 **Invalidations** 选项卡以打开它。然后，点击 **创建无效化** 按钮。![图
    11.20 – 为 CloudFront 分发创建无效化
- en: '](img/B17528_11_20.jpg)'
  id: totrans-140
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_20.jpg)'
- en: Figure 11.20 – Creating invalidation for your CloudFront distribution
  id: totrans-141
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.20 – 为 CloudFront 分发创建无效化
- en: In the `/`) in the **Object Paths** field and click **Invalidate**, as shown
    in the following screenshot. This should take about 5 minutes or so:![Figure 11.21
    – Invalidating CloudFront distribution
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 **Object Paths** 字段中的 `/` 处点击 **无效化**，如下截图所示。这个过程大约需要 5 分钟左右：![图 11.21 – 无效化
    CloudFront 分发
- en: '](img/B17528_11_21.jpg)'
  id: totrans-143
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_21.jpg)'
- en: Figure 11.21 – Invalidating CloudFront distribution
  id: totrans-144
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.21 – 无效化 CloudFront 分发
- en: Once the invalidation is completed, go back to the **Outputs** tab of your stack
    in the **Amazon CloudFormation** console and click the **ParentPageUrl** value:![Figure
    11.22 – Clicking ParentPageUrl value
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 无效化完成后，返回 **Amazon CloudFormation** 控制台中的堆栈 **Outputs** 选项卡，点击 **ParentPageUrl**
    值：![图 11.22 – 点击 ParentPageUrl 值
- en: '](img/B17528_11_22.jpg)'
  id: totrans-146
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_22.jpg)'
- en: Figure 11.22 – Clicking ParentPageUrl value
  id: totrans-147
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.22 – 点击 ParentPageUrl 值
- en: This will launch the website you provisioned, along with your chatbot. But before
    you can use your chatbot, Amazon Cognito will force you to sign into your website,
    as shown. If this is the first time you are accessing the website, click on the
    **Sign up** button and follow the instructions to sign up:![Figure 11.23 – Signing
    up or signing in to your website
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将启动您配置的网站，并展示您的聊天机器人。但在使用聊天机器人之前，Amazon Cognito 会强制您登录到网站，如下所示。如果这是您第一次访问该网站，请点击
    **注册** 按钮并按照提示进行注册：![图 11.23 – 注册或登录到您的网站
- en: '](img/B17528_11_23.jpg)'
  id: totrans-149
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_23.jpg)'
- en: Figure 11.23 – Signing up or signing in to your website
  id: totrans-150
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.23 – 注册或登录到您的网站
- en: You will receive a verification code in your email after you complete the sign-up
    process. Enter the verification code to be signed in:![Figure 11.24 – Entering
    the verification code
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 注册过程完成后，您将收到一封包含验证码的邮件。输入验证码即可登录：![图 11.24 – 输入验证码
- en: '](img/B17528_11_24.jpg)'
  id: totrans-152
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B17528_11_24.jpg)'
- en: Figure 11.24 – Entering the verification code
  id: totrans-153
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.24 – 输入验证码
- en: Now that you have signed in, your website along with your chatbot as a widget
    will be displayed. Click the **Send** button to send the first utterance to the
    bot. You can type subsequent questions:![Figure 11.25 – Text interaction with
    your Amazon Lex chatbot widget embedded in parent website](img/B17528_11_25.jpg)
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录后，您的网站及其作为小部件的聊天机器人将显示出来。点击 **发送** 按钮将第一次输入的语句发送给机器人。您可以输入后续问题：![图 11.25 –
    与嵌入在主网站中的 Amazon Lex 聊天机器人小部件进行文本交互](img/B17528_11_25.jpg)
- en: Figure 11.25 – Text interaction with your Amazon Lex chatbot widget embedded
    in parent website
  id: totrans-155
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 11.25 – 与嵌入在主网站中的 Amazon Lex 聊天机器人小部件进行文本交互
- en: Click the microphone button in the chat widget to talk to your bot. The bot
    will respond back in the voice, as shown in the next screenshot. Accept the notification
    from your browser to allow it to use the microphone to proceed.
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击聊天小部件中的麦克风按钮与机器人对话。机器人会用语音回应，如下图所示。接受浏览器的通知，允许它使用麦克风继续操作。
- en: '![Figure 11.26 – Voice interaction with your chatbot'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.26 – 与您的聊天机器人进行语音交互'
- en: '](img/B17528_11_26.jpg)'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17528_11_26.jpg)'
- en: Figure 11.26 – Voice interaction with your chatbot
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.26 – 与您的聊天机器人进行语音交互
- en: And that concludes the solution build for this chapter. Feel free to try out
    the solution and leave us your feedback. You can customize what we built in this
    chapter for your own needs very easily. For additional ideas on how you can use
    Amazon Kendra and Amazon Lex for your needs, please refer to the *Further reading*
    section.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 这就完成了本章的解决方案构建。请随时尝试这个解决方案并给我们反馈。你可以根据自己的需求轻松地定制我们在本章中构建的内容。有关如何利用Amazon Kendra和Amazon
    Lex满足你需求的更多想法，请参考*进一步阅读*部分。
- en: Summary
  id: totrans-161
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we built a solution using Amazon Kendra to automate searching
    for and deriving insights from document corpuses without having to manually read
    through the documents, understand the context, interpret the meaning, identify
    content across documents relevant to a common topic, and so on. We also saw how
    to set up an intelligent AI-based chat assistant using Amazon Lex that implicitly
    integrated with the Amazon Kendra intelligent search feature to provide a seamless
    chat and voice interface for (literally) "talking" to the document. Finally, we
    used a best practices approach with AWS CloudFormation to deploy our chatbot to
    a parent website as an embedded widget and distributed it using the Amazon CloudFront
    content delivery network.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们使用Amazon Kendra构建了一个解决方案，用于自动搜索并从文档语料库中提取洞察，无需手动阅读文档、理解上下文、解释含义、识别跨文档与共同主题相关的内容等等。我们还展示了如何使用Amazon
    Lex设置一个智能的基于AI的聊天助手，该助手隐式集成了Amazon Kendra的智能搜索功能，提供了一个无缝的聊天和语音界面，用于（字面上）“与文档对话”。最后，我们使用AWS
    CloudFormation的最佳实践方法将我们的聊天机器人部署到父网站作为嵌入式小部件，并通过Amazon CloudFront内容分发网络进行了分发。
- en: Interestingly, NLP has diverse uses in the field of medicine, as we will see
    in the next chapter, where we will review how NLP and AI technologies have helped
    transform modern-day medical claims processing. We will start by discussing how
    to automatically extract data from medical intake forms, how to understand the
    clinical data using **Amazon** **Comprehend Medical** ([https://aws.amazon.com/comprehend/medical/](https://aws.amazon.com/comprehend/medical/)),
    and how to set up a serverless real-time pipeline for the adjudication of medical
    claims. As before, we will introduce the use case, discuss how to design the architecture,
    establish the pre-requisites, and walk through in detail the various steps required
    to build the solution.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 有趣的是，NLP在医学领域有着多种应用，正如我们在下一章中将看到的那样，在那里我们将回顾NLP和AI技术如何帮助转变现代医疗索赔处理。我们将从讨论如何自动从医疗接收表单中提取数据开始，如何使用**Amazon**
    **Comprehend Medical** ([https://aws.amazon.com/comprehend/medical/](https://aws.amazon.com/comprehend/medical/))理解临床数据，以及如何为医疗索赔的裁定设置无服务器的实时管道。如之前所述，我们将介绍使用案例，讨论如何设计架构，建立前提条件，并详细讲解构建解决方案所需的各种步骤。
- en: Further reading
  id: totrans-164
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: '*Enhancing enterprise search with Amazon Kendra* by Leonardo Gomez: [https://aws.amazon.com/blogs/machine-learning/enhancing-enterprise-search-with-amazon-kendra/](https://aws.amazon.com/blogs/machine-learning/enhancing-enterprise-search-with-amazon-kendra/)'
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*通过Amazon Kendra增强企业搜索*，作者：Leonardo Gomez：[https://aws.amazon.com/blogs/machine-learning/enhancing-enterprise-search-with-amazon-kendra/](https://aws.amazon.com/blogs/machine-learning/enhancing-enterprise-search-with-amazon-kendra/)'
- en: '*How Citibot''s chatbot search engine uses AI to find more answers* by Francisco
    Zamora, Bratton Riley, and Nicholas Burden: [https://aws.amazon.com/blogs/machine-learning/how-citibots-chatbot-search-engine-uses-ai-to-find-more-answers/](https://aws.amazon.com/blogs/machine-learning/how-citibots-chatbot-search-engine-uses-ai-to-find-more-answers/)'
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Citibot的聊天机器人搜索引擎如何利用AI找到更多答案*，作者：Francisco Zamora、Bratton Riley 和 Nicholas
    Burden：[https://aws.amazon.com/blogs/machine-learning/how-citibots-chatbot-search-engine-uses-ai-to-find-more-answers/](https://aws.amazon.com/blogs/machine-learning/how-citibots-chatbot-search-engine-uses-ai-to-find-more-answers/)'
- en: '*Building an omnichannel Q and A chatbot with Amazon Connect, Amazon Lex, Amazon
    Kendra, and the open-source QnABot project* by Bob Strahan and Michael Widell:
    [https://aws.amazon.com/blogs/machine-learning/building-a-multi-channel-qa-chatbot-with-amazon-connect-amazon-lex-amazon-kendra-and-the-open-source-qnabot-project/?nc1=b_rp](https://aws.amazon.com/blogs/machine-learning/building-a-multi-channel-qa-chatbot-with-amazon-connect-amazon-lex-amazon-kendra-and-the-open-source-qnabot-project/?nc1=b_rp)'
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用Amazon Connect、Amazon Lex、Amazon Kendra以及开源QnABot项目构建全渠道问答聊天机器人*，作者：Bob
    Strahan 和 Michael Widell：[https://aws.amazon.com/blogs/machine-learning/building-a-multi-channel-qa-chatbot-with-amazon-connect-amazon-lex-amazon-kendra-and-the-open-source-qnabot-project/?nc1=b_rp](https://aws.amazon.com/blogs/machine-learning/building-a-multi-channel-qa-chatbot-with-amazon-connect-amazon-lex-amazon-kendra-and-the-open-source-qnabot-project/?nc1=b_rp)'
