- en: Time Series Analysis
  id: totrans-0
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列分析
- en: In the previous chapter, we introduced AI, machine learning, and deep learning.
    We also discovered how the banking sector functions and how the use of AI can
    enhance banking processes. We learned the importance of banking processes being
    easily accessible. We also learned about a machine learning modeling approach
    called **CRISP-DM**. Overall, the chapter provided the necessary background for
    the application of machine learning in the banking industry to solve various business
    problems.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们介绍了人工智能、机器学习和深度学习。我们还了解了银行业的运作方式以及人工智能如何增强银行业务流程。我们学习了银行流程如何变得更易于访问的重要性。我们还了解了一种名为**CRISP-DM**的机器学习建模方法。总体而言，本章为机器学习在银行业中的应用提供了必要的背景知识，以解决各种商业问题。
- en: In this chapter, we will learn about an algorithm that analyzes historical data
    to forecast future behavior, known as **time series analysis**. Time series analysis
    works on the basis of one variable—time. It is the process of capturing data points,
    also known as **observations**, at specific time intervals. The goal of this chapter
    is to understand time series analysis in detail through examples and explain how
    **Machine-to-Machine** (**M2M**) communication can be helpful in the implementation
    of time series analysis. We will also understand the concepts of financial banking
    as well.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将学习一种算法，该算法通过分析历史数据来预测未来的行为，这就是**时间序列分析**。时间序列分析基于一个变量——时间。它是通过在特定时间间隔捕获数据点，也称为**观测值**的过程。本章的目标是通过示例详细了解时间序列分析，并解释**机器对机器**（**M2M**）通信如何在实施时间序列分析中起到帮助作用。我们还将理解金融银行的相关概念。
- en: 'In this chapter, we will cover the following topics :'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主题：
- en: Understanding time series analysis
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解时间序列分析
- en: M2M communication
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: M2M通信
- en: The basic concepts of financial banking
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 金融银行的基本概念
- en: AI modeling techniques
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 人工智能建模技术
- en: Demand forecasting using time series analysis
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用时间序列分析进行需求预测
- en: Procuring commodities using neural networks on Keras
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Keras神经网络采购商品
- en: Understanding time series analysis
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解时间序列分析
- en: 'A **time series** is technically defined as the ordered sequence of values
    of a variable captured over a uniformly spaced time interval. Put simply, it is
    the method of capturing the value of a variable at specific time intervals. It
    can be 1 hour, 1 day, or 20 minutes. The captured values of a variable are also
    known as **data points**. Time series analysis is performed in order to understand
    the structure of the underlying sources that produced the data. It is also used
    in forecasting, feedforward control, monitoring, and feedback. The following is
    a list of some of the known applications of time series analysis:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '**时间序列**在技术上定义为在均匀时间间隔内捕获的一个变量的有序数值序列。简单来说，它是在特定时间间隔捕获一个变量的值的方法。可以是1小时、1天或20分钟。所捕获的变量值也称为**数据点**。进行时间序列分析的目的是理解产生数据的底层源的结构。它也用于预测、前馈控制、监控和反馈。以下是时间序列分析的一些已知应用：'
- en: Utility studies
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 公用事业研究
- en: Stock market analysis
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 股票市场分析
- en: Weather forecasting
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 天气预测
- en: Sales projections
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 销售预测
- en: Workload scheduling
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 工作负载调度
- en: Expenses forecasting
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 费用预测
- en: Budget analysis
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 预算分析
- en: Time series analysis is achieved by applying various analytical methods to extract
    meaningful information from raw data that has been captured from various data
    sources. Time series analysis is also useful for producing statistics and other
    characteristics of data—for example, the size of data, the type of data, the frequency
    of data, and more. In time series analysis, the capturing of a value is done at
    a point of observation.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列分析是通过应用各种分析方法，从各种数据源捕获的原始数据中提取有意义的信息。时间序列分析还可以用来生成数据的统计信息和其他特征——例如数据的大小、数据的类型、数据的频率等。在时间序列分析中，值的捕获是在观察点进行的。
- en: Let's try to understand this through an example. When using time series analysis
    modeling, the branch manager of a specific branch can predict or forecast the
    expenses that will occur in the upcoming year. The branch manager can do this
    by employing a time series analysis machine learning model and then training the
    model using historical yearly expense records. The recorded observations can be
    plotted on a graph with a specific time (each day, in this example) on the *x*
    axis and historical expenses on the *y* axis. Therefore, time series analysis
    is an algorithm that is used to forecast the future values of one variable (that
    is, yearly expenses in this example) based on the values captured for another
    variable (in this case, time).
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过一个例子来尝试理解这个过程。在使用时间序列分析建模时，特定分行的分行经理可以预测或预报即将发生的费用。分行经理可以通过采用时间序列分析机器学习模型，并使用历史的年度费用记录来训练该模型，进而实现预测。记录的观察数据可以绘制在图表上，图表的横轴（在此示例中为每一天）表示时间，纵轴表示历史费用。因此，时间序列分析是一种算法，用来根据另一个变量（在此例中为时间）所捕获的值，预测一个变量（即年度费用）未来的值。
- en: Let's understand this in more detail using another example. In this example,
    we will imagine that a bank wants to perform expense projections based on the
    historical data it has. The bank manager wants to know and forecast the expenses
    in the year 2020 for the branch that he manages. So, the process of forecasting
    the expenses will start by collecting historical expenses information from the
    year 2000\. First, the bank manager will look at the expenses data for the year.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过另一个例子来更详细地理解这个问题。在这个例子中，我们假设一家银行希望根据其历史数据进行费用预测。银行经理希望了解并预测他所管理的分行2020年的费用。因此，预测费用的过程将从收集2000年以后的历史费用信息开始。首先，银行经理会查看该年度的费用数据。
- en: 'As we mentioned earlier, time series analysis is done by capturing the values
    of a variable. Can you guess the variable in this example? I am sure that you
    will have guessed it by now. The variable under observation is the total expense
    amount per year. Let''s assume that the following is the data per year:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们之前提到的，时间序列分析是通过捕获一个变量的值来进行的。你能猜到这个例子中的变量是什么吗？我相信你现在已经猜出来了。被观察的变量是每年的总费用。假设以下是每年的数据：
- en: '| **Year** | **Total expense (in USD)** |'
  id: totrans-23
  prefs: []
  type: TYPE_TB
  zh: '| **年份** | **总费用（以美元计）** |'
- en: '| 2000 | 20,000 |'
  id: totrans-24
  prefs: []
  type: TYPE_TB
  zh: '| 2000 | 20,000 |'
- en: '| 2001 | 22,500 |'
  id: totrans-25
  prefs: []
  type: TYPE_TB
  zh: '| 2001 | 22,500 |'
- en: '| 2002 | 21,000 |'
  id: totrans-26
  prefs: []
  type: TYPE_TB
  zh: '| 2002 | 21,000 |'
- en: '| 2003 | 18,000 |'
  id: totrans-27
  prefs: []
  type: TYPE_TB
  zh: '| 2003 | 18,000 |'
- en: '| 2004 | 25,700 |'
  id: totrans-28
  prefs: []
  type: TYPE_TB
  zh: '| 2004 | 25,700 |'
- en: '| 2005 | 22,100 |'
  id: totrans-29
  prefs: []
  type: TYPE_TB
  zh: '| 2005 | 22,100 |'
- en: '| 2006 | 23,300 |'
  id: totrans-30
  prefs: []
  type: TYPE_TB
  zh: '| 2006 | 23,300 |'
- en: '| 2007 | 17,600 |'
  id: totrans-31
  prefs: []
  type: TYPE_TB
  zh: '| 2007 | 17,600 |'
- en: '| 2008 | 18,200 |'
  id: totrans-32
  prefs: []
  type: TYPE_TB
  zh: '| 2008 | 18,200 |'
- en: '| 2009 | 20,400 |'
  id: totrans-33
  prefs: []
  type: TYPE_TB
  zh: '| 2009 | 20,400 |'
- en: '| 2010 | 21,200 |'
  id: totrans-34
  prefs: []
  type: TYPE_TB
  zh: '| 2010 | 21,200 |'
- en: '| 2011 | 20,900 |'
  id: totrans-35
  prefs: []
  type: TYPE_TB
  zh: '| 2011 | 20,900 |'
- en: '| 2012 | 22,600 |'
  id: totrans-36
  prefs: []
  type: TYPE_TB
  zh: '| 2012 | 22,600 |'
- en: '| 2013 | 17,500 |'
  id: totrans-37
  prefs: []
  type: TYPE_TB
  zh: '| 2013 | 17,500 |'
- en: '| 2014 | 19,300 |'
  id: totrans-38
  prefs: []
  type: TYPE_TB
  zh: '| 2014 | 19,300 |'
- en: '| 2015 | 20,100 |'
  id: totrans-39
  prefs: []
  type: TYPE_TB
  zh: '| 2015 | 20,100 |'
- en: '| 2016 | 22,200 |'
  id: totrans-40
  prefs: []
  type: TYPE_TB
  zh: '| 2016 | 22,200 |'
- en: '| 2017 | 22,500 |'
  id: totrans-41
  prefs: []
  type: TYPE_TB
  zh: '| 2017 | 22,500 |'
- en: '| 2018 | 19,400 |'
  id: totrans-42
  prefs: []
  type: TYPE_TB
  zh: '| 2018 | 19,400 |'
- en: '| 2019 | 23,800 |'
  id: totrans-43
  prefs: []
  type: TYPE_TB
  zh: '| 2019 | 23,800 |'
- en: Many options are available to analyze this data and predict future expenses.
    The analytical methods vary in terms of complexity. The simplest one will be to
    average out the expenses and assume the resultant value to be the number of expenses
    for the year 2020\. However, this is solely for the purpose of our example. You
    can find the average of expenses by using various other mathematical and analytical
    methods as well. With this option, the total number of expenses for the year 2020
    will be $20,915.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 有多种选项可用来分析这些数据并预测未来的费用。分析方法的复杂性各不相同。最简单的方法是将费用取平均值，并假设结果值就是2020年的费用总额。然而，这仅仅是为了我们的示例。你也可以使用各种其他数学和分析方法来计算费用的平均值。采用这种方法，2020年的总费用将为20,915美元。
- en: 'The complex method may involve analyzing detailed expenses, predicting future
    values for each individual expense type, and deriving the total expenses amount
    based on it. This may provide a more accurate prediction than the averaging option.
    You can apply a more complex analytical method based on your needs. This example
    is provided so that you can understand how time series analysis works. The amount
    of historical data that we have used in this example is very limited. AI and machine
    learning algorithms use large amounts of data to generate predictions or results.
    The following is a graphical representation of this example:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 复杂的方法可能涉及分析详细的开支，预测每种开支类型的未来数值，并基于此推导出总开支金额。这可能提供比平均法更准确的预测。你可以根据需求应用更复杂的分析方法。这个例子是为了帮助你理解时间序列分析的工作原理。我们在这个例子中使用的历史数据量非常有限。AI
    和机器学习算法使用大量数据来生成预测或结果。以下是该例子的图形表示：
- en: '![](img/90ebad2e-e7a3-41dd-812e-6494224f4423.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![](img/90ebad2e-e7a3-41dd-812e-6494224f4423.jpg)'
- en: In the following section, we will learn how machines can communicate with each
    other using a concept known as **M2M communication**.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的部分中，我们将学习机器如何通过一种称为**M2M 通信**的概念进行互相沟通。
- en: M2M communication
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: M2M 通信
- en: M2M communication is extremely powerful and can dramatically improve the functions
    of commercial banking.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: M2M 通信非常强大，能够显著提升商业银行的功能。
- en: M2M communication represents the communication between two machines or devices
    through various channels such as physical networks, information-sharing networks,
    software communication, and application interfaces. The sole purpose of M2M communication
    is the exchange of information across two or more machines or between software
    running on those machines.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: M2M 通信代表通过各种渠道（如物理网络、信息共享网络、软件通信和应用程序接口）进行的机器或设备之间的通信。M2M 通信的唯一目的是在两台或更多机器之间，或运行在这些机器上的软件之间交换信息。
- en: 'The concept of M2M communication assumes that no human intervention is required
    while exchanging information between machines. M2M communication can also take
    place over wireless networks. Wireless networks have made M2M communication easier
    and more accessible. The following list includes several common applications of
    M2M communication:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: M2M 通信的概念假设在机器之间交换信息时不需要人工干预。M2M 通信也可以通过无线网络进行。无线网络使得 M2M 通信更加便捷和普及。以下列出了 M2M
    通信的一些常见应用：
- en: Manufacturing
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 制造业
- en: Smart utility management
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 智能公用事业管理
- en: Home appliances
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 家用电器
- en: Healthcare device management
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 医疗设备管理
- en: However, M2M communication is different from IoT. IoT uses sensors to trigger
    inputs, whereas M2M communication specifically refers to the interaction between
    two systems.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，M2M 通信与物联网（IoT）不同。物联网使用传感器触发输入，而 M2M 通信则专门指两个系统之间的交互。
- en: Commercial banking is a group of financial services that includes deposits,
    checking account services, loan services, drafts, certificates of deposits, and
    savings accounts for individuals and businesses. Commercial banks are the usual
    destination for peoples' banking needs. *But how do banks function and make money?*
    This is a very common question that we will answer right now. Commercial banks
    make money when they earn interest from various types of loans that they provide
    to their customers. The types of loans can vary, for example, automobile loans,
    business loans, personal loans, and mortgage loans. Usually, a commercial bank
    has a specialty in one or more types of loans.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 商业银行是一组金融服务，包括个人和企业的存款、支票账户服务、贷款服务、汇票、存单和储蓄账户。商业银行是人们银行需求的常见去处。*但银行是如何运作并盈利的呢？*
    这是一个非常常见的问题，我们现在来解答。商业银行通过从它们提供给客户的各种贷款中赚取利息来赚钱。贷款种类可以有所不同，例如汽车贷款、商业贷款、个人贷款和抵押贷款。通常，商业银行在一种或多种类型的贷款方面有一定的专长。
- en: Commercial banks get their capital from various types of account services that
    they provide to their customers. The types of accounts include checking accounts,
    savings accounts, corporate accounts, money market accounts, and more. Banks utilize
    this capital to invest in high-return investment options such as mutual funds,
    stocks, and bonds. Banks have to pay interest to those customers who have their
    accounts with the bank. The rate of interest is far less when compared to loans,
    however.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 商业银行通过向客户提供各种类型的账户服务来获取资本。这些账户类型包括支票账户、储蓄账户、公司账户、货币市场账户等。银行利用这些资本投资于高回报的投资选项，如共同基金、股票和债券。然而，银行必须向那些在银行开设账户的客户支付利息，尽管与贷款相比，利率要低得多。
- en: The role of M2M communication in commercial banking
  id: totrans-59
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: M2M通信在商业银行中的作用
- en: Consider an example that involves transferring money from one customer's account
    to another customer's account. In the past, this was a manual task that required
    filling in an appropriate form, submitting the form to the appropriate department
    where ledger entries were created, and then the amount was debited from one account
    and credited to the beneficiary's account.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑一个涉及将钱从一个客户账户转到另一个客户账户的例子。在过去，这是一项手动任务，需要填写适当的表格，提交表格到相关部门进行账本登记，然后从一个账户中扣款并将款项存入受益人的账户。
- en: Nowadays, this process has changed entirely. With a mobile phone, the customer can
    transfer funds from one account to another without any hassle. The beneficiary's
    account will be credited with the money within a few minutes. Incredible, isn't
    it? So, how did this happen? Well, M2M communication and process automation have
    played a major role in making this happen. It has become possible for machines
    (that is, computer systems, cloud-based virtual machines, and mobile devices)
    to connect over a wireless or wired network and transfer every piece of necessary
    information to another machine or software running on that machine. Nowadays,
    you only have to visit the bank for a few specific reasons. Customers can now
    even open a savings bank account or a loan account straight from their mobile
    devices.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 如今，这一过程已经完全改变。有了手机，客户可以轻松地将资金从一个账户转移到另一个账户。受益人的账户将在几分钟内收到款项。不可思议，对吧？那么，这一切是怎么发生的呢？实际上，M2M通信和流程自动化在其中起到了重要作用。现在，计算机系统、基于云的虚拟机和移动设备等机器可以通过无线或有线网络连接，向另一台机器或运行在该机器上的软件传输所有必要的信息。如今，客户只需因特定原因前往银行。客户甚至可以直接通过手机开设储蓄账户或贷款账户。
- en: The basic concepts of financial banking
  id: totrans-62
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 金融银行的基本概念
- en: Before we move full steam ahead into another example, we will first craft out
    our data, AI, and business techniques and knowledge. If you are familiar with
    all of these concepts, feel free to skip this section.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们全速进入下一个示例之前，我们首先将构建出我们的数据、人工智能和商业技术及知识。如果你对这些概念已经很熟悉，可以跳过这一部分。
- en: Financial knowledge is a good place to start to understand how our decisions
    in forecasting business activities impact financial decision-making in non-financial
    firms. Additionally, when predicting future activities using a machine learning
    model, we also learn how the finance industry can prepare for this future volume
    of business. What financing does to help with core business activities in non-financial
    firms is covered in the following section.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 金融知识是理解我们在预测商业活动时如何影响非金融公司财务决策的一个很好的起点。此外，在使用机器学习模型预测未来活动时，我们也能了解金融行业如何为未来的业务量做好准备。融资对非金融公司核心业务活动的帮助将在以下部分中讨论。
- en: The functions of financial markets – spot and future pricing
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 金融市场的功能——现货和期货定价
- en: Financial markets, such as exchanges, play the role of markets for products
    to be exchanged. For example, consider commodities such as natural gas—we can
    either buy it directly from sellers or buy it via an exchange. As it turns out,
    long-running economics theories encourage you to buy the product from an exchange
    as much as possible if the product is standardized. **Chicago Mercantile Exchange**
    (**CME**) in the US could be a popular choice for commodities and, needless to
    say, the **New York Stock Exchange** (**NYSE**) is the market for publicly listed
    equities.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 金融市场，如交易所，扮演着交换产品的市场角色。例如，考虑天然气这样的商品——我们可以直接从卖家购买，也可以通过交易所购买。实际上，长期的经济学理论鼓励你尽可能通过交易所购买标准化商品。如果是标准化商品，美国的**芝加哥商业交易所**（**CME**）可能是一个热门选择，此外，**纽约证券交易所**（**NYSE**）则是上市股票的市场。
- en: In this chapter, let's stick to natural gas as a product that we need. Of course,
    in some cases, it could be more efficient to buy it from big oil companies such
    as Shell—that is, if we want these physical goods from producers on a regular
    basis.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将天然气作为需要的产品。当然，在某些情况下，从壳牌等大型石油公司购买可能更有效——即如果我们希望定期从生产商那里获得这些实物商品。
- en: Within exchange markets, there are two prices— the spot price and the future
    price. **Spot price** means you can have goods (delivered) now if you pay; **future
    price** means you get the goods later by paying now.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 在交易市场中，有两种价格——现货价格和期货价格。**现货价格**意味着如果你支付，就可以立即获得货物（交付）；**期货价格**意味着你现在支付，稍后会获得货物。
- en: Choosing between a physical delivery and cash settlement
  id: totrans-69
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 选择实物交付和现金结算之间的区别
- en: 'Even if a change in ownership is to take place, it could occur in two forms,
    that is, via physical delivery or a cash settlement. Ultimately, physical delivery
    or a cash settlement depends on whether we need the goods immediately or not.
    However, on any given trading day, we must weigh up the cost of only two options:
    *physical delivery (cost of natural gas + cost of financing + cost of storage)
    as opposed to a cash settlement*.'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 即使所有权发生变化，也可能有两种形式：即通过实物交付或现金结算。最终，实物交付或现金结算取决于我们是否需要立即获得货物。然而，在任何交易日，我们必须权衡两种选择的成本：*实物交付（天然气成本+融资成本+储存成本）与现金结算*。
- en: 'Essentially, we have four options, as presented in the following table—assuming
    that we need to have the physical natural gas product in 3 months time for the
    generation of electricity:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 本质上，我们有四种选择，如下表所示——假设我们需要在3个月内获得天然气实物产品以进行发电：
- en: '|  | **Physical delivery** | **Cash settlement** |'
  id: totrans-72
  prefs: []
  type: TYPE_TB
  zh: '|  | **实物交付** | **现金结算** |'
- en: '| **Spot** | Finance the purchase to get the product now; store it for 3 months.
    | Buy the product now and own it on paper. There is no need to keep the goods. 
    |'
  id: totrans-73
  prefs: []
  type: TYPE_TB
  zh: '| **现货** | 资助购买以立即获得产品；储存3个月。 | 立即购买产品并在纸面上拥有它，无需保管货物。 |'
- en: '| **Future** | Finance the purchase now to get the product in the future; get
    it in 3 months. | Finance to buy the product in the future. 3 months later, purchase
    on spot from the market with physical delivery. |'
  id: totrans-74
  prefs: []
  type: TYPE_TB
  zh: '| **期货** | 现在融资购买以在未来获得产品；3个月后获得。 | 融资购买未来的产品。3个月后，从市场上以现货购买并进行实物交付。 |'
- en: 'To weigh up the options, we require the following data:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 为了权衡各种选择，我们需要以下数据：
- en: '**Storage costs** should be provided by the internal source if the company
    owns the storage facility for natural gas. It is assumed to be rather static,
    for example, at around 0.12 per MMBtu. MMBtu is a unit used to measure the energy
    content in fuel. It stands for one **Million British Thermal Units**.'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**储存成本**应由内部来源提供，如果公司拥有天然气的储存设施。假设这个成本相对稳定，例如每MMBtu约为0.12美元。MMBtu是用来衡量燃料能量含量的单位，代表百万英国热量单位（**Million
    British Thermal Units**）。'
- en: The **financing cost** should cover the storage period and the interest expenses
    for the purchase cost. It is assumed to be $0.1 per MMBtu. This should be fed
    by the bank.
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**融资成本**应涵盖存储期和购买成本的利息费用。假设为每MMBtu 0.1美元。此费用应由银行提供。'
- en: The **cost of natural gas** (spot price) should be provided by the market data
    provider. The real-time Henry Hub spot price should be provided by Thomson Reuters,
    for example, at around $2.5 per MMBtu.
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**天然气成本**（现货价格）应由市场数据提供商提供。例如，实时亨利中心现货价格应由汤森路透提供，约为每MMBtu 2.5美元。'
- en: The **cost of futures** should be provided by CME. Data should be available
    on Quandl free of charge. It should be around $3 per MMBtu for 3-month contract.
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**期货成本**应由CME提供。数据应在Quandl上免费提供。对于3个月期货合同，成本应该在每MMBtu $3左右。'
- en: The numbers given here merely provide an indication of the magnitude of values.
    Of course, they could be optimized by comparing the options—however, the decisions
    can be derived by linear algebra, and not many machine learning techniques are
    needed. In real life, we should not impose a machine learning solution on anything
    if we can have a nice deterministic formula to do so.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 这里给出的数字仅提供了数值大小的指示。当然，它们可以通过比较选项进行优化——然而，这些决策可以通过线性代数推导出来，而不需要许多机器学习技术。在现实生活中，如果我们可以使用一个简洁的确定性公式来解决问题，就不应该强行使用机器学习解决方案。
- en: Options to hedge price risk
  id: totrans-81
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 对冲价格风险的期权
- en: To avoid the price swinging outside the predefined price range of natural gas,
    we will need heuristic rules such as deciding what to do at what price given a
    fixed target purchase quantity. Alternatively, we need the rules to adjust what
    has been already placed to sell or buy more.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 为了避免天然气价格波动超出预定范围，我们需要采用启发式规则，例如在给定固定目标采购数量的情况下，根据价格决定采取何种行动。或者，我们需要规则来调整已经下单的卖出或买入数量。
- en: 'Take the following example. If the price is beyond the acceptable range, for
    example, lower than $2.84 or higher than $3.95, we can choose to pocket the profit
    by doing one of the following:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 以以下示例为例。如果价格超出了可接受的范围，例如低于$2.84或高于$3.95，我们可以选择通过以下方式锁定利润：
- en: Writing options (selling insurance) if the price drops a lot.
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果价格大幅下跌，可以选择卖出期权（卖保险）。
- en: Reducing the loss by buying options (buying insurance) if the price shoots up
    unfavorably.
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果价格不利地飙升，可以通过购买期权（购买保险）来减少损失。
- en: 'The following diagram shows the per-unit payoff from the hedged position by
    buying insurance against the high procurement price and selling the benefits at
    a low procurement price:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表显示了通过购买保险对冲高采购价格并在低采购价格下出售收益的每单位收益：
- en: '![](img/4cb00173-c7a8-4eb2-b418-544488501838.png)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4cb00173-c7a8-4eb2-b418-544488501838.png)'
- en: Here, we have sold insurance at an extremely low price—which means that even
    though we should have enjoyed a lower cost of procurement, we gave it away at
    the benefit of taking an insurance premium. On the other hand, there will be positive
    payoff when the price is too expensive, that may eat into the profitability of
    the company—by paying a premium to buy insurance. The exact price of the insurance
    is called option pricing and will be addressed in [Chapter 7](d29ff3a8-3879-4d50-8795-a39bae5cc793.xhtml),
    *Sensing Market Sentiment for Algorithmic Marketing at Sell Side*. We now assume
    that the price we pay for the insurance is the same as the price we earn from
    selling insurance.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们以极低的价格卖出了保险——这意味着尽管我们本应享有更低的采购成本，但我们通过接受保险费用将其赠送出去。另一方面，当价格过高时，会产生正向收益，这可能侵蚀公司的盈利能力——通过支付保费购买保险。保险的确切价格称为期权定价，将在[第7章](d29ff3a8-3879-4d50-8795-a39bae5cc793.xhtml)《面向卖方的算法营销中的市场情绪感知》中讨论。我们现在假设我们支付的保险费用与卖出保险所赚取的费用相同。
- en: AI modeling techniques
  id: totrans-89
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: AI建模技术
- en: 'In the following sections, we will introduce the **Autoregressive Integrated
    Moving Average** (**ARIMA**), the most traditional type of forecasting model.
    We will also introduce a neural network model. ARIMA is a class of statistical
    models that is used to forecast a time series using past values. ARIMA is an acronym
    for the following:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的部分，我们将介绍**自回归积分滑动平均**（**ARIMA**）模型，这是最传统的预测模型类型。我们还将介绍一个神经网络模型。ARIMA是一类用于使用过去值预测时间序列的统计模型。ARIMA是以下词组的首字母缩写：
- en: '**AR** (**autoregression**): Autoregression is a process that takes previous
    data values as inputs, applies this to the regression equation, and generates
    resultant prediction-based data values.'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**AR**（**自回归**）：自回归是一种将先前的数据值作为输入，应用于回归方程并生成基于预测的结果数据值的过程。'
- en: '**I** (**integrated**): ARIMA uses an integrated approach by using differences
    in observations to make the time series equally spaced. This is done by subtracting
    the observation from an observation on a previous step or time value.'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**I**（**积分**）：ARIMA通过使用观测值的差异来进行积分处理，使时间序列等间隔。这是通过将当前观测值与前一个时间步骤的观测值相减来实现的。'
- en: '**MA** (**moving average**): A model that uses the observation and the residual
    error applied to past observations.'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**MA**（**移动平均**）：一种使用观测值和应用于过去观测值的残差误差的模型。'
- en: '**Introducing the time series model – ARIMA**'
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**介绍时间序列模型——ARIMA**'
- en: For this project, we will fit data into a time series model called **ARIMA**.
    ARIMA is a specific type of time series model in statistics, which is commonly
    used to predict data points in the future, with parameters on autoregressive terms
    (*p*), non-seasonal differences (*d*), and lagged terms (*q*).
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个项目中，我们将数据拟合到一个称为**ARIMA**的时间序列模型。ARIMA是统计学中一种特定类型的时间序列模型，通常用于预测未来的数据点，包含自回归项（*p*）、非季节性差分项（*d*）和滞后项（*q*）的参数。
- en: This ARIMA model belongs to parametric modeling—models that are fitted by known
    parameters. Normally, we classify this type of model as a statistical model because
    we need to make assumptions about what the data looks like. This is considerably
    different for wider machine learning models that do not have any preset assumptions
    about what the data looks like.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 这个ARIMA模型属于参数模型——通过已知参数拟合的模型。通常，我们将这种类型的模型归类为统计模型，因为我们需要对数据的形态做出假设。这与没有预设假设数据形态的更广泛的机器学习模型有很大不同。
- en: However, in a real banking scenario, a statistical approach is still prevalent
    among the econometrics, quantitative finance, and risk management domains. This
    approach works when we have a handful of data points, for example, around 30 to
    100 data points. However, when we have a wealth of data, this approach may not
    fare as well as other machine learning approaches.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，在实际的银行场景中，统计方法仍然在计量经济学、定量金融和风险管理领域占主导地位。当我们拥有少量数据点时，例如大约30到100个数据点，这种方法是有效的。然而，当我们拥有大量数据时，这种方法可能不如其他机器学习方法有效。
- en: 'ARIMA assumes that there is a stationary trend that we can describe. The autoregressive
    terms, *p* and *d*, are each significant in their own way:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: ARIMA假设存在一个可以描述的平稳趋势。自回归项*p*和*d*各自在其方式上都是重要的：
- en: '*p* means the number of past period(s) that is affecting the current period
    value (for example, *p = 1: Y current period = Y current -1 period * coefficient
    + constant*).'
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*p*意味着影响当前周期值的过去周期数（例如，*p = 1*：当前周期的*Y* = 当前周期的*Y* - 1周期 * 系数 + 常数*）。'
- en: 'Non-seasonal difference (*d*) refers to the number of past periods progression
    impacting the current period values (for example, *d = 1*: the difference between *Y* now versus *Y* in
    the past period).'
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 非季节性差分（*d*）是指过去几个周期的变化对当前周期值的影响（例如，*d = 1*：当前的*Y*与上一个周期的*Y*之间的差异）。
- en: Lagged terms (*q*) means the number of the past period's forecast errors impacting
    the current period values.
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 滞后项（*q*）是指过去周期的预测误差对当前周期值的影响。
- en: 'Consider an example in which *q = 1: Y* impacted by an error in the *t - 1* period—here,
    error refers to the difference between the actual and predicted values.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑一个例子，其中*q = 1*：*Y*受到*t - 1*周期的误差影响——这里，误差是指实际值与预测值之间的差异。
- en: In a nutshell, ARIMA specifies how the previous period's coefficient, constant,
    error terms, and even predicted values impact the current predicted values. It
    sounds scary, but it is, in fact, very understandable.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 简而言之，ARIMA指定了前一时期的系数、常数、误差项，甚至是预测值如何影响当前的预测值。听起来有点吓人，但事实上它是非常易于理解的。
- en: After the model is fit, it will be asked to make a prediction and be compared
    against the actual testing data. The deviation of the prediction from the testing
    data will record the accuracy of the model. We will use a metric called the **Mean
    Square Error** (**MSE**) in this chapter to determine the fitness of the model
    to the data.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 在模型拟合后，它将被要求进行预测，并与实际的测试数据进行比较。预测与测试数据之间的偏差将记录模型的准确性。在本章中，我们将使用一种叫做**均方误差**（**MSE**）的度量标准来确定模型对数据的拟合度。
- en: Introducing neural networks – the secret sauce for accurately predicting demand
  id: totrans-105
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 介绍神经网络——精准预测需求的秘密武器
- en: We may have a good data source, but we should not forget that we also need a
    smart algorithm. You may have read about neural networks thousands of times, but
    let's look at a short explanation before we use them extensively throughout the
    book. A neural network is an attempt by a computer to mimic how our brain works—it
    works by connecting different computing points/neurons with different settings.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可能有一个很好的数据源，但我们不应忘记我们还需要一个智能算法。你可能已经读过成千上万次关于神经网络的文章，但在我们在本书中广泛使用它们之前，让我们先来看一个简短的解释。神经网络是计算机模仿我们大脑工作方式的一种尝试——它通过不同的计算点/神经元连接来工作，且这些连接有不同的设置。
- en: 'Architecture-wise, it looks like layers of formulas. Those of you reading this
    book probably have some background in algebra, and can see how the interested
    outcome *Y* is related to *X*, the variable, with *b* being the coefficient and
    *c* being the constant term:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 从架构上看，它像是公式的层次结构。你们中间阅读本书的读者可能有一定的代数基础，可以看到所关心的结果 *Y* 是如何与变量 *X* 相关联的，其中 *b*
    是系数，*c* 是常数项：
- en: '![](img/c5eb98bf-4c05-4d02-9ccf-9d61d6cbac22.png)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c5eb98bf-4c05-4d02-9ccf-9d61d6cbac22.png)'
- en: '*Y* is what we wish to predict on the left-hand side; on the right-hand side, *bX
    + c* are the forms that describe how the feature (*X*) is related to *Y*. In other
    words, *Y* is the output, while *X* is the input. The neural network describes
    the relationship between the input and the output.'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '*Y* 是我们希望在左侧预测的内容；在右侧，*bX + c* 是描述特征（*X*）与 *Y* 之间关系的形式。换句话说，*Y* 是输出，而 *X* 是输入。神经网络描述了输入与输出之间的关系。'
- en: 'Suppose that *Z* is what we want to predict:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 假设 *Z* 是我们想要预测的内容：
- en: '![](img/e582ab05-9812-4fb9-bf27-7931cad554a0.png)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e582ab05-9812-4fb9-bf27-7931cad554a0.png)'
- en: 'It seems that the formulas are linked:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 看起来这些公式是相互关联的：
- en: '![](img/30df07a7-15f5-4c36-a4e8-8e274f6dfad2.png)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![](img/30df07a7-15f5-4c36-a4e8-8e274f6dfad2.png)'
- en: This is the simplest form of a neural network, with one input layer, one hidden
    layer, and one output layer. Each of the layers has one neuron (point).
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 这是神经网络最简单的形式，包含一个输入层、一个隐藏层和一个输出层。每一层都有一个神经元（点）。
- en: I encourage you to read research papers and introductory text on machine learning
    or even enroll yourself for online courses. Useful resources from Packt include Sebastian
    Raschka and Vahid Mirjalili's *Python Machine Learning* ([https://www.packtpub.com/big-data-and-business-intelligence/python-machine-learning-second-edition](https://www.packtpub.com/big-data-and-business-intelligence/python-machine-learning-second-edition)) and Rowel
    Atienza's *Advanced Deep Learning with* *Keras* ([https://www.packtpub.com/big-data-and-business-intelligence/advanced-deep-learning-keras](https://www.packtpub.com/big-data-and-business-intelligence/advanced-deep-learning-keras))*.*
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 我鼓励你阅读关于机器学习的研究论文和入门教材，甚至可以报名参加在线课程。来自Packt的有用资源包括Sebastian Raschka和Vahid Mirjalili的*《Python机器学习》*（[https://www.packtpub.com/big-data-and-business-intelligence/python-machine-learning-second-edition](https://www.packtpub.com/big-data-and-business-intelligence/python-machine-learning-second-edition)）和Rowel
    Atienza的*《深度学习进阶与Keras》*（[https://www.packtpub.com/big-data-and-business-intelligence/advanced-deep-learning-keras](https://www.packtpub.com/big-data-and-business-intelligence/advanced-deep-learning-keras)）*。
- en: Backpropagation
  id: totrans-116
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 反向传播
- en: There are other concepts in neural networks, such as backpropagation. This refers
    to the feedback mechanism that fine-tunes the neural network's parameters, which
    mostly connect neurons within the network (except when it is a constant parameter
    at the layer). It works by comparing the output at output layer *Z* (predicted)
    versus the actual value of *Z* (actual). The wider the gap between actual and
    predicted, the more adjustment of *b*, *c*, *d*, and *e* is needed.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 神经网络中还有其他概念，比如反向传播。它指的是一个反馈机制，用来微调神经网络的参数，这些参数大多数是在网络内连接神经元（除非它是层中的常数参数）。它通过比较输出层
    *Z*（预测值）与 *Z* 的实际值（实际值）来工作。实际值与预测值之间的差距越大，就越需要调整 *b*、*c*、*d* 和 *e*。
- en: Understanding how gaps are measured is also an important piece of knowledge—this
    is called **metrics** and will be addressed in [Chapter 3](61949743-f7c3-4295-aaee-dab1d169d25c.xhtml),
    *Using Features and Reinforcement Learning to Automate Bank Financing.*
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 理解如何衡量误差也是一个重要的知识点——这就是所谓的**度量**，将在[第3章](61949743-f7c3-4295-aaee-dab1d169d25c.xhtml)中讨论，*使用特征和强化学习来自动化银行融资*。
- en: Neural network architecture
  id: totrans-119
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 神经网络架构
- en: Architecture concerns the layers and number of neurons at each layer, as well
    as how the neurons are interconnected in a neural network. The input layer is
    represented as **features**. The output layer can be a single number or a series
    of numbers (called a **vector**), which generates a number ranging from 0 to 1
    or a continuous value—subject to the problem domain.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 架构关注的是每一层的神经元层数和数量，以及神经元在神经网络中的互联方式。输入层表示为**特征**。输出层可以是一个单一的数字或一系列数字（称为**向量**），生成从0到1的数字或一个连续值——取决于问题领域。
- en: 'For example, to understand the structure of a neural network, we can project
    that it will look like the following screenshot from TensorFlow Playground ([https://playground.tensorflow.org/](https://playground.tensorflow.org/)),
    which is the visualization of another network with the same hidden layers—three
    layers with a size of 6:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，为了理解神经网络的结构，我们可以预测它看起来像下面这个来自 TensorFlow Playground 的截图（[https://playground.tensorflow.org/](https://playground.tensorflow.org/)），这是另一个具有相同隐藏层——三个层，每个层大小为6——的网络的可视化。
- en: '![](img/2225db38-32a7-49d4-9d47-930cd76d6e65.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2225db38-32a7-49d4-9d47-930cd76d6e65.png)'
- en: Using epochs for neural network training
  id: totrans-123
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用epoch进行神经网络训练
- en: Besides the design of the neural network, we also utilize the `epoch` parameter,
    which indicates the number of times the same set of data is fed to the neural
    network.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 除了神经网络的设计外，我们还利用了`epoch`参数，它表示相同数据集被输入神经网络的次数。
- en: We need to increase the number of epochs if we do not have enough data to satisfy
    the number of parameters in neural networks. Given that we have *X* parameters
    in the neural network, we need at least *X* data points to be fed to the network.
    Unfortunately, if our data point is only *X*/2, we need to set `epoch` to 2 in
    order to make sure that we can feed *X* data points (all of them are fed twice)
    to the network.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们没有足够的数据来满足神经网络中的参数数量，我们需要增加epoch的数量。假设我们在神经网络中有*X*个参数，我们至少需要*X*个数据点输入到网络中。不幸的是，如果我们的数据点只有*X*/2，我们需要将`epoch`设置为2，以确保我们可以将*X*个数据点（所有数据点都会被输入两次）喂入网络。
- en: Scaling
  id: totrans-126
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 缩放
- en: Before feeding the features to the machine learning model, we will normalize
    the input features of different magnitudes to be of the same magnitude. For example,
    the price and volume of goods are different types of numeric data. The scaling
    process will make sure that both of them are scaled to the same range, from 0
    to 1\. In classical statistical modeling processes, this step is very important
    to avoid a particular feature of bigger scales that dominate the influence on
    the prediction.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 在将特征输入机器学习模型之前，我们将对不同数量级的输入特征进行归一化，使其具有相同的数量级。例如，商品的价格和体积是不同类型的数值数据。缩放过程将确保它们都被缩放到相同的范围，从0到1。在经典的统计建模过程中，这一步非常重要，以避免某些具有更大尺度的特征主导对预测的影响。
- en: Sampling
  id: totrans-128
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 采样
- en: Apart from data column-level scaling, we also need to pay attention to the sampling
    bias of the model. Normally, we will set aside a portion of the data unseen by
    the machine while it is training and learning on another set of data—which is
    called a **training set**. Later on, the testing set (which is the dataset kept
    aside) will be used to check against the prediction made by the model.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 除了数据列级的缩放外，我们还需要注意模型的采样偏差。通常，我们会保留一部分机器在训练和学习另一组数据时看不见的数据——这被称为**训练集**。稍后，测试集（即保留的数据集）将用于与模型所做的预测进行对比。
- en: Demand forecasting using time series analysis
  id: totrans-130
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用时间序列分析进行需求预测
- en: In this section, we will take a look at the first example of forecasting the
    demand for electricity consumption, and predict the energy expenses using time
    series analysis. We will start with a brief problem statement and define steps
    to solve the problem. This will give you a better understanding of how to find
    solutions to problems using time series analysis.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将首先看一个预测电力消费需求的例子，并使用时间序列分析预测能源费用。我们将从简要的问题陈述开始，并定义解决问题的步骤。这将帮助你更好地理解如何使用时间序列分析找到问题的解决方案。
- en: Today, electricity or energy is a very basic necessity for all of us. We use
    electricity and pay bills. Now, as a customer, we want to analyze electricity
    consumption and predict future consumption and predict energy expenses. This is
    the problem that we will solve in this section.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 今天，电力或能源是我们所有人的基本需求。我们使用电力并支付电费。现在，作为消费者，我们希望分析电力消费，预测未来的消费并预测能源费用。这就是我们在本节中要解决的问题。
- en: 'Time series analysis is the optimal approach for solving problems similar to
    the one defined in the preceding problem statement. Machine learning models need
    large datasets to be fed before the actual solution is derived. These large datasets
    are used by machine learning models to derive a pattern or identify an existing
    pattern that might not be visible when the data is scattered. Similarly, our first
    step would be to obtain a large amount of data and process it to extract meaningful
    information. This is going to be a three-step process. Here are the steps that
    we will follow:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列分析是解决类似于前面问题描述中的问题的最佳方法。机器学习模型需要大量数据集供其处理，以便得出实际解决方案。这些大数据集被机器学习模型用来推导出模式，或者识别出散布的数据中可能无法看到的模式。同样，我们的第一步是获取大量数据并对其进行处理，以提取有意义的信息。这将是一个三步过程。以下是我们将遵循的步骤：
- en: Downloading the data
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载数据
- en: Preprocessing the data
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 数据预处理
- en: Model fitting the data
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 模型拟合数据
- en: Downloading the data
  id: totrans-137
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 下载数据
- en: Start by downloading data regarding electricity consumption and energy expenses.
    Even though we can download data from public websites now, in a true production
    environment, it is not uncommon to download data from an internal database and
    pass it to users as a flat file (a text file with no database structure).
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 从下载有关电力消费和能源费用的数据开始。尽管我们现在可以从公共网站下载数据，但在实际的生产环境中，通常需要从内部数据库下载数据，并以平面文件的形式将其传递给用户（即没有数据库结构的文本文件）。
- en: 'You can download the files from the following paths:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从以下路径下载文件：
- en: '**Consumption**: [https://www.eia.gov/opendata/qb.php?category=873&sdid=ELEC.CONS_TOT.NG-CA-98.M](https://www.eia.gov/opendata/qb.php?category=873&sdid=ELEC.CONS_TOT.NG-CA-98.M)'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**消费**: [https://www.eia.gov/opendata/qb.php?category=873&sdid=ELEC.CONS_TOT.NG-CA-98.M](https://www.eia.gov/opendata/qb.php?category=873&sdid=ELEC.CONS_TOT.NG-CA-98.M)'
- en: '**Cost**: [https://www.eia.gov/opendata/qb.php?category=41625&sdid=ELEC.COST.NG-CA-98.M](https://www.eia.gov/opendata/qb.php?category=41625&sdid=ELEC.COST.NG-CA-98.M)'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**成本**: [https://www.eia.gov/opendata/qb.php?category=41625&sdid=ELEC.COST.NG-CA-98.M](https://www.eia.gov/opendata/qb.php?category=41625&sdid=ELEC.COST.NG-CA-98.M)'
- en: '**Revenue**: [https://www.eia.gov/opendata/qb.php?category=1007&sdid=E LEC.REV.CA-RES.M](https://www.eia.gov/opendata/qb.php?category=1007&sdid=ELEC.REV.CA-RES.M)'
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**收入**: [https://www.eia.gov/opendata/qb.php?category=1007&sdid=ELEC.REV.CA-RES.M](https://www.eia.gov/opendata/qb.php?category=1007&sdid=ELEC.REV.CA-RES.M)'
- en: There are many ways of obtaining data, for example, using an API or robots.
    We will address these other methods of extracting data as we move further into
    the book. In [Chapter 4](0c281efb-a1b8-423f-976b-0fa47f5da990.xhtml), *Mechanizing
    Capital Market Decisions,* we'll obtain data through an API call. If we were to
    use a robot, for example, we could have used **Beautiful Soup** to parse the website
    or register the API. However, in this example, we simply visit the site using
    a browser and navigate to the download button to download the data.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 获取数据的方式有很多种，例如使用API或机器人。我们将在本书后续部分讨论这些其他获取数据的方法。在[第4章](0c281efb-a1b8-423f-976b-0fa47f5da990.xhtml)，*资本市场决策的机械化*中，我们将通过API调用获取数据。如果我们使用机器人，例如，可以使用**Beautiful
    Soup**来解析网站或注册API。然而，在这个示例中，我们只是使用浏览器访问网站并导航到下载按钮以下载数据。
- en: Preprocessing the data
  id: totrans-144
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据预处理
- en: 'After we obtain the data, we align it together in the same time series, as
    the data we''ve downloaded can cover different periods of time. As data scientists,
    we strive to align our data in one single sheet of data, with all of the required
    data listed column by column (that is, cost, consumption, sales, and more):'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 获取数据后，我们将其对齐在同一个时间序列中，因为我们下载的数据可能覆盖不同的时间段。作为数据科学家，我们力求将数据对齐到一张数据表中，所需的所有数据按列列出（即：成本、消费、销售等）：
- en: '![](img/80f80a27-42ee-4915-a5bb-7de60f89f01a.png)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
  zh: '![](img/80f80a27-42ee-4915-a5bb-7de60f89f01a.png)'
- en: 'Each line (or row) of the data should represent a single month. Right before
    we feed our data for the machine to learn the patterns, we will need to set aside
    some data for testing and some for learning. With the testing data, we can see
    whether the model predicts well, without training on the learning data first.
    This is a fundamental step in all ML/predictive models. We do not feed the testing
    dataset for ML/training. The line that calls the function is as follows:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 数据的每一行（或每一列）应代表一个单独的月份。在我们将数据提供给机器以学习模式之前，我们需要将一部分数据留作测试，另一部分用作学习。使用测试数据，我们可以查看模型是否预测准确，而无需先在学习数据上进行训练。这是所有机器学习/预测模型中的基本步骤。我们不将测试数据集提供给机器学习/训练。调用该函数的代码行如下：
- en: '[PRE0]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: In this program, we set aside the earliest 70% of data points as training data
    for the machine to learn and adapt to, while keeping the latter 30% of data points
    as testing data. This is data that will be used to compare against the prediction
    made by the model, not used to fit the data.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个程序中，我们将最早的 70% 数据点作为训练数据，让机器进行学习和适应，而将后 30% 数据点作为测试数据。这些数据将用于与模型预测进行比较，而不用于拟合数据。
- en: Model fitting the data
  id: totrans-150
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 模型拟合数据
- en: Once the data is clean, we will start training the machine to learn about the
    pattern. The training data will be fed to the machine as fitting. The model is
    like a shirt and the training data is like the body we're attempting to fit it
    to.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦数据清理完成，我们将开始训练机器学习模式。训练数据将作为拟合数据输入到机器中。模型就像一件衬衫，而训练数据就像我们试图将其拟合的身体。
- en: 'Here are the steps to fit our data into an ARIMA model:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是将我们的数据拟合到 ARIMA 模型的步骤：
- en: For each data file/field in the consolidated file, we run *step 3* and *step
    4* (which have been marked in the code file for the following code block).
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于汇总文件中的每个数据文件/字段，我们运行 *步骤 3* 和 *步骤 4*（这在代码文件中的下一个代码块已经标明）。
- en: 'If the Boolean variable, `parameter_op`, is set to `True`, then we will run
    *step 5* (which is marked as well). This explores all the possible combinations
    of parameters in ARIMA with regard to `p`, `d`, and `q`, which are set as follows:'
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果布尔变量 `parameter_op` 设置为 `True`，则我们将运行 *步骤 5*（该步骤也已标明）。这将探索 ARIMA 中 `p`、`d`
    和 `q` 参数的所有可能组合，具体设置如下：
- en: '`p`: Ranging from 0 to 12'
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`p`：范围从 0 到 12'
- en: '`d`: Ranging from 0 to 2'
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`d`：范围从 0 到 2'
- en: '`q`: Ranging from 0 to 3'
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`q`：范围从 0 到 3'
- en: For combinations of any of the preceding values, we calculate the fitness of
    the data to the actual pattern and measure the error values. The combinations
    with the lowest error values are selected as the chosen parameters of the ARIMA
    model.
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于前述任何组合的值，我们会计算数据与实际模式的拟合度，并测量误差值。选择误差值最小的组合作为 ARIMA 模型的选定参数。
- en: 'The following is the code snippet to fine-tune the parameters used (please
    refer to the full code file on GitHub: [https://github.com/PacktPublishing/Hands-On-Artificial-Intelligence-for-Banking](https://github.com/PacktPublishing/Hands-On-Artificial-Intelligence-for-Banking)):'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是用于微调参数的代码片段（请参阅 GitHub 上的完整代码文件：[https://github.com/PacktPublishing/Hands-On-Artificial-Intelligence-for-Banking](https://github.com/PacktPublishing/Hands-On-Artificial-Intelligence-for-Banking)）：
- en: '[PRE1]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Congratulations! We have now delivered a model that can provide volume forecasts
    for the future!
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！我们现在已经交付了一个可以提供未来销售预测的模型！
- en: Procuring commodities using neural networks on Keras
  id: totrans-162
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Keras 中的神经网络进行商品采购
- en: In this section, we will take a look at another more complex example. As before,
    we will define the problem statement and then define steps to solve the problem.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一部分，我们将通过一个更复杂的例子进行讲解。和之前一样，我们将先定义问题陈述，然后再定义解决问题的步骤。
- en: In this example, we want to forecast the procurement of commodities based on
    historical data. The commodity that we are going to use is natural gas. In the
    case of natural gas, we do not have any control over its pricing because it is
    a hugely globalized commodity. However, we can still set up the internal procurement
    strategy when the pricing of the natural gas hits a certain range. The profitability
    ratio target will constrain the maximum pricing we can pay for the raw material
    to be profitable for the owners of the firm. We will track the profitability ratio,
    which is the ratio of cost of natural gas to sales.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们希望根据历史数据预测商品的采购。我们将使用的商品是天然气。对于天然气，我们无法控制其定价，因为它是一个高度全球化的商品。然而，我们仍然可以在天然气价格达到某个范围时设定内部采购策略。盈利率目标将约束我们能够支付的原材料最大定价，以确保公司所有者的盈利性。我们将跟踪盈利率，即天然气成本与销售额的比率。
- en: 'Let''s understand this pricing constraint with an example. In this example,
    we assume that for each dollar spent where the unit cost of natural gas (for electric
    power) increased, the cost of materials to sales of the energy company will increase
    by **9.18%** (this is based on 3 years of data):'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过一个例子来理解这个定价约束。在这个例子中，我们假设每花费 1 美元，而天然气（用于电力）的单位成本上升时，能源公司的材料成本与销售额的比率将增加
    **9.18%**（这是基于 3 年的数据）：
- en: '![](img/6a26e3a0-4c56-4591-9a36-5147ead969ee.png)'
  id: totrans-166
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6a26e3a0-4c56-4591-9a36-5147ead969ee.png)'
- en: 'The following table shows the weighted average for sales on an annual basis:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 下表显示了年度销售额的加权平均值：
- en: '![](img/761ff695-2f42-4796-b6ec-f358d0014b85.png)'
  id: totrans-168
  prefs: []
  type: TYPE_IMG
  zh: '![](img/761ff695-2f42-4796-b6ec-f358d0014b85.png)'
- en: Here, you can see the cost of natural gas to sales from **2015** to **2017**.
    In **2017**, at an average unit weight of **$3.91**, the cost of natural gas to
    sales is at **36.45%**. We assume that the average unit weight and cost to sales
    are in a constant relationship—averaging the values of the cost of materials rate
    across the years (from **2015**-**2017**, that is, **7.66%**, **9.32%**, and **9.66%**).
    We took an average of all three figures to come to a weighted average of **9.18%**.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，您可以看到从**2015**年到**2017**年的天然气销售成本。在**2017**年，单位成本平均为**$3.91**时，天然气的销售成本为**36.45%**。我们假设单位成本和销售成本之间存在常量关系——对各年份的材料成本比率进行平均（即**2015**年至**2017**年分别为**7.66%**，**9.32%**和**9.66%**）。我们取了这三个数字的平均值，得到了加权平均值**9.18%**。
- en: Remember, the actual number should, in practice, come from the internal accounting
    system, not the external US **Energy Information Administration** (**EIA**) data
    that is used only for the purpose of electric power.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，实际数字应来自内部会计系统，而不是仅用于电力目的的外部美国**能源信息管理局**（**EIA**）数据。
- en: Based on the last 3 years of data, we find that the average cost of materials
    to sales stood at 31.15% (the average of iii from the table), which translates
    into $3.39 million/thousand cubic feet. The cost of the material of sales is at
    36.24% with the unit cost at $3.95 million/mcf in the upper range. The **mcf**
    is a standard unit cost of natural gas. It is equal to a thousand cubic feet.
    However, at the lower range, the cost of the material of sales is 26.07% with
    the unit cost at $2.84 million/mcf. The unit conversion details can be found on
    the EIA website.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 根据过去三年的数据，我们发现材料成本与销售额的平均比率为31.15%（表格中的iii平均值），这相当于每千立方英尺$3.39百万。销售材料成本为36.24%，单位成本为每千立方英尺$3.95百万，处于上限范围内。**mcf**是天然气的标准单位成本，等于千立方英尺。然而，在下限范围内，销售材料的成本为26.07%，单位成本为每千立方英尺$2.84百万。单位转换的详细信息可以在EIA网站上找到。
- en: 'Data is extracted from the preceding sales figure table: *Operating Expenses/Operating
    Revenues = cost of materials to sales*.'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 数据提取自前面的销售数据表：*运营费用/运营收入 = 材料成本与销售额的比例*。
- en: After we have established the procurement plan, we then need to understand where
    to source the natural gas from. In real life, we would consider how the model's
    insight gets executed; perhaps we also need to build a model to make the subsequent
    decision on how the model's insights get executed. This is exactly what we have
    mentioned in business understanding on how to execute the order in exchange markets.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 在建立采购计划后，我们需要了解从哪里采购天然气。在现实生活中，我们会考虑模型洞察如何执行；或许我们还需要构建一个模型来做出如何执行模型洞察的后续决策。这正是我们在商业理解部分提到的，关于如何在交易市场上执行订单的问题。
- en: To complete this story, we assume that we purchase the natural gas from the
    exchange markets using physical deliveries whenever the price hits the target
    range for the quantity we forecasted.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 为了完成这个故事，我们假设当价格达到我们预测的数量目标区间时，我们通过物理交付从交易市场购买天然气。
- en: Data flow
  id: totrans-175
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据流
- en: 'The following data flow outlines the steps we need to take in order to prepare
    and generate the code to build the commodity procurement model. The first box
    denotes a script run on the SQLite database; the other boxes denote steps run
    on Python:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 以下数据流概述了我们在准备和生成代码以构建商品采购模型时需要采取的步骤。第一个框表示在SQLite数据库上运行的脚本，其他框表示在Python中执行的步骤：
- en: '![](img/de546535-10d8-4539-af24-fe10f04bb9f7.png)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![](img/de546535-10d8-4539-af24-fe10f04bb9f7.png)'
- en: It generally fits into the framework of CRISP-DM, with different areas of focus
    throughout this book—some may focus on understanding the business, while some
    may focus on evaluation. The steps in the preceding diagram are covered in detail
    in the following sections.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 它通常适用于CRISP-DM框架，在本书中针对不同的重点领域——有些可能侧重于理解业务，有些则可能侧重于评估。前面的图示步骤将在后续章节中详细介绍。
- en: Preprocessing the data (in the SQL database)
  id: totrans-179
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 数据预处理（在SQL数据库中）
- en: 'Data preprocessing means converting the data into the desired data features.
    We run it outside of Python coding to reduce the layers involved (that is, we
    interact directly with SQLite rather than using Python to interact with SQLite).
    Here are the steps involved in performing database operations:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 数据预处理意味着将数据转换为所需的数据特征。我们将其在Python编码之外运行，以减少所涉及的层级（即，我们直接与SQLite进行交互，而不是使用Python与SQLite交互）。以下是执行数据库操作的步骤：
- en: Create the SQLite database.
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建SQLite数据库。
- en: Import the data as a staging table.
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将数据导入为暂存表。
- en: Create the required table(s)—a one-time operation.
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建所需的表（一次性操作）。
- en: Insert the staging table into the actual table with data type and format transformation.
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将暂存表插入实际表，并进行数据类型和格式转换。
- en: Create the view that does the feature engineering.
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建执行特征工程的视图。
- en: Output the preprocessed view as CSV data.
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将预处理后的视图输出为 CSV 数据。
- en: Importing libraries and defining variables
  id: totrans-187
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 导入库并定义变量
- en: 'Import libraries and define variables to make sure that the relevant functions
    can be used. Import all of the relevant libraries:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 导入库并定义变量，以确保可以使用相关函数。导入所有相关库：
- en: '`pandas`: This is for data storage before data is fed to the machine learning module.'
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pandas`：这是在数据输入机器学习模块之前用于数据存储的库。'
- en: '`keras`: This an easy-to-use machine learning framework that has another library.'
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`keras`：这是一个易于使用的机器学习框架，具有另一个库。'
- en: '`tensorflow`: This is used as the backend.'
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`tensorflow`：这被用作后台。'
- en: '`sklearn`: This is a very popular machine learning module that provides lots
    of data preprocessing toolkits along with some machine learning models that are
    easy to use. The models are not used in this example, as we wish to build up the
    foundation for the more extensive use of machine learning models afterward. In
    addition, `sklearn` also has metrics that appraise the performance of the models.'
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sklearn`：这是一个非常流行的机器学习模块，提供了许多数据预处理工具集以及一些易于使用的机器学习模型。由于我们希望为后续更广泛的机器学习模型应用打下基础，因此本示例中没有使用模型。此外，`sklearn`
    还有评估模型性能的度量标准。'
- en: '`matplotlib`: This is the default data visualization tool.'
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`matplotlib`：这是默认的数据可视化工具。'
- en: 'The following code block is the code importing all the listed libraries:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码块是导入所有列出库的代码：
- en: '[PRE2]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Reading in data
  id: totrans-196
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 读取数据
- en: 'The following is the code snippet to read in the data and take on the result
    generated from *step 1*:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是读取数据并获取*步骤 1*生成的结果的代码片段：
- en: '[PRE3]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Preprocessing the data (in Python)
  id: totrans-199
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 数据预处理（在 Python 中）
- en: 'Now we come to data preprocessing in Python. Some studies claim that data scientists
    spend 80% of their time on this step! It includes selecting features and target
    variables, checking/validating data types and handling missing values (this component
    is not included in this example to reduce complexity), and splitting data into
    a training set and a testing set. In some cases, when the ratios of the various
    classes of targets are not similar in quantity, we may need to do stratified sampling
    to ensure that balanced training samples are fed for machine learning. In this
    example, we set aside 20% for testing and 80% for training:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们进入 Python 中的数据预处理步骤。一些研究表明，数据科学家将80%的时间花在这一步骤上！它包括选择特征和目标变量，检查/验证数据类型以及处理缺失值（此部分在本示例中未包含，以减少复杂性），并将数据分为训练集和测试集。在某些情况下，当目标的各类比例在数量上不相似时，我们可能需要进行分层抽样，以确保为机器学习提供平衡的训练样本。在本示例中，我们将20%的数据保留用于测试，80%的数据用于训练：
- en: '[PRE4]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Training and validating the model
  id: totrans-202
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 训练和验证模型
- en: 'We train the neural network by feeding the training dataset to generate a model.
    The following code snippet defines the machine learning model in Keras and trains
    it. It builds the deep neural network model with 329 parameters:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通过将训练数据集输入神经网络来训练模型。以下代码片段定义了 Keras 中的机器学习模型并进行训练。它构建了一个具有329个参数的深度神经网络模型：
- en: '[PRE5]'
  id: totrans-204
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Testing the model
  id: totrans-205
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 测试模型
- en: 'We will compare the data points set aside (20%) in *step 4* against the predicted
    outcome based on the models trained and the features data:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将比较*步骤 4*中预留的数据点（20%）与基于训练好的模型和特征数据的预测结果：
- en: '[PRE6]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Visualizing the test result
  id: totrans-208
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 可视化测试结果
- en: 'This step allows us to cross-check the metrics that represent the performance
    of the model—the MSE:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 这一步让我们能够交叉检查表示模型性能的度量标准——均方误差（MSE）：
- en: '[PRE7]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'This will result in the following plot:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 这将生成以下图表：
- en: '![](img/676dc5bf-04f0-4c0e-97c3-745d6b7c9508.png)'
  id: totrans-212
  prefs: []
  type: TYPE_IMG
  zh: '![](img/676dc5bf-04f0-4c0e-97c3-745d6b7c9508.png)'
- en: Generating the model for production
  id: totrans-213
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 为生产生成模型
- en: 'The model that was trained and tested in *steps 5* and *6* will be output as
    a file for the production system to run on unseen production data. We will output
    two files—one for scaling the input features and another one for the neural network:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 在*步骤 5*和*步骤 6*中训练和测试的模型将作为文件输出，供生产系统在未见过的生产数据上运行。我们将输出两个文件——一个用于缩放输入特征，另一个用于神经网络：
- en: '[PRE8]'
  id: totrans-215
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Congratulations! We have now delivered a model that can be used at the operational
    level to identify the quantity to order for this month''s demand, next month,
    and the month after. The following diagram shows the steps in the training versus
    the deployment of machine learning models:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！我们现在已经交付了一个可以在操作层面使用的模型，用于识别本月、下月及下下月的需求量。下图展示了机器学习模型训练与部署的步骤：
- en: '![](img/f49bd5d6-8529-4a66-8fae-8c9f7fdc7cf8.png)'
  id: totrans-217
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f49bd5d6-8529-4a66-8fae-8c9f7fdc7cf8.png)'
- en: However, we are not going to cover deployment right now. We will keep this in
    mind and address the topic as we progress in this book. We will explore wrapping
    the AI production solution as an API in [Chapter 8](064a80f9-0636-4b3f-aed3-e2fee86ed7af.xhtml),
    *Building Personal Wealth Advisers with Bank APIs*.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，我们现在不会涵盖部署部分。我们会记住这一点，并在本书的后续部分讨论这个话题。我们将在[第8章](064a80f9-0636-4b3f-aed3-e2fee86ed7af.xhtml)《使用银行API构建个人财富顾问》中探讨如何将AI生产解决方案封装为API。
- en: Summary
  id: totrans-219
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, you learned about time series analysis, M2M communication,
    and the benefits of time series analysis for commercial banking. We also looked
    at two useful examples by defining the problem statement and deriving the solution
    step by step. We also learned about the basic concepts of time series analysis
    and a few techniques, such as ARIMA.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您了解了时间序列分析、机器对机器（M2M）通信，以及时间序列分析对商业银行的好处。我们还通过定义问题陈述并一步步推导解决方案，探讨了两个有用的例子。我们还学习了时间序列分析的基本概念和一些技术，例如ARIMA。
- en: In the next chapter, we will explore reinforcement learning. Reinforcement learning
    is an area of machine learning involving algorithms. The application takes an
    appropriate action to maximize the effectiveness of the outcome in a particular
    situation. We will also look at how to automate decision-making in banking using
    reinforcement learning. Exciting, isn't it?
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将探讨强化学习。强化学习是机器学习的一个领域，涉及算法。应用程序在特定情况下采取适当的行动，以最大化结果的效果。我们还将了解如何使用强化学习来自动化银行决策。令人兴奋，是吗？
