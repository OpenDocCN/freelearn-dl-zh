- en: Deep Learning in Healthcare IoT
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 深度学习在医疗物联网中的应用
- en: The IoT has diverse application domains, including health and medical care.
    Use of IoT in healthcare is growing at a dangerously fast pace, and market research
    shows that the global IoT healthcare market could reach US $534.3 billion by 2025\.
    Most of these applications, including remote and real-time patient monitoring,
    will generate heterogeneous, streaming, and/or big data. However, analyzing and
    extracting useful information from this data is a challenging task for medical
    and healthcare professionals. In this context, **machine learning** (**ML**) and
    **deep learning** (**DL**) models can address the challenge by automated analysis,
    classification of various data, and detection of anomalies within data. The healthcare
    industry is extensively using ML and DL for various applications. Hence, the use
    of ML/DL models in IoT healthcare applications is a necessity for the true realization
    of healthcare IoT.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 物联网有着广泛的应用领域，包括健康和医疗保健。物联网在医疗健康中的应用正在以危险的速度增长，市场研究表明，全球物联网医疗市场到2025年有望达到5343亿美元。这些应用中的大多数，包括远程和实时病人监控，将产生异构流数据和/或大数据。然而，从这些数据中分析并提取有用信息，对于医疗健康专业人员来说是一个巨大的挑战。在这种背景下，**机器学习**（**ML**）和**深度学习**（**DL**）模型能够通过自动化分析、分类各类数据以及检测数据中的异常来应对这一挑战。医疗行业广泛使用机器学习和深度学习进行各种应用。因此，机器学习/深度学习模型在物联网医疗健康应用中的使用，对于真正实现医疗物联网至关重要。
- en: 'In this chapter, we present DL-based IoT solutions for healthcare in general.
    In the first part of the chapter, we will present an overview of the various applications
    of IoT in healthcare. Then, we will briefly discuss two use cases where healthcare
    services can be improved and/or automatized through DL-supported IoT solutions.
    In the second part of the chapter, we will present hands-on experience of the
    DL-based healthcare incident and/or diseases detection part of the two use cases.
    In this chapter, we will cover the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将介绍基于深度学习（DL）的物联网（IoT）解决方案在医疗健康领域的应用。首先，我们将概述物联网在医疗健康中的各类应用。接着，我们将简要讨论两个使用案例，展示如何通过基于深度学习的物联网解决方案来改进和/或自动化医疗服务。第二部分将介绍这两个案例中，基于深度学习的医疗事件和/或疾病检测的实际经验。本章将涵盖以下主题：
- en: IoT and healthcare applications
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 物联网与医疗健康应用
- en: 'Use case one: remote chronic disease management'
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用案例一：远程慢性病管理
- en: Implementation of remote chronic disease management
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 远程慢性病管理的实施
- en: 'Use case two: IoT for acne detection and care'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用案例二：物联网在痤疮检测与护理中的应用
- en: Implementation of acne detection and care
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 痤疮检测与护理的实施
- en: DL for IoT in healthcare
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 深度学习在医疗物联网中的应用
- en: CNN and LSTM in IoT healthcare applications
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 卷积神经网络（CNN）和长短时记忆网络（LSTM）在医疗物联网应用中的应用
- en: Data collection
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据收集
- en: Data preprocessing
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据预处理
- en: Model training
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型训练
- en: Evaluation of the models
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型评估
- en: IoT in healthcare
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 物联网在医疗健康中的应用
- en: 'Globally, health and medical care services are facing tremendous challenges
    owing to, for example, soaring costs, an ageing population, an increase in the
    prevalence of chronic and/or multiple conditions, and a shortage of skilled healthcare
    professionals. In addition, traditional care services relying on average and/or
    qualitative data and a one-size-fits-all prescribing approach do not work well.
    In this context, the use of IoT in healthcare services addresses many of these
    challenges by offering the following features:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 全球范围内，健康和医疗服务面临着巨大的挑战，例如成本飙升、人口老龄化、慢性病和/或多重病症的患病率增加，以及医疗专业人员短缺。此外，依赖于平均数据和/或定性数据以及一刀切的处方方式的传统医疗服务效果并不理想。在这种背景下，物联网在医疗服务中的应用通过以下特性应对了这些挑战：
- en: Seamless integration with various existing technologies
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与各种现有技术的无缝集成
- en: Support of big data processing and analysis
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 大数据处理与分析的支持
- en: Personalized services
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 个性化服务
- en: Remote and real-time monitoring-based connected healthcare services
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于远程与实时监控的连接医疗服务
- en: Quantitative data, which offer more effective services than qualitative data
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定量数据，相比定性数据，能够提供更有效的服务
- en: Interactive and real-time interaction between healthcare professionals and patients
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 医疗专业人员与患者之间的互动与实时互动
- en: Ubiquitous access to services
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务的普遍可达性
- en: Efficient management of healthcare resources
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 高效的医疗资源管理
- en: 'All these features of the IoT-based solutions will disrupt the healthcare industry
    by offering various services. These services can be viewed and served in two different
    environments:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 所有这些基于物联网的解决方案特点将通过提供各种服务颠覆医疗行业。这些服务可以在两种不同的环境中查看和提供：
- en: Hospital and clinics
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 医院和诊所
- en: Non-clinical patient environments
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 非临床病人环境
- en: 'The following diagram highlights a few main applications of these two environments
    and presents a list of potential services in each of the environments:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表突出展示了这两种环境中的一些主要应用，并列出了每个环境中的潜在服务：
- en: '![](img/67da9769-c4a9-4793-b631-f0db4541f3f5.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![](img/67da9769-c4a9-4793-b631-f0db4541f3f5.png)'
- en: 'The following are the key subdomains of IoT healthcare:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是物联网医疗的关键子领域：
- en: '**Smart hospitals**: Globally, in both developed and developing countries,
    hospitals are overcrowded with patients. Also, they have a shortage of resources—including
    skilled professionals—and equipment. The situation is really bad in rural areas
    of most countries, where people have limited or no access to healthcare facilities.
    In this context, IoT-based remote services, such as remote monitoring and telemedicine,
    can offer access to many basic healthcare services. Also, remote monitoring of
    elderly patients and those with chronic diseases can greatly reduce healthcare-related
    costs, and improve quality of life for both patients and healthcare professionals.
    Smart and connected ambulances can offer on-fleet prompt and emergency services,
    and reduce emergency services-related incidents. In an operating room, connected
    doctors (locally and externally), staff, and medical devices can offer a better
    and smoother operating environment. Also, inventory management in hospitals can
    be greatly improved through IoT applications.'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**智能医院**：在全球范围内，无论是发达国家还是发展中国家，医院都面临病人过多的问题。此外，它们还面临资源短缺——包括缺乏熟练的专业人员和设备。在大多数国家的农村地区，情况尤为严重，那里的人们几乎无法或完全无法获得医疗服务。在这种背景下，基于物联网的远程服务，如远程监测和远程医疗，可以提供许多基础的医疗服务。此外，远程监测老年病人和慢性病患者可以大大降低与医疗相关的成本，并提高病人和医疗专业人员的生活质量。智能和联网的救护车可以提供车载即时和紧急服务，并减少与紧急服务相关的事故。在手术室中，连接的医生（本地和远程）、工作人员和医疗设备可以提供更好、更顺畅的手术环境。此外，医院的库存管理可以通过物联网应用得到极大的改善。'
- en: '**Clinics**: Many people go to a **general practitioner** **(****GP)** practice
    or clinic for primary care services. These service providers can also benefit
    from using IoT applications. For example, a GP can view and analyze virtually
    the patient''s pathology report, which saves time for both parties. Importantly,
    patients will get more time for care-related discussions than information gathering.
    Clinics can verify insurance coverage for patients in real time. Appointment management
    in clinics and GP practices is a global challenge. In England, approximately 15
    million appointments per year are missed, which costs the **National Health Service**
    (**NHS**) millions of pounds. This situation can be improved by IoT-based applications.'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**诊所**：许多人去**全科医生**（**GP**）诊所接受初级保健服务。这些服务提供者也可以通过使用物联网应用受益。例如，全科医生可以虚拟查看和分析病人的病理报告，这节省了双方的时间。重要的是，病人将获得更多用于护理相关讨论的时间，而不是单纯的信息收集。诊所可以实时核实病人的保险覆盖情况。诊所和全科医生诊所的预约管理是一个全球性挑战。在英格兰，每年大约有1500万次预约未能按时进行，这使**国民健康服务**（**NHS**）损失了数百万英镑。物联网应用可以改善这一情况。'
- en: '**Non-clinical patient environments**: Two potential application areas of IoT
    could be connected—the patient and the smart home. Here, the smart home would
    offer healthcare services to patients anytime and anywhere. Remote monitoring
    of a prescribed intervention, such as physiotherapy, can be done through a connected
    patient application. Also, patients can get personalized services, such as reminders
    to take medication. Offering monitoring and healthcare services to elderly people
    is a great challenge worldwide. Smart home solutions can improve existing services
    and offer new services for these highly vulnerable people through fall detection,
    medication reminders, telemedicine, and general assisted living.'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**非临床病人环境**：物联网的两个潜在应用领域是连接的——病人和智能家居。在这里，智能家居可以随时随地为病人提供医疗服务。远程监测处方干预措施，如物理治疗，可以通过连接的病人应用程序进行。此外，病人可以获得个性化服务，例如提醒服药。为老年人提供监测和医疗服务是全球性的重大挑战。智能家居解决方案可以通过跌倒检测、服药提醒、远程医疗和一般辅助生活等服务改善现有服务，并为这些高风险人群提供新的服务。'
- en: It is clear from the preceding discussion that IoT has huge potential in healthcare
    domains. In the following section, we will briefly discuss two use cases of IoT
    in healthcare.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 从上述讨论中可以明显看出，物联网在医疗领域具有巨大的潜力。在接下来的部分，我们将简要讨论物联网在医疗领域的两个用例。
- en: Use case one – remote management of chronic disease
  id: totrans-34
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用例一 – 慢性病的远程管理
- en: Chronic diseases—including cardiovascular diseases, hypertension, and diabetes—cause
    over 40 million deaths per year globally. This problem has different dimensions
    in developing countries and developed countries. In developing countries, people
    with chronic diseases have limited or no access to many basic health services,
    including early or on-time detection facilities, which leads to many deaths. On
    the other hand, in developed countries, medical research has led to a significant
    increase in life expectancy. This has been achieved by means of, for example,
    early detection and monitoring of disease. However, in developed countries, including
    the UK, for every 2 years of increased life expectancy, we gain just 1 year of
    quality life. Consequently, the proportion of our lives spent with chronic diseases
    and disability is rising. The cost of managing patients with multiple chronic
    diseases is trillions of dollars/pounds. Fortunately, IoT-based remote monitoring
    of patients with chronic diseases can address most of these issues and offer cost-effective
    services.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 慢性病——包括心血管疾病、高血压和糖尿病——每年全球造成超过4000万人的死亡。这个问题在发展中国家和发达国家有不同的表现。在发展中国家，慢性病患者在许多基本健康服务方面存在访问限制或无法获取，包括早期或及时的检测设施，这导致了大量死亡。另一方面，在发达国家，医学研究已显著提高了预期寿命。例如，通过早期发现和疾病监测来实现这一点。然而，在包括英国在内的发达国家，每增加2年的预期寿命，我们只能获得1年的高质量生命。因此，我们在慢性病和残疾中度过的生命比例正在上升。管理多种慢性疾病患者的成本达到数万亿美元/英镑。幸运的是，基于物联网的慢性病患者远程监测能够解决大部分这些问题，并提供具有成本效益的服务。
- en: Implementation of use case one
  id: totrans-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用例一的实施
- en: 'We are considering an IoT-based remote patient monitoring application for use
    case one. The following diagram briefly presents how the IoT-based, remote patient
    monitoring and management system will work:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 我们正在考虑一个基于物联网（IoT）的远程患者监测应用程序，适用于用例一。以下图表简要展示了基于物联网的远程患者监测与管理系统如何运作：
- en: '![](img/39cdf21e-54aa-48f0-b6c3-a6da036d7a59.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![](img/39cdf21e-54aa-48f0-b6c3-a6da036d7a59.png)'
- en: 'As shown, the IoT-based, remote patient monitoring system consists of three
    main elements, namely, smart home, care providers, and Health Cloud:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 如图所示，基于物联网的远程患者监测系统由三个主要元素组成，分别是智能家居、护理提供者和健康云：
- en: '**Smart home**: This is the heart of the solution, and includes the patient
    and various devices for the IoT solutions. The smart home consists of the following
    key components:'
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**智能家居**：这是解决方案的核心，包括患者和各种物联网设备。智能家居由以下关键组件组成：'
- en: '**Patient**: A patient will be attached to multiple sensors, including an **electrocardiogram (ECG)**,
    blood pressure sensor, accelerometer, and gyroscope. These sensors will collect
    physiological and activity-related data and send them to the care providers for
    necessary and real-time feedback.'
  id: totrans-41
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**患者**：患者将连接到多个传感器，包括**心电图（ECG）**、血压传感器、加速度计和陀螺仪。这些传感器将收集生理和活动相关的数据，并将其发送给护理提供者，以便进行必要的实时反馈。'
- en: '**Ambient sensing**: Body sensors and wearable devices are not sufficient to
    cover all of the activities of the patient. Also, patients do not feel comfortable
    with too many sensors on their body for many reasons, including the need for seamless
    movement. The smart home will be installed with various ambient sensors, including
    light, vibration, motion, pressure, and door sensors. These sensors will provide
    contextual information about the patient.'
  id: totrans-42
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**环境感知**：仅靠身体传感器和可穿戴设备不足以覆盖患者的所有活动。此外，患者因多种原因对身体上有过多传感器感到不适，包括需要无缝移动。智能家居将安装各种环境传感器，包括光线、振动、运动、压力和门传感器。这些传感器将提供关于患者的上下文信息。'
- en: '**Edge computing platform**: We have various options for this component, for
    example, a smartphone/tablet, edge gateway, or a Raspberry Pi 3\. For this use
    case, we are considering a Raspberry Pi 3\. All the sensors mentioned earlier
    can be connected to the Raspberry Pi 3\. Most will sense the environment and/or
    patient''s activity continuously, and others will be event-driven (for example,
    the door sensor will be activated if someone opens or knocks on the door). These
    sensors will send data to the Raspberry Pi 3 for further processing, including
    detecting events such as high blood pressure or body temperature, or a fall. Finally,
    this processed data will be sent to the care providers through the home router,
    and Health Cloud. Importantly, the Raspberry Pi 3 will be installed with various
    pretrained DL/ML models, including an ECG measurement classifier for detection
    of any heart-related anomalies.'
  id: totrans-43
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**边缘计算平台**：我们为此组件提供了多种选择，例如智能手机/平板电脑、边缘网关或Raspberry Pi 3。在这个用例中，我们考虑使用Raspberry
    Pi 3。前面提到的所有传感器都可以连接到Raspberry Pi 3。大多数传感器将持续监测环境和/或患者的活动，其他传感器则是事件驱动的（例如，门传感器会在有人开门或敲门时被激活）。这些传感器将把数据发送到Raspberry
    Pi 3进行进一步处理，包括检测高血压、体温异常或摔倒等事件。最后，处理后的数据将通过家庭路由器和健康云发送给护理提供者。重要的是，Raspberry Pi
    3将安装各种预训练的深度学习/机器学习模型，包括用于检测心脏异常的ECG测量分类器。'
- en: '**Health Cloud for model learning and data analysis:** The Health Cloud is
    a cloud computing platform, mainly designed for healthcare-related services, and
    is mainly responsible for the following:'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**健康云用于模型学习和数据分析**：健康云是一个云计算平台，主要设计用于与健康护理相关的服务，主要负责以下内容：'
- en: DL model training
  id: totrans-45
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 深度学习模型训练
- en: Data analysis
  id: totrans-46
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据分析
- en: The model training component will train the necessary DL models for categorizing
    or classifying a variety of physiological signals from the patient and contextual
    data to make informed decisions. The Health Cloud will receive various data from
    the Raspberry Pi 3, and some of them may conflict with each other. In this context,
    a data analysis tools will analyze and present the data to the healthcare professionals
    for decision making.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 模型训练组件将训练必要的深度学习模型，用于分类或分类来自患者的各种生理信号以及背景数据，以做出明智的决策。健康云将接收来自Raspberry Pi 3的各种数据，其中一些数据可能相互冲突。在这种情况下，数据分析工具将分析并展示数据，以供医疗专业人员做出决策。
- en: '**Care providers**: Care providers can be hospitals or clinics that provide
    care services. As many patients have multiple chronic diseases, most need to be
    directly or indirectly connected with more than one specialized doctor. Once the
    doctor receives information about the patient and their environment, they will
    make a decision with the support of other data, including historical data from
    an **electronic health record (EHR)**. Once the decision has been made, it will
    be sent back to the patient and, if necessary, a decision will be actuated through
    the appropriate devices (such as an insulin pump) connected to the patient.'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**护理提供者**：护理提供者可以是提供护理服务的医院或诊所。由于许多患者患有多种慢性病，大多数需要与不止一位专科医生直接或间接联系。一旦医生收到患者及其环境的信息，他们将根据其他数据（包括来自**电子健康记录（EHR）**的历史数据）做出决策。决策做出后，结果将反馈给患者，并在必要时通过适当的设备（如胰岛素泵）执行决策。'
- en: ECG-based health checking of the heart is an essential element of the above
    use case. In the second part of the chapter, we will describe implementation of
    the DL-based ECG measurement classification of the preceding use case.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 基于ECG（心电图）的心脏健康检查是上述用例中的一个重要元素。在本章的第二部分，我们将描述基于深度学习的ECG测量分类的实现，以便于先前用例的实施。
- en: Use case two – IoT for acne detection and care
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用例二 – 用于痤疮检测和护理的物联网
- en: 'Acne is one of the world''s most common skin conditions. Most people, at some
    point in their lifetime, are affected by acne. Generally, acne develops on the
    face and appears as spots (as shown in the following diagram) and oily skin. Sometimes,
    the skin can become hot or painful to the touch. Acne can manifest as whiteheads,
    blackheads, pustules, papules, cysts, and nodules. The first three are also known
    as pimples. Different types of acne need different treatments and care; therefore,
    detection and automated classification of acne could be useful. Acne can be confused
    with one of three similar conditions—rosacea, eczema, or allergic reaction—because
    patients often self-diagnose and treat. Incorrect diagnosis and treatment can
    make the condition worse. The following diagram shows two examples of what acne
    can look like:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 痤疮是世界上最常见的皮肤病之一。大多数人在一生中的某个阶段都会受到痤疮的影响。通常，痤疮出现在面部，并以斑点（如下图所示）和油性皮肤的形式出现。有时，皮肤可能会变得发热或触碰时感到疼痛。痤疮可以表现为白头、黑头、脓疱、丘疹、囊肿和结节。前三种也被称为粉刺。不同类型的痤疮需要不同的治疗和护理；因此，痤疮的检测和自动分类可能会很有用。痤疮可能与三种类似的皮肤病混淆——玫瑰痤疮、湿疹或过敏反应——因为患者通常会自行诊断和治疗。错误的诊断和治疗可能会使病情加重。以下图展示了痤疮的两种表现形式：
- en: '![](img/462bc10c-3fce-4d56-bd9d-f1b8da31dd06.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![](img/462bc10c-3fce-4d56-bd9d-f1b8da31dd06.png)'
- en: Generally, acne is not only a physical health issue, but also a mental health
    issue for many affected people. According to research, acne is significantly linked
    with depression. In a study published in the *British Journal of Dermatology*,
    researchers analyzing the records of patients with acne between 1986 and 2012
    in the UK made a strong claim about the mental health issues these patients. They
    concluded that patients with acne have a 63% higher risk of developing depression
    compared with patients who did not have acne.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 一般来说，痤疮不仅是一个身体健康问题，对于许多患者来说，还是一个心理健康问题。根据研究，痤疮与抑郁症密切相关。在《英国皮肤病学杂志》上发布的一项研究中，研究人员分析了1986年至2012年间英国患有痤疮的患者记录，并对这些患者的心理健康问题做出了强有力的结论。他们得出结论，患有痤疮的患者发展为抑郁症的风险比没有痤疮的患者高出63%。
- en: In this chapter, we will present an innovative solution using IoT and DL modes
    to address the acne detection/diagnosis problem.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将介绍一种创新的解决方案，使用物联网（IoT）和深度学习（DL）模型来解决痤疮检测/诊断问题。
- en: Implementation of use case two
  id: totrans-55
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用例二的实现
- en: Most people with acne and related skin conditions use a mirror to detect acne
    and monitor the progress of treatment. Therefore, the innovative idea is to create
    a smart and connected mirror to help the user detect and identify skin (mainly
    facial) anomalies, including acne.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数患有痤疮及相关皮肤病的人使用镜子来检测痤疮并监测治疗进展。因此，创新的想法是创建一面智能联网镜子，帮助用户检测和识别皮肤（主要是面部）异常，包括痤疮。
- en: 'The following diagram presents an IoT infrastructure for the implementation
    of automated acne detection, classification, and care services:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图展示了实现自动痤疮检测、分类和护理服务的物联网基础设施：
- en: '![](img/ac01b78e-eb75-47d6-b1e2-c9ceb7318ff4.png)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ac01b78e-eb75-47d6-b1e2-c9ceb7318ff4.png)'
- en: 'As shown in the diagram, the IoT-based automated acne detection, classification,
    and care system consists of three main elements—a smart mirror, care providers,
    and the Health Cloud:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 如图所示，基于物联网的自动痤疮检测、分类和护理系统由三大元素组成——智能镜子、护理提供者和健康云：
- en: '**Smart mirror**: This is the heart of the solution, and includes the following
    three components:'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**智能镜子**：这是解决方案的核心，包含以下三个组件：'
- en: '**Camera**: The mirror features a high-resolution camera embedded in such a
    way that it will be able to capture facial images. There will be a button in the
    mirror that will activate the detection process, as a patient might not always
    be interested or in need of the service. The mirror will also have a small display
    to present the results and/or suggested treatment for the acne from care providers.'
  id: totrans-61
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**摄像头**：镜子内置高分辨率摄像头，能够以嵌入的方式捕捉面部图像。镜子上将有一个按钮，用于激活检测过程，因为患者可能并不总是对该服务感兴趣或有需求。镜子还将有一个小显示屏，展示结果和/或护理提供者针对痤疮的建议治疗方案。'
- en: '**Edge computing platform**: We have various options for this component, including
    a smartphone/tablet, edge gateway, or a Raspberry Pi 3\. For this use case, we
    are considering a Raspberry Pi 3 that will be connected to the camera. Once it
    receives the images, it will detect any skin-related issue, including acne, with
    the support of a preinstalled DL model. Finally, the Raspberry Pi 3 will send
    the detection results, along with the images, to a care provider to obtain treatment
    suggestions. Also, a model can be incorporated in the Raspberry Pi 3 (not within
    the scope of this book) that will analyze facial images for potential depression
    detection and corresponding support from a psychiatrist.'
  id: totrans-62
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**边缘计算平台**：我们有多种选择，包括智能手机/平板、边缘网关或树莓派3。在这个用例中，我们考虑使用连接到摄像头的树莓派3。一旦它接收到图像，它将通过预安装的深度学习模型检测任何皮肤问题，包括痤疮。最终，树莓派3将把检测结果及图像发送给护理提供者，以获得治疗建议。此外，还可以在树莓派3中集成一个模型（不在本书的范围内），分析面部图像以进行潜在的抑郁症检测，并由精神科医生提供相应支持。'
- en: '**Health Cloud for model learning and data**: The Health Cloud is a cloud computing
    platform mainly designed for healthcare-related services. This cloud platform
    will be used to train the DL model for the image-based detection and classification
    of acne and other skin conditions. The Health Cloud is also responsible for updating
    any preinstalled model in the Raspberry Pi 3 or IoT devices.'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**健康云用于模型学习和数据**：健康云是一个主要为医疗健康相关服务设计的云计算平台。该平台将用于训练深度学习模型，以实现基于图像的痤疮及其他皮肤问题的检测和分类。健康云还负责更新预先安装在树莓派3或物联网设备中的任何模型。'
- en: '**Care providers**: Care providers can be hospitals and clinics that provide
    care services. As acne might cause depression, we are considering two potential
    doctors—a dermatologist for skin-related issues and a psychiatrist for depression-related
    issues. Once the doctors receive the detected information and images, they will
    make a decision with the support of other data, including historical images of
    the patient. Finally, the suggested treatment or feedback will be sent back to
    the patient.'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**护理提供者**：护理提供者可以是提供护理服务的医院和诊所。由于痤疮可能引起抑郁，我们考虑了两位潜在的医生——一位是皮肤科医生，处理皮肤相关问题；另一位是精神科医生，处理抑郁症相关问题。一旦医生收到检测到的信息和图像，他们将结合其他数据（包括患者的历史图像）作出决定。最终，建议的治疗方案或反馈将发送给患者。'
- en: In the following sections, we will describe implementation of the DL-based solutions
    required for the aforementioned use cases. All the necessary codes are available
    in the chapter's code folder.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的章节中，我们将描述针对上述使用案例所需的基于深度学习的解决方案的实现。所有必要的代码可以在本章的代码文件夹中找到。
- en: DL for healthcare
  id: totrans-66
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 深度学习在医疗健康中的应用
- en: DL models are evolving as the most powerful and effective computing resources
    for every industry. They are contributing significantly to the industries' value
    by improving user experience and enabling more informed decision making. Healthcare
    is one of the key application domains of DL, and DL has been further progressed
    by the increasing availability of heterogeneous healthcare data.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 深度学习（DL）模型正不断发展，成为各行业最强大和最有效的计算资源。它们通过改善用户体验和推动更为明智的决策，显著地为各行业创造价值。医疗健康是深度学习的一个重要应用领域，随着异构医疗数据的日益增多，深度学习在这一领域得到了进一步发展。
- en: 'Unlike many other industries, the health and medical industries are obtaining
    highly value-added applications in many areas, including research, innovation,
    and real-world medical environments. Many of these applications are patient-facing
    (such as early detection and prediction of cancer, and personalized medicine)
    and others are for improving the user experience in various aspects of healthcare
    IT. The following diagram highlights some of the application areas of DL in healthcare:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 与许多其他行业不同，健康和医疗行业在多个领域获得了高附加值的应用，包括研究、创新和实际的医疗环境。这些应用中，许多是面向患者的（如癌症的早期检测和预测，以及个性化医疗），而其他应用则是为了改善医疗信息技术各方面的用户体验。下图突出显示了深度学习在医疗健康领域的一些应用领域：
- en: '![](img/d9612bba-f7cd-476e-a489-92b169f7033a.png)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d9612bba-f7cd-476e-a489-92b169f7033a.png)'
- en: CNN and LSTM in healthcare applications
  id: totrans-70
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 卷积神经网络（CNN）和长短期记忆网络（LSTM）在医疗健康应用中的应用
- en: Healthcare applications generate big data, and they come from heterogeneous
    sources in heterogeneous formats. A large number of these, including screening
    and diagnostic data from **magnetic resonance imaging** **(MRI)**, X-ray, and
    ultrasound are in image format. Human physiological signals, such as those detected
    by **electromyography** (**EMG**), **electroencephalography** (**EEG**), ECG,
    and **electrooculography** **(EOG)**, are time series data. EHRs include structured
    (such as diagnosis, prescriptions, and laboratory tests) as well as unstructured
    (such as free-text clinical notes) clinical data. Also, high-throughput biology,
    such as genomics, produces high-dimensional data regarding human internal structures.
    All of this different healthcare data requires the support of ML—especially DL—to
    extract valuable information and gain insights into any potential issues.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 医疗保健应用产生大量数据，且这些数据来自异构来源，格式也各异。包括来自**磁共振成像**(**MRI**)、X射线和超声的筛查和诊断数据，其中大量数据以图像格式存在。人体生理信号，如**肌电图**(**EMG**)、**脑电图**(**EEG**)、ECG和**眼电图**(**EOG**)等，是时间序列数据。电子健康记录（EHR）包括结构化数据（如诊断、处方和实验室检查）以及非结构化数据（如自由文本的临床记录）。此外，高通量生物学数据，如基因组学，生成关于人体内部结构的高维数据。所有这些不同的医疗数据都需要机器学习，尤其是深度学习（DL）的支持，以提取有价值的信息并获得有关潜在问题的洞察。
- en: A number of DL models have been used for the analysis of these heterogeneous
    healthcare data. CNN and LSTMs (RNNs) are the most widely used DL models, as their
    features work well with most healthcare data types. For example, CNN models are
    best for image processing and are used for various medical images. By contrast,
    LSTMs/RNNs are best for most physiological signals, as they have a memory feature
    to handle the temporal properties of the signals. ECG measurements are one of
    the key physiological signals in screening for cardiovascular disease. Therefore,
    the remote patient-monitoring system includes a DL-based ECG signal analyzer for
    detecting various heart conditions, such as **atrial fibrillation** (**AF**).
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 许多深度学习（DL）模型已被用于分析这些异构医疗数据。卷积神经网络（CNN）和长短时记忆网络（LSTM）（递归神经网络，RNN）是最广泛使用的DL模型，因为它们的特性与大多数医疗数据类型非常契合。例如，CNN模型最适合图像处理，并且用于各种医学图像。相比之下，LSTM/RNN最适合大多数生理信号，因为它们具有处理信号时序特性的记忆特性。ECG测量值是筛查心血管疾病的关键生理信号之一。因此，远程患者监控系统包括一个基于DL的ECG信号分析器，用于检测各种心脏病状况，如**房颤**(**AF**）。
- en: Considering the temporal aspect of the ECG signal, we will consider an LSTM
    for the implementation of the remote patient monitoring system. In addition, we
    will test a CNN for the ECG signal as a comparison. The IoT-based acne detection
    and care system will rely on images. Therefore, we will implement this using a
    CNN architecture. Both of these DL models have been briefly presented in chapters;
    please refer to those for an overview.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑到ECG信号的时间特性，我们将考虑使用LSTM来实现远程患者监控系统。此外，我们将测试CNN作为ECG信号的对比。基于物联网的痤疮检测和护理系统将依赖图像。因此，我们将使用CNN架构来实现此系统。这两种DL模型在章节中已简要介绍；请参考这些章节以了解概览。
- en: Data collection
  id: totrans-74
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据收集
- en: Data collection for health and medical care applications is a challenging task
    for many reasons, including privacy and ethical issues. In this context, we have
    decided to use two different open source datasets for the two use cases.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 健康和医疗保健应用的数据收集是一个具有挑战性的任务，原因包括隐私和伦理问题。在这种背景下，我们决定为这两个应用场景使用两个不同的开源数据集。
- en: Use case one
  id: totrans-76
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 应用场景一
- en: 'The ECG dataset for use case one has been collected from 2017 PhysioNet/computing
    in cardiology challenge. This dataset consists of 8,528 ECG measurements. These
    measurements were recorded through an AliveCor hand-held device (as shown in the
    following screenshot), and, interestingly, this is an example healthcare IoT application:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 用于第一种应用场景的ECG数据集是从2017年PhysioNet/计算心脏病学挑战中收集的。该数据集包含8,528个ECG测量值。这些测量值通过AliveCor手持设备记录（如下图所示），有趣的是，这是一个医疗物联网（IoT）应用示例：
- en: '![](img/b4924850-4a0a-41b9-91e9-a7c69d172df3.jpg)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b4924850-4a0a-41b9-91e9-a7c69d172df3.jpg)'
- en: 'The sampling rate of the ECG measurements was 300 Hz, and noise was removed
    by band-pass filtered by the AliveCor device. Each recorded measurement is compliant
    with MATLAB V4 WFDB format, and consists of two files:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: ECG测量的采样率为300 Hz，噪声通过AliveCor设备的带通滤波器去除。每个记录的测量值符合MATLAB V4 WFDB格式，由两个文件组成：
- en: A file with a `.mat` extension that presents the main ECG signal information
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 `.mat` 扩展名的文件，呈现主要的ECG信号信息
- en: A corresponding header file with a `.hea` extension that contains the waveform-related
    information of the measurement
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 具有`.hea`扩展名的相应头文件，包含了测量的波形相关信息
- en: 'The dataset consists of four different classes of signals: normal rhythm, AF,
    other rhythm, or too noisy to classify. The following diagram presents a visualization
    of these different classes of the ECG signals:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 数据集包括四种不同类别的信号：正常节律、房颤、其他节律或过于嘈杂以至于无法分类。以下图表展示了这些不同类别的心电图信号的可视化：
- en: '![](img/74bcce0f-4072-4a35-98ff-2b1cc7824def.png)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![](img/74bcce0f-4072-4a35-98ff-2b1cc7824def.png)'
- en: 'AF is characterized by rapid and irregular beating of the atria and indicates
    that the heart rhythm is not normal. Other abnormal heart rhythms are considered
    as the other rhythm class. Finally, any measurements that do not reflect one of
    the three classes, as they are too noisy to be classified, are defined as a noisy
    measurement. The DL model-based classifier needs to extract these features in
    the measurements to classify the signals recorded from the patient, and the corresponding
    heart-related issues. For a better understanding and real-life implementation,
    further studies on ECG signals are necessary, which is not within the scope of
    this book. The following graph presents normal versus AF heart signal measurements:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 房颤是心房快速而不规则跳动的特征，表明心律不正常。其他异常心律被视为其他节律类别。最后，任何不能反映这三类之一的测量，因为噪音太大而无法分类，被定义为嘈杂的测量。基于深度学习模型的分类器需要提取这些测量中的特征，以对来自患者的记录信号进行分类，并与相关的心脏问题进行关联。为了更好地理解和实际实施，需要进一步研究心电图信号，这不在本书的范围内。以下图表展示了正常与房颤心脏信号测量的对比：
- en: '![](img/07d582b8-0fa1-4727-8a1b-5fc8323ea887.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![](img/07d582b8-0fa1-4727-8a1b-5fc8323ea887.png)'
- en: Use case two
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用例二
- en: 'For the acne detection and care system use case, we are relying on an image
    dataset. We have gathered images from the *Dermnet Skin Disease Atlas*, which
    is an open-source database on various skin diseases. The database contains 23
    datasets, each on a different skin disease, and each of the categories (including
    acne and rosacea) has subcategories. The datasets are not easily downloaded as
    there are too many pages. We have written an image, or image scraper, using Python''s
    Beautiful Soup module, and we have made the scraper generic so that readers can
    test their LSTM/CNN models on the different skin diseases. The scraper `image_scraper.py`
    is available in the chapter''s code subfolder, `use-case-2`. To scrap all 23 datasets,
    run the following command:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 对于痤疮检测和护理系统用例，我们依赖于一个图像数据集。我们从*Dermnet皮肤病图谱*中收集了图片，这是一个关于各种皮肤病的开源数据库。数据库包含23个数据集，每个数据集都涉及不同的皮肤病，每个类别（包括痤疮和酒渣鼻）都有子类别。由于页面太多，这些数据集不易下载。我们使用Python的Beautiful
    Soup模块编写了一个图像爬虫，我们使爬虫通用化，以便读者可以在不同的皮肤病上测试他们的LSTM/CNN模型。爬虫`image_scraper.py`位于本章代码子文件夹`use-case-2`中。要爬取所有23个数据集，请运行以下命令：
- en: '[PRE0]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The following screenshot shows the downloaded images folder of all types of
    skin disease:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了各种皮肤病的下载图像文件夹：
- en: '![](img/aed9490f-59a6-4e47-8ad9-0e6a972c5c05.png)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![](img/aed9490f-59a6-4e47-8ad9-0e6a972c5c05.png)'
- en: Data exploration
  id: totrans-91
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据探索
- en: 'In the following section, we will explore the datasets used for the two use
    cases. These are as follows:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的部分，我们将探索用于两个用例的数据集。具体如下：
- en: The ECG dataset
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 心电图数据集
- en: The acne dataset
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 痤疮数据集
- en: The ECG dataset
  id: totrans-95
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 心电图数据集
- en: 'The following diagram presents a snapshot of the ECG dataset, which includes
    four classes of data. As shown in the diagram, each of the signals has distinctive
    features to be exploited by the DL models:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 下图显示了包含四类数据的心电图数据集的快照。如图所示，每个信号都具有独特的特征，可以被深度学习模型利用：
- en: '![](img/72f757eb-be89-4f72-b8fe-0dbdf41b390d.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](img/72f757eb-be89-4f72-b8fe-0dbdf41b390d.png)'
- en: We can generate this exploration result, or similar, using the available code, `ecg_singal_explorer.py`,
    in the chapter's `use-case-1` code folder.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用可用的代码`ecg_singal_explorer.py`在本章的`use-case-1`代码文件夹中生成这种探索结果或类似的结果。
- en: The acne dataset
  id: totrans-99
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 痤疮数据集
- en: 'We have used the acne and rosacea images dataset. The following screenshot
    presents a folder view of the dataset, including the number of images in the class.
    Unfortunately, as we can see, only four of the folders or classes have 100 or
    more images:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经使用了痤疮和酒渣鼻图像数据集。以下截图展示了数据集的文件夹视图，包括各类中的图片数量。不幸的是，正如我们所见，只有四个文件夹或类别有100张或更多的图片：
- en: '![](img/cf6844f3-d4fb-4ce3-9e45-d4531507e121.png)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cf6844f3-d4fb-4ce3-9e45-d4531507e121.png)'
- en: As we are using MobileNet v1 architecture, any class with lower than 100 images
    might show an error. In fact, we have tested this and found the data size-related
    error. In this context, we have chosen a reduced dataset, which consists of only
    four classes of data that have more than 100 images.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们使用的是MobileNet v1架构，任何图像数少于100张的类别可能会出现错误。事实上，我们已经测试过，并发现了与数据大小相关的错误。在这种情况下，我们选择了一个减少的数据集，该数据集仅包含四个类别，每个类别的图像数都超过100张。
- en: 'The following screenshot shows the reduced acne dataset following exploration:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 下图展示了经过探索后的减少版痤疮数据集：
- en: '![](img/757d1f52-3ca5-4292-96d3-1eea4d2de088.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](img/757d1f52-3ca5-4292-96d3-1eea4d2de088.png)'
- en: Data preprocessing
  id: totrans-105
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据预处理
- en: Data preprocessing is an essential step for a DL pipeline. The ECG dataset is
    not ready to be used for model training and validation. The preprocessor for the
    ECG signals is included in the model training and validation codes, `LSTM_ECG.py`
    and `CNN1D_ECG.py`, respectively. They will run the models after preprocessing
    `.mat` input data. However, the acne image dataset is ready to be used for training
    and validation.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 数据预处理是深度学习管道中的一个关键步骤。ECG数据集无法直接用于模型训练和验证。ECG信号的预处理程序已包含在模型训练和验证代码`LSTM_ECG.py`和`CNN1D_ECG.py`中，分别用于运行模型并对输入的`.mat`数据进行预处理。然而，痤疮图像数据集已经准备好用于训练和验证。
- en: Model training
  id: totrans-107
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 模型训练
- en: As we mentioned earlier, we are using LSTM and CNN, particularly 1D CNN, for
    use case one. For use case two, we are using MobileNet v1\. All of these DL implementations
    support transfer learning that does not require training from scratch to use them
    in IoT devices.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，我们在用例一中使用LSTM和CNN，特别是1D CNN。在用例二中，我们使用MobileNet v1。所有这些深度学习实现都支持迁移学习，因此无需从头开始训练即可在物联网设备中使用。
- en: Use case one
  id: totrans-109
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用例一
- en: 'We used an LSTM five-layered architecture for the ECG data classification,
    as shown in the following diagram:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 我们为ECG数据分类使用了五层LSTM架构，如下图所示：
- en: '![](img/1e65abf3-9627-4970-a5c0-88f92a6a457e.png)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1e65abf3-9627-4970-a5c0-88f92a6a457e.png)'
- en: 'We can train and test the model by running the `LSTM_ECG.py` file available
    in the chapter''s code folder named `use-case-1` subfolder:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过运行`LSTM_ECG.py`文件来训练和测试模型，该文件位于本章代码文件夹中的`use-case-1`子文件夹内：
- en: '[PRE1]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'For the ECG data in the remote patient-management system, we also tested and
    validated a CNN model. The following diagram presents the CNN architecture we
    used for the ECG dataset. As we can see, the CNN architecture consists of four
    convolutional layers:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 对于远程患者管理系统中的ECG数据，我们还测试并验证了一个CNN模型。下图展示了我们用于ECG数据集的CNN架构。从图中可以看出，CNN架构由四个卷积层组成：
- en: '![](img/b5ecf62c-f78e-42b1-b04f-1e08218ab5a0.png)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b5ecf62c-f78e-42b1-b04f-1e08218ab5a0.png)'
- en: 'We can train and test the model by running the `CNN1D_ECG.py` file, available
    in the chapter''s code folder named `use-case-1` subfolder:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过运行`CNN1D_ECG.py`文件来训练和测试模型，该文件位于本章代码文件夹中的`use-case-1`子文件夹内：
- en: '[PRE2]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Use case two
  id: totrans-118
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用例二
- en: 'We used MobileNet v1 for the second use case. The following diagram presents
    the architecture of the model:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在第二个用例中使用了MobileNet v1。下图展示了该模型的架构：
- en: '![](img/74b1bab5-469d-4085-ac21-37c1f7a3a64c.png)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![](img/74b1bab5-469d-4085-ac21-37c1f7a3a64c.png)'
- en: To train and validate the model on the acne dataset, we need to run the `retrain_CNN.py`
    file available in the chapter's code folder named `use-case-2` subfolder. To train
    and test the model*,* we need to just run the following in the Command Prompt.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 为了在痤疮数据集上训练和验证模型，我们需要运行`retrain_CNN.py`文件，该文件位于本章代码文件夹中的`use-case-2`子文件夹内。要训练和测试模型*，*我们只需在命令提示符下运行以下命令。
- en: '[PRE3]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: The final two parameters of MobileNet v1 training are compulsory, and the rest
    are optional.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: MobileNet v1训练的最后两个参数是强制性的，其他参数则是可选的。
- en: Model evaluations
  id: totrans-124
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 模型评估
- en: 'We have evaluated three different aspects of the models:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 我们评估了模型的三个不同方面：
- en: Learning/(re)training time
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 学习/（重新）训练时间
- en: Storage requirement
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 存储需求
- en: Performance (accuracy)
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 性能（准确率）
- en: In terms of training time, in a desktop (Intel Xenon CPU E5-1650 v3 @3.5 GHz
    and 32 GB RAM) with GPU support, LSTM and CNN 1D on the ECG data took more than
    one hour, and MobileNet v1 on the acne dataset took less than 1 hour.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 在训练时间方面，在一台带GPU支持的台式机（Intel Xenon CPU E5-1650 v3 @3.5 GHz，32 GB RAM）上，LSTM和CNN
    1D在ECG数据上的训练时间超过一小时，而MobileNet v1在痤疮数据集上的训练时间不到1小时。
- en: 'The storage requirement of a model is an essential consideration in resource-constrained
    IoT devices. The following screenshot presents the storage requirements for the
    three models we tested for the two use cases:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 模型的存储需求是资源受限的物联网设备中的一个重要考量。下图展示了我们为两个用例测试的三个模型的存储需求：
- en: '![](img/6c66eabf-5f6a-494a-96cc-cea9d8fc6127.png)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6c66eabf-5f6a-494a-96cc-cea9d8fc6127.png)'
- en: As shown, a saved model of LSTM took 234 MB of storage, CNN 1D took 8.5 MB,
    and MobileNet v1 (CNN) took 16.3 MB. In terms of storage requirements, all of
    the models, except the current version of LSTM, are fine to be deployed in many
    resource-constrained IoT devices, including Raspberry Pi 3 or smartphones.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 如图所示，LSTM保存的模型占用了234 MB的存储空间，CNN 1D占用了8.5 MB，MobileNet v1（CNN）占用了16.3 MB。在存储需求方面，除了当前版本的LSTM外，所有模型都可以部署在许多资源受限的IoT设备上，包括Raspberry
    Pi 3或智能手机。
- en: Finally, we have evaluated the performance of the models. In both of the use
    cases, dataset-wide evaluation or testing has been executed during the training
    phase in the desktop PC platform/server side, but we can also test them in the
    Raspberry Pi 3 or any IoT edge computing devices as the models are transferable.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们评估了模型的性能。在这两个用例中，数据集范围内的评估或测试已在桌面PC平台/服务器端的训练阶段执行，但我们也可以在Raspberry Pi 3或任何IoT边缘计算设备上进行测试，因为这些模型是可迁移的。
- en: Model performance (use case one)
  id: totrans-134
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 模型性能（用例一）
- en: 'The following screenshot shows the training and validation result of the LSTM
    used on the ECG dataset. As seen in the screenshot, the test accuracy is consistently
    very close to 1.0 or 100%. However, validation accuracy is not great, and is in
    the range of 50% for the two different runs of the model (100 and 500 epochs).
    The following screenshot shows how the LSTM model is progressing during the training
    stage:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了在ECG数据集上使用LSTM的训练和验证结果。从截图中可以看到，测试准确率始终接近1.0或100%。然而，验证准确率不理想，且在两次不同的模型运行（100和500个epoch）中，验证准确率在50%左右。以下截图显示了LSTM模型在训练阶段的进展：
- en: '![](img/75306c51-c5ca-4044-b569-8bf315bf0d76.png)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![](img/75306c51-c5ca-4044-b569-8bf315bf0d76.png)'
- en: 'The following graph, generated through TensorBoard''s log file, shows the training
    accuracy of the LSTM model on the ECG dataset:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表通过TensorBoard的日志文件生成，展示了LSTM模型在ECG数据集上的训练准确率：
- en: '![](img/9ba98f59-9088-4c77-b24a-a560fc010c24.png)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9ba98f59-9088-4c77-b24a-a560fc010c24.png)'
- en: 'The following diagram presents the confusion matrix of the LSTM model''s validation
    results for the ECG data:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表展示了LSTM模型在ECG数据集上的验证结果的混淆矩阵：
- en: '![](img/e15b3019-2c21-4cfd-ae87-6404a50f6fac.png)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e15b3019-2c21-4cfd-ae87-6404a50f6fac.png)'
- en: The matrix clearly highlights the fact that the LSTM model is performing poorly
    on the ECG data. In particular, it is failing to identify most AF measurements
    (abnormal heart rhythm).
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 矩阵清楚地显示了LSTM模型在ECG数据集上的糟糕表现。特别是，它未能识别大多数AF（异常心律）测量。
- en: 'The LSTM''s poor performance on the ECG dataset motivated us to test the CNN
    1D model on the dataset. The following diagrams present the performance of the
    CNN 1D model on the ECG dataset. As shown in the diagrams, CNN''s one-dimensional
    model test accuracy is consistently well above 0.96 or 96% (slightly lower than
    for the LSTM model) and, importantly, its validation accuracies are consistently
    in the range of 0.82, which is well above that for LSTM. Models with this level
    of accuracy should be able to classify the correct heart rhythm of the patient
    in most cases and report accordingly. The following screenshot shows how the CNN
    1D model is progressing during the training stage and its final training and validation
    accuracy:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: LSTM在ECG数据集上的表现不佳，促使我们在该数据集上测试了CNN 1D模型。以下图示展示了CNN 1D模型在ECG数据集上的性能。如图所示，CNN的单维度模型的测试准确率始终高于0.96或96%（略低于LSTM模型），且其验证准确率始终在0.82左右，明显高于LSTM。具备这种准确度的模型应该能够在大多数情况下正确分类患者的心律，并进行相应报告。以下截图显示了CNN
    1D模型在训练阶段的进展及其最终训练和验证准确率：
- en: '![](img/2110adc9-16e3-47df-a508-15e74bad8d23.png)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2110adc9-16e3-47df-a508-15e74bad8d23.png)'
- en: 'The following graph, generated through TensorBoard''s log file, shows the validation
    accuracy of the CNN 1D model on the ECG dataset:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表通过TensorBoard的日志文件生成，展示了CNN 1D模型在ECG数据集上的验证准确率：
- en: '![](img/4fe89cfc-d2ce-4618-b92d-e2885a7333e3.png)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4fe89cfc-d2ce-4618-b92d-e2885a7333e3.png)'
- en: 'The following diagram presents the normalized confusion matrix of the CCN 1D
    model''s validation results for the ECG data:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表展示了CNN 1D模型在ECG数据集上的验证结果的归一化混淆矩阵：
- en: '![](img/7fd2e2af-4d10-417b-90d7-999bfcc8889b.png)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7fd2e2af-4d10-417b-90d7-999bfcc8889b.png)'
- en: The matrix clearly highlights the fact that the model is performing much better
    than the LSTM model on the ECG data. Importantly, it is successfully identifying
    most (87.5%) AF measurements (abnormal heart rhythm).
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 矩阵清楚地突出显示了该模型在 ECG 数据上的表现远超 LSTM 模型。重要的是，它成功地识别了大多数（87.5%）的房颤（AF）测量值（异常心律）。
- en: The CCN 1D model's performance can be improved; it can even be made very close
    to 100% by making the model's network denser. However, this will make the model
    complex, and the trained model will need more memory, making it unsuitable for
    resource-constrained IoT devices.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 通过增加模型网络的密度，CCN 1D 模型的性能可以得到改善，甚至可以接近 100%。然而，这会使得模型变得复杂，训练后的模型需要更多的内存，这使得它不适用于资源受限的物联网设备。
- en: Model performance (use case two)
  id: totrans-150
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 模型性能（用例二）
- en: 'We have trained and validated the MobileNet v1 model on the reduced acne dataset.
    The following screenshot presents the evaluation results of the model. As we can
    see from the screenshot, training accuracy is 1.0, or 100% in most steps, and
    final test accuracy is 0.89, or 89%:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经在减少后的痤疮数据集上训练并验证了 MobileNet v1 模型。以下截图展示了模型的评估结果。从截图中可以看到，大多数步骤中的训练准确率为
    1.0 或 100%，最终的测试准确率为 0.89 或 89%：
- en: '![](img/1c7c1c4c-11b4-4cd7-a0b4-557a507d38a7.png)'
  id: totrans-152
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1c7c1c4c-11b4-4cd7-a0b4-557a507d38a7.png)'
- en: 'The following graph, generated in TensorBoard using the model''s training and
    validation accuracies'' log files, show that training accuracies are a little
    inconsistent in the early steps, and consistently close to 1.0, or 100%, after
    that. On the other hand, validation accuracies are a little inconsistent in the
    range of 80-89%:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表是通过 TensorBoard 生成的，基于模型的训练和验证准确率日志文件，显示了训练准确率在初期步骤中略有不一致，而之后稳定接近 1.0 或
    100%。另一方面，验证准确率在 80% 到 89% 范围内略有不一致：
- en: '![](img/b812cbe8-3cdf-4a42-b62a-37e9f7d70bd4.png)'
  id: totrans-154
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b812cbe8-3cdf-4a42-b62a-37e9f7d70bd4.png)'
- en: We believe that, even with this inconsistency, the model should be able to detect
    the type of acne in more than 80% of cases.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 我们相信，即使存在这些不一致，模型仍然能够在超过 80% 的案例中检测到痤疮的类型。
- en: Summary
  id: totrans-156
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: The healthcare industry is adopting ML and DL for various applications. IoT
    healthcare applications need to adopt ML and DL techniques for the true realization
    of healthcare IoT. In this chapter, we have tried to show how DL-based IoT solutions
    can be useful and how they can be implemented in healthcare applications. In the
    first part of this chapter, we presented an overview of the various applications
    of IoT in healthcare. Then, we briefly discussed two use cases where healthcare
    services can be improved and/or automated through DL-supported IoT solutions.
    In the second part of the chapter, we presented a hands-on experience of the DL-based
    healthcare incident and/or skin diseases, detection part of the two use cases.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 医疗行业正在采用机器学习（ML）和深度学习（DL）技术进行各种应用。物联网（IoT）医疗应用需要采用 ML 和 DL 技术，才能真正实现医疗物联网的目标。本章中，我们尝试展示了基于
    DL 的物联网解决方案如何有用，以及它们如何在医疗应用中得以实施。在本章的第一部分，我们介绍了物联网在医疗行业的各种应用概述。随后，我们简要讨论了两个使用案例，通过
    DL 支持的物联网解决方案可以改善和/或自动化医疗服务。在本章的第二部分，我们展示了基于 DL 的医疗事件和/或皮肤病检测案例的实践经验。
- en: The use of DL in IoT applications is emerging. However, there are challenges
    associated with DL techniques and IoT that need to be addressed soon in order
    to get the best results from the integration of these two exciting technologies.
    In the next and final chapter, we will identify and discuss these challenges.
    In addition, we will provide a few future directions to mitigate some of the issues.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 深度学习（DL）在物联网应用中的使用正在兴起。然而，DL 技术与物联网结合存在一些挑战，这些问题需要尽快解决，以便最大限度地发挥这两种令人兴奋的技术整合的潜力。在下一章，也是最后一章中，我们将识别并讨论这些挑战。此外，我们将提供一些未来的方向，以减轻一些问题。
- en: References
  id: totrans-159
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考文献
- en: 'Bahar Farahani, Farshad Firouzi, Victor Chang, Mustafa Badaroglu, Nicholas
    Constant, and Kunal Mankodiya, *Towards fog-driven IoT eHealth: Promises and challenges
    of IoT in medicine and healthcare*, Future Generation Computer Systems, volume
    78, part 2, 2018, pages 659-676'
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Bahar Farahani, Farshad Firouzi, Victor Chang, Mustafa Badaroglu, Nicholas Constant,
    和 Kunal Mankodiya，*面向雾计算驱动的物联网电子健康：物联网在医学和医疗中的承诺与挑战*，《未来一代计算机系统》，第 78 卷，第 2 部分，2018年，第
    659-676 页
- en: 'Missed GP appointments costing the NHS millions: [https://www.england.nhs.uk/2019/01/missed-gp-appointments-costing-nhs-millions/](https://www.england.nhs.uk/2019/01/missed-gp-appointments-costing-nhs-millions/)'
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 错过的全科医生预约让 NHS 损失数百万：[https://www.england.nhs.uk/2019/01/missed-gp-appointments-costing-nhs-millions/](https://www.england.nhs.uk/2019/01/missed-gp-appointments-costing-nhs-millions/)
- en: World Health Organization, (September 10, 2017), *Noncommunicable diseases*: [http://www.who.int/mediacentre/factsheets/fs355/en/](http://www.who.int/mediacentre/factsheets/fs355/en/)
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 世界卫生组织，（2017年9月10日），*非传染性疾病*：[http://www.who.int/mediacentre/factsheets/fs355/en/](http://www.who.int/mediacentre/factsheets/fs355/en/)
- en: 'MACAELA MACKENZIE, *All the Ways Acne Can Mess With Your Mental Health*: [https://www.allure.com/story/how-acne-affects-mental-health-depression](https://www.allure.com/story/how-acne-affects-mental-health-depression)'
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MACAELA MACKENZIE，*粉刺如何影响心理健康的各种方式*：[https://www.allure.com/story/how-acne-affects-mental-health-depression](https://www.allure.com/story/how-acne-affects-mental-health-depression)
- en: 'Vallerand IA, Lewinson RT, Parsons LM, Lowerison MW, Frolkis AD, Kaplan GG,
    Barnabe C, Bulloch AGM, and Patten SB: *Risk of depression among patients with
    acne in the UK: a population-based cohort study*, Br. J. Dermatol, (2018) 178(3):
    e194-e195'
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Vallerand IA, Lewinson RT, Parsons LM, Lowerison MW, Frolkis AD, Kaplan GG,
    Barnabe C, Bulloch AGM 和 Patten SB：*在英国患有粉刺的患者中抑郁的风险：基于人群的队列研究*，Br. J. Dermatol，（2018）178（3）：e194-e195
- en: 'Riccardo Miotto, Fei Wang, Shuang Wang, Xiaoqian Jiang, and Joel T Dudley,
    *Deep learning for healthcare: review, opportunities, and challenges*, Briefings
    in Bioinformatics, Volume 19, Issue 6, November 2018, pp. 1236–1246'
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Riccardo Miotto, Fei Wang, Shuang Wang, Xiaoqian Jiang 和 Joel T Dudley，*医疗健康的深度学习：回顾、机遇和挑战*，Briefings
    in Bioinformatics，Volume 19，Issue 6，2018年11月，pp. 1236–1246
- en: 'Goldberger AL, Amaral LAN, Glass L, Hausdorff JM, Ivanov PCh, Mark RG, Mietus
    JE, Moody GB, Peng C-K, Stanley HE. *PhysioBank, PhysioToolkit, and PhysioNet:
    components of a new research resource for complex physiologic signals*, *Circulation*
    (2000) 101(23): e215-e220'
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Goldberger AL, Amaral LAN, Glass L, Hausdorff JM, Ivanov PCh, Mark RG, Mietus
    JE, Moody GB, Peng C-K, Stanley HE。*PhysioBank, PhysioToolkit 和 PhysioNet：复杂生理信号的新研究资源的组成部分*，*Circulation*（2000）101（23）：e215-e220
- en: 'AliveCor: [https://www.alivecor.com/](https://www.alivecor.com/)'
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AliveCor：[https://www.alivecor.com/](https://www.alivecor.com/)
- en: '*Dermnet* *Skin Disease Atlas*: [http://www.dermnet.com/dermatology-pictures-skin-disease-pictures/](http://www.dermnet.com/dermatology-pictures-skin-disease-pictures/)'
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*皮肤病图谱Dermnet*：[http://www.dermnet.com/dermatology-pictures-skin-disease-pictures/](http://www.dermnet.com/dermatology-pictures-skin-disease-pictures/)'
