- en: MAB for Financial Engineering
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 金融工程中的多臂老虎机（MAB）
- en: 'Today, **machine learning** (**ML**) has taken on a fundamental role in many
    environments of the financial ecosystem: from the approval of loans and the management
    of activities, to the assessment of risks. **Artificial intelligence** (**AI**)
    systems have great importance in the management of equity portfolios and in the
    creation of algorithms for trading. Again, AI is increasingly important for fraud
    detection, and the search for and identification of fraudulent practices. Algorithms
    that are capable of learning and calibrating how they act to new threats are overcoming
    the limits of traditional processes that are based on rigid checklists. In this
    chapter, we will address some of the financial engineering problems with **reinforcement
    learning** (**RL**) to learn about optimization and anomaly identification techniques.'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 今天，**机器学习**（**ML**）在金融生态系统中的许多领域已扮演着至关重要的角色：从贷款批准、活动管理到风险评估。**人工智能**（**AI**）系统在股票投资组合管理和交易算法的创建中具有重要作用。同样，AI在欺诈检测中也变得越来越重要，用于寻找和识别欺诈行为。能够学习并根据新威胁调整行为的算法正在克服传统依赖严格检查清单的过程的局限性。本章将讨论一些金融工程问题，采用**强化学习**（**RL**）来学习优化和异常识别技术。
- en: By the end of this chapter, we will have learned about the fundamental concepts
    of finance problems and how to model credit risk using Markov chains. We will
    also understand how to build a pricing optimization system to find the best price
    to launch a new product. Finally, we will learn how to optimize equity portfolios.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 到本章结束时，我们将了解金融问题的基本概念，以及如何使用马尔可夫链来建模信用风险。我们还将理解如何构建一个定价优化系统，以找到推出新产品的最佳价格。最后，我们将学习如何优化股票投资组合。
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: Finance problem essentials
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 金融问题要点
- en: Modeling credit risks as Markov chains
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将信用风险建模为马尔可夫链
- en: Pricing optimization system
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定价优化系统
- en: Optimizing equity portfolios
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 优化股票投资组合
- en: Fraud detection techniques
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 欺诈检测技术
- en: Technical requirements
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'Check out the following video to see the Code in Action:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 查看以下视频，了解代码的实际应用：
- en: '[http://bit.ly/34ee91x](http://bit.ly/34ee91x)'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://bit.ly/34ee91x](http://bit.ly/34ee91x)'
- en: Finance problem essentials
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 金融问题要点
- en: Technological innovation and the financial sphere have been proceeding hand
    in hand for several years, further accelerating with the entry of machine learning into
    the field. The high volumes of data, the possibility of accessing accurate historical
    documentation, and the quantitative nature of the financial sphere makes it one
    of the most suitable industries in which to integrate automatic learning. In this
    way, the operators of the sector are freed from a series of necessary activities
    that are of little creative value.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 技术创新与金融领域已共同发展多年，并随着机器学习的引入而加速推进。大量的数据、访问精确历史文档的可能性以及金融领域的量化特性，使其成为集成自动学习的最合适行业之一。通过这种方式，行业从业者能够摆脱一系列低创意价值的必要活动。
- en: 'Machine learning allows machines to make autonomous decisions: instead of a
    series of instructions for carrying out an activity, instructions are provided
    on how to learn to perform these activities independently. This capacity for self-learning,
    combined with the analysis of big data and special algorithms, has taken on a
    fundamental role in various financial operations, from risk assessment to loan
    approval.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 机器学习使机器能够自主决策：与执行活动的指令序列不同，它提供了如何学习独立完成这些活动的指令。这种自我学习的能力，结合大数据分析和特殊算法，已在各种金融操作中扮演着基础性角色，从风险评估到贷款批准。
- en: Through machine learning, a financial company can innovate its work activities
    and increase efficiency, output, and, ultimately, profitability. Understanding
    the technological evolution that's undertaken by these companies reveals numerous
    opportunities, but also the need to recognize change and welcome and manage it.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 通过机器学习，金融公司可以创新其工作活动，提高效率、产出，并最终提升盈利能力。了解这些公司所进行的技术演进揭示了诸多机会，同时也凸显了需要识别变化、欢迎并管理变化的必要性。
- en: 'In the complex set of financial activities, it is difficult to hypothesize
    an area in which machine learning cannot intervene to speed up, simplify, and
    streamline procedures, and it is no coincidence that it is precisely in this context
    that there is a profound reflection on the role that human employees will have
    in the near future. But there is no need to worry: from the perspective of continuous
    growth, financial organizations will limit themselves to directing their staff
    toward high value-added activities, where artificial agents will be important
    consultants but cannot have a decision-making role.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 在复杂的金融活动体系中，很难假设有任何一个领域是机器学习无法介入的，去加速、简化和精简程序，也正因如此，正是在这个背景下，关于人工员工在未来将扮演何种角色的深刻反思才得以展开。但不必担心：从持续增长的角度来看，金融机构将仅仅引导其员工从事高附加值的活动，在这些活动中，人工代理将作为重要的顾问，尽管无法扮演决策者的角色。
- en: Finance has always been rich in terms of numbers, but in recent decades, it
    has grown in complexity. The digital revolution first and then that of communications
    has made the availability of data of all kinds grow exponentially. Interactions
    on social networks, queries on search engines, banking transactions, and e-commerce
    activities add to the immense catalog of digitized information that can be automatically
    analyzed.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 金融一直以来都充满数字，但在最近几十年，它的复杂性不断增长。首先是数字革命，随后是通信革命，促使各种数据的可用性呈指数级增长。社交网络上的互动、搜索引擎上的查询、银行交易和电子商务活动，都增加了可以自动分析的数字信息的庞大目录。
- en: A new demand for data management services is born from recommendation systems
    for the contents of e-commerce sites because of the need to know and to stabilize
    increasingly complex credit systems. For finance, the pressure of competition
    in almost perfect markets leads to continuous improvement. We are witnessing a
    constant tension between agents trying to break the equilibrium, aspiring to new
    forms of profit, and agents pushing toward equilibrium points to realize small,
    systematic profits.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 由于需要了解和稳定日益复杂的信用体系，电子商务网站内容推荐系统产生了对数据管理服务的新需求。对于金融而言，几乎是完美市场中的竞争压力促使持续改进。我们正目睹着代理商之间不断的张力：一些代理商试图打破平衡，追求新的利润形式，而另一些代理商则推向平衡点，力图实现小规模的、系统性的利润。
- en: 'In the financial sphere, there are many fields in which artificial agents can
    be useful to simplify activities, as shown in the following diagram:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在金融领域，有许多领域可以利用人工代理来简化活动，如下图所示：
- en: '![](img/de1defae-4c6e-412c-9a6c-775c81885ecb.png)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![](img/de1defae-4c6e-412c-9a6c-775c81885ecb.png)'
- en: In the upcoming sections, we will analyze the most widespread activities that
    use algorithms based on machine learning.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的章节中，我们将分析使用基于机器学习算法的最广泛应用活动。
- en: Financial trading
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 金融交易
- en: 'Financial trading is a high-yield speculative investment activity that involves
    the financial market. The financial market is defined as a place where financial
    assets are traded. Trading on financial markets is based on a set of factors:
    technical analysis, micro and macroeconomic fundamentals, news, and market sentiment.
    When we talk about high-frequency trading, where the positions are maintained
    even for fractions of a second, the management that''s done by advanced algorithms
    is fundamental. The introduction of machine learning is responsible for a strong
    refinement of techniques and can be used for strategic processing based on various
    indicators, to identify arbitration opportunities and evaluate performance, learn
    the critical issues, and apply an improved model to the upcoming trading opportunities.'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 金融交易是一种高收益的投机性投资活动，涉及到金融市场。金融市场被定义为金融资产交易的场所。金融市场的交易基于一组因素：技术分析、微观和宏观经济基本面、新闻和市场情绪。当我们谈到高频交易时，仓位的保持时间甚至可能只有几分之一秒，这时由高级算法管理的作用是至关重要的。机器学习的引入使得技术得到了强有力的细化，可以通过各种指标进行战略性处理，用来识别套利机会、评估绩效、学习关键问题，并将改进的模型应用于即将到来的交易机会。
- en: Credit scoring
  id: totrans-24
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 信用评分
- en: 'The credit assessment process is a pillar of the business of commercial banks
    and has been refined over the years with new methodologies and access to ever
    larger datasets. Within this activity, which is often referred to as **credit
    scoring**, machine learning can make the difference and it is no coincidence that
    many institutions are already active on the front. Here too, machine learning
    is given a role in extending the procedures in place: in addition to all of the
    consolidated parameters, which continue to be the basis of credit scoring, machine
    learning can complete the evaluation process by examining extremely heterogeneous
    data such as behavior on social networks.'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 信用评估过程是商业银行业务的支柱，并且随着新的方法论的出现以及对越来越大数据集的访问，已经得到了多年的精细化发展。在这一活动中，通常被称为**信用评分**，机器学习能够发挥关键作用，许多机构已经在这一领域有所作为，这也并非巧合。在这里，机器学习的作用体现在扩展现有流程：除了所有经过验证的参数，它们仍然是信用评分的基础，机器学习还可以通过分析非常异质的数据，如社交网络上的行为，来完善评估过程。
- en: Financial chatbot
  id: totrans-26
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 金融聊天机器人
- en: Among the first ever uses of machine learning in the banking sector, is virtual
    assistance. Speaking of cost reduction, entrusting a large part of customer care
    activities to a bot supported by machine learning is extremely efficient. Also,
    this rule is applied according to which routine requests (counterclaim, transfer,
    and withdrawal) are both the most common and the most easily assigned to software.
    It is no coincidence that the Bank of America introduced its Erica bot in 2016
    to simplify the management of personal finance to its tens of millions of customers.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在银行业中，机器学习的早期应用之一是虚拟助手。说到成本降低，将大量客户服务工作委托给由机器学习支持的机器人是极为高效的。此外，应用这一规则，常见的例行请求（如反索赔、转账和取款）是最常见的，也是最容易交给软件处理的。美国银行在2016年推出其Erica机器人，旨在简化个人财务管理，服务数千万客户，这并非巧合。
- en: Robo-advisor
  id: totrans-28
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 机器人顾问
- en: An example of a virtual assistant is the robo-advisor, who compared to the simple
    automation of routine operations, belongs to the world of financial consulting.
    Through the robo-advisor, it is possible to receive personalized asset management
    advice based on our objectives and, possibly, to buy or sell financial products.
    The same robo-advisor can then follow the investment trend by offering the client
    periodic reports and proposing any corrective measures.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 一个虚拟助手的例子是机器人顾问，和简单的常规操作自动化相比，它属于金融咨询领域。通过机器人顾问，用户可以根据自身目标获得个性化的资产管理建议，可能还可以买卖金融产品。同样，机器人顾问还可以跟踪投资趋势，向客户提供定期报告，并提出任何必要的纠正措施。
- en: In the next section, we will use Markov chains to model a company's credit risk.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一部分，我们将使用马尔可夫链来模拟公司信用风险。
- en: Modeling credit risks as Markov chains
  id: totrans-31
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将信用风险建模为马尔可夫链
- en: 'A financial company is exposed to different types of risk, which are generally
    divided into three main groups: market risk, credit risk, and operational risk.
    In the international financial landscape of recent years, credit scoring has acquired
    a crucial role in what is defined as the **credit risk analysis** process. The
    goal of **credit scoring** models is to be able to correctly classify who applies
    for access to a credit channel to reduce the risk related to the possible insolvency
    of the applicant. Following the global crisis that broke out in the United States
    due to the delinquencies on sub-prime mortgages, financial and credit institutions
    have had to face major losses over the last decade, followed by a long period
    of recession. All of this inevitably brought the entire credit risk analysis process
    under the magnifying glass, with emphasis on credit scoring techniques.'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 金融公司面临着不同类型的风险，通常分为三大类：市场风险、信用风险和操作风险。在近年来的国际金融环境中，信用评分在被定义为**信用风险分析**的过程中发挥了至关重要的作用。**信用评分**模型的目标是能够正确地分类哪些申请人能获得信贷渠道的访问权限，从而减少与申请人可能违约相关的风险。继美国因次贷危机爆发后，金融和信贷机构在过去十年中遭遇了重大损失，随后进入了漫长的衰退期。所有这些不可避免地将整个信用风险分析过程置于放大镜下，特别强调了信用评分技术。
- en: Credit scoring has undergone significant growth in recent decades. Before these
    developments, loans were granted following mostly subjective assessments, based
    on the personal relationships that were created between the applicant and the
    credit institution's credit analyst. In most cases, the latter was represented
    precisely by the bank to which funding was requested. However, the ever-growing
    requests for financing and the multitude of financial products available have
    made it necessary to adapt the credit management system. Increasingly, we have
    tried to apply automatic and objective techniques that allow the analysis of the
    potential customer in a faster and more efficient way. The output of these techniques
    involves the adoption of a **score** that can reliably classify the customer's
    creditworthiness.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 信用评分在近几十年来经历了显著的增长。在这些发展之前，贷款通常是根据主观评估来授予的，评估依据是申请人和信用机构的信用分析师之间建立的人际关系。在大多数情况下，信用分析师通常是代表着提供资金的银行。然而，日益增长的融资需求和众多可用的金融产品迫使我们不得不调整信用管理系统。我们越来越多地尝试应用自动化和客观的技术，使得对潜在客户的分析可以更快速、更高效。这些技术的输出结果通常是采用一个**评分**，能够可靠地分类客户的信用状况。
- en: A correct assessment of credit risk is essential to be able to achieve successful
    management in all of the activities of a bank. The need to increase the accuracy
    of risk assessment by financial intermediaries has led to the development, updating,
    and discovery of new models and techniques for calculating the probability of
    default and expected recovery rates. A precise analysis on the evolution of the
    creditworthiness of the debtor, and a correct estimate of the parameters that
    influence the credit risk, are also indispensable to solve the problems related
    to the pricing of loans and bonds. Among the various models and tried-and-tested
    approaches, there are the more modern ones that exploit the new technological
    capabilities of data storage, analysis, and training to statistical theory in
    order to identify credit risk components more accurately.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 对信用风险的正确评估对于银行的所有活动能够成功管理至关重要。金融中介机构需要提高风险评估的准确性，这促使了新模型和新技术的发展、更新和发现，用于计算违约概率和预期回收率。对债务人信用状况演变的精确分析，以及对影响信用风险的参数的正确估计，也是解决与贷款和债券定价相关问题的必要条件。在各种模型和成熟的方法中，现代方法利用了新的数据存储、分析和统计理论训练的技术能力，以便更准确地识别信用风险的组成部分。
- en: In the next section, we will deal with modeling credit scoring using some packages
    already available in R.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将介绍使用 R 中已存在的一些软件包进行信用评分建模。
- en: The CreditMetrics package
  id: totrans-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '`CreditMetrics`软件包'
- en: To address credit scoring techniques, we will use the `CreditMetrics` package
    that's available on CRAN. This package contains a set of functions for computing
    the `CreditMetrics` risk model.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 为了处理信用评分技术，我们将使用在 CRAN 上可用的`CreditMetrics`软件包。该软件包包含一组用于计算`CreditMetrics`风险模型的函数。
- en: 'The following table gives some information about this package:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 下表提供了关于此软件包的一些信息：
- en: '| Package | `CreditMetrics` |'
  id: totrans-39
  prefs: []
  type: TYPE_TB
  zh: '| 软件包 | `CreditMetrics` |'
- en: '| Date | 2015-02-19 |'
  id: totrans-40
  prefs: []
  type: TYPE_TB
  zh: '| 日期 | 2015-02-19 |'
- en: '| Version | 0.0-2 |'
  id: totrans-41
  prefs: []
  type: TYPE_TB
  zh: '| 版本 | 0.0-2 |'
- en: '| Title | Functions for calculating the `CreditMetrics` risk model |'
  id: totrans-42
  prefs: []
  type: TYPE_TB
  zh: '| 标题 | 用于计算`CreditMetrics`风险模型的函数 |'
- en: '| Author | Andreas Wittmann |'
  id: totrans-43
  prefs: []
  type: TYPE_TB
  zh: '| 作者 | 安德烈亚斯·维特曼 |'
- en: The `CreditMetrics` model was proposed for the first time by J.P. Morgan as
    a tool for calculating the **Value At Risk** (**VAR**) related to credit exposures.
    This model is one of the most widespread credit risk management systems. It aims
    to define a composition of the loan portfolio so that it's consistent with the
    expected risk-return combination desired by the intermediary, and therefore with
    a more efficient allocation of capital. The credit risk value, in particular,
    varies with the quality associated with the receivables present in the portfolio,
    generating movements of the single credits (migrations) among the three main classes
    identified (the financial distress, the upgrading or improvement of the credit
    rating, and the downgrading or deterioration of the quality associated with the
    individual loan). The credit risk differs substantially from the market risk (`riskmetrics`)
    because, for the latter, it is possible to assume a normal probability distribution
    that is symmetrical with respect to its average value, while what's relative to
    portfolios that are exposed to the risk of credit is positively asymmetric. In
    the next section, we will discuss a practical case of credit risk modeling using
    the `CreditMetrics` package.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '`CreditMetrics` 模型首次由J.P. 摩根提出，作为计算与信贷风险敞口相关的**风险价值**（**VAR**）的工具。该模型是最广泛使用的信用风险管理系统之一。它旨在定义贷款组合的构成，使其与中介所期望的风险-回报组合一致，从而实现更高效的资本配置。特别地，信用风险值会随着与投资组合中应收账款相关的质量变化而变化，导致单一信用（迁移）在识别的三个主要类别之间的变动（财务困境、信用评级的升级或改善，以及与单一贷款相关的质量下降或恶化）。信用风险与市场风险（`riskmetrics`）有显著不同，因为对于后者，可以假设相对于其平均值对称的正态概率分布，而与暴露于信用风险的投资组合相关的风险则是正向非对称的。在下一节中，我们将讨论一个使用`CreditMetrics`包进行信用风险建模的实际案例。'
- en: The CreditMetrics risk model
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: CreditMetrics风险模型
- en: Credit risk is the risk that an unexpected event, related to the repayment capacity
    or creditworthiness of a counterparty, will change the value of the credit position.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 信用风险是指与对方的偿付能力或信用状况相关的意外事件，可能会改变信用头寸的价值。
- en: In assessing credit risk, we can distinguish between the default mode approach,
    which only considers the occurrence of insolvency, and a multi-state approach,
    in which even the deterioration of the counterpart's creditworthiness represents
    a source of credit risk.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在评估信用风险时，我们可以区分违约模式方法，它只考虑破产的发生，以及多状态方法，在这种方法中，即使对方信用状况的恶化也代表了信用风险的来源。
- en: 'The first approach envisages two possible states for a credit position: default
    or non-default. The occurrence of the default event is determined exclusively
    by the default probability of the associated binary variable. The multi-state
    approach considers the migration risk, which is the risk that the value of a position
    will change due to a deterioration in the creditworthiness of the counterparty.
    The default status represents one of the possible states and the migration in
    this state coincides with the insolvency event.'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 第一种方法设想了信用头寸的两种可能状态：违约或非违约。违约事件的发生仅由相关的二元变量的违约概率决定。多状态方法考虑了迁移风险，即由于对方信用状况的恶化，头寸价值发生变化的风险。违约状态代表可能的一个状态，而在该状态下的迁移与破产事件一致。
- en: The fundamental tool on which the multi-state approach is based is the transition
    matrix, which can be estimated based on historical observations and is provided
    by rating agencies.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 多状态方法的基本工具是转移矩阵，可以基于历史观察来估计，并由评级机构提供。
- en: 'We will begin our analysis by defining the migration matrix, which, as we anticipated,
    is provided by rating agencies:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将通过定义迁移矩阵开始分析，正如我们预见的那样，该矩阵由评级机构提供：
- en: 'To start, we will import the `CreditMetrics` library:'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们将导入`CreditMetrics`库：
- en: '[PRE0]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Now, let''s reproduce the experiment:'
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们复现这个实验：
- en: '[PRE1]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: This command sets the seed of R's random number generator. You must use this
    function every time you want to get a reproducible random result. When we use
    this command, the random numbers that are generated will always be the same, so
    with each execution of the code, the results that are obtained will always be
    the same. Each seed value will correspond to a sequence of values that are generated
    for a given random number generator.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 这个命令设置了 R 随机数生成器的种子。每次想要得到可重现的随机结果时，都必须使用这个函数。使用此命令时生成的随机数将始终相同，因此每次执行代码时，得到的结果也将始终相同。每个种子值将对应于给定随机数生成器生成的数值序列。
- en: Now, let's define the migration matrix, which represents the transition matrix
    of a Markov process. Rating agencies, such as `Standard% Poor`, provide transition
    matrices based on historical data related to over 20 years of observations on
    companies in different sectors.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们定义迁移矩阵，它表示马尔可夫过程的转移矩阵。评级机构，如 `Standard% Poor`，基于公司不同行业超过 20 年的观察数据提供转移矩阵。
- en: There are seven rating categories, from the highest AAA class to the lowest
    CCC class. The last state is the default, which is characterized by being an absorbent
    state in which the probability of exit is null.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 有七个评级类别，从最高的 AAA 类到最低的 CCC 类。最后一个状态是默认状态，其特征是吸收状态，在这种状态下，退出的概率为零。
- en: 'Then, we define the rating classes:'
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们定义评级类别：
- en: '[PRE2]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'After doing this, we define the transition matrix:'
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 做完这些后，我们定义了转移矩阵：
- en: '[PRE3]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The following matrix is printed:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 打印以下矩阵：
- en: '[PRE4]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'In this table, the ratings in the first column are the starting or current
    ratings. The ratings in the first row are the ratings at the risk horizon. Furthermore,
    each row of the matrix sums to 100%. The meaning of the transition matrix is now
    clear. This is a square matrix containing the probabilities of the transition
    matrix. For example, there is an 8.33% chance that an AAA rated credit will downgrade
    to an AA rating within one year. In this way, we can recover the credit rating
    that''s going to be the most likely to occur in any year as the current one. As
    a rule, the transition matrix should be calculated for the same time interval
    as the risk horizon over which we are estimating the risk. In our case, we are
    satisfied with the values provided:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个表中，第一列的评级是起始或当前评级。第一行的评级是风险视野处的评级。此外，矩阵的每一行都总和为 100%。现在清楚了转移矩阵的含义。这是一个包含转移概率的方阵。例如，AAA
    评级的信用有 8.33% 的概率在一年内降级为 AA 评级。通过这种方式，我们可以恢复出在任何一年内最有可能发生的信用评级，作为当前评级。作为一个规则，转移矩阵应该是在我们估计风险的风险视野内计算的同样时间间隔。在我们的情况下，我们对提供的值感到满意：
- en: 'To start, we can create the `markovchain` object, as follows:'
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们可以创建 `markovchain` 对象，如下所示：
- en: '[PRE5]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: The `markovchain` class has been designed to handle homogeneous Markov chain
    processes.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: '`markovchain` 类已被设计用来处理同质马尔可夫链过程。'
- en: 'The following slots are passed:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 传递了以下插槽：
- en: '`transitionMatrix`: This is the square transition matrix containing the probabilities
    of the transition matrix.'
  id: totrans-69
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`transitionMatrix`: 这是包含转移概率的方阵转移矩阵。'
- en: '`states`: This is the name of the states. It must be of the same `colnames`
    and `rownames` as the transition matrix—this is a character vector, listing the
    states for which transition probabilities are defined.'
  id: totrans-70
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`states`: 这是状态的名称。它必须与转移矩阵的 `colnames` 和 `rownames` 相同，这是一个字符向量，列出了定义了转移概率的状态。'
- en: '`byrow`: This is a binary flag—a logical element indicating whether transition
    probabilities are shown by row or by column.'
  id: totrans-71
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`byrow`: 这是一个二进制标志，一个逻辑元素，指示转移概率是按行还是按列显示。'
- en: '`name`: This is an optional character element to name the discrete time Markov
    chains.'
  id: totrans-72
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`name`: 这是一个可选的字符元素，用于命名离散时间马尔可夫链。'
- en: 'To show a summary of the model we''ve just created, use the following command:'
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要显示我们刚刚创建的模型的摘要，使用以下命令：
- en: '[PRE6]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The following results are returned:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 返回以下结果：
- en: '[PRE7]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: As we can see, four slots are listed—`states`, `byrow`, `transitionMatrix`,
    and `name`. To retrieve the elements contained in each one, use the name of the
    object (`MarkovChainModel`), followed by the name of the slot, separated by the `@` symbol.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们所见，列出了四个插槽——`states`、`byrow`、`transitionMatrix` 和 `name`。要检索每个插槽中包含的元素，使用对象的名称（`MarkovChainModel`），后跟插槽的名称，用`@`符号分隔。
- en: 'For example, to print the states, we will write the following:'
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 例如，要打印状态，我们将写以下内容：
- en: '[PRE8]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'The following results are returned:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 返回以下结果：
- en: '[PRE9]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Other information that we can extract from the newly developed model is the
    transition probability that represents the probability of passing from one state
    to another. Recall that a Markov chain is said to be homogeneous in time if the
    probabilities of transition from one state to another are independent of the time
    index. To obtain this information, we will use the `transitionProbability()` function,
    which allows us to get the transition probabilities from initial to subsequent
    states.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以从新开发的模型中提取的其他信息是过渡概率，表示从一种状态过渡到另一种状态的概率。请记住，如果马尔可夫链在时间上是齐次的，那么从一个状态到另一个状态的过渡概率是独立于时间指数的。为了获取此信息，我们将使用 `transitionProbability()` 函数，它允许我们获取从初始状态到后续状态的过渡概率。
- en: 'Let''s learn how to get this information:'
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们学习如何获取这些信息：
- en: '[PRE10]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'The following result is returned:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 返回以下结果：
- en: '[PRE11]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: We can confirm this result by analyzing the transition matrix. In that matrix,
    the transition from the AAA state to the AA state is given by the element p[12],
    which is just equal to 0.083.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过分析过渡矩阵来确认这一结果。在该矩阵中，从AAA状态到AA状态的过渡由元素p[12]给出，其值正好等于0.083。
- en: Now, let's calculate the credit spread for the migration matrix. The credit
    spread indicates a series of measures that are used to determine how much an investor
    is paid to compensate for the assumption of the intrinsic credit risk in the security.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们计算迁移矩阵的信用违约利差。信用违约利差指一系列用于确定投资者支付多少来补偿所承担的证券固有信用风险的措施。
- en: To calculate the credit spread, we will use the `cm.cs()` function, which requires
    a migration matrix and the loss given default as input. The loss given default
    represents the loss that the credit institution suffers due to the insolvency
    of the counterparty when it becomes effective. Therefore, it is never predictable
    a priori; it only occurs when the credit recovery operation ends.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 要计算信用违约利差，我们将使用 `cm.cs()` 函数，它需要迁移矩阵和违约给予损失作为输入。违约给予损失表示信用机构由于交易对手破产而遭受的损失，仅在信用恢复操作结束时才能确定。因此，它从不是预先可预测的；它只有在信用恢复操作结束时才发生。
- en: 'In our case, we will set this value as an initial variable, as follows:'
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在我们的情况下，我们将此值作为初始变量设置如下：
- en: '[PRE12]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The preceding code indicates that, in the case of insolvency, the loss of the
    bank will be 40%. Now, we can apply the `cm.cs()` function, as follows:'
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 上述代码表明，在破产情况下，银行的损失将为40%。现在，我们可以应用 `cm.cs()` 函数，如下所示：
- en: '[PRE13]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'This function returns the credit spread for time *t = 1* of each rating in
    the migration matrix, as follows:'
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此函数返回迁移矩阵中每个评级在时间*t = 1*的信用违约利差，如下所示：
- en: '[PRE14]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Let''s calculate the value of the credit in one year. To do this, we can use
    the `cm.ref()` function. The following arguments are required:'
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们计算一年内的信用价值。为此，我们可以使用 `cm.ref()` 函数。需要以下参数：
- en: Migration matrix, where the last row gives the default class
  id: totrans-97
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 迁移矩阵，其中最后一行给出违约类别
- en: Loss given default
  id: totrans-98
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 违约给予损失
- en: Rating of companies
  id: totrans-99
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 公司评级
- en: Exposure at default
  id: totrans-100
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 违约风险
- en: Riskless interest rate
  id: totrans-101
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 无风险利率
- en: The first two arguments have already been defined and used, that is, the migration
    matrix and loss given default. For the remaining three, it is necessary to initialize
    them.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 前两个参数已经定义并使用，即迁移矩阵和违约给予损失。对于剩余的三个参数，需要初始化它们。
- en: 'Let''s start with the rating of the companies whose credit value we want to
    evaluate. We will set three values, as follows:'
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们从我们想要评估其信用价值的公司的评级开始。我们将设置三个值，如下：
- en: '[PRE15]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '**Exposure At Default** (**EAD**) is the amount of loss that a bank may suffer
    due to default. Since the default occurs on an unknown future date, this loss
    is conditioned by the amount the bank exposed to the borrower at the time of default.'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '**违约暴露**（**EAD**）是银行可能由于违约而遭受的损失金额。由于违约发生在未来的未知日期，这种损失取决于银行在违约时对借款人暴露的金额。'
- en: 'We will set three values, as follows:'
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将设置三个值，如下：
- en: '[PRE16]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Then, we have to set the riskless interest rate; this parameter represents
    the interest expected by an investor from a completely risk-free investment over
    a given period of time. We set this value as follows:'
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们需要设置无风险利率；该参数表示投资者在给定时间段内从完全无风险投资中预期的利率。我们将此值设置如下：
- en: '[PRE17]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Now that we have all of the arguments that are required by the `cm.ref()` function,
    we just have to apply it:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经有了 `cm.ref()` 函数所需的所有参数，我们只需应用它：
- en: '[PRE18]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Two values are returned:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 返回两个值：
- en: '`constVal`: Credit value in one year'
  id: totrans-113
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`constVal`：一年内的信用价值'
- en: '`constPV`: Portfolio of all the credit values in one year'
  id: totrans-114
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`constPV`：一年内所有信用值的投资组合'
- en: 'To extract these values, we can use the following commands:'
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要提取这些值，我们可以使用以下命令：
- en: '[PRE19]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'The following results are printed:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 以下结果被打印：
- en: '[PRE20]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Finally, we can search the absorbing state of the model. Remember that the
    absorbing state is a state that once entered, cannot be left. To evaluate the
    absorbing state, we can use the `absorbingStates()` function as follows:'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，我们可以搜索模型的吸收状态。记住，吸收状态是一种一旦进入就无法退出的状态。为了评估吸收状态，我们可以使用`absorbingStates()`函数，方法如下：
- en: '[PRE21]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'The following result is returned:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 返回以下结果：
- en: '[PRE22]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: It is easy to understand that the default is a state absorbed in the sense that,
    once reached, it cannot be abandoned anymore. In the next section, we will address
    the problem of price optimization using the multi-armed bandit analysis.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 很容易理解，默认状态是一种吸收状态，一旦进入，就无法再退出。在下一节中，我们将使用多臂赌博机分析来解决价格优化问题。
- en: Pricing optimization system
  id: totrans-124
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 定价优化系统
- en: Pricing is something more than simply aligning prices with those of competitors
    in the market. One of the most negative aspects of global trade is that there
    is always someone, somewhere, selling the same products at a much lower price.
    Automatically aligning prices with competitors is not a sustainable strategy.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 定价不仅仅是将价格与市场上竞争对手的价格对齐。全球贸易的一个负面方面是，总有某些地方有人以远低于市场价格的价格出售相同的产品。自动将价格与竞争对手对齐并不是一个可持续的策略。
- en: There are two pricing strategies. The first considers the trader's point of
    view and offers an intuitive pricing method, according to which the choice of
    the right price must depend on the manager's intuition. Since this strategy is
    very subjective, and since the results depend substantially on the manager's ability,
    it is difficult to evaluate it. And if the manager leaves the company, much of
    the knowledge about it should be lost. The second is based on a more theoretical
    point of view and offers an econometric pricing method, in which the choice of
    prices must be made based on advanced mathematical parameters.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 有两种定价策略。第一种考虑的是交易员的观点，提供了一种直观的定价方法，根据该方法，选择正确的价格必须依赖于经理的直觉。由于这种策略非常主观，且结果在很大程度上取决于经理的能力，因此很难评估它。如果经理离开公司，关于该策略的大部分知识将会丧失。第二种策略基于更理论化的观点，提供了一种计量经济学定价方法，在该方法中，价格的选择必须基于先进的数学参数。
- en: Once we have chosen a range of prices to apply to the financial product, it
    is good practice to adopt an optimization procedure that evaluates the market
    reactions to the new product we want to launch. In the simplest case, an optimization
    problem consists of maximizing or minimizing a real function by systematically
    choosing the input values from an allowed set and calculating the value of the
    function. The generalization of theory and optimization techniques to other formulations
    constitutes a vast area of applied mathematics. More generally, optimization includes
    searching for the best available values of some objective functions in each domain,
    including a variety of different types of objective functions and different types
    of domains.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们选择了适用于金融产品的价格范围，采用一种优化程序来评估市场对我们想要推出的新产品的反应是一个良好的做法。在最简单的情况下，优化问题包括通过系统地选择允许集合中的输入值并计算函数值来最大化或最小化一个实数函数。理论和优化技术的推广到其他公式构成了应用数学的一个广阔领域。更一般地说，优化包括在每个领域中寻找一些目标函数的最佳可用值，涵盖了各种不同类型的目标函数和领域。
- en: 'There are many optimization methods available; the following are some of the
    most important:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 有许多优化方法可用；以下是一些最重要的方法：
- en: Linear programming
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 线性规划
- en: Least squares method
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最小二乘法
- en: Simplex algorithm
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 单纯形算法
- en: Lagrange multiplier method
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 拉格朗日乘数法
- en: Stochastic optimization
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 随机优化
- en: In this example, we will try to address the problem of price optimization using
    multi-armed bandit analysis and the Bandit R package. To learn more about multi-armed
    bandit algorithms, see [Chapter 4](80162fc2-33f6-4f5a-9f70-6d063b32d9c9.xhtml),
    *Multi-Armed Bandit Models*. We will begin by introducing the Bandit package.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们将尝试通过多臂赌博机分析和Bandit R包来解决价格优化问题。欲了解更多关于多臂赌博机算法的信息，请参见[第4章](80162fc2-33f6-4f5a-9f70-6d063b32d9c9.xhtml)，*多臂赌博机模型*。我们将从介绍Bandit包开始。
- en: The Bandit package
  id: totrans-135
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Bandit包
- en: 'This package contains a set of functions for analyzing A/B split test data
    and web metrics in general. The following table gives some information about this
    package:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 该包包含一组用于分析A/B拆分测试数据和一般网页指标的函数。以下表格提供了有关该包的一些信息：
- en: '| Package | `Bandit` |'
  id: totrans-137
  prefs: []
  type: TYPE_TB
  zh: '| 包 | `Bandit` |'
- en: '| Date | 2015-02-19 |'
  id: totrans-138
  prefs: []
  type: TYPE_TB
  zh: '| 日期 | 2015-02-19 |'
- en: '| Version | 0.5.0 |'
  id: totrans-139
  prefs: []
  type: TYPE_TB
  zh: '| 版本 | 0.5.0 |'
- en: '| Title | Functions for simple A/B split test and multi-armed bandit analysis
    |'
  id: totrans-140
  prefs: []
  type: TYPE_TB
  zh: '| 标题 | 用于简单A/B拆分测试和多臂强盗分析的函数 |'
- en: '| Author | Thomas Lotze and Markus Loecher |'
  id: totrans-141
  prefs: []
  type: TYPE_TB
  zh: '| 作者 | 托马斯·洛茨和马库斯·勒歇尔 |'
- en: In the upcoming sections, we will formalize the problem and then face it through
    multi-armed bandit analysis.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的章节中，我们将形式化这个问题，并通过多臂强盗分析来解决它。
- en: Pricing strategy for new financial services
  id: totrans-143
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 新金融服务的定价策略
- en: A financial company that is very active in the market is considering the release
    of a new financial service. After having tested all of the services already available
    on the market by competitors and having compared their performance, the company
    decides to establish a range of prices to be attributed to the launch of its own
    service.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 一家在市场上非常活跃的金融公司正在考虑推出一项新的金融服务。在测试了市场上竞争对手已提供的所有服务并对其性能进行了比较后，该公司决定为其自己推出的服务设定一系列价格。
- en: To check which of the identified prices best suits the needs of consumers, they
    have decided to test four types of prices by collecting subscriptions to the service.
    Each price will be attributed to the service for a period of time, during which
    the users who have been contacted and the accessions that have been obtained will
    be registered.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 为了检查哪种确定的价格最能满足消费者的需求，他们决定通过收集服务订阅来测试四种不同的价格。每个价格将会在一段时间内归属于该服务，在此期间，将记录已经联系过的用户和已获得的订阅。
- en: 'The monitoring campaign will last three months, and an analysis will be carried
    out for each month. In the end, the best performing price will be adopted. Follow
    these steps:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 监控活动将持续三个月，每个月都会进行分析。最后，将采用表现最佳的价格。请按照以下步骤操作：
- en: 'To start, we need to import the `Bandit` library:'
  id: totrans-147
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们需要导入`Bandit`库：
- en: '[PRE23]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Now, let''s reproduce the experiment:'
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们重现实验：
- en: '[PRE24]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Now, we report the data that was collected in the first month related to the
    users contacted and to the purchases of the services performed, as well as to
    the prices offered:'
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们报告在第一个月内收集的数据，涉及已联系的用户、已购买的服务以及提供的价格：
- en: '[PRE25]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'As we can see, these are three vectors, which contain the data for each category.
    At this point, we can move on to the simulation of the posterior distribution
    for each arm at various prices:'
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如我们所见，这里有三个向量，其中包含每个类别的数据。现在，我们可以开始模拟不同价格下每个手臂的后验分布：
- en: '[PRE26]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Here, we used the `sim_post()` function, which simulates the posterior distribution
    of the Bayesian probabilities for each arm being the best binomial bandit. The
    following arguments were passed:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们使用了`sim_post()`函数，该函数模拟了每个手臂作为最优二项分布强盗的贝叶斯概率的后验分布。以下是传递的参数：
- en: '`Purchases1`: A vector of the number of successes'
  id: totrans-156
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Purchases1`：成功次数的向量'
- en: '`UsersContacted1`: A vector of the number of trials'
  id: totrans-157
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`UsersContacted1`：试验次数的向量'
- en: '`ndraws`: The number of random draws from the posterior'
  id: totrans-158
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ndraws`：来自后验的随机抽样次数'
- en: 'In this way, we get 10,000 assessments of the posterior distribution for the
    Bayesian probabilities. In the following are the first 10 assessments:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 通过这种方式，我们获得了10,000次对后验分布的评估，用于贝叶斯概率的估计。以下是前10次评估：
- en: '[PRE27]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'We can, therefore, evaluate the winner:'
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 因此，我们可以评估赢家：
- en: '[PRE28]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: The `prob_winner()` function was used, which computes the probability that each
    arm is the winner, given simulated posterior results obtained in the preceding
    step. This function accepts only one argument—the simulated results from the posterior,
    provided by the `sim_post()` function.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 使用了`prob_winner()`函数，该函数计算每个手臂在给定前一步模拟后的结果时成为赢家的概率。该函数只接受一个参数——`sim_post()`函数提供的后验模拟结果。
- en: 'We now assign the names to the winners we have simulated:'
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们现在为我们模拟的赢家分配名称：
- en: '[PRE29]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'Now, let''s visualize the simulation results:'
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们可视化模拟结果：
- en: '[PRE30]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'The following results are returned:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 返回以下结果：
- en: '[PRE31]'
  id: totrans-169
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: As we can see, the simulation told us that the price that seems to have been
    the most popular among users is $306, which collected 78.5% of the probability.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所见，模拟结果告诉我们，似乎在用户中最受欢迎的价格是$306，该价格收集了78.5%的概率。
- en: As we anticipated, we continue our monitoring by extending the analysis to the
    second month.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们预期的那样，我们通过扩展分析到第二个月，继续我们的监控。
- en: 'To start, we report the data collected in the second month relating to the
    users contacted and the purchases of the services performed:'
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们报告第二个月收集的数据，这些数据涉及联系的用户和进行的服务购买：
- en: '[PRE32]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: As we can see, these are two vectors that respectively contain the four data
    for each category.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们所见，这些是分别包含每个类别四个数据的两个向量。
- en: 'At this point, we can move on to the simulation of the posterior distribution
    for each arm at various prices:'
  id: totrans-175
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此时，我们可以进入不同价格下每个臂的后验分布模拟：
- en: '[PRE33]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'We can, therefore, evaluate the winner:'
  id: totrans-177
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 因此，我们可以评估获胜者：
- en: '[PRE34]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'We now assign the names to the winners we have simulated:'
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们现在给模拟的获胜者分配名称：
- en: '[PRE35]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Now, let''s visualize the simulation results:'
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们可视化模拟结果：
- en: '[PRE36]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'The following results are returned:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 返回以下结果：
- en: '[PRE37]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: As we can see, the simulation told us that the price that seems to have been
    the most popular among users is $306, which collected 60.3% of the probability.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们所见，模拟结果告诉我们，似乎在用户中最受欢迎的价格是 $306，获得了 60.3%的概率。
- en: 'Finally, let''s move on to the last month of price monitoring:'
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，让我们进入价格监控的最后一个月：
- en: '[PRE38]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'At this point, we can move on to the simulation of the posterior distribution
    for each arm at various prices:'
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此时，我们可以进入不同价格下每个臂的后验分布模拟：
- en: '[PRE39]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'We can, therefore, evaluate the winner:'
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 因此，我们可以评估获胜者：
- en: '[PRE40]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'We now assign the names to the winners we have simulated:'
  id: totrans-192
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们现在给模拟的获胜者分配名称：
- en: '[PRE41]'
  id: totrans-193
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'Now, let''s visualize the simulation results:'
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们可视化模拟结果：
- en: '[PRE42]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'The following results are returned:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 返回以下结果：
- en: '[PRE43]'
  id: totrans-197
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: As we can see, the simulation told us that the price that seems to have been
    the most popular among users is $306, which collected 52.9 % of the probability.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们所见，模拟结果告诉我们，似乎在用户中最受欢迎的价格是 $306，获得了 52.9%的概率。
- en: Let's try to see whether the results obtained are statistically significant.
    When can we say that our experiment is significant? Nothing is significant at
    all. We decide how convincing the experiment must be to make us conclude that
    it really works. A fairly common way to represent the significance of a study
    is the P-value. The P-value is a number that represents the probability that the
    result found is due to chance, rather than to the phenomenon under consideration.
    Usually, by designing the experiment, you decide that you want to reach a particular
    P-value, for example, 1%, and you decide accordingly how big the sample must be;
    in other cases, the sample size is not under our control and the significance
    of the study is calculated a posteriori.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们尝试看看得到的结果是否具有统计学意义。我们什么时候可以说我们的实验是显著的？实际上，没有任何结果是显著的。我们决定实验结果需要有多有说服力，才能得出它真的有效。表示研究显著性的一种常见方式是
    P 值。P 值是一个数字，表示结果是由于偶然因素而非研究现象本身的概率。通常，在设计实验时，你会决定想要达到的特定 P 值，例如 1%，然后相应地决定样本大小；在其他情况下，样本大小无法控制，研究的显著性则是事后计算的。
- en: 'To perform a significance test, we will use the `significance_analysis()` function,
    as follows:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 为了进行显著性检验，我们将使用 `significance_analysis()` 函数，如下所示：
- en: '[PRE44]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'This function performs overall proportion comparison, and the following values
    are returned:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 该函数执行总体比例比较，并返回以下值：
- en: '`successes`: A vector of the number of successes'
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`successes`: 成功次数的向量'
- en: '`totals`: A vector of the number of trials'
  id: totrans-204
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`totals`: 试验次数的向量'
- en: '`estimated_proportion`: The number of successes/number of trials'
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`estimated_proportion`: 成功次数/试验次数'
- en: '`lower`: 0.95 confidence interval on the estimated amount by which this alternative
    outperforms the next-lower alternative'
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`lower`: 0.95 置信区间，表示此方案比下一个低效方案的估计优势'
- en: '`upper`: 0.95 confidence interval on the estimated amount by which this alternative
    outperforms the next-lower alternative'
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`upper`: 0.95 置信区间，表示此方案比下一个低效方案的估计优势'
- en: '`significance`: P-value for the test that this alternative outperforms the
    next-lower alternative'
  id: totrans-208
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`significance`: 此方案比下一个低效方案的 P 值'
- en: '`order`: order by highest success proportion'
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`order`: 按成功比例从高到低排序'
- en: '`best`: 1 if it is part of the "highest performing group"—those groups that
    were not significantly different from the best group'
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`best`: 如果它属于“表现最好的组”——即那些与最佳组没有显著差异的组，则为 1'
- en: '`p_best`: Bayesian posterior probability that this alternative is the best
    binomial bandit'
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`p_best`: 贝叶斯后验概率，表示此方案是最优二项带状选手'
- en: 'The data for the third month of monitoring returns the following results for
    the significance test:'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 监控第三个月的数据返回了显著性检验的以下结果：
- en: '![](img/08d12858-2479-43d9-a992-1ff47143df8c.png)'
  id: totrans-213
  prefs: []
  type: TYPE_IMG
  zh: '![](img/08d12858-2479-43d9-a992-1ff47143df8c.png)'
- en: The results confirm that the fourth value that we have chosen as the price has
    produced non-significant results, so we can leave it out in subsequent analyses.
    The monitoring conducted so far has provided us with enough data. Let's go on
    to calculate the distribution of the improvement amounts that another arm could
    have on the current best arm.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 结果确认我们选择的第四个作为价格的值产生了不显著的结果，因此我们可以在后续的分析中将其排除。到目前为止进行的监控为我们提供了足够的数据。接下来，我们将计算另一个臂可能对当前最佳臂产生的改进金额的分布。
- en: 'To start, we will calculate the value remaining as follows:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们将按如下方式计算剩余值：
- en: '[PRE45]'
  id: totrans-216
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'We have used the `value_remaining()` function that returns the distribution
    of improvement amounts that another arm might have over the current best arm.
    Finally, we will calculate the potential value remaining:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用了`value_remaining()`函数，该函数返回另一个臂可能对当前最佳臂产生的改进金额的分布。最后，我们将计算潜在的剩余值：
- en: '[PRE46]'
  id: totrans-218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: In the previous code, we used the `quantile()` function. This function returns
    the quantiles of the indicated function (`ValueRemaining`) corresponding to the
    required value (0.95).
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 在之前的代码中，我们使用了`quantile()`函数。该函数返回指定函数（`ValueRemaining`）对应的分位数值（0.95）。
- en: 'The following result is returned:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 返回以下结果：
- en: '[PRE47]'
  id: totrans-221
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: This value tells us that, compared to the price that seems to be winning ($306),
    any other value could beat it with a probability of up to 7.14%, which represents
    the 95% quantile of the remaining value.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 这个值告诉我们，相较于看似获胜的价格（$306），任何其他值都可能以高达7.14%的概率击败它，这代表了剩余值的95%分位数。
- en: 'In the following section, we will tackle an optimization problem: we will try
    to evaluate the optimal configuration of a financial portfolio.'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的部分，我们将处理一个优化问题：我们将尝试评估金融投资组合的最佳配置。
- en: Optimizing equity portfolios
  id: totrans-224
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 优化股票投资组合
- en: 'The selection of an optimal portfolio is a typical decision problem, and as
    such, its solution consists of the following elements: the identification of a
    set of alternatives, using selection criteria to sort through the different possibilities,
    and the solution of the problem. To optimize a financial portfolio, we start by
    measuring the yield and risk of the products available. The risk-return variables
    can be considered two sides of the same coin since a certain level of risk will
    correspond to a given return. The return can be defined as the sum of the results
    produced by the investment concerning the capital employed, while the concept
    of risk can be translated into the degree of variability of returns associated
    with a given financial instrument. The preceding problem can be modeled as a MAB
    problem with financial products such as arms and product performance as a result.
    Before analyzing the code, we will define some concepts related to the world of
    financial investments.'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 选择一个最佳投资组合是一个典型的决策问题，因此其解决方案包括以下几个元素：识别一组备选方案，使用选择标准筛选不同的可能性，以及问题的解决。为了优化金融投资组合，我们首先衡量可用产品的收益和风险。风险-收益变量可以视为同一枚硬币的两面，因为一定水平的风险会对应一个给定的收益。收益可以定义为与所投入资本相关的投资产生的结果之和，而风险的概念可以转化为与特定金融工具相关的收益变动程度。前述问题可以建模为一个MAB问题，金融产品如同臂，产品性能作为结果。在分析代码之前，我们将定义一些与金融投资相关的概念。
- en: Exchange-traded fund portfolio optimization
  id: totrans-226
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 交易型基金投资组合优化
- en: 'The term **exchange-traded fund** (**ETF**) identifies a particular type of
    investment fund with two main characteristics: it is traded on the stock exchange
    as a share, and its sole investment objective is to replicate the index to which
    it reports (benchmark) through totally passive management.'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: '**交易型基金**（**ETF**）这一术语指的是一种特定类型的投资基金，具有两个主要特点：它像股票一样在证券交易所交易，且其唯一的投资目标是通过完全被动的管理复制其所跟踪的指数（基准）。'
- en: 'An ETF summarizes the characteristics of a fund and an action, allowing investors
    to exploit the strengths of both instruments:'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: ETF总结了基金和股票的特点，允许投资者利用这两种工具的优势：
- en: Diversification and risk reduction of the funds
  id: totrans-229
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 资金的多样化和风险降低
- en: Flexibility and information transparency of real-time trading of shares
  id: totrans-230
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 股票实时交易的灵活性和信息透明度
- en: 'Given its characteristics, the ETF lends itself to various modes of employment:
    medium/long-term investment, even intraday type trading and short selling to take
    a bearish position on the benchmark index. The possibility of easily diversifying
    the portfolio, the precision with which the benchmark index is replicated, and
    the low management costs mean that the ETF is particularly suitable for the construction
    of an accumulation plan through periodic payments—even small ones—that are made
    by individual investors. Let''s see how an ETF dataset is structured.'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 鉴于其特点，ETF可以用于多种方式：中长期投资，甚至是日内交易和卖空，借此对基准指数采取看空立场。由于ETF可以轻松实现投资组合的多样化、精准复制基准指数以及管理成本低，这使得它特别适合通过定期小额付款（即使是个体投资者）来构建累积投资计划。让我们来看看ETF数据集的结构。
- en: ETF dataset
  id: totrans-232
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ETF 数据集
- en: 'An ETF is, therefore, a collection of securities that draws an underlying index.
    The most well-known example is the SPDR S&P 500 (SPY) ETF, which replicates the
    S&P 500 index. In the example we are about to tackle, we will use a dataset containing
    the historical series of the following six ETFs:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，ETF是一组证券，它追踪一个基础指数。最著名的例子是SPDR S&P 500（SPY）ETF，它复制了S&P 500指数。在我们即将处理的示例中，我们将使用包含以下六只ETF的历史数据集：
- en: '**SPY**: SPDR S&P 500 ETF'
  id: totrans-234
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**SPY**: SPDR S&P 500 ETF'
- en: '**XLF**: Financial Select Sector SPDR Fund'
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**XLF**: 金融精选行业SPDR基金'
- en: '**IWM**: iShares Russell 2000 ETF; IEF'
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**IWM**: iShares Russell 2000 ETF; IEF'
- en: '**IEF**: iShares 7-10 Year Treasury Bond ETF'
  id: totrans-237
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**IEF**: iShares 7-10年期美国国债ETF'
- en: '**GLD**: SPDRÂ Gold Shares'
  id: totrans-238
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**GLD**: SPDR黄金股票'
- en: '**VWO**: Vanguard FTSE Emerging Markets ETF'
  id: totrans-239
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**VWO**: Vanguard FTSE 新兴市场ETF'
- en: These figures refer to the period from 1 January 2009 to 1 January 2019 and
    were downloaded from the Yahoo Finance website.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 这些数据对应的时间范围是从2009年1月1日到2019年1月1日，数据从雅虎财经网站下载。
- en: 'To start, we will import the dataset:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们将导入数据集：
- en: '[PRE48]'
  id: totrans-242
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'The dataset contains the following:'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 数据集包含以下内容：
- en: '**150 observations**: Monthly historical series'
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**150次观察**: 月度历史数据'
- en: '**6 variables**: `EFTreturns`'
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**6个变量**: `EFTreturns`'
- en: 'This information is returned using the `str()` function, as follows:'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 以下信息是通过`str()`函数返回的，如下所示：
- en: '[PRE49]'
  id: totrans-247
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'The following list is printed:'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 打印出以下列表：
- en: '[PRE50]'
  id: totrans-249
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'In the following screenshot, we can see the first 20 rows of the dataset:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 在下图中，我们可以看到数据集的前20行：
- en: '![](img/99f114f6-5eb4-4545-81a2-776e87b1be97.png)'
  id: totrans-251
  prefs: []
  type: TYPE_IMG
  zh: '![](img/99f114f6-5eb4-4545-81a2-776e87b1be97.png)'
- en: 'More information can be obtained using the `summary()` function, which produces
    summaries of each variable:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用`summary()`函数获得更多信息，该函数生成每个变量的摘要：
- en: '[PRE51]'
  id: totrans-253
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'The following results are returned:'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 返回以下结果：
- en: '![](img/eb00f1f0-bd2a-419e-acf2-dda7bff1df9b.png)'
  id: totrans-255
  prefs: []
  type: TYPE_IMG
  zh: '![](img/eb00f1f0-bd2a-419e-acf2-dda7bff1df9b.png)'
- en: 'In this way, we have obtained a series of statistical descriptors that show
    us the distribution of the values assumed by the indices. To get an overview of
    the data, we can trace a boxplot. A boxplot describes the distribution of a dataset
    by simple dispersion and position indexes. A boxplot can be either horizontal
    or vertical and contains a rectangular partition divided by two segments. The
    rectangle (box) is delimited by the following features: first quartile (25^(th)
    percentile) and the third quartile (75^(th) percentile). The line inside the box
    represents the median (50^(th) percentile). Generally, the `boxplot()` function
    is used to plot a boxplot, as follows:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 通过这种方式，我们获得了一系列统计描述符，展示了各指数的值分布。为了概览数据，我们可以绘制一个箱线图。箱线图通过简单的离散度和位置指标描述数据集的分布。箱线图可以是水平的或垂直的，并包含一个由两个分段组成的矩形分区。矩形（箱子）由以下特征限定：第一四分位数（25^(th)
    百分位数）和第三四分位数（75^(th) 百分位数）。箱子内部的线表示中位数（50^(th) 百分位数）。通常，`boxplot()`函数用于绘制箱线图，如下所示：
- en: '[PRE52]'
  id: totrans-257
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'The following diagram shows the boxplot of the ETFs contained in the dataset:'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 下图展示了数据集中包含的ETF的箱线图：
- en: '![](img/0092954a-da47-4390-8fb7-0a1d61a8f88a.png)'
  id: totrans-259
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0092954a-da47-4390-8fb7-0a1d61a8f88a.png)'
- en: The `boxplot()` function can also be used to identify outlier values. Outliers
    are extreme values that are far from other available observations. These values
    tend to distort the results of the data analysis. For these reasons, the outliers
    must be previously identified in the data cleaning phase or processed in the subsequent
    data analysis phase. Analyzing the previous diagram, we can see that the XLF variable
    shows different anomalous values at the extremes.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: '`boxplot()` 函数也可以用来识别异常值。异常值是远离其他可用观察值的极端值。这些值通常会扭曲数据分析的结果。因此，异常值必须在数据清理阶段提前识别，或者在随后的数据分析阶段处理中。通过分析前面的图表，我们可以看到，XLF
    变量在极值处表现出不同的异常值。'
- en: Upper confidence bounds approach
  id: totrans-261
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 上置信界限方法
- en: As we mentioned in Chapter 4, *Multi-Armed Bandit Models*, the game allows us
    to carry out exploitation and exploration together. At the beginning of the game,
    we don't know which arm is the best. Therefore, we cannot characterize any arm.
    Hence, the UCB algorithm employs that all arms have the same observed average
    value. So, a confidence limit for each arm will be created and an arm will be
    selected randomly.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们在第四章 *多臂老虎机模型* 中提到的，游戏允许我们同时进行开发和探索。在游戏开始时，我们不知道哪个臂是最好的，因此我们无法对任何臂进行特征化。因此，UCB
    算法假设所有臂的观察平均值相同。所以，每个臂都会创建一个置信区间，且臂会被随机选择。
- en: In this context, each arm will give a reward or not. If the arm selected returns
    a mistake, the average that's observed by the arm will decrease, as well as the
    confidence limit. If the arm that's selected returns a reward, the observed average
    will increase, and the confidence limit will also increase. Taking advantage of
    the best, we are decreasing the confidence limit. Adding more and more rounds,
    the likelihood that other arms are doing well also increases.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个上下文中，每个臂会给出奖励或不奖励。如果所选的臂返回一个错误，则该臂观察到的平均值会下降，置信区间也会减小。如果所选的臂返回奖励，则观察到的平均值会增加，置信区间也会增加。通过利用最好的臂，我们实际上是在减少置信区间。增加更多的回合时，其他臂表现良好的概率也会增加。
- en: 'Our goal is to select the stock that showed the maximum return for the highest
    number of observations. To do this, we transform our matrix with the monthly returns
    into a matrix in which, for each row, there will be some zeros, except for the
    maximum value, which will present a 1\. To do this, we will initialize a matrix
    of the same size as the starting dataset to zero. Then, we''ll enter a unit value
    at the maximum value of each row of the starting dataset:'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的目标是选择那个在最多观察次数中显示最大回报的股票。为此，我们将把包含月度回报的数据矩阵转换成一个矩阵，其中每行会有一些零，除了最大值之外，最大值位置会呈现为
    1。为此，我们将初始化一个与起始数据集大小相同的矩阵，并将其填充为零。然后，我们会在起始数据集每行的最大值位置填入 1：
- en: '[PRE53]'
  id: totrans-265
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: 'From this moment on, we will work on this dataset. To start, we will set the
    number of observation and the number of arms:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 从这一刻起，我们将使用这个数据集。首先，我们将设置观察次数和臂的数量：
- en: '[PRE54]'
  id: totrans-267
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: 'After doing this, we will try to initialize a series of variables that will
    be useful in our calculations:'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 做完这些之后，我们将尝试初始化一系列对我们的计算有用的变量：
- en: '[PRE55]'
  id: totrans-269
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'The names of the variables are quite intuitive, but let''s verify their meaning:'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 变量名称非常直观，但我们还是来验证一下它们的含义：
- en: '`EFTSelected`: The EFT selected in the iterative cycle'
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`EFTSelected`：在迭代周期中选定的 EFT'
- en: '`NumSelections`: The number of selections made'
  id: totrans-272
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`NumSelections`：所做选择的次数'
- en: '`RewSum`: The sum of rewards for each arm'
  id: totrans-273
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`RewSum`：每个臂的奖励总和'
- en: '`TotRew`: The total reward obtained'
  id: totrans-274
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`TotRew`：获得的总奖励'
- en: 'At this point, we must use two iterative cycles to pass the entire matrix.
    The first cycle will allow us to cross all of the rows, while the second will
    work on the columns. Previously, we defined these as the number of `NumObs` rows
    and as the number of `NumArms` columns:'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一点上，我们必须使用两个迭代周期来遍历整个矩阵。第一个周期将允许我们遍历所有行，而第二个周期将处理列。之前，我们将这些定义为 `NumObs` 行数和
    `NumArms` 列数：
- en: '[PRE56]'
  id: totrans-276
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: 'For each line, we initialize two further variables:'
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 对于每一行，我们初始化两个额外的变量：
- en: '[PRE57]'
  id: totrans-278
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: 'Now, we can go through the columns:'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以查看各列：
- en: '[PRE58]'
  id: totrans-280
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: 'Recall that, to perform an upper confidence bound at each round, two variables
    are computed: the sum of the rewards obtained by the lever *i* after *n* plays,
    and the number of times the lever *i* is played by the strategy in the first *n*
    plays. We calculate the average rewards obtained by the lever *i* after *n* plays
    as follows:'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，为了在每一轮进行上置信区间（UCB）计算，需要计算两个变量：杠杆*i*在*n*次操作后获得的奖励总和，以及策略在前*n*次操作中使用杠杆*i*的次数。我们按如下方式计算杠杆*i*在*n*次操作后获得的平均奖励：
- en: '[PRE59]'
  id: totrans-282
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: 'We calculate the confidence interval after *n* plays using the following command:'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用以下命令计算在*n*次操作后获得的置信区间：
- en: '[PRE60]'
  id: totrans-284
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: 'Then, we select the lever *i* that returns the maximum UCB, as follows:'
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们选择返回最大UCB的杠杆*i*，如下所示：
- en: '[PRE61]'
  id: totrans-286
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: 'After doing this, we make some checks:'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 完成此操作后，我们进行了一些检查：
- en: '[PRE62]'
  id: totrans-288
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: 'Finally, we update the values:'
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们更新了这些值：
- en: '[PRE63]'
  id: totrans-290
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: At this point, our analysis has been completed and we can view the results.
    To visualize the results, we need to draw a histogram. A histogram is a graph
    that shows the frequency that a given item appears in a specific range. A histogram
    is similar to a bar chart, but normally its area is used to graphically represent
    the frequency with which a given element appears. Histograms are used to represent
    a set of continuous data, such as time, a measurement, or a temperature. The main
    problem with histograms is the difficulty of comparing two sets of data and the
    impossibility of obtaining a precise reading of the values assumed by the data.
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，我们的分析已经完成，可以查看结果。为了可视化结果，我们需要绘制一个直方图。直方图是一种显示给定项目在特定范围内出现频率的图形。直方图类似于条形图，但通常使用其面积来图示某个元素出现的频率。直方图用于表示一组连续数据，如时间、测量值或温度。直方图的主要问题在于，比较两组数据的困难，以及无法精确读取数据所假设的值。
- en: 'To draw a histogram, we will use the `hist()` function, which computes a histogram
    of the given data values, as follows:'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 为了绘制直方图，我们将使用`hist()`函数，它计算给定数据值的直方图，如下所示：
- en: '[PRE64]'
  id: totrans-293
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: 'The following histogram is printed:'
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 打印出以下直方图：
- en: '![](img/14c98532-878c-4d02-a6b1-ff2c37228fef.png)'
  id: totrans-295
  prefs: []
  type: TYPE_IMG
  zh: '![](img/14c98532-878c-4d02-a6b1-ff2c37228fef.png)'
- en: From the analysis of the preceding diagram, it seems that stock (GLD) number
    6 is the one that's selected the most, by the algorithm.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的图表分析来看，股票（GLD）编号6是算法选择最多的。
- en: Finally, let's see how we can deal with the problems of identifying fraud.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，让我们看看如何处理欺诈识别的问题。
- en: Fraud detection techniques
  id: totrans-298
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 欺诈检测技术
- en: In the banking sector, fraud prevention is essential. And here, too, the implementation
    of machine learning within consolidated algorithms is a clear success factor.
    Here, we will return to the predictive capacity of AI—a suspicious movement is
    not only anomalous in terms of the level of figures and perhaps of geographical
    location, but also that which deviates from a behavioral model of the client that
    the AI has clearly identified. In this way, in the face of obvious anomalies,
    the AI can set blocks or limitations without waiting for the fraud to manifest
    itself in all of its potential.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 在银行领域，防止欺诈至关重要。在这里，机器学习在整合算法中的应用也是一个明显的成功因素。在此，我们将回到人工智能的预测能力——一个可疑的动作不仅在数字的层面和地理位置上表现出异常，还可能偏离人工智能明确识别的客户行为模型。通过这种方式，面对明显的异常，人工智能可以在欺诈完全暴露之前就设定阻止措施或限制。
- en: 'Fraud detection problems have generally been addressed using supervised algorithms.
    In these algorithms, a series of labels guide the machine to the identification
    of system anomalies. Reinforcement learning is a very robust algorithm that allows
    an agent to receive states from an environment and then perform actions based
    on those states. Depending on these actions, it will be rewarded accordingly.
    As we saw in [Chapter 2](aed130c4-9d8b-42d1-826a-e26a4162ebcf.xhtml), *Building
    Blocks of Reinforcement Learning*, the three essential elements are as follows:'
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 欺诈检测问题通常通过使用监督算法来解决。在这些算法中，一系列标签引导机器识别系统异常。强化学习是一种非常强大的算法，它允许智能体从环境中接收状态，然后根据这些状态执行行动。根据这些行动，智能体会相应地获得奖励。正如我们在[第二章](aed130c4-9d8b-42d1-826a-e26a4162ebcf.xhtml)《强化学习的构建模块》中看到的，三个基本要素如下：
- en: State
  id: totrans-301
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 状态
- en: Action
  id: totrans-302
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 行动
- en: Reward
  id: totrans-303
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 奖励
- en: If you want to use this to tackle a classification problem, it is necessary
    to carefully define the three parameters we just mentioned.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想使用它来解决分类问题，就需要仔细定义我们刚刚提到的三个参数。
- en: 'Suppose we want to identify the fraudulent use of credit cards, which is one
    of the most common computer crimes. The available data provides us with some variables
    that propose the behavior of the user and then the binary class (1.0) that labels
    the operation. In this case, a correct formulation of the problem includes the
    following parameters:'
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们想要识别信用卡的欺诈使用，这是最常见的计算机犯罪之一。可用数据为我们提供了一些变量，这些变量展示了用户的行为，然后是标记操作的二进制类（1.0）。在这种情况下，问题的正确表述包括以下参数：
- en: '`status`: These are all of the variables that summarize the user''s behavior.'
  id: totrans-306
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`status`: 这些是总结用户行为的所有变量。'
- en: '`action`: This is the binary value containing the operation label (0 = valid
    operation and 1 = fraudulent operation).'
  id: totrans-307
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`action`: 这是包含操作标签的二进制值（0 = 有效操作，1 = 欺诈操作）。'
- en: '`reward`: This provides feedback to the system. The reward is obtained through
    an evaluation of the action. You get a reward if the action = 0, or if the operation
    is valid. This will allow the reinforcement learning-based system to learn when
    an operation is valid and to discern it from fraudulent ones.'
  id: totrans-308
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`reward`: 这为系统提供反馈。奖励是通过对操作的评估获得的。如果操作=0，或者操作有效，则会获得奖励。这将使基于强化学习的系统学会何时操作有效，并将其与欺诈行为区分开来。'
- en: To improve the reward function, negative recompense can be envisaged in the
    case of fraudulent exploitation.
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 为了改进奖励函数，可以在欺诈行为的情况下考虑负面奖励。
- en: Summary
  id: totrans-310
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we learned how to solve financial problems using reinforcement
    learning techniques. After introducing the field of application, we studied some
    practical cases. For starters, we learned how to model credit risks such as Markov
    chains to perform credit scoring analysis. Then, we learned how to choose the
    best price for a new product to be launched on the market. Once we have chosen
    a range of prices to apply to the financial product, it is good practice to adopt
    an optimization procedure that evaluates the market reactions to the new product
    we want to launch. To do this, we modeled the system through an algorithm based
    on the multi-armed bandit approach. Finally, we learned how to optimize the choice
    of a stock market based on the returns that had been obtained in recent years.
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一章中，我们学习了如何利用强化学习技术解决金融问题。在介绍应用领域之后，我们研究了一些实际案例。首先，我们学习了如何通过建模信用风险（如马尔科夫链）进行信用评分分析。然后，我们学习了如何为即将上市的新产品选择最佳价格。一旦我们选择了一系列价格来应用于金融产品，采用一种优化程序评估市场对新产品的反应是一种良好的做法。为此，我们通过一个基于多臂赌博机方法的算法对系统进行了建模。最后，我们学习了如何基于近年来获得的回报优化股票市场的选择。
- en: In the next chapter, we will learn how to use reinforcement learning in healthcare.
    First, we will learn how to choose the optimal policies from observational data
    and understand how to detect breast cancer using TD-learning. Finally, we will
    learn how to forecast thyroid disease using R.
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将学习如何在医疗保健中应用强化学习。首先，我们将学习如何从观察数据中选择最优策略，并了解如何使用TD学习检测乳腺癌。最后，我们将学习如何使用R预测甲状腺疾病。
