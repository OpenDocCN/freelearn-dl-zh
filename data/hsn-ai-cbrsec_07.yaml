- en: Network Anomaly Detection with AI
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 基于AI的网络异常检测
- en: The current level of interconnection that can be established between different
    devices (for example, think of the **Internet of Things** (**IoT**)) has reached
    such a complexity that it seriously questions the effectiveness of traditional
    concepts such as perimeter security. As a matter of fact, cyberspace's attack
    surface grows exponentially, and it is therefore essential to resort to automated
    tools for the effective detection of network anomalies associated with unprecedented
    cybersecurity threats.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 当前可以在不同设备之间建立的互联互通水平（例如，考虑到**物联网**（**IoT**））已达到如此复杂的程度，以至于严重质疑传统概念，如边界安全的有效性。实际上，网络空间的攻击面呈指数级增长，因此，必须借助自动化工具来有效地检测与前所未有的网络安全威胁相关的网络异常。
- en: 'This chapter will cover the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: Network anomaly detection techniques
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络异常检测技术
- en: How to classify network attacks
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何分类网络攻击
- en: Detecting botnet topology
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测僵尸网络拓扑
- en: Different **machine learning** (**ML**) algorithms for botnet detection
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不同的**机器学习**（**ML**）算法用于僵尸网络检测
- en: In this chapter, we will focus on anomaly detection related to network security,
    postponing the discussion of the aspects of fraud detection and user anomaly behavior
    detection until the following chapters.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将重点讨论与网络安全相关的异常检测，将欺诈检测和用户异常行为检测的讨论推迟到后续章节。
- en: Network anomaly detection techniques
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络异常检测技术
- en: The techniques we have seen so far can also be adopted to manage anomaly detection
    and related attempts to gain unauthorized access to the corporate network. To
    fully understand the potential of anomaly detection techniques, we will trace
    its evolution in the cybersecurity area, illustrating the basic principles that
    characterize it.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 我们迄今为止所看到的技术也可以应用于管理异常检测以及相关的未授权访问企业网络的尝试。为了充分理解异常检测技术的潜力，我们将追溯其在网络安全领域的发展，阐明其基本原理。
- en: In fact, anomaly detection has always been a research area of cybersecurity,
    particularly in the field of network security protection. However, anomaly detection
    is not limited to identifying and preventing network attacks, but can also be
    adopted in other areas, such as fraud detection and in the identification of possible
    compromises of user profiles.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，异常检测一直是网络安全领域的研究方向，尤其是在网络安全保护领域。然而，异常检测不仅仅局限于识别和防止网络攻击，它还可以在其他领域中应用，比如欺诈检测和用户资料的潜在泄露识别。
- en: Anomaly detection rationales
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 异常检测的原理
- en: 'In the area of ​​network intrusion detection in particular, the following two
    different approaches have been followed over time:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在网络入侵检测领域，特别是长期以来，采取了以下两种不同的策略：
- en: Signature-based detection
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于签名的检测
- en: Anomaly detection
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 异常检测
- en: In the first case, we start from the analysis of attacks that are already known,
    building a knowledge base of signatures of attacks that were previously detected.
    This gets combined with an alert system to be launched whenever a correspondence
    with archived signatures is detected in the network traffic. The analogies of
    signature-based detection systems with various antivirus software are obvious,
    and the disadvantages are equally evident, hence the knowledge base of the signatures
    must be constantly updated to detect new types of attacks.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在第一种情况下，我们从已知攻击的分析开始，构建一个由之前检测到的攻击签名组成的知识库。这与警报系统结合，一旦网络流量中出现与归档签名的匹配，即可触发警报。基于签名的检测系统与各种杀毒软件的类比显而易见，缺点同样明显，因此，签名知识库必须不断更新，以便检测新的攻击类型。
- en: In the case of anomaly detection, on the other hand, an attempt is made to identify
    network traffic behavior that can be defined as **normal**, in order to detect
    differences in behavior that deviate from normality as **anomalous**. This approach,
    therefore, makes it possible to detect the new types of attack by analyzing the
    characteristics of network traffic that could be considered as anomalous.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 在异常检测的情况下，另一方面，我们尝试识别可以定义为**正常**的网络流量行为，以便检测那些偏离正常行为的差异，即将其识别为**异常**。因此，这种方法使得通过分析可能被认为是异常的网络流量特征来检测新型攻击成为可能。
- en: Therefore, it will be necessary to identify what constitutes **abnormal behavior** in
    terms of network traffic.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，有必要识别出什么构成**异常行为**，特别是针对网络流量的异常行为。
- en: 'In order to detect anomalous traffic, some elements that can be taken into
    consideration are as follows:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 为了检测异常流量，可以考虑以下一些元素：
- en: The number of connections to and from a specific host
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 到特定主机的连接数量
- en: Unusual remote communication ports or unexpected traffic patterns
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不寻常的远程通信端口或意外的流量模式
- en: Unusual traffic peaks occurring at particular times of the day (for example,
    traffic carrying on during the night)
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 特定时间段内出现的不寻常流量高峰（例如，夜间持续的流量）
- en: Communication bandwidth heavily occupied by particular hosts within the network
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络中由特定主机占用的大量通信带宽
- en: All these events may be considered as suspicious on the basis of the analysis
    previously conducted with respect to the network traffic that was regarded as
    normal. The basis of this comparison is that it is possible to define appropriate
    filters and associate alarm signals (alerts) with them, which, once triggered,
    can even determine the dropping of the corresponding network traffic.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 所有这些事件可能会被视为可疑，基于之前对被认为是正常的网络流量进行的分析。这种比较的基础是，可以定义适当的过滤器并将警报信号（警报）与它们关联，一旦触发，甚至可以决定丢弃相应的网络流量。
- en: Obviously, it will also be necessary to take into account novelties in the network
    traffic that are not associated with suspicious behavior. If, for example, a new
    communication channel has been added that did not exist before, this change will
    have to be taken into account, and considered as normal.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，还需要考虑与可疑行为无关的新型网络流量。例如，如果添加了以前没有的新通信通道，这种变化必须被考虑，并视为正常。
- en: Therefore, one of the sensitive aspects of anomaly detection, as we will see,
    is the distinction between true positives and false positives.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，正如我们将看到的，异常检测的一个敏感方面是区分真正的正例和假正例。
- en: Intrusion Detection Systems
  id: totrans-26
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 入侵检测系统
- en: 'Traditionally, intrusion detection activity has been managed through the introduction
    of specialized devices, known as **Intrusion Detection Systems** (**IDS**). These
    devices were usually divided into the following two categories:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 传统上，入侵检测活动通过引入专门的设备来管理，这些设备被称为**入侵检测系统**（**IDS**）。这些设备通常被分为以下两类：
- en: Host-based IDS
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于主机的IDS
- en: Network-based IDS
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于网络的入侵检测系统
- en: 'With the introduction of **Artificial Intelligence** (**AI**) techniques in
    the field of cybersecurity, a third type of IDS has also been added to the aforementioned
    two traditional types: anomaly-driven IDS.'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 随着**人工智能**（**AI**）技术在网络安全领域的引入，第三种类型的IDS——基于异常的IDS——也加入了前述的两种传统类型。
- en: To fully understand the differences and advantages of anomaly-driven IDS, it
    is appropriate to briefly describe the two traditional types of IDS.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 为了充分理解基于异常的入侵检测系统（IDS）的区别和优势，简要描述两种传统类型的IDS是适当的。
- en: Host Intrusion Detection Systems
  id: totrans-32
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 主机入侵检测系统
- en: 'The task of **Host Intrusion Detection Systems** (**HIDS**) is to detect possible
    intrusions affecting host machines within an organization, especially the machines
    that are considered critical. To this end, HIDS monitors some of the system metrics
    that are supposed to be significant for identifying possible attacks, such as
    system information associated with the following system metrics:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: '**主机入侵检测系统**（**HIDS**）的任务是检测可能影响组织内主机的入侵，尤其是那些被认为是关键的机器。为此，HIDS监控一些被认为对识别可能攻击至关重要的系统指标，如与以下系统指标相关的系统信息：'
- en: Number and type of running processes
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 正在运行的进程的数量和类型
- en: Number, type, and creation of user accounts
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户账户的数量、类型和创建情况
- en: Kernel modules loading (device drivers included)
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 内核模块加载（包括设备驱动程序）
- en: File and directory activity
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件和目录活动
- en: Task scheduler activity
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 任务调度器活动
- en: Registry key modification
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 注册表键值修改
- en: Background processes (daemons and services)
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 后台进程（守护进程和服务）
- en: '**Operating system** (**OS**) modules loaded at startup'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**操作系统**（**OS**）在启动时加载的模块'
- en: Host network activity
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主机网络活动
- en: Typically, the identification of the system metrics to be monitored is strictly
    dependent on the adopted threat model, and in order to collect the information
    to be monitored, it is possible to use the tools that come installed with the
    OS of the host machines, or by installing specialized system monitoring tools.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，待监控的系统指标的识别严格依赖于所采用的威胁模型，并且为了收集待监控的信息，可以使用操作系统自带的工具，或通过安装专门的系统监控工具。
- en: Network Intrusion Detection Systems
  id: totrans-44
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络入侵检测系统
- en: The typical task of **Network Intrusion Detection Systems** (**NIDS**) is to
    identify possible attack patterns by analyzing network traffic; that is, by processing
    network packets in transit—both incoming and outgoing—and detecting known attacking
    patterns in the flow of data.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '**网络入侵检测系统**（**NIDS**）的典型任务是通过分析网络流量来识别可能的攻击模式；也就是说，通过处理传输中的网络数据包——包括进站和出站数据——并在数据流中检测已知的攻击模式。'
- en: 'Some of the network attacks typically detected by NIDS are as follows:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: NIDS通常检测到的网络攻击如下：
- en: Adware (resulting in unsolicited and malicious **advertisements** (**AD**) downloads
    from remote hosts)
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 广告软件（导致来自远程主机的未经请求和恶意的**广告**（**AD**）下载）
- en: Spyware (sensitive information transmitted toward remote hosts)
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 间谍软件（向远程主机传输敏感信息）
- en: '**Advanced Persistent Threats** (**APTs**) (APT-targeted attacks that leverage
    specific organization flaws or misconfigured services)'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**高级持续性威胁**（**APT**）（APT针对特定组织漏洞或配置错误服务的攻击）'
- en: Botnets (a typical **Command and Control** (**C2**) attack that leverages organization
    network resources by transforming hosts into zombie machines, executing remote
    instructions)
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 僵尸网络（典型的**指挥与控制**（**C2**）攻击，通过将主机转变为僵尸机器并执行远程指令来利用组织的网络资源）
- en: The implementation of NIDS can leverage network diagnostic tools including sniffers
    (such as `tcpdump` and Wireshark).
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: NIDS的实施可以利用网络诊断工具，包括嗅探器（如`tcpdump`和Wireshark）。
- en: NIDS can also deploy integrated software solutions, such as Snort, which represents
    a valid solution for real-time detection of possible network intrusions.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: NIDS还可以部署集成软件解决方案，如Snort，这代表了实时检测可能的网络入侵的有效解决方案。
- en: This helps to define ad hoc rules on the basis of which to make comparisons
    between normal and malicious network traffic, thus activating triggers that perform
    the appropriate actions once the attack is identified.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 这有助于根据特定规则来定义，在此基础上可以比较正常和恶意的网络流量，从而在攻击被识别后激活触发器，执行适当的操作。
- en: Often, these triggers are associated with a given threshold, which is a predetermined
    value that reliably separates the events among them. Obviously, the problem of
    how to adequately determine this threshold value arises, and whether this value
    can be validly used in relation to different contexts. In the same way, an attacker
    could try to modify this threshold value, or discover what this value actually
    is set to, try to adopt a stealth-access mode (by keeping their activity constantly
    below the threshold), and make themselves invisible to IDS.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，这些触发器与给定的阈值相关联，这是一个预定值，它可靠地区分它们之间的事件。显然，如何充分确定该阈值值的问题就出现了，且该值是否可以有效地用于不同上下文下。以同样的方式，攻击者可能尝试修改此阈值，或发现这个值实际上被设置成什么，尝试采用隐形访问模式（通过保持活动始终低于阈值），使自己对IDS不可见。
- en: It would therefore be preferable to adopt a dynamic threshold (rather than relying
    on a hardcoded value) by systematically recalculating its value over time. These
    improvements can be obtained by resorting to statistical metrics, calculated on
    a time series (moving averages), for example, or through the re-elaboration of
    statistical measurements made on the distribution of the data (for example, adopting
    position measurements such as the median or the **interquartile range** (**IQR**)).
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，更优的做法是采用动态阈值（而不是依赖硬编码的值），通过系统地重新计算其值来随时间变化。这些改进可以通过采用基于时间序列（移动平均）的统计度量来获得，例如，或者通过对数据分布的统计测量重新处理（例如，采用位置测量如中位数或**四分位间距**（**IQR**））。
- en: Although useful, this statistical approach for determining the trigger threshold
    is inevitably ineffective in the most complex cases of intrusion detection, which
    needs to take into account the possible correlations existing between the various
    variables.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管有用，但这种统计方法用于确定触发阈值在最复杂的入侵检测案例中不可避免地无效，因为它需要考虑不同变量之间可能存在的相关性。
- en: In other words, it is likely that in certain scenarios, the trigger thresholds
    to be triggered simultaneously are more than one, since the anomalies are represented
    by different features in relation to each other.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，在某些场景中，可能需要同时触发多个触发阈值，因为异常在相互关系中由不同特征表示。
- en: Given the complexity that characterizes the network data flow, it is therefore
    necessary to introduce the **stateful inspection**—also known as **Packet Filtering**
    activity—as separate from the common network monitoring (aimed at extracting information
    from different types of packets).
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 鉴于网络数据流的复杂性，因此有必要引入**有状态检查**——也称为**数据包过滤**活动——作为与常见网络监控（旨在提取不同类型数据包的信息）分开的过程。
- en: By keeping track of the various packets being transferred and received, the
    stateful inspection is characterized by the ability to correlate different types
    of packets in order to identify connection attempts toward certain network services,
    attempts to saturate network resources (**Denial of Service** (**DoS**)), or attacks
    conducted at the lower network protocol levels (such as ARP cache poisoning).
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 通过跟踪传输和接收的各种数据包，有状态检查的特点在于能够关联不同类型的数据包，以识别针对某些网络服务的连接尝试、网络资源的饱和攻击（**拒绝服务攻击**（**DoS**））或在更低网络协议层次进行的攻击（如ARP缓存中毒）。
- en: Given its advanced network analysis features, stateful inspection can be associated
    with more sophisticated forms of anomaly detection.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 由于其先进的网络分析功能，有状态检查可以与更复杂的异常检测形式结合使用。
- en: Anomaly-driven IDS
  id: totrans-61
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 基于异常的IDS
- en: With the introduction of AI techniques to the field of NIDS, it is now possible
    to evolve traditional IDS toward more advanced detection solutions, exploiting
    supervised and unsupervised learning algorithms, as well as reinforcement learning
    and deep learning.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 随着人工智能技术的引入，NIDS（网络入侵检测系统）领域现在可以将传统的IDS发展为更先进的检测解决方案，利用监督学习和无监督学习算法，以及强化学习和深度学习。
- en: Similarly, the clustering techniques analyzed in the previous chapters, which
    exploit the concepts of similarity between the categories of data, can validly
    be used for the implementation of anomaly-based IDS.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，前几章分析的聚类技术，利用了数据类别之间的相似性概念，可以有效地用于基于异常的入侵检测系统（IDS）的实现。
- en: 'In choosing the algorithms for the anomaly detection network, however, some
    characteristic aspects of the network environment must be taken into consideration:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，在选择用于异常检测网络的算法时，必须考虑网络环境的一些特征性方面：
- en: In the case of solutions based on supervised learning algorithms, we will have
    to categorize (label) all the data since, by definition, in supervised learning
    the classes to which sample data belongs are known in advance.
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在基于监督学习算法的解决方案中，我们必须对所有数据进行分类（标记），因为按定义，监督学习中样本数据所属的类别是已知的。
- en: The categorization of all the data inevitably involves a computational overload
    and a possible slowdown in the network performance, since the network traffic
    must be analyzed before being sent to the destination. In this sense, we could
    decide to resort to unsupervised learning algorithms, not only to let the algorithm
    identify unknown classes, but also to reduce the computational overhead.
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 所有数据的分类不可避免地会涉及计算过载，并可能导致网络性能下降，因为在发送到目标之前，网络流量必须进行分析。从这个角度来看，我们可以决定采用无监督学习算法，不仅让算法识别未知类别，还能减少计算开销。
- en: Similarly, the algorithms that exploit the concept of similarity (such as clustering
    algorithms) are well suited for the implementation of anomaly detection solutions.
    However, it is also necessary in this case to pay particular attention to the
    type of metrics used to define the concept of similarity that distinguishes the
    traffic considered as normal from that being considered as anomalous.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 类似地，利用相似性概念的算法（如聚类算法）非常适合用于实现异常检测解决方案。然而，在这种情况下，同样需要特别注意用于定义相似性概念的度量类型，这些度量能够区分正常流量与异常流量。
- en: 'Commonly, in the implementation of anomaly detection solutions, scoring systems
    are used for the assessment of traffic: identifying thresholds of values ​​that
    separate the different types of traffic from each other (normal versus anomalous).
    For this purpose, when choosing the most appropriate metrics, we must take into
    consideration the ordering and distribution of the data.'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，在实施异常检测解决方案时，会使用评分系统来评估流量：确定分隔不同类型流量（正常与异常）之间的值阈值。为此，在选择最合适的度量时，我们必须考虑数据的排序和分布。
- en: In other words, an anomaly detection system can use—as a scoring metric—the
    distance existing between the values ​​of the dataset (considered as points of
    the *n*-dimensional space representing the different features), or evaluate the
    regularity in the distribution of data, with respect to a distribution considered
    representative of the phenomenon under investigation.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，异常检测系统可以使用——作为评分指标——数据集值之间的距离（这些值被视为代表不同特征的*n*维空间中的点），或评估数据分布的规律性，依据的是被认为是研究现象代表性的分布。
- en: Turning service logs into datasets
  id: totrans-70
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将服务日志转化为数据集
- en: One of the problems related to network anomaly detection is how to collect sufficient
    and reliable data to perform algorithm analysis and training. There are hundreds
    of datasets freely available on the internet, and there are different datasets
    on which to carry out our analysis; however, it is also possible to use our own
    network devices to accumulate data that is more representative of our specific
    reality.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 网络异常检测的一个问题是如何收集足够且可靠的数据来进行算法分析和训练。互联网上有数百个免费提供的数据集，可以用于我们的分析；然而，我们也可以使用自己的网络设备来积累更能代表我们特定现实的数据。
- en: 'To this end, we can use the following:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 为此，我们可以使用以下方法：
- en: Network devices, such as routers or network sensors, using tools such as `tcpdump`
    for data collection
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络设备，如路由器或网络传感器，使用`tcpdump`等工具进行数据采集。
- en: Services logs and system logs
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务日志和系统日志
- en: Within the operating system, services logs and system logs can be stored in
    various places. In the case of a Unix-like system, the services logs are usually
    stored as text files inside the `/var/log` directory and its relative subdirectories.
    In the case of Windows OSes, logs are distinguished between Windows logs (including
    security logs and system logs) and application logs. They are accessible through
    the Windows Event Viewer application, or by accessing file system locations such
    as `%SystemRoot%\System32\Config`.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 在操作系统内部，服务日志和系统日志可以存储在不同的位置。对于类Unix系统，服务日志通常以文本文件的形式存储在`/var/log`目录及其相关子目录中。对于Windows操作系统，日志分为Windows日志（包括安全日志和系统日志）和应用程序日志。它们可以通过Windows事件查看器应用程序访问，或者通过访问文件系统位置如`%SystemRoot%\System32\Config`进行访问。
- en: In both the cases of Unix-like systems and Windows OSes, the log files are of
    a text-based format according to predefined templates, with the difference being
    that, in the case of Windows, an event ID is also associated with each event recorded
    in the corresponding log file. The textual nature of the logs files is well suited
    for the integration of the information stored in the logs.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 无论是类Unix系统还是Windows操作系统，日志文件都是基于预定义模板的文本格式，唯一不同的是，在Windows中，每个事件在相应的日志文件中都会关联一个事件ID。日志文件的文本性质非常适合集成存储在日志中的信息。
- en: Advantages of integrating network data with service logs
  id: totrans-77
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 集成网络数据与服务日志的优势
- en: Both data sources, that is, network data and services logs, entail advantages
    and disadvantages for the purposes of network anomaly detection.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 两个数据源，即网络数据和服务日志，在网络异常检测中各有优缺点。
- en: However, their integration makes it possible to limit the disadvantages in favor
    of the advantages.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，它们的集成使得可以在利用优势的同时，限制其缺点。
- en: It is no coincidence that in recent years, several software solutions (both
    proprietary and open source) have been released to solve the task of integrating
    different data sources, allowing users to utilize methods of analysis from data
    science and big data analytics.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 近年来，发布了多种软件解决方案（包括专有软件和开源软件），这些解决方案旨在解决集成不同数据源的问题，使用户能够利用数据科学和大数据分析的方法进行分析，这并非偶然。
- en: Among the most widespread solutions, we can mention the **ElasticSearch, Logstash,
    Kibana** (**ELK**) suite, which allows the indexing of events extracted from log
    files and can be represented in an intuitive visual form.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 在最广泛的解决方案中，我们可以提到**ElasticSearch, Logstash, Kibana**（**ELK**）套件，它可以对从日志文件中提取的事件进行索引，并以直观的可视化形式表示。
- en: Other widespread proprietary networking solutions are based on Cisco's NetFlow
    protocol, which allows for a compact representation of network traffic.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 其他广泛使用的专有网络解决方案基于Cisco的NetFlow协议，它可以紧凑地表示网络流量。
- en: Reconstructing the events of interest starting from the raw data is anything
    but easy. This moreover lends itself—if carried out in an automated manner—to
    the generation of unreliable signals (false positives) that represent a problem
    in the management of security.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 从原始数据重构感兴趣的事件是非常困难的。更重要的是，如果以自动化的方式进行处理，这可能会导致生成不可靠的信号（误报），这代表了安全管理中的一个问题。
- en: Moreover, in the case of network data, they are representative of the individual
    services to which they refer, while in the case of service logs, they are directly
    related to the processes that generated them.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，在网络数据的情况下，它们代表了各个相关服务，而在服务日志的情况下，它们直接与生成它们的进程相关。
- en: The integration of both data sources (network data and service logs) therefore
    allows for a contextualization of the events being analyzed, consequently increasing
    contextual awareness, and reducing the effort required for interpreting events
    when starting from raw data.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，整合两种数据源（网络数据和服务日志）可以实现对正在分析事件的上下文化，进而提高上下文意识，并减少从原始数据开始解读事件所需的努力。
- en: How to classify network attacks
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何分类网络攻击
- en: We have seen that it is possible to use all different types of algorithms (such
    as supervised, unsupervised, and reinforcement learning), even in the implementation
    of network anomaly detection systems.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经看到，可以使用各种不同类型的算法（如监督学习、无监督学习和强化学习），即使是在实施网络异常检测系统时。
- en: But how can we effectively train these algorithms in order to identify the anomalous
    traffic?
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 那么我们如何有效地训练这些算法，以便识别异常流量呢？
- en: It will be necessary to first identify a training dataset that is representative
    of the traffic considered normal within a given organization.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 首先需要识别一个代表给定组织内正常流量的训练数据集。
- en: To this end, we will have to adequately choose the representative features of
    our model.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 为此，我们必须适当地选择代表我们模型的特征。
- en: The choice of features is of particular importance, as they provide a contextual
    value to the analyzed data, and consequently determine the reliability and accuracy
    of our detection system.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 特征选择尤为重要，因为它们为所分析的数据提供了上下文价值，从而决定了我们检测系统的可靠性和准确性。
- en: In fact, choosing features that are not characterized by high correlation with
    possible anomalous behaviors translates into high error rates (false positives),
    which therefore invalidate their usefulness.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 事实上，选择那些与可能的异常行为相关性不高的特征会导致较高的错误率（误报），因此会使它们失去效用。
- en: A solution to choosing reliable features could be to evaluate existing anomalies
    in the use of network protocols.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 选择可靠特征的一种解决方案是评估现有的网络协议使用中的异常。
- en: Attacks—such as SYN floods—are characterized by the anomalous use of the TCP/IP
    handshake (in which the packet with the SYN flag set is not followed by packets
    with the ACK flag set, in order to establish a valid connection).
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击——例如SYN洪水攻击——的特征是TCP/IP握手的异常使用（在这种情况下，设置SYN标志的数据包后面没有跟随设置ACK标志的数据包，从而无法建立有效连接）。
- en: A feature can be characterized by one or more attributes related to the protocol
    or the header of the network packet, just as different types of network attributes
    constitute a feature represented by the specific network connection being analyzed
    (that is, a telnet session is characterized by a connection to a remote port `23`,
    which is carried out between two endpoints having their respective IP addresses
    and IP ports).
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 一个特征可以通过一个或多个与协议或网络数据包头部相关的属性来描述，就像不同类型的网络属性构成了由正在分析的特定网络连接表示的特征（即，telnet会话的特征是连接到远程端口`23`，该连接发生在两个具有各自IP地址和IP端口的端点之间）。
- en: Most common network attacks
  id: totrans-96
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 最常见的网络攻击
- en: Given the enormous variety of combinations that we can identify by putting together
    different features, it is inevitable that we have to resort to a threat model
    that reflects the level of risk to which a given organization is subjected, and
    on the basis of this model, to identify the most representative feature of combinations
    for possible attacks.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 鉴于我们可以通过组合不同的特征来识别的各种组合的巨大多样性，必须依赖一个反映给定组织所面临风险水平的威胁模型，并在此模型的基础上，识别出最具代表性的特征组合，以便应对可能的攻击。
- en: 'In this sense, it can be useful to analyze which are the most frequent types
    of network attacks:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 从这个角度来看，分析最常见的网络攻击类型是有用的：
- en: Malware-based
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于恶意软件的
- en: Zero-day exploits
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 零日漏洞
- en: Data exfiltration via network sniffing
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过网络嗅探进行数据泄漏
- en: Saturation of network resources (DoS)
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络资源饱和（DoS）
- en: Session hijacking
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 会话劫持
- en: Connection spoofing
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 连接欺骗
- en: Port scanning
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 端口扫描
- en: On the basis of a similar classification (to be adapted to the specific context
    and constantly updated), we can identify which features to consider, feeding our
    algorithms with more representative datasets.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 基于类似的分类（需根据具体上下文进行调整并不断更新），我们可以识别需要考虑的特征，将更具代表性的数据集输入到我们的算法中。
- en: Anomaly detection strategies
  id: totrans-107
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 异常检测策略
- en: We have therefore seen that the very concept of anomaly detection refers to
    a behavior that is different from what was expected; this difference, in technical
    terms, translates into outlier detection.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们已经看到，异常检测的概念本身指的是与预期行为不同的表现；这种差异，从技术角度来说，就是离群点检测。
- en: 'To identify the outliers, it is possible to follow different strategies:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 要识别离群点，可以采取不同的策略：
- en: '**Analyzing a sequence of events within a time series**: The data is collected
    at regular intervals, evaluating the changes that occur in the series over time.
    This is a technique widely used in the analysis of financial markets, but it can
    be also validly used in the cybersecurity context to detect the frequency of characters
    (or commands) entered by the user in a remote session. Even the simple unnatural
    increase in the frequency of data entered per unit of time is indicative of an
    anomaly that can be traced back to the presence of an automated agent (instead
    of a human user) in the remote endpoint.'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分析时间序列中的事件序列**：数据在定时间隔内收集，评估序列随时间发生的变化。这种技术广泛应用于金融市场分析，但也可以有效地应用于网络安全领域，用于检测用户在远程会话中输入字符（或命令）的频率。即使是每单位时间内输入数据频率的简单不自然增加，也可以表明存在异常，这可能表明远程端点中存在自动化代理（而非人工用户）。'
- en: '**Using supervised learning algorithms**: This approach makes sense when normal
    and anomalous behaviors can be reliably distinguished from each other, as in the
    case of credit card fraud, in which it is possible to detect predefined patterns
    of suspicious behavior, relying on the fact that future fraud attempts are attributable
    to a predefined scheme.'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**使用监督学习算法**：当正常行为与异常行为可以可靠地区分时，这种方法是有意义的，例如在信用卡欺诈的情况下，可以检测到预定义的可疑行为模式，依赖于未来的欺诈行为可以归因于一个预定义的方案。'
- en: '**Using unsupervised learning algorithms**: In this case, it is not possible
    to trace the anomalies back to predefined behaviors, as it is not possible to
    identify a reliable and representative training dataset for supervised learning.
    This scenario is the one that most commonly describes the reality of cybersecurity,
    characterized by new forms of attack or exploits of new vulnerabilities (zero-day
    attacks). Similarly, it is often difficult to trace all the theoretically possible
    intrusions back to a single predefined scheme.'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**使用无监督学习算法**：在这种情况下，无法将异常行为追溯到预定义的行为，因为无法识别出可靠且具有代表性的训练数据集用于监督学习。这种场景最常描述网络安全的现实，特征是新的攻击形式或新漏洞的利用（零日攻击）。同样，通常也很难将所有理论上可能的入侵归结为一个预定义的方案。'
- en: Anomaly detection assumptions and challenges
  id: totrans-113
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 异常检测假设与挑战
- en: From a methodological point of view, there is no doubt that outliers represent
    a problem for learning algorithms, as they constitute a disturbing element in
    the identification of a descriptive model, starting from training data.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 从方法论角度来看，毫无疑问，离群点是学习算法的一个问题，因为它们在基于训练数据构建描述性模型时构成了干扰因素。
- en: When dealing with an anomalous value, how should the algorithm behave? Should
    it take into account the determination of the model or should it discard it, considering
    it as an estimation error? Or do the outliers represent novelties in the dataset
    that testify to real changes in the phenomenon being under scrutiny? To answer
    these questions, we need to investigate the most probable origin of the outliers.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 当处理异常值时，算法应如何处理？是应该考虑模型的判定，还是应该将其丢弃，视为估计误差？或者，离群点是否代表数据集中反映出实际变化的创新现象？要回答这些问题，我们需要调查离群点的最可能来源。
- en: In some cases, the outliers are a combination of uncommon values, they are estimate
    errors, or they originate from the joining of multiple datasets with different
    semantics that produce unreliable or highly unlikely samples. Their presence,
    however, represents a disturbing element, especially for the algorithms that are
    based on metrics consisting of estimating the distances between expected values
    ​​and observed values. In technical terms, this implies an increase in overall
    variance that can cause the algorithm to overestimate the error to the detriment
    of the signal (a well-known phenomenon that goes by the name of **overfitting**).
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些情况下，异常值是不同寻常值的组合，它们是估计误差，或者源自多个具有不同语义的数据集的合并，导致不可靠或极不可能的样本。然而，它们的存在却构成了一个干扰因素，特别是对于那些基于估计预期值与观察值之间距离的度量的算法而言。从技术角度讲，这意味着整体方差增加，可能导致算法高估误差，从而影响信号的正确性（这一现象被称为**过拟合**）。
- en: Obviously, not all algorithms are equally sensitive to the presence of outliers.
    However, it is good practice to try to make the learning process robust, smoothing
    the parameter-updating phase, weighting those anomalous values that, even if lower
    in numerical terms with respect to normal values, might otherwise affect the correct
    parameters estimation.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，并不是所有算法对异常值的存在都同样敏感。然而，良好的做法是尽量使学习过程更具鲁棒性，通过平滑参数更新阶段，给那些尽管在数值上低于正常值但可能会影响正确参数估计的异常值加权。
- en: To identify the possible presence of outliers within the dataset, it is good
    practice to conduct a preliminary analysis of the data, known as **exploratory
    data analysis** (**EDA**), using visual tools and calculating simple descriptive
    statistical measurements (such as the average or the median).
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 为了识别数据集中可能存在的异常值，通常做法是进行数据的初步分析，这被称为**探索性数据分析**（**EDA**），利用可视化工具并计算简单的描述性统计量（如均值或中位数）。
- en: In this way, it is possible to intuitively spot the presence of anomalous values,
    in addition to verifying any asymmetries in the data, evidenced by the increasing
    distance between the values ​​of the average and the median in the distribution.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 通过这种方式，可以直观地发现异常值的存在，并验证数据中的任何不对称性，表现为分布中均值与中位数之间的距离逐渐增大。
- en: Some statistical measurements are less sensitive to the presence of extreme
    values. The measures aimed at representing the ordering of the data are, in fact,
    more robust with respect to the presence of anomalous values ​​in the distribution
    (such as the IQRs).
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 一些统计度量对极端值的存在不那么敏感。事实上，旨在表示数据排序的度量对于分布中的异常值具有更强的鲁棒性（例如四分位间距IQR）。
- en: Therefore, one of the fundamental assumptions in outlier detection is that there
    are many more normal observations within a dataset with respect to anomalous observations.
    However, the fact remains that, often, the correct identification of the outliers
    is not an easy task to accomplish.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，异常值检测的一个基本假设是数据集中正常观测值远多于异常观测值。然而，事实是，通常正确识别异常值并不是一项容易完成的任务。
- en: 'In this sense, if we decide to use statistical measures to determine the presence
    of the outliers, we can proceed with the following steps:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 从这个角度来看，如果我们决定使用统计度量来确定异常值的存在，我们可以按照以下步骤进行操作：
- en: Calculate statistical values ​​representative of the data to be used as comparison
    terms to determine the anomalous values ​​(that is, the values ​​that deviate
    from the representative ones the most)
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算代表数据的统计值，用作对比标准，以确定异常值（即，最偏离代表性值的那些值）。
- en: Identify a reference model for anomaly detection, which can be based on distance
    measurements, or assume a known **statistical distribution** (that is, a normal
    distribution) as representative of normal values
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定一个异常检测的参考模型，这个模型可以基于距离度量，或者假定已知的**统计分布**（即正态分布）作为正常值的代表。
- en: Define a confidence interval and evaluate the probability (likelihood) of outlier's
    presence, given a chosen distribution
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义置信区间并评估异常值存在的概率（可能性），基于所选择的分布。
- en: 'The statistical approach to the identification of outliers, while being easy
    and immediate to apply, nevertheless presents important methodological limits:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 统计方法用于识别异常值，虽然容易且直接应用，但仍然存在重要的理论限制：
- en: Most of the statistical tests take into account only single features
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 大多数统计检验只考虑单一特征。
- en: Often, the underlying distribution of the data is unknown, or not attributable
    to a known statistical distribution
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通常，数据的底层分布是未知的，或者不能归因于已知的统计分布。
- en: In the presence of complex and multi dimensional cases (in which several features
    must be taken into account simultaneously), the presence of outliers determines
    an increase in the total variance, making the identified representative models
    less significant in predictive terms
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在复杂且多维的案例中（其中必须同时考虑多个特征），离群值的存在会导致总方差的增加，使得所识别的代表性模型在预测上变得不那么显著。
- en: Detecting botnet topology
  id: totrans-130
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检测僵尸网络拓扑
- en: One of the most common pitfalls in network anomaly detection has to do with
    the detection of botnets within the corporate network. Given the danger of such
    hidden networks, the detection of botnets is particularly relevant, not only for
    preventing the exhaustion of the organization's computational and network resources
    by external attackers, but also for preventing the dissemination of sensitive
    information (data leakage) outward.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 网络异常检测中最常见的陷阱之一与在企业网络内检测僵尸网络有关。由于这些隐藏网络的危险，检测僵尸网络尤其重要，不仅是为了防止外部攻击者耗尽组织的计算和网络资源，还为了防止敏感信息的泄露（数据泄漏）。
- en: However, identifying the presence of a botnet in time is often an operation
    that is anything but simple. This is why it is important to understand the very
    nature of botnets.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，及时识别僵尸网络的存在往往是一个复杂的操作。这就是为什么理解僵尸网络的本质非常重要。
- en: What is a botnet?
  id: totrans-133
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 什么是僵尸网络？
- en: The term **botnet** comes from the juxtaposition of the words **bot** and **net**.
    In the case of the term **net**, we evidently have to deal with the concept of
    networking; in the case of the term **bot**, we have to spend a few more words.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: '**僵尸网络**这一术语来源于**bot**和**net**两个词的组合。对于“net”一词，我们显然需要处理网络的概念；而对于“bot”一词，我们则需要再多说几句。'
- en: The term bot is, in fact, increasingly associated with the spread of automated
    agents within cyberspace.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: “Bot”一词实际上越来越与自动化代理在网络空间中的传播相关联。
- en: Starting from **chatbots** (software agents that are commonly present in websites
    for the management of the preliminary phases of customer care, but are also increasingly
    widespread, even on the social networks for the most disparate purposes) all the
    way to trolls (software agents aimed at distracting users or confusing them with
    the dissemination of false information), cyberspace is increasingly becoming infested
    with the presence of such software agents that automate the activities and interactions
    between humans and digital devices.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 从**聊天机器人**（通常在网站上用于管理客户服务初期阶段的软件代理，但也越来越广泛，甚至在社交网络上为各种目的使用）到网络喷子（旨在通过传播虚假信息分散用户注意力或困惑用户的软件代理），网络空间正日益被这些自动化的、在人与数字设备之间进行交互的软件代理所感染。
- en: In the case of botnets, the attacker's intent is to transform the victim host
    (by installing malware) into an automated agent that fulfills the orders received
    by the attacker, through a C2 console that is usually managed by a centralized
    server.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 在僵尸网络的情况下，攻击者的意图是通过安装恶意软件将受害主机转变为自动化代理，通过通常由集中式服务器管理的C2控制台接收并执行攻击者的命令。
- en: 'The victim machine thus becomes part of a vast network of compromised machines
    (the botnet), contributing toward a common goal with its own computational and
    network resources:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 受害机器因此成为一个庞大的受感染机器网络（僵尸网络）的一部分，通过其计算和网络资源贡献共同目标：
- en: Taking part in email spamming campaigns
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 参与电子邮件垃圾邮件活动
- en: Performing **Distributed Denial of Services** (**DDoS**) toward institutional
    or private third-party sites
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对机构或私人第三方网站执行**分布式拒绝服务**（**DDoS**）攻击
- en: Bitcoin and cryptocurrency mining
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 比特币和加密货币挖矿
- en: Password cracking
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 密码破解
- en: Credit card cracking
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 信用卡破解
- en: Data leakages and data breaches
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据泄漏和数据泄露
- en: For an organization, dealing with a botnet (even unconsciously) represents a
    serious risk in terms of legal responsibility toward third parties; it is not
    just a waste of company resources.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 对于一个组织来说，处理一个僵尸网络（即使是不自觉地）代表着在法律责任方面对第三方的重大风险；这不仅仅是公司资源的浪费。
- en: This is why it is important to monitor the company network by trying to promptly
    identify the presence of hosts that might be part of a botnet.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，重要的是监控公司网络，尽早识别可能属于僵尸网络的主机。
- en: The botnet kill chain
  id: totrans-147
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 僵尸网络杀伤链
- en: In order to promptly identify the possible presence of a botnet, it may be useful
    to consider its kill chain (the different phases that characterize its realization).
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 为了及时识别僵尸网络的可能存在，考虑其攻击链（实现过程中的不同阶段）可能是有益的。
- en: 'We can, therefore, distinguish the following phases:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们可以区分以下阶段：
- en: Malicious software installation
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 恶意软件安装
- en: Joining the botnet via C2
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过C2加入僵尸网络
- en: Spreading the botnet to other hosts
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将僵尸网络传播到其他主机
- en: Among the events to constantly monitor for the possible presence of a botnet,
    the connections made at regular intervals to remote hosts should be included.
    Rather than monitoring the quality of the traffic itself (very often, in fact,
    botnets make use of apparently harmless communication protocols, such as HTTP
    traffic, using the service's default port `80`, in order to mask its presence
    within the logs files), the real nature of network connections should be investigated.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 在需要持续监控的可能存在僵尸网络的事件中，应包括定期连接到远程主机的行为。与其监控流量本身的质量（事实上，僵尸网络经常使用看似无害的通信协议，如HTTP流量，使用服务的默认端口`80`，以掩盖其在日志文件中的存在），不如调查网络连接的实际性质。
- en: In the case of a botnet, the victim host must constantly call home to receive
    new orders and send the information gathered to the C2 server, along with the
    results obtained from the processes that were performed on the victim system.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在僵尸网络的情况下，受害主机必须不断呼叫主控服务器（C2），以接收新命令并将收集到的信息以及在受害系统上执行的进程结果发送给C2服务器。
- en: This phenomenon is known as **beaconing** and is characterized precisely by
    the presence within the network of connections made on a regular basis (even during
    closing hours) between infected hosts and remote destinations (which can also
    be legitimate websites compromised by the attacker).
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 这种现象被称为**信标现象**，其特征正是网络中存在定期（即使在非工作时间）进行连接的行为，这些连接发生在感染的主机与远程目标之间（这些远程目标也可能是被攻击者妥协的合法网站）。
- en: 'The phenomenon of beaconing is usually characterized by the presence of the
    following characteristics:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 信标现象通常以以下特点为特征：
- en: Long-term user sessions, with the exchange of empty packages (keepalive packets)
    necessary to keep the connection open
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 长期的用户会话，交换空包（保持连接的空包），以保持连接的打开
- en: Data exchange between hosts on a regular basis
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主机之间定期的数据交换
- en: The problem with beaconing is that it cannot always be identified reliably;
    thus, they constitute a symptom of the presence of a botnet, as other legitimate
    services also show characteristics similar to those mentioned previously. To capture
    the reliable signals that attest the presence of a real beaconing process—telling
    it apart from a benign SSH or telnet session, as well as from the systematic download
    of updates carried out by an antivirus software—therefore requires in-depth network
    traffic monitoring, along with statistical analysis of a time series and calculating
    position measures such as the median and IQR, in order to spot communications
    that are taking place on a regular basis.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 信标现象的问题在于它不能总是可靠地识别；因此，它构成了僵尸网络存在的一个症状，因为其他合法服务也可能表现出类似之前提到的特征。为了捕获能够证明真实信标过程存在的可靠信号——并将其与良性的SSH或telnet会话区分开来，以及与抗病毒软件执行的系统更新下载过程区分开来——因此需要深入的网络流量监控，并结合时间序列的统计分析和位置度量的计算，如中位数和IQR，以便识别那些定期发生的通信。
- en: Subsequently, it is necessary to graphically visualize the mapping of the local
    and remote hosts that present these connections, in order to identify a possible
    network topology with stable characteristics that can reasonably raise suspects
    of the presence of a botnet.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 随后，必须通过图形化的方式展示这些本地和远程主机的映射，以便识别可能具有稳定特征的网络拓扑，并合理地引发对僵尸网络存在的怀疑。
- en: From this description of the necessary preliminary analysis activities, it is
    easy to deduce how high the risk is of ending up trapped in a network of false
    positives, rather than in a real botnet, especially if the number of potential
    appliances that are constantly connected to the network increases exponentially
    (a scenario that is progressively becoming more realistic than ever before, due
    to the spread of the IoT).
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 从对必要的初步分析活动的描述中，很容易推断出在被误判为僵尸网络而非真实僵尸网络的网络中，存在被误报的风险，特别是在潜在的设备数量（它们持续连接到网络）呈指数增长时（这一情景比以往任何时候都更为现实，因为物联网的普及）。
- en: Different ML algorithms for botnet detection
  id: totrans-162
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用于僵尸网络检测的不同机器学习算法
- en: From what we have described so far, it is clear that it is not advisable to
    exclusively rely on automated tools for network anomaly detection, but it may
    be more productive to adopt AI algorithms that are able to dynamically learn how
    to recognize the presence of any anomalies within the network traffic, thus allowing
    the analyst to perform an in-depth analysis of only really suspicious cases. Now,
    we will demonstrate the use of different ML algorithms for network anomaly detection,
    which can also be used to identify a botnet.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 从我们迄今为止描述的内容来看，显然不建议仅依赖自动化工具进行网络异常检测，采用能够动态学习如何识别网络流量中异常存在的人工智能算法可能更为高效，这样可以使分析师对仅真正可疑的案例进行深入分析。接下来，我们将展示不同的机器学习算法在网络异常检测中的应用，这些算法也可用于识别僵尸网络。
- en: The selected features in our example consist of the values of network latency
    and network throughput. In our threat model, anomalous values ​​associated with
    these features can be considered as representative of the presence of a botnet.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 我们示例中选择的特征包括网络延迟和网络吞吐量的值。在我们的威胁模型中，与这些特征相关的异常值可以视为僵尸网络存在的代表。
- en: 'For each example, the accuracy of the algorithm is calculated, in order to
    be able to make comparisons between the results obtained:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 对于每个示例，都会计算算法的准确度，以便能够对比所获得的结果：
- en: '[PRE0]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Gaussian anomaly detection
  id: totrans-167
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 高斯异常检测
- en: One of the most widespread approaches for detecting regularity within data distribution
    makes use of the Gaussian distribution of probabilities.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 检测数据分布规律性最广泛使用的一种方法是利用高斯概率分布。
- en: As we shall see, this statistical distribution presents a series of interesting
    characteristics that help to adequately model many natural, social, and economic
    phenomena.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们所看到的，这种统计分布具有一系列有趣的特性，帮助我们适当建模许多自然、社会和经济现象。
- en: Obviously, not all the phenomena under investigation can be represented by the
    Gaussian distribution (very often, as we have seen, the underlying distribution
    of the analyzed phenomena is unknown); however, it constitutes a reliable reference
    point in many cases of anomaly detection.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，并非所有待研究的现象都可以用高斯分布表示（正如我们所看到的，分析现象的基础分布往往是未知的）；然而，在许多异常检测的案例中，它仍然是一个可靠的参考点。
- en: Therefore, we must see the characteristics of the Gaussian distribution in order
    to understand why it is frequently used.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们必须了解高斯分布的特性，才能理解为什么它被广泛使用。
- en: The Gaussian distribution
  id: totrans-172
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 高斯分布
- en: 'In mathematical terms, the Gaussian distribution (also known as the **normal
    distribution**) represents a probability distribution of random variables, which
    takes the following mathematical form:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 从数学角度来看，高斯分布（也称为**正态分布**）表示随机变量的概率分布，其数学形式如下：
- en: '![](img/855e4324-2b8a-43bb-a832-38021286110a.png)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
  zh: '![](img/855e4324-2b8a-43bb-a832-38021286110a.png)'
- en: Here, *µ* represents the average, and *σ²* is the variance (which is representative
    of the variability of the data around the average value). In its standard form,
    the mean, *µ*, assumes the value of *0*, and *σ*^(*2*) assumes the value of *1*.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，*µ*表示均值，*σ²*表示方差（它代表数据围绕均值的变化性）。在其标准形式中，均值*µ*为*0*，*σ*^(*2*)为*1*。
- en: The strength of the Gaussian distribution is the central limit theorem, which,
    in general terms, establishes that the average of the observational data of a
    random variable—extracted independently—converges to the normal value as the number
    of observations increases.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 高斯分布的优势在于中心极限定理，简单来说，它确立了随机变量的观察数据的平均值——独立提取的——随着观察次数的增加会收敛到正态值。
- en: 'In other words, the observations, as their number increases, are distributed
    symmetrically (and with greater probability) around the mean, *µ*:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，随着观察次数的增加，这些观察值会围绕均值*µ*对称分布（且具有更高的概率）：
- en: '![](img/d85c75c0-4d94-4314-bcb5-52500391417b.png)'
  id: totrans-178
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d85c75c0-4d94-4314-bcb5-52500391417b.png)'
- en: While they deviate from the average value (tending to be distributed in the
    left and right extremities) for increasing values of *σ*, the normal distribution
    is therefore adequately represented by the values assumed by *µ* and *σ*.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 当偏离平均值（趋向于分布在左右极端）时，随着*σ*值的增加，正态分布因此由*µ*和*σ*所假定的值充分表示。
- en: 'Similarly, it is possible to determine the probability with which the observations
    are distributed around the average value, in proportion to the value of the variance;
    in other words, we can determine the following:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，可以确定观察值围绕平均值分布的概率，这与方差的值成比例；换句话说，我们可以确定以下内容：
- en: 68% of observations fall within the range between *µ - σ* and *µ + σ*
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 68%的观察值落在*µ - σ*和*µ + σ*之间
- en: 95% of observations fall within the range between *µ - 2σ* and *µ + 2σ*
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 95%的观察值落在*µ - 2σ*和*µ + 2σ*之间
- en: 99.7% of observations fall within the range between *µ - 3σ* and *µ + 3σ*
  id: totrans-183
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 99.7%的观察值落在*µ - 3σ*和*µ + 3σ*之间
- en: Anomaly detection using the Gaussian distribution
  id: totrans-184
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用高斯分布进行异常检测
- en: The Gaussian distribution can be used to identify the outliers. Also, in this
    case, the anomaly element consists of the significant difference assumed by the
    outliers with respect to the rest of the data.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 高斯分布可以用来识别异常值。此外，在这种情况下，异常元素由与其余数据相比，异常值的显著差异所组成。
- en: Obviously, the more the majority of the data is firmly concentrated around the
    mean value, *µ*, with a low variance, *σ*, the more significant the anomalous
    value assumed by the outlier is.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，数据的大多数值越是紧密集中在均值*µ*周围，且方差*σ*较低，越能使异常值的差异变得更加显著。
- en: 'To use the Gaussian distribution in anomaly detection, we will have to perform
    the following steps:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 为了在异常检测中使用高斯分布，我们需要执行以下步骤：
- en: Assume that the features of the training set are normally distributed (this
    can also be verified intuitively from the visual analysis of plotted data)
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 假设训练集的特征服从正态分布（这一点也可以通过对绘制数据的直观分析来验证）
- en: Estimate the *µ* and *σ* values, representative of the distribution
  id: totrans-189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 估算*µ*和*σ*值，代表该分布
- en: Choose an adequate threshold, representative of the probability that the observations
    are anomalous
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择一个合适的阈值，代表观察值为异常的概率
- en: Assess the reliability of the algorithm
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 评估算法的可靠性
- en: In the following example, we will show an implementation of Gaussian anomaly
    detection.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下示例中，我们将展示高斯异常检测的实现。
- en: Gaussian anomaly detection example
  id: totrans-193
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 高斯异常检测示例
- en: 'First of all, let''s import the necessary Python libraries, and then load the
    data from a `.csv` file that represents the latency and network throughput values
    of each data stream we detected:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们导入必要的Python库，然后从`.csv`文件加载数据，该文件表示我们检测到的每个数据流的延迟和网络吞吐量值：
- en: '[PRE1]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Once the data is loaded into memory, we verify whether the distribution of
    the samples might resemble a Gaussian distribution, displaying the corresponding
    values in the form of a histogram:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 数据加载到内存后，我们验证样本的分布是否可能类似于高斯分布，并以直方图的形式显示相应的值：
- en: '[PRE2]'
  id: totrans-197
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The preceding code generates the following output:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的代码生成以下输出：
- en: '![](img/2f7eb18f-881b-4aa1-bf9b-feff330cf362.png)'
  id: totrans-199
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2f7eb18f-881b-4aa1-bf9b-feff330cf362.png)'
- en: 'At this point, we perform the data plotting on a scatter diagram, visually
    identifying the possible outliers:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一点上，我们在散点图上进行数据绘制，直观地识别出可能的异常值：
- en: '[PRE3]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The preceding code generates the following output:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的代码生成以下输出：
- en: '![](img/ef93f94d-3568-4861-863e-e9203e14e9d7.png)'
  id: totrans-203
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ef93f94d-3568-4861-863e-e9203e14e9d7.png)'
- en: 'As can also be seen visually, most of the observations are concentrated around
    the average values, except for some cases. We therefore want to verify whether
    the anomalous cases are real, and then we proceed to estimate the representative
    values, *µ* and *σ*, of the underlying Gaussian distribution:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 从视觉上看，绝大多数观察值集中在平均值周围，只有一些例外。因此，我们希望验证异常情况是否属实，然后继续估算潜在高斯分布的代表性值*µ*和*σ*：
- en: '[PRE4]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'We then proceed to estimate the probabilities and threshold value, which we
    can then compare to identify the anomalous data:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们估算概率和阈值，然后进行比较，以识别异常数据：
- en: '[PRE5]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'At this point, we are able to identify the outliers by comparing the individual
    probabilities of the samples with the previously estimated optimal threshold value,
    visualizing their presence in a scatter diagram:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一点上，我们可以通过将各个样本的概率与先前估算的最优阈值进行比较，从而识别异常值，并在散点图中可视化它们的存在：
- en: '[PRE6]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The preceding code generates the following output:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的代码生成以下输出：
- en: '![](img/4635736b-5bd7-4c39-9ed5-a24a49643e7f.png)'
  id: totrans-211
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4635736b-5bd7-4c39-9ed5-a24a49643e7f.png)'
- en: The time has come to make some assessments on the estimates made by the algorithm.
    But first, we will have to introduce some concepts related to the identification
    of false alarms in anomaly detection.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 现在是对算法进行估计的时候了。但首先，我们需要介绍一些与异常检测中误报识别相关的概念。
- en: False alarm management in anomaly detection
  id: totrans-213
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 异常检测中的误报管理
- en: We have previously seen how anomaly detection gives rise to rather consistent
    estimation errors. In particular, in the case of IDS based on signatures, the
    risk of error is represented by the high number of false negatives, that is, attacks
    that are not detected.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 我们之前已经看到异常检测会导致相当一致的估计误差。特别是在基于签名的IDS案例中，错误的风险由较高数量的假阴性表示，即未检测到的攻击。
- en: It is the same type of risk that we incur when using antivirus software. When
    a correspondence with the suspicious signature is not found, the IDS does not
    detect any anomalies.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 当使用反病毒软件时，我们面临相同类型的风险。如果没有与可疑签名的对应，IDS将不会检测到任何异常。
- en: On the other hand, in the case of anomaly-driven IDS, which is programmed to
    detect anomalies automatically, we face the risk of having a high number of false
    positives; that is, anomalies that are detected despite not being harmful.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，在基于异常驱动的IDS案例中，该系统被编程为自动检测异常，我们面临着高假阳性数量的风险；即检测到的异常实际上并非有害。
- en: To adequately manage these false alarms, we need to introduce some metrics that
    will help us to estimate these errors.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 要适当地管理这些误报，我们需要引入一些度量标准，这些度量标准将帮助我们估计这些错误。
- en: 'The first one is `True Positive Rate` (also known as `Sensitivity` or the recall
    rate):'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个是**真正率**（也称为**灵敏度**或召回率）：
- en: '[PRE7]'
  id: totrans-219
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Then, we have `False Positive Rate`:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们有**假正率**：
- en: '[PRE8]'
  id: totrans-221
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'On the basis of these metrics, it is possible to estimate the `F1` value, which
    represents the harmonic average between `Precision` and `Sensitivity`:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 基于这些指标，可以估计`F1`值，它表示`Precision`和`Sensitivity`之间的调和平均值：
- en: '[PRE9]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '`F1` can be used to evaluate the results obtained from Gaussian anomaly detection.
    The best estimates are obtained with `F1` values close to `1`, while the worst
    estimates correspond to `F1` values that are close to `0`.'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: '`F1`可用于评估从高斯异常检测中获得的结果。最佳估计结果通常对应于接近`1`的`F1`值，而最差的估计结果则对应于接近`0`的`F1`值。'
- en: 'In our example of Gaussian anomaly detection, the value of `F1` is as follows:'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的高斯异常检测示例中，`F1`值如下：
- en: '[PRE10]'
  id: totrans-226
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: This `F1` value is rather close to `1`, which does not surprise us, since in
    choosing the best threshold, our Gaussian anomaly detection model selects the
    value that corresponds to the highest `F1` score.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 这个`F1`值接近`1`，这并不令我们惊讶，因为在选择最佳阈值时，我们的高斯异常检测模型选择对应于最高`F1`分数的值。
- en: Receiver operating characteristic analysis
  id: totrans-228
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 接收器工作特性分析
- en: 'Often, between false positives and false negatives, there is a trade-off. Reducing
    the number of false negatives or the number of attacks not detected leads to an
    increase in false positive attacks being detected. To show the existence of this
    trade-off, a particular curve, known as the **receiver operating characteristic**
    (**ROC**) curve, is used. In our example, the ROC curve is calculated by using
    `roc_curve()` of `scikit-learn`, to which the target values and the corresponding
    probabilities are passed as parameters:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 在假阳性和假阴性之间经常需要进行权衡。减少未检测到的攻击数或未检测到的攻击数会导致检测到的假阳性攻击增加。为了展示这种权衡的存在，使用一种特定的曲线，称为**接收器工作特性**（**ROC**）曲线。在我们的例子中，通过`scikit-learn`的`roc_curve()`计算ROC曲线，将目标值和相应的概率作为参数传递：
- en: '[PRE11]'
  id: totrans-230
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: It is possible to note the link between **True Positive Rate** (`TPR` or sensitivity),
    **False Positive Rate** (`FPR`), and the ROC curve (the `OPC` value instead represents
    a control coefficient, known as the **Operating Characteristic**, such as the
    total number of connections).
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以注意到**真正率**（`TPR`或灵敏度）、**假正率**（`FPR`）与ROC曲线之间的关联（`OPC`值代表控制系数，称为**工作特性**，例如总连接数）。
- en: 'We can therefore represent sensitivity by plotting the `TPR` value with respect
    to the value of the `OPC` control coefficient:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们可以通过绘制`TPR`值与`OPC`控制系数的值来表示灵敏度：
- en: '[PRE12]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The preceding code generates the following output:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 前述代码生成以下输出：
- en: '![](img/05f306df-6364-47da-88b2-7db76d048996.png)'
  id: totrans-235
  prefs: []
  type: TYPE_IMG
  zh: '![](img/05f306df-6364-47da-88b2-7db76d048996.png)'
- en: We can also see how sensitivity (`TPR`) decreases as the value of `OPC` increases.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以看到灵敏度（`TPR`）随着`OPC`值的增加而降低。
- en: 'In the same way, we can draw the ROC curve by comparing the sensitivity (`TPR`)
    with the `FPR` value:'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，我们可以通过将敏感度（`TPR`）与`FPR`值进行比较来绘制ROC曲线：
- en: '[PRE13]'
  id: totrans-238
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The preceding code generates the following output:'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成了以下输出：
- en: '![](img/d14a609c-a646-46ad-9b5a-fd4768b067d7.png)'
  id: totrans-240
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d14a609c-a646-46ad-9b5a-fd4768b067d7.png)'
- en: Summary
  id: totrans-241
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In an increasingly interconnected world, and with the progressive spread of
    the IoT, it becomes essential to effectively analyze network traffic in search
    of anomalies that can represent reliable indications of possible compromises (such
    as the presence of botnets).
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个日益互联的世界中，随着物联网（IoT）的逐步普及，有效分析网络流量以寻找可能代表安全漏洞的异常变得至关重要（例如，僵尸网络的存在）。
- en: On the other hand, the exclusive use of automated systems in performing network
    anomaly detection tasks exposes us to the risk of having to manage an increasing
    number of misleading signals (false positives).
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，单纯依赖自动化系统进行网络异常检测任务会使我们面临管理越来越多误导性信号（假阳性）的风险。
- en: It is, therefore, more appropriate to integrate the automated anomaly detection
    activities with analysis carried out by human operators, exploiting AI algorithms
    as filters, in order to only select the anomalies that are really worthy of in-depth
    attention from the analysts.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，将自动化异常检测活动与人工操作员进行的分析相结合，利用AI算法作为过滤器，选择那些真正值得分析人员深入关注的异常，显得更加合适。
- en: In the next chapter we will deal with AI solutions for securing user authentication.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章，我们将讨论用于保护用户认证的AI解决方案。
