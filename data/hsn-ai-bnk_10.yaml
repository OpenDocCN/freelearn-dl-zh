- en: Building Personal Wealth Advisers with Bank APIs
  id: totrans-0
  prefs: []
  type: TYPE_NORMAL
  zh: 使用银行 API 构建个人财富顾问
- en: In the previous chapter, we analyzed the behavior of a sell-side of the exchange.
    We also learned about sentiment analysis and gained in-depth knowledge of the
    subject by learning how to analyze market needs using sentiment analysis. We then
    learned a bit about Neo4j, which is a NoSQL database technique. We then used Neo4j
    to build and store a network of entities involved in security trading.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们分析了交易所卖方的行为。我们还学习了情绪分析，并通过学习如何使用情绪分析来分析市场需求，深入了解了这一主题。接着，我们学习了Neo4j，这是一个NoSQL数据库技术。然后，我们使用Neo4j构建并存储了一个涉及证券交易的实体网络。
- en: In this chapter, we will focus on consumer banking and understand the needs
    of managing customer's digital data. Then, we will learn how to access the Open
    Bank Project, an open source platform for open banking. After that, we'll look
    at an example of wrapping AI models around bank APIs. Finally, we will learn about
    document layout analysis.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将重点关注消费者银行业务，理解如何管理客户的数字数据需求。接着，我们将学习如何访问开放银行项目，这是一个开源平台，旨在促进开放银行业务。之后，我们将查看如何将人工智能模型与银行
    API 结合使用的示例。最后，我们将学习文档布局分析。
- en: 'We will cover the following topics in this chapter:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: Managing customer's digital data
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 管理客户的数字数据
- en: The Open Bank Project
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 开放银行项目
- en: Performing document layout analysis
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行文档布局分析
- en: Cash flow projection using the Open Bank API
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用开放银行 API 进行现金流预测
- en: Using invoice entity recognition to track daily expenses
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用发票实体识别追踪日常开支
- en: Let's get started!
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们开始吧！
- en: Managing customer's digital data
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 管理客户的数字数据
- en: In this era of digitization, there is no reason that money cannot be 100% transparent
    or that money transfers can't happen in real time, 24/7\. Consumers have the right
    to their data as it represents their identity. Whether it is possible to or not,
    we should be consolidating our own data – realistically, this should be happening
    today and in the coming few years. It is best to consolidate our banking data
    in one place; for example, our frequent flyer mileage. The key point is that there
    shall be two tiers of data architecture – one for consolidation (including storage)
    and another for running the artificial intelligence services that will be used
    to analyze the data through the use of a smart device, also known as **mobile
    applications**. It can be painful to design an AI algorithm without understanding
    what is going on at the data consolidation layer.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个数字化时代，没理由认为资金不能做到100%透明，也没有理由认为资金转账不能在实时、全天候（24/7）进行。消费者有权拥有自己的数据，因为数据代表了他们的身份。无论是否可能，我们都应该开始整合自己的数据——实际上，这应该在今天以及未来几年内实现。最好将我们的银行数据整合到一个地方；例如，我们的常客飞行里程。关键是要有两层数据架构——一层用于数据整合（包括存储），另一层用于运行将通过智能设备进行数据分析的人工智能服务，也就是所谓的**移动应用程序**。如果不了解数据整合层的运作，设计一个AI算法是很痛苦的。
- en: Here, our data source could be identity data, bio/psychometric data, financial
    data, events that could impact any of this static data, and social data, which
    represents our relationship with others (including humans, objects, living organisms,
    and so on). This is, in fact, very similar to a **business-to-business** (**B2B**)
    setting, where any corporation could be represented by its legal identity, shareholders/ownership
    structures, financial health, events, as well as its commercial relationship,
    as outlined in [Chapter 7](d29ff3a8-3879-4d50-8795-a39bae5cc793.xhtml), *Sensing
    Market Sentiment for Algorithmic Marketing at Sell-Side*. This also means that
    what we are learning in this chapter can help with your understanding of the previous
    chapters in this book.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们的数据来源可以是身份数据、生物/心理数据、财务数据、可能影响这些静态数据的事件以及社交数据，后者代表我们与他人的关系（包括人类、物体、生命体等）。事实上，这与**企业对企业**（**B2B**）环境非常相似，其中任何公司都可以通过其法律身份、股东/所有权结构、财务状况、事件以及商业关系来表示，正如在[第7章](d29ff3a8-3879-4d50-8795-a39bae5cc793.xhtml)《在卖方市场中感知市场情绪进行算法营销》中所概述的那样，*利用情绪分析来理解市场需求*。这也意味着我们在本章学到的内容可以帮助你更好地理解本书前几章的内容。
- en: However, for all individuals, including your, our financial needs are quite
    basic—they include payment, credit, and wealth. These spell out the core activities
    of financial services. Insurance is included as part of wealth as it aims to protect
    our wealth against undesirable events and risks—it's like the derivatives that
    hedge risked on procurement costs in [Chapter 2](9ee6480e-c259-4e5d-bc11-31057de1a173.xhtml),
    *Time Series Analysis*.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，对于所有个人，包括你和我们，我们的财务需求是相当基础的——它们包括支付、信用和财富。这些勾画了金融服务的核心活动。保险作为财富的一部分被纳入其中，因为它旨在保护我们的财富免受不良事件和风险的影响——这就像是[第二章](9ee6480e-c259-4e5d-bc11-31057de1a173.xhtml)中关于采购成本风险对冲的衍生品，*时间序列分析*。
- en: However, I am also of the opinion that the data that's derived from consumers
    is also owned by the bank processing the transaction. It's like parenthood—all
    decisions regarding data (the parent's children) are agreed upon between the data
    owner (the consumer) and the data producer (the bank). What is lacking today is
    the technology to quickly attribute the data and economic benefits of the use
    of this data to certain economic activities, such as marketing. If one organization
    (for example, a supermarket) is paying social media (for example, Google, Facebook,
    and Twitter) for consumer's data for marketing purposes, the data owner will be
    credited with a portion of the economic benefits. Without advances in data technology,
    mere legal regulations will not be practical.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，我也认为从消费者那里得出的数据同样属于处理交易的银行。这就像父母身份——所有关于数据（父母的孩子）的决策都是由数据所有者（消费者）和数据生产者（银行）之间达成的协议。目前缺乏的是能够迅速将这些数据以及其使用所带来的经济利益归属到某些经济活动（例如市场营销）中的技术。如果某个组织（例如超市）为消费者数据付费给社交媒体（例如谷歌、Facebook和Twitter）用于市场营销目的，那么数据所有者应当获得一定比例的经济利益。没有数据技术的进步，单纯的法律法规将不具备实际可操作性。
- en: '**The Open Bank Project**'
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**开放银行项目**'
- en: The world's most advanced policy that allows consumers to consolidate their
    own data is called the **Open Banking Project**. It started in the UK in 2016,
    following the European's Directive PSD2 – the revised Payment Services Directive
    ([https://www.ecb.europa.eu/paym/intro/mip-online/2018/html/1803_revisedpsd.en.html](https://www.ecb.europa.eu/paym/intro/mip-online/2018/html/1803_revisedpsd.en.html)).
    This changed the competitive landscape of banks by lowering the entry barrier
    in terms of making use of banks' information for financial advisory reasons. This
    makes robo-advisors a feasible business as the financial data that banks contain
    is no longer segregated.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 允许消费者整合自己数据的世界上最先进政策被称为**开放银行项目**。它始于2016年在英国，遵循欧洲的支付服务指令PSD2——修订后的支付服务指令（[https://www.ecb.europa.eu/paym/intro/mip-online/2018/html/1803_revisedpsd.en.html](https://www.ecb.europa.eu/paym/intro/mip-online/2018/html/1803_revisedpsd.en.html)）。这一政策通过降低使用银行信息进行财务咨询的准入门槛，改变了银行的竞争格局。这使得机器人顾问成为可行的商业模式，因为银行所拥有的金融数据不再是隔离的。
- en: 'The challenge with this project is that the existing incumbent dominant banks
    have little incentive to open up their data. On the consumer side, the slowness
    in data consolidation impacts the economic values of this inter-connected network
    of financial data on banking services. This obeys Metcalfe''s Law, which states
    that the value of a network is equivalent to the square number of connected users
    (in our case, banks). The following table analyzes the situation using Game Theory
    to anticipate the outcome for both banks and consumers—assuming that consumers
    have only two banks in the market with four possible outcomes:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 这个项目面临的挑战是，现有的主导性银行几乎没有动力开放它们的数据。在消费者方面，数据整合的缓慢影响了银行服务中这种互联网络的经济价值。这遵循了梅特卡夫定律，即一个网络的价值等同于连接用户数量的平方（在我们的案例中是银行）。下表使用博弈论分析了这种情况，预期了银行和消费者的结果——假设消费者市场中只有两家银行，有四种可能的结果：
- en: '| **Cell value = benefits of** **bank A/bank B/Consumer** | **Bank B: Open
    Bank API** | **Bank B: Not Open Bank API** |'
  id: totrans-18
  prefs: []
  type: TYPE_TB
  zh: '| **单元格值 = 银行A/银行B/消费者的收益** | **银行B：开放银行API** | **银行B：未开放银行API** |'
- en: '| Bank A: Open Bank API | 0.5\0.5\2 | 0.5\1\1 |'
  id: totrans-19
  prefs: []
  type: TYPE_TB
  zh: '| 银行A：开放银行API | 0.5\0.5\2 | 0.5\1\1 |'
- en: '| Bank A: Not Open Bank API | 1\0.5\1 | 1\1\1 |'
  id: totrans-20
  prefs: []
  type: TYPE_TB
  zh: '| 银行A：未开放银行API | 1\0.5\1 | 1\1\1 |'
- en: For the status quo (that is, without any Open Bank API), let's assume that both
    banks A and B will enjoy 1 unit of benefits while the consumers will also have
    1 unit of benefits.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 对于现状（即没有开放银行API的情况下），假设银行A和银行B将各自享有1个单位的收益，而消费者也将拥有1个单位的收益。
- en: For any bank to develop an Open Bank API, they will need to consume 0.5 of its
    resources. Therefore, we will have two cells showing either bank A or B developing
    the Open Bank API while the other does not. The one developing Open Bank API will
    have fewer benefits since 0.5 of the original 1 unit will need to be spent as
    resources to maintain the API. In these two cases, consumers cannot enjoy any
    additional benefits as the data is not consolidated.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 任何银行要开发开放银行API，都需要消耗其0.5的资源。因此，我们将展示两种情况：银行A或B开发开放银行API，而另一家则没有。开发开放银行API的银行将获得较少的收益，因为原本1个单位的0.5将需要用作维持API的资源。在这两种情况下，由于数据没有整合，消费者无法享受任何额外的收益。
- en: Only in the case where all banks are adopting the Open Bank API will the consumers
    see incremental benefits (let's assume there's one more unit so that there's two
    in total, just to be arbitrary), while both banks have fewer benefits. This, of
    course, could be wrong as the market as a whole shall be more competitive, which
    is what is happening in the UK with regard to virtual banking—a new sub-segment
    has been created because of this initiative! So, at the end of the day, all banks
    could have improved benefits.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 只有在所有银行都采用开放银行API的情况下，消费者才能看到逐步增加的收益（假设再增加一个单位，使总数变为两个，仅为任意假设），而两家银行的收益却减少。当然，这种情况可能是错误的，因为整体市场会变得更加竞争激烈，这也是英国虚拟银行所发生的情况——由于这一举措，已经创造了一个新的子领域！所以，归根结底，所有银行的收益可能都会得到改善。
- en: Having said that, the reality for most incumbent banks is that they have to
    maintain two sets of banking services—one completely virtual while the other set
    of banking channels remains brick and mortar and not scalable. Perhaps the way
    forward is to build another banking channel outside of its existing one and transfer
    the clients there.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 话虽如此，大多数现有银行的现实情况是，它们必须维持两套银行服务——一套完全虚拟，而另一套银行渠道仍然是传统的实体存在，且不可扩展。或许前进的道路是，在现有银行渠道之外再建立一个新的银行渠道，并将客户转移到那里。
- en: Since a truly ideal state hasn't been achieved yet, for the moment, to construct
    a Digital You, there needs to be data from the **Open Bank Project** (**OBP**)
    from the UK on financial transactions ([https://uk.openbankproject.com/](https://uk.openbankproject.com/)),
    identity verification via Digidentity from the EU ([https://www.digidentity.eu/en/home/](https://www.digidentity.eu/en/home/)),
    health records stored with IHiS from Singapore ([https://www.ihis.com.sg/](https://www.ihis.com.sg/)),
    events and social data from Facebook, Twitter, Instagram, and LinkedIn, life events
    from insurance companies, and so on. In short, we still need to work on each respective
    system rollout before we unite all these data sources.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 由于理想状态尚未实现，目前，要构建数字化你，需要来自英国**开放银行项目**（**OBP**）的金融交易数据（[https://uk.openbankproject.com/](https://uk.openbankproject.com/)）、来自欧盟Digidentity的身份验证（[https://www.digidentity.eu/en/home/](https://www.digidentity.eu/en/home/)）、新加坡IHiS存储的健康记录（[https://www.ihis.com.sg/](https://www.ihis.com.sg/)）、Facebook、Twitter、Instagram和LinkedIn的事件与社交数据、保险公司提供的生活事件等。简而言之，我们仍需为每个相应系统的推出做好准备，才能整合所有这些数据源。
- en: Smart devices – using APIs with Flask and MongoDB as storage
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 智能设备——使用Flask和MongoDB作为存储的API
- en: 'Your smart device is a personalized private banker: the software will interact
    with markets and yourself. Within the smart device, the core modules are the **Holding**
    and **User Interaction** modules. The **Holding** module will safeguard the investment
    of the user/customer, while the user''s interactions and the user themselves are
    greeted and connected by the **User Interaction** module.'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 你的智能设备就是一位个性化的私人银行家：软件将与市场和你自己互动。在智能设备中，核心模块是**持有**模块和**用户互动**模块。**持有**模块将保障用户/客户的投资，而用户的互动和用户本身则由**用户互动**模块迎接并连接。
- en: The **Holding** module handles the quantitative aspect of investments—this is
    exactly what we covered in the previous two chapters, but at a personal level—by
    managing the portfolio and capturing various market data. However, the difference
    is that we need to understand the user/customer better through behavioral data
    that's been captured in the **User Interaction** module. The **Holding** module
    is the cognitive brain of the smart device.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '**持有**模块处理投资的定量方面——这正是我们在前两章中讨论的内容，但是在个人层面——通过管理投资组合并捕获各种市场数据。然而，区别在于，我们需要通过在**用户互动**模块中捕获的行为数据，更好地理解用户/客户。**持有**模块是智能设备的认知大脑。'
- en: The **User Interaction** module provides, of course, the interaction aspect
    of a smart device—it understands the user's preferences on investment and interactions.
    These investment preferences are captured in the **Investment Policy Statement**
    (**IPS**). These interactions are then handled by the **Behavior Analyzer**, which
    analyzes the preferred time, channels, and messages to communicate, as well as
    the financial behaviors of the user regarding their actual personality and risk
    appetite, both of which are derived from the data that's obtained from the **Data
    Feeds **of external sources or user-generated data from using the device. Last
    but not least, the **communication channels** (**Comm Channels**) interact with
    the user either by voice, text, or perhaps physically via a physical robot.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '**用户互动**模块提供了智能设备的互动方面——它理解用户在投资和互动中的偏好。这些投资偏好记录在**投资政策声明（IPS）**中。然后，这些互动通过**行为分析器**处理，分析用户偏好的时间、渠道和沟通方式，以及关于用户个性和风险偏好的财务行为，这些信息都来自于通过设备使用获得的**外部数据源**或用户生成的数据。最后但同样重要的是，**沟通渠道**（**Comm
    Channels**）通过语音、文字或通过物理机器人与用户互动。'
- en: 'This sums up nicely what we mentioned in [Chapter 1](1464aff7-9b01-4476-bce9-7da307ef0211.xhtml), *The
    Importance of AI in Banking*, as the definition of AI—a machine that thinks and
    acts like a human, either rationally or emotionally, or both. The **Holding**
    module is the rational brain of a human and acts accordingly in the market, while
    its emotions are handled by the **User Interaction** module – sympathized by the
    **Behavior Analyzer** and how they interact via the **Comm Channels**. The following
    diagram shows the market and user interaction through banking functions:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 这很好地总结了我们在[第一章](1464aff7-9b01-4476-bce9-7da307ef0211.xhtml)《人工智能在银行业中的重要性》中提到的内容，作为人工智能的定义——一种能够像人类一样进行理性或感性（或两者兼具）思考和行动的机器。**持有**模块是人类的理性大脑，在市场中根据此理性行动，而情感则由**用户互动**模块处理——通过**行为分析器**同情并根据**沟通渠道**与用户互动。下图展示了通过银行功能实现的市场与用户互动：
- en: '![](img/72ccb197-84bc-4ef9-8819-773962b6d241.png)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![](img/72ccb197-84bc-4ef9-8819-773962b6d241.png)'
- en: Since we've already talked about the **Holding** module in the previous two
    chapters, which focused on the investment process, here, we'll focus more on the
    **User Interaction** module. Specifically, we will dig deeper into **IPS**, which
    records the investment needs of the user.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们在前两章中已经讨论过**持有**模块，主要聚焦于投资过程，因此在这里，我们将更多地关注**用户互动**模块。具体来说，我们将深入探讨**投资政策声明（IPS）**，它记录了用户的投资需求。
- en: Understanding IPS
  id: totrans-33
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 理解IPS
- en: As we mentioned in [Chapter 6](0e7c4e25-941b-4bd6-a04a-55924bdbaa43.xhtml), *Automated
    Portfolio Management Using Treynor-Black Model and ResNet*, we will start looking
    at the individual's investment policy statement here. To do this, we need to collect
    data to build up the IPS for an individual customer.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们在[第六章](0e7c4e25-941b-4bd6-a04a-55924bdbaa43.xhtml)《使用Treynor-Black模型和ResNet的自动化投资组合管理》中提到的，我们将在这里开始研究个人的投资政策声明。为此，我们需要收集数据，以便为个别客户构建IPS。
- en: 'Here is what it takes to build an IPS for a family:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 这是为一个家庭构建IPS所需的内容：
- en: '**Return and risk objectives**:'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**回报和风险目标**：'
- en: '| **Objective** | **Comment** |'
  id: totrans-37
  prefs: []
  type: TYPE_TB
  zh: '| **目标** | **注释** |'
- en: '| Return objectives | To be inputted by the investors and via the behavioral
    analyzer—personality profiling |'
  id: totrans-38
  prefs: []
  type: TYPE_TB
  zh: '| 投资回报目标 | 由投资者输入，并通过行为分析器——个性化分析 |'
- en: '| Ability to take risk | To be inputted by the investors and via the behavioral
    analyzer—personality profiling |'
  id: totrans-39
  prefs: []
  type: TYPE_TB
  zh: '| 承担风险的能力 | 由投资者输入，并通过行为分析器——个性化分析 |'
- en: '| Willingness to take risk | To be inputted by the investors and via the behavioral
    analyzer—personality profiling |'
  id: totrans-40
  prefs: []
  type: TYPE_TB
  zh: '| 承担风险的意愿 | 由投资者输入，并通过行为分析器——个性化分析 |'
- en: '**Constraints**:'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**约束条件**：'
- en: '| **Constraint** | **Comment** |'
  id: totrans-42
  prefs: []
  type: TYPE_TB
  zh: '| **约束条件** | **注释** |'
- en: '| Liquidity | Liquidity of assets can be determined by the prices within the
    smart device. |'
  id: totrans-43
  prefs: []
  type: TYPE_TB
  zh: '| 流动性 | 资产的流动性可以通过智能设备中的价格来确定。 |'
- en: '| Time horizon | Plan for your children''s future – their studies (where and
    which school, how much, and so on), housing plans, jobs, retirement, and so on.
    |'
  id: totrans-44
  prefs: []
  type: TYPE_TB
  zh: '| 时间范围 | 规划你孩子的未来——他们的学业（在哪里、上什么学校、学费等）、住房计划、工作、退休等。 |'
- en: '| Taxes (both US citizens) | Citizenship via Digidentity. |'
  id: totrans-45
  prefs: []
  type: TYPE_TB
  zh: '| 税收（美国公民） | 通过Digidentity验证公民身份。 |'
- en: '| Legal & regulatory environment | This could be implicated via commercial
    transactions, citizenship, employment, and residential constraints.You may also
    need to consider the legal entity that will manage your wealth, such as a family
    trust. |'
  id: totrans-46
  prefs: []
  type: TYPE_TB
  zh: '| 法律和监管环境 | 这可能涉及商业交易、公民身份、就业和居住限制。你也可能需要考虑管理你财富的法律实体，如家庭信托。 |'
- en: '| Unique circumstances | Interests and special circumstances aren''t made known,
    including social media or medical profiles that stand out from a *standard* user''s – this
    needs to be compared across users anonymously to provide real, unique circumstances.
    |'
  id: totrans-47
  prefs: []
  type: TYPE_TB
  zh: '| 独特情况 | 兴趣和特殊情况没有被公开，包括社交媒体或与*标准*用户不同的医疗档案——这需要在用户之间匿名对比，提供真实的、独特的情况。 |'
- en: Behavioral Analyzer – expenditure analyzers
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 行为分析器 – 支出分析器
- en: Similar to [Chapter 2](9ee6480e-c259-4e5d-bc11-31057de1a173.xhtml), *Time Series
    Analysi*s, we are going to forecast the day-to-day cash flow in the market. Since
    the income for most cases (and even most of the population who are working on
    salary) are fixed on a monthly basis, the only moving parts are the expenditures.
    Within these expenditures, there could be regular spending costs for things such
    as groceries, as well as irregular spending costs for things such as buying white
    goods or even a car. For a machine to track and project regular spending habits,
    as well as infrequent spending, the practical approach is to record these habits
    efficiently when they occur.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 类似于[第二章](9ee6480e-c259-4e5d-bc11-31057de1a173.xhtml)，*时间序列分析*，我们将预测市场中的日常现金流。由于大多数情况下的收入（甚至是大多数按月领薪的工作人群）是固定的，唯一变动的部分是支出。在这些支出中，可能有一些定期支出，如购买日常杂货，和一些不定期支出，如购买家电甚至是汽车。为了让机器追踪并预测定期支出习惯以及不常见的支出，实际的方法是当这些支出发生时，能够高效地记录这些习惯。
- en: Exposing AI services as APIs
  id: totrans-50
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将AI服务暴露为API
- en: While the portfolio optimization model we built in [Chapter 6](0e7c4e25-941b-4bd6-a04a-55924bdbaa43.xhtml),
    *Automated Portfolio Management Using Treynor-Black Model and ResNet*, was great,
    the key technology that will be addressed in this chapter will demonstrate how
    AI models are wrapped and provided to users via API. With regard to technical
    modeling skills, we are not going to add any new techniques to our repertoire
    in this chapter.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然我们在[第六章](0e7c4e25-941b-4bd6-a04a-55924bdbaa43.xhtml)，*使用Treynor-Black模型和ResNet的自动化投资组合管理*中建立的投资组合优化模型很出色，但本章将要讨论的关键技术是如何通过API将AI模型封装并提供给用户。关于技术建模技能，本章不会向我们的技能库中添加任何新技术。
- en: Performing document layout analysis
  id: totrans-52
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 执行文档布局分析
- en: In ML, there is a discipline called **document layout analysis**. It is indeed
    about studying how humans understand documents. It includes computer vision, natural
    language processing, and knowledge graphs. The end game is to deliver an ontology
    that can allow any document to be navigated, similar to how word processors can,
    but in an automated manner. In a word processor, we have to define certain words
    that are found in headers, as well as within different levels of the hierarchy
    – for example, heading level 1, heading level 2, body text, paragraph, and so
    on. What's not defined manually by humans is sentences, vocabulary, words, characters,
    pixels, and so on. However, when we handle the images taken by a camera or scanner,
    the lowest level of data is a pixel.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 在机器学习中，有一门学科叫做**文档布局分析**。它实际上是研究人类如何理解文档的过程。它包括计算机视觉、自然语言处理和知识图谱。最终目标是提供一个本体，允许任何文档都能像文字处理软件那样被导航，但方式是自动化的。在文字处理软件中，我们需要定义某些词汇，这些词汇出现在标题中，也出现在不同层次的层级中——例如，一级标题、二级标题、正文文本、段落等。而没有人为定义的是句子、词汇、单词、字符、像素等。然而，当我们处理相机或扫描仪拍摄的图像时，最低级别的数据是像素。
- en: Steps for document layout analysis
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 文档布局分析的步骤
- en: 'In this section, we will learn how to perform document layout analysis. The
    steps are as follows:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将学习如何执行文档布局分析。步骤如下：
- en: '**Forming characters from pixels**: The technique, which is used to convert
    pixels into characters, is known as **Optical Character Recognition** (**OCR**).
    It is a well-known problem that can be solved by many examples of deep learning,
    including the MNIST dataset. Alternatively, we could use Tesseract-OCR to perform
    OCR.'
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**从像素形成字符**：这项技术用于将像素转换为字符，称为**光学字符识别**（**OCR**）。这是一个众所周知的问题，可以通过许多深度学习示例来解决，包括MNIST数据集。或者，我们可以使用Tesseract-OCR来执行OCR。'
- en: '**Image rotation**: When the image is not located at the correct vertical orientation,
    it may create challenges for people to read the characters. Of course, new research
    in this area is occurring that seems to be able to skip this step.'
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**图像旋转**：当图像没有正确的垂直方向时，可能会给人们阅读字符带来挑战。当然，当前在这一领域的研究表明，有些技术似乎能够跳过这个步骤。'
- en: '**Forming words from characters**: Practically, we cannot wait minutes upon
    minutes for this to happen; with human performance, we can get this right. How
    do we know that a character shall be banded together with other characters to
    form one word? We know this from spatial clues. Yet the distance between characters
    is not fixed, so how can we teach a machine to understand this spatial distance?
    This is perhaps the challenge most people suffering from dyslexia face. Machines
    also suffer from dyslexia by default.'
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**从字符形成单词**：实际上，我们不能等待几分钟才能完成这个过程；在人类的表现下，我们可以做对这一点。我们怎么知道一个字符要与其他字符组合形成一个单词呢？我们知道这一点是通过空间线索。然而，字符之间的距离并不是固定的，那么我们如何教机器理解这个空间距离呢？这也许是大多数患有阅读障碍的人面临的挑战。机器默认也会遭遇阅读障碍。'
- en: '**Building meaning from words**: This requires us to know the topic of the
    paper and the spelling of the words, which helps us to check our various dictionaries
    to understand what the document is about. *Learning* (in terms of deep learning
    in this book) could mean just a topic related to education, and the reason we
    know that it because you understand that this book is a machine learning book
    by Packt – a publisher name that you learned about in the past. Otherwise, by
    merely reading the word Packt, we may guess that it is related to a packaging
    company (that is, PACK-t)? In addition, we also draw clues from the label words—*step
    3* itself looks like label words that introduce the actual content on the right-hand
    side of it.'
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**从词语构建意义**：这要求我们了解文章的主题和单词的拼写，这有助于我们查阅各种词典来理解文档的内容。*学习*（在本书中指深度学习）可能只是一个与教育相关的主题，而我们之所以知道这一点，是因为你理解到这本书是由Packt出版社出版的机器学习书籍——一个你以前学过的出版社名称。否则，仅仅通过阅读“Packt”这个词，我们可能会猜测它与一个包装公司有关（也就是PACK-t）？此外，我们还可以从标签词中获得线索——*步骤3*本身就像是标签词，用来引导右侧的实际内容。'
- en: Classifying words as various generic types of entities helps – for example,
    dates, serial numbers, dollar amount, time, and so on. These are the generic entities
    we typically see in open source spaces such as spaCy, which we used in [Chapter
    7](d29ff3a8-3879-4d50-8795-a39bae5cc793.xhtml), *Sensing Market Sentiment for
    Algorithmic Marketing at Sell Side*.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 将词语分类为各种通用类型的实体是有帮助的——例如，日期、序列号、金额、时间等等。这些是我们通常在开源领域看到的通用实体，比如我们在[第7章](d29ff3a8-3879-4d50-8795-a39bae5cc793.xhtml)中使用的spaCy，*在卖方算法营销中感知市场情绪*。
- en: With regard to spatial clues in the form of words, we may understand the importance
    of larger words while paying less attention to smaller words. The location of
    the words on the page matter too. For example, to read English, we normally read
    from top to bottom, left to right, while in some other languages, we need to read
    from right to left, top to bottom, such as ancient Chinese.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 关于词语的空间线索，我们可能会在关注较大的词语时，忽视较小的词语。词语在页面上的位置也很重要。例如，在阅读英文时，我们通常是从上到下，从左到右，而在一些其他语言中，我们需要从右到左，从上到下阅读，比如古代汉语。
- en: Using Gensim for topic modeling
  id: totrans-62
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用Gensim进行主题建模
- en: In our example of topic modeling, we will focus on *step 4* to limit our scope
    of work. We will do this while we take the prework from *steps 1* to *3* for granted
    and skip *steps 5* and *6*. The dataset image we will be using has already been
    cleaned, rotated, and OCRed – this included binding characters to form words.
    What we have at hand is a dataset with each record represented by a text block,
    which could include multiple words. Gensim is concerned with tracking nouns in
    text.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的主题建模示例中，我们将专注于*步骤4*来限制我们的工作范围。我们在此过程中会默认*步骤1*到*步骤3*的预工作，并跳过*步骤5*和*步骤6*。我们将使用的数据集图像已经过清理、旋转和OCR处理——这包括将字符绑定成单词。我们手头的数据集每条记录由一个文本块表示，可能包含多个单词。Gensim关注的是追踪文本中的名词。
- en: Vector dimensions of Word2vec
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Word2vec的向量维度
- en: Word2Vec defines words by their different features – the feature value of each
    word is defined by the distance between the words that appear in the same sentence.
    It is meant to quantify the similarity between concepts and topics. In our example
    of Word2vec, we will use a pre-trained model to convert text into words. However,
    for each text block, there may be several values involved. In such a case, a series
    of these vectors would be compressed into a value, using a value called an **Eigenvalue**.
    We will use this simple approach to perform dimension reduction, which we do when
    we want to reduce the number of features (dimensions) of a variable. The most
    common approach to dimension reduction is called **Principal Component Analysis**
    (**PCA**). It is mostly applied to scalars, not vectors of variables. Imagine
    that each word is represented by a vector. Here, one text block with two words
    will be represented by a matrix composed of two vectors. Therefore, the PCA may
    not be an ideal solution for this kind of dimension reduction task.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: Word2Vec通过不同的特征定义单词——每个单词的特征值由出现在同一句子中的单词之间的距离定义。它的目的是量化概念和话题之间的相似性。在我们的Word2Vec示例中，我们将使用一个预训练模型将文本转换成单词。然而，对于每个文本块，可能涉及多个值。在这种情况下，这些向量会被压缩成一个值，使用一个叫做**特征值**的值。我们将采用这种简单的方法进行降维，这通常用于减少变量的特征数量（维度）。降维的最常见方法叫做**主成分分析**（**PCA**）。它主要应用于标量，而不是变量的向量。想象每个单词都由一个向量表示。在这里，两个单词的文本块将由一个由两个向量组成的矩阵表示。因此，PCA可能不是这种降维任务的理想解决方案。
- en: While interpreting the vectors that represent the topic of the word, it is important
    to analyze the dimensions involved, as each dimension represents one semantic/meaning
    group. In our example of Word2vec, we'll skip this step to avoid putting too many
    dimensions into the meaningful extraction process. This means we'll have smaller
    feature spaces for illustration purposes.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 在解释代表单词主题的向量时，分析涉及的维度非常重要，因为每个维度代表一个语义/意义组。在我们的Word2Vec示例中，我们将跳过这一步，以避免将过多的维度引入有意义的提取过程。这意味着我们会为说明目的缩小特征空间。
- en: Cash flow projection using the Open Bank API
  id: totrans-67
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Open Bank API的现金流预测
- en: In the future, we will need robo-advisors to be able to understand our needs.
    The most basic step is to be able to pull our financial data from across banks.
    Here, we will assume that we are customers of consumer banking services from the
    US who are staying in the UK. We are looking for wealth planning for a family
    of four—a married couple and two kids. What we want is a robo-advisor to perform
    all our financial activities for us.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 未来，我们需要机器人顾问能够理解我们的需求。最基本的步骤是能够从不同银行提取我们的财务数据。在这里，我们假设我们是来自美国的消费银行服务客户，当前居住在英国。我们正在为一个四口之家——一对已婚夫妇和两个孩子——寻找财富规划。我们希望机器人顾问为我们执行所有的财务活动。
- en: We will retrieve all the necessary transaction data from the **Open Bank Project**
    (**OBP**) API to forecast our expenditure forecasting via Open Bank API. The data
    that we will be using will be simulated data that follows the format specified
    in the OBP. We are not going to dive deep into any of the software technologies
    while focusing on building the wealth planning engine. The family description
    we'll be using has been obtained from the Federal Reserve ([https://www.federalreserve.gov/econresdata/2016-economic-well-being-of-us-households-in-2015-Income-and-Savings.htm](https://www.federalreserve.gov/econresdata/2016-economic-well-being-of-us-households-in-2015-Income-and-Savings.htm)) regarding
    American household financials.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将通过**Open Bank Project**（**OBP**）API检索所有必要的交易数据，以预测我们的支出。我们将使用遵循OBP格式的模拟数据。我们不会深入探讨任何软件技术，而是专注于构建财富规划引擎。我们使用的家庭描述来自美联储（[https://www.federalreserve.gov/econresdata/2016-economic-well-being-of-us-households-in-2015-Income-and-Savings.htm](https://www.federalreserve.gov/econresdata/2016-economic-well-being-of-us-households-in-2015-Income-and-Savings.htm)）关于美国家庭财务的相关数据。
- en: 'The following table shows the typical values of households in the US, which
    helps us understand the general demand for consumer banking:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格展示了美国家庭的典型数值，帮助我们了解消费银行的一般需求：
- en: '| **Income/Expense** | **Value (In US $)** | **Data Source (OBS)** |'
  id: totrans-71
  prefs: []
  type: TYPE_TB
  zh: '| **收入/支出** | **数值（单位：美元）** | **数据来源（OBS）** |'
- en: '| **Income** | **102.7** |  |'
  id: totrans-72
  prefs: []
  type: TYPE_TB
  zh: '| **收入** | **102.7** |  |'
- en: '| Salaries from working people | 102.7 | Largest auto-payment every month,
    with fixed salaries on a monthly basis. |'
  id: totrans-73
  prefs: []
  type: TYPE_TB
  zh: '| 工作人员工资 | 102.7 | 每月最大自动支付，月薪固定。 |'
- en: '| **Living expenses** | **67.3** |  |'
  id: totrans-74
  prefs: []
  type: TYPE_TB
  zh: '| **生活费用** | **67.3** |  |'
- en: '| Annual expenses | 57.3 | Retrieve all transactions from credit cards, savings,
    and current accounts. |'
  id: totrans-75
  prefs: []
  type: TYPE_TB
  zh: '| 年度支出 | 57.3 | 从信用卡、储蓄和活期账户中提取所有交易。|'
- en: '| Debt repayment | 10.0 | Transactions related to debt account. |'
  id: totrans-76
  prefs: []
  type: TYPE_TB
  zh: '| 债务偿还 | 10.0 | 与债务账户相关的交易。|'
- en: '| **Net worth** | **97** |  |'
  id: totrans-77
  prefs: []
  type: TYPE_TB
  zh: '| **净资产** | **97** |  |'
- en: '| **Assets** | **189.9** |  |'
  id: totrans-78
  prefs: []
  type: TYPE_TB
  zh: '| **资产** | **189.9** |  |'
- en: '| Financial assets | 23.5 | The outstanding balance of Securities account.
    No visibility of the 401 plan. |'
  id: totrans-79
  prefs: []
  type: TYPE_TB
  zh: '| 金融资产 | 23.5 | 证券账户的未偿还余额。401计划无可见性。|'
- en: '| Non-financial assets | 158.9 | Housing valuation provided by Zillow. |'
  id: totrans-80
  prefs: []
  type: TYPE_TB
  zh: '| 非金融资产 | 158.9 | 由Zillow提供的房产估值。|'
- en: '| **Liabilities** | **92.6** |  |'
  id: totrans-81
  prefs: []
  type: TYPE_TB
  zh: '| **负债** | **92.6** |  |'
- en: '| Mortgage | 59.5 | The outstanding balance of the debt account. |'
  id: totrans-82
  prefs: []
  type: TYPE_TB
  zh: '| 抵押贷款 | 59.5 | 债务账户的未偿还余额。|'
- en: '| Auto loans and educational debts | 32.8 | Auto loan: Outstanding balance
    of debt account; student loan (federal), with the counterpart being Federal Student
    loan''s; Student loan (private): Outstanding balance of debt account. |'
  id: totrans-83
  prefs: []
  type: TYPE_TB
  zh: '| 汽车贷款和教育债务 | 32.8 | 汽车贷款：债务账户的未偿还余额；学生贷款（联邦），对应为联邦学生贷款；学生贷款（私人）：债务账户的未偿还余额。|'
- en: For more details about Zillow, please refer to this link: [https://www.zillow.com/howto/api/APIOverview.htm](https://www.zillow.com/howto/api/APIOverview.htm).
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 欲了解更多关于Zillow的细节，请参考此链接：[https://www.zillow.com/howto/api/APIOverview.htm](https://www.zillow.com/howto/api/APIOverview.htm)。
- en: Steps involved
  id: totrans-85
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 所涉及的步骤
- en: 'To use the Open Bank API, we will need to do the following:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 使用开放银行API，我们需要做以下操作：
- en: Register to use the Open Bank API.
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 注册使用开放银行API。
- en: Download the necessary data.
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载所需数据。
- en: Create a database to store this data.
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个数据库来存储这些数据。
- en: Set up an API for forecasting.
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置一个预测用的API。
- en: Let's get started!
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们开始吧！
- en: Registering to use Open Bank API
  id: totrans-92
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注册使用开放银行API
- en: There are several ways we can access the Open Banking Project—we will work on
    one such where we registered at [https://demo.openbankproject.com/](https://demo.openbankproject.com/).
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过几种方式访问开放银行项目——我们将在其中一个方式中进行操作，我们已在[https://demo.openbankproject.com/](https://demo.openbankproject.com/)注册。
- en: Creating and downloading demo data
  id: totrans-94
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 创建并下载示例数据
- en: 'The code for this section can be downloaded from GitHub ([https://github.com/OpenBankProject/Hello-OBP-DirectLogin-Python](https://github.com/OpenBankProject/Hello-OBP-DirectLogin-Python)).
    Based on the `hello_obp.py` file from this repository, we have modified the program
    so that it downloads the required data. Use the following code snippet to download
    the demo data:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 这一部分的代码可以从GitHub下载([https://github.com/OpenBankProject/Hello-OBP-DirectLogin-Python](https://github.com/OpenBankProject/Hello-OBP-DirectLogin-Python))。基于此库中的`hello_obp.py`文件，我们已修改程序，使其能够下载所需的数据。使用以下代码片段下载示例数据：
- en: '[PRE0]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Creating a NoSQL database to store the data locally
  id: totrans-97
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 创建NoSQL数据库以本地存储数据
- en: I prefer MongoDB for this due to its ability to import JSON files in a hierarchical
    manner, without us needing to define the structure in advance. Even though we
    will need to store the NoSQL file in SQL database format (as we did in the previous
    chapter) whenever we need to run predictions with the ML model, it is still useful
    for us to cache the downloaded data physically before we run the prediction.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 我更倾向于使用MongoDB，因为它能够以层级方式导入JSON文件，而我们无需提前定义结构。即使我们需要将NoSQL文件以SQL数据库格式存储（就像在上一章中那样），每当需要使用ML模型进行预测时，它仍然有助于我们在运行预测之前将下载的数据物理缓存起来。
- en: So, you may be wondering why we need to store it in a NoSQL database for our
    purposes – can't we just save it as we did in the previous chapter, when we handled
    tweet data? No – we want to use a database because for quicker retrieval, given
    that we will be storing hundreds of thousands of JSON files with an infinite number
    of days versus batch downloads. This also depends on how frequently we want to
    download the data; if we wish to update our databases every day, we may not need
    to store the JSON data in a NoSQL database as we wouldn't have very many files
    to deal with. However, if we are querying the data or continuously adding new
    features to the training dataset, we might be better off storing the raw data
    on our side.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，你可能会想知道为什么我们需要将数据存储在NoSQL数据库中——难道我们不能像上一章处理推文数据时那样直接保存吗？不——我们希望使用数据库，因为为了更快地检索数据，我们将存储数十万个JSON文件，而不是批量下载的数据。这也取决于我们希望多频繁地下载数据；如果我们希望每天更新数据库，可能就不需要将JSON数据存储在NoSQL数据库中，因为我们处理的数据文件不会很多。然而，如果我们需要查询数据或持续向训练数据集中添加新特征，存储原始数据可能更有利。
- en: 'The following code is used to establish our connectivity with the MongoDB server:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码用于建立与MongoDB服务器的连接：
- en: '[PRE1]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The following code is used to create the database:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码用于创建数据库：
- en: '[PRE2]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Setting up the API for forecasting
  id: totrans-104
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 设置预测用API
- en: To perform forecasting for payments, we need to know what kind of forecasting
    model we want to build. Do we want a time series model or the ML model? Of course,
    we want to have a model that provides more information.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 为了进行支付预测，我们需要知道我们想要构建什么样的预测模型。我们是想要一个时间序列模型，还是机器学习模型？当然，我们希望有一个能够提供更多信息的模型。
- en: In our example, we have not prepared any model for this as the method we'll
    be using will be similar to the model we used in [Chapter 2](9ee6480e-c259-4e5d-bc11-31057de1a173.xhtml),
    *Time Series Analysis*. The main point to illustrate here is how to set up the
    API server and how to use another program to consume the API. Please make sure
    these two programs are run simultaneously.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的示例中，我们没有为此准备任何模型，因为我们将使用的方法与我们在[第2章](9ee6480e-c259-4e5d-bc11-31057de1a173.xhtml)中使用的模型类似，*时间序列分析*。这里的主要目的是说明如何设置API服务器，以及如何使用另一个程序来调用该API。请确保这两个程序同时运行。
- en: 'The server will be set up to listen to requests so that it can run predictions.
    We will simply load the model without running any predictions. The following code
    snippet is used to connect us to the Open Bank API server:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器将被设置为监听请求，以便它可以运行预测。我们将简单地加载模型，而不运行任何预测。以下代码片段用于将我们连接到Open Bank API服务器：
- en: '[PRE3]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The following code snippet is used to create requests from the client application:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段用于从客户端应用程序创建请求：
- en: '[PRE4]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Congratulations! You have built a robot that can read data from banks and have
    built it so that it can run AI models on this data.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！你已经建立了一个能够读取银行数据的机器人，并使其能够在这些数据上运行AI模型。
- en: For a household, it becomes critical to limit expenses to increase their cash
    flow. In the next section, we will look at how to track daily expenses using the
    invoice entity recognition technique.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 对于家庭来说，限制支出以增加现金流变得至关重要。在接下来的部分，我们将探讨如何使用发票实体识别技术来追踪日常支出。
- en: Using invoice entity recognition to track daily expenses
  id: totrans-113
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用发票实体识别技术追踪日常支出
- en: While we are always dreaming for the end game of digitization through AI in
    finance, the reality is that there is data that's trapped. And very often, these
    expenses come in the form of paper, not API feeds. Dealing with paper would be
    inevitable if we were to transform ourselves into a fully digital world where
    all our information is stored in JSON files or SQL databases. We cannot avoid
    handling existing paper-based information. Using an example of a paper-based document
    dataset, we are going to demonstrate how to build up the engine for the invoice
    entity extraction model.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然我们一直在梦想通过AI在金融领域实现数字化的最终目标，但现实是有些数据被困住了。而且这些费用往往以纸质的形式存在，而不是API数据流。如果我们要转型为一个完全数字化的世界，所有信息都存储在JSON文件或SQL数据库中，处理纸质文档将是不可避免的。我们无法避免处理现有的纸质信息。通过一个纸质文档数据集的例子，我们将展示如何建立发票实体提取模型的引擎。
- en: In this example, we will assume you are developing your own engine to scan and
    transform the invoice into a structured data format. However, due to a lack of
    data, you will need to parse the Patent images dataset, which is available at [http://machinelearning.inginf.units.it/data-and-tools/ghega-dataset](http://machinelearning.inginf.units.it/data-and-tools/ghega-dataset).
    Within the dataset, there are images, text blocks, and the target results that
    we want to extract from. This is known as **entity extraction**. The challenge
    here is that these invoices are not in a standardized format. Different merchants
    issue invoices in different sizes and formats, yet we are still able to understand
    the visual clues (font size, lines, positions, and so on) and the languages of
    the words and the words surrounding it (called **labels**).
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个示例中，我们假设你正在开发自己的引擎来扫描并将发票转换为结构化数据格式。然而，由于缺乏数据，你需要解析专利图像数据集，该数据集可以在[http://machinelearning.inginf.units.it/data-and-tools/ghega-dataset](http://machinelearning.inginf.units.it/data-and-tools/ghega-dataset)找到。在这个数据集中，有图像、文本块以及我们希望从中提取的目标结果。这被称为**实体提取**。这里的挑战在于，这些发票并不是标准化格式。不同的商家开具的发票尺寸和格式各不相同，但我们仍然能够理解视觉线索（字体大小、线条、位置等）以及单词及其周围的单词（称为**标签**）。
- en: Steps involved
  id: totrans-116
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 涉及的步骤
- en: 'We have to follow six steps to track daily expenses using invoice entity recognition.
    These steps are as follows:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 我们必须遵循六个步骤，使用发票实体识别来追踪每日开销。这些步骤如下：
- en: 'Import the relevant libraries and define the variables. In this example, we''re
    introducing topic modeling, including **Word to Vector** (`Word2vec`), using `gensim`,
    and regular expressions using `re`, a built-in module. The following code snippet
    is used to import the required libraries:'
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入相关库并定义变量。在本示例中，我们引入了主题建模技术，包括**词向量**（`Word2vec`），使用`gensim`，以及使用`re`进行正则表达式匹配，这是一个内置模块。以下代码片段用于导入所需的库：
- en: '[PRE5]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Define the functions that will need to be used later. There will be two groups
    of functions—one, `2A`, is used to train and test the neural network, while the
    other, `2B`, aims at converting the text into numeric values. The following code
    snippet defines the functions that will be used for invoice entity recognition:'
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义之后需要使用的函数。将有两组函数——一组`2A`用于训练和测试神经网络，另一组`2B`旨在将文本转换为数值。以下代码片段定义了将用于发票实体识别的函数：
- en: '[PRE6]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Prepare the dataset. In this example, we will try to use `numpy` to store the
    features as they''re quite big. We will also use `pandas` for each file as it
    is far easier to manipulate and select columns using a DataFrame, given that the
    size of each image isn''t too large. The following code snippet is used to prepare
    the dataset:'
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 准备数据集。在本示例中，我们将尝试使用`numpy`来存储特征，因为它们相当大。我们还将使用`pandas`处理每个文件，因为使用DataFrame来操作和选择列更加方便，前提是每个图像的大小不太大。以下代码片段用于准备数据集：
- en: '[PRE7]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Execute the model. Here, we execute the model we prepared using the functions
    we defined in previous steps. The following code snippet is used to execute the
    model:'
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行模型。在这里，我们使用之前步骤中定义的函数来执行我们准备的模型。以下代码片段用于执行该模型：
- en: '[PRE8]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Congratulations! With that, you have built a model that can extract information
    from scanned images!
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！到此为止，你已经构建了一个能够从扫描图像中提取信息的模型！
- en: Draw the clues from the spatial and visual environment of the word. The preceding
    line clearly separates *steps 4* and *5*. Noticing how these lines are being projected
    also helps us group similar words together. For documents that require original
    copies, we may need to look at signatures and logos, as well as matching these
    against a true verified signature or stamp.
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从单词的空间和视觉环境中提取线索。前述这一行明确区分了*步骤 4*和*步骤 5*。注意这些线条如何被投射出来，也有助于我们将相似的单词分组。对于需要原件的文档，我们可能需要查看签名和标志，并将其与真实的已验证签名或印章进行比对。
- en: Construct a knowledge map of these documents. This is when we can build a thorough
    understanding of the knowledge embedded in the document. Here, we need to use
    the graph database to keep track of this knowledge (we covered this in the previous
    chapter).
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 构建这些文档的知识图谱。这是我们可以深入了解文档中所蕴含的知识的时候。在这里，我们需要使用图形数据库来追踪这些知识（我们在前一章中已介绍过）。
- en: This concludes our example of tracking daily expenses, as well as this chapter.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 这就结束了我们关于追踪每日开销的示例，也结束了这一章的内容。
- en: Summary
  id: totrans-130
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we covered how to extract data and provide AI services using
    APIs. We understood how important it is to manage customer's digital data. We
    also understood the Open Bank Project and document layout analysis. We learned
    about this through two examples—one was about projecting cash flows, while the
    other was about tracking daily expenses.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一章中，我们介绍了如何使用API提取数据并提供AI服务。我们理解了管理客户数字数据的重要性。我们还理解了开放银行项目和文档布局分析。通过两个示例我们学习了这些内容——一个是关于现金流投影，另一个是关于追踪每日开销的。
- en: The next chapter will also focus on consumer banking. We will learn how to create
    proxy data for information that's missing in the customer's profile. We also will
    take a look at an example chatbot that we can use to serve and interact with customers.
    We will use graph and NLP techniques to create this chatbot.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 下一章将继续聚焦于消费者银行业务。我们将学习如何为客户资料中缺失的信息创建代理数据。我们还将查看一个示例聊天机器人，用于服务和与客户互动。我们将使用图形和自然语言处理技术来构建这个聊天机器人。
