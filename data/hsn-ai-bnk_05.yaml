- en: Using Features and Reinforcement Learning to Automate Bank Financing
  id: totrans-0
  prefs: []
  type: TYPE_NORMAL
  zh: 使用特征和强化学习来自动化银行融资
- en: Commercial banks make money by earning interest on money that was loaned to
    borrowers. In many cases, the loan becomes a **Non-Performing Asset** (**NPA**)
    for the bank. There are instances where the borrower could go bankrupt, leaving
    the bank with a loss. In such situations, it becomes critical for commercial banks
    to assess the borrower's ability to repay the loan in a timely manner.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 商业银行通过对借款人贷款收取利息来赚取利润。在许多情况下，贷款会变成银行的**不良资产**（**NPA**）。有些情况下，借款人可能会破产，导致银行遭受损失。在这种情况下，商业银行必须及时评估借款人还款能力，变得至关重要。
- en: Now, if we look at this scenario closely, we realize that every loan is funded
    by the money deposited by other customers. Thus, the commercial bank owes interest
    to the depositor for the money deposited for a time period. This is usually the
    interest on the depositor's money that is credited by the banks on a quarterly
    basis. The bank also profits if it charges the borrower more interest and pays
    a low interest to the depositor.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，如果我们仔细看这个场景，我们会意识到每一笔贷款都是由其他客户存款提供资金的。因此，商业银行需要向存款人支付利息，这是对存款人资金的一种回报，通常是按季度计算的。银行还可以通过向借款人收取更高的利息，并向存款人支付较低的利息来获利。
- en: In this chapter, we will derive the solution for both of these situations by
    using **Reinforcement Learning** (**RL**), which is an important area of machine
    learning. Apart from this, we shall also look at examples of how RL can be helpful
    in banking functions. RL is one of the three areas of machine learning, with the
    others being supervised learning and unsupervised learning. RL is specifically
    applicable where decision-making is required based on the surroundings or the
    current environment. In RL, an agent is presented with options to move toward
    the reward. The agent has to choose one of the options available. If the correct
    option is chosen, the agent gets a reward. Otherwise, the agent gets penalized.
    The goal for the agent is to maximize their chance of getting closer to the reward
    with each step and to ultimately obtain it.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将通过使用**强化学习**（**RL**），这一机器学习的重要领域，推导出这两种情况的解决方案。除此之外，我们还将看看强化学习如何在银行职能中提供帮助。强化学习是机器学习的三个领域之一，另外两个是监督学习和无监督学习。强化学习特别适用于基于环境或当前环境做出决策的场景。在强化学习中，代理会面临多种选择，朝着奖励前进。代理需要选择一个可用选项。如果选择了正确的选项，代理会得到奖励，否则会受到惩罚。代理的目标是通过每一步最大化接近奖励的机会，并最终获得奖励。
- en: 'All of these concepts shall be divided into the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 所有这些概念将分为以下主题：
- en: Breaking down the functions of a bank
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 拆解银行的功能
- en: AI modeling techniques
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 人工智能建模技术
- en: Metrics of model performance
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型性能的度量
- en: Building a bankruptcy prediction model
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建破产预测模型
- en: Funding the loan using reinforcement learning
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用强化学习为贷款提供资金
- en: Before we move forward and learn about RL, it is necessary to understand the
    banking business and how it functions.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们继续深入了解强化学习（RL）之前，了解银行业务及其运作方式是必要的。
- en: Breaking down the functions of a bank
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 拆解银行的功能
- en: 'Within a bank, as an intermediary between those with excess money (the depositors)
    and those who need money (the borrowers), there are two important questions that
    need to be answered:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在银行内部，作为资金过剩者（存款人）和资金需求者（借款人）之间的中介，有两个重要问题需要回答：
- en: How risky is a borrower?
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 借款人的风险有多大？
- en: What is the funding cost of money?
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 资金成本是什么？
- en: These are the two important questions that need to be considered before we look
    at the profit required for sustaining the business operations in order to cover
    its running costs.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是我们在查看支持业务运营所需的利润之前，需要考虑的两个重要问题，以覆盖其运行成本。
- en: 'When these decisions are not made properly, it threatens the viability of a
    bank. There could be two possible outcomes in such instances:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 当这些决策没有正确做出时，会威胁到银行的生存能力。在这种情况下，可能会有两种结果：
- en: If the bank does not make enough profit to cover the cost of risk and operations
    when a risky event occurs, the bank could collapse.
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果银行在发生风险事件时无法赚取足够的利润来覆盖风险和运营成本，银行可能会倒闭。
- en: If the bank fails to meet the depositor's requirements or fails to honor its
    borrower's agreements to lend, it hurts the credibility of the bank, thus driving
    potential customers away.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果银行未能满足存款人的要求或未能履行借款人贷款协议，就会损害银行的信誉，从而导致潜在客户流失。
- en: Major risk types
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 主要风险类型
- en: To answer the question, *How risky is a borrower?,* we first need to understand
    the factors contributing to risk.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 为了回答“*借款人有多大风险？*”的问题，我们首先需要了解影响风险的因素。
- en: '**Risk** is an unfavorable outcome in the future that impacts the functioning
    of a bank. For a bank, the major contributors include the following:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: '**风险**是指未来对银行运作产生不利影响的结果。对于银行而言，主要的风险因素包括以下内容：'
- en: '**Credit risk**: This risk concerns the borrower''s inability to repay the
    capital back to the bank in a lending transaction; for example, the financial
    distress of the borrowing firm, causing its inability to repay the loan.'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**信用风险**：这种风险涉及借款人在借款交易中无法按时偿还资本的问题；例如，借款公司面临财务困境，导致无法偿还贷款。'
- en: '**Market risk**: This risk concerns unfavorable price movements in financial
    markets, such as an interest rate hike in the market from which the bank sources
    its funding.'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**市场风险**：这种风险涉及金融市场中不利的价格变动，例如银行筹资来源市场的利率上升。'
- en: '**Operational risk**: This risk concerns events happening in the operations
    of the bank as an organization. This could include internal theft, a cyber attack,
    and so on.'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**操作风险**：这种风险涉及银行作为组织在运营过程中发生的事件。这可能包括内部盗窃、网络攻击等。'
- en: For a complete list of the types of risk, please refer to the Basel Framework by
    BIS ([https://www.bis.org/bcbs/basel3.htm](https://www.bis.org/bcbs/basel3.htm)).
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 有关风险类型的完整列表，请参考BIS的《巴塞尔框架》([https://www.bis.org/bcbs/basel3.htm](https://www.bis.org/bcbs/basel3.htm))。
- en: Asset liability management
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 资产负债管理
- en: Commercial banks need deposits in order to fund loans. As well as assessing
    the riskiness of borrowers, the bank also performs a useful function in that they
    convert deposits from savers into loans for borrowers. Thus, a pricing mechanism
    for both depositors and borrowers is important. To a bank, loans sit on the asset
    side of financial statements, while deposits sit on the liabilities side of the
    business. Therefore, this is often called **Asset and Liability Management** (**ALM**).
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 商业银行需要存款来为贷款提供资金。除了评估借款人的风险外，银行还发挥着一个有用的功能，即将储户的存款转化为借款人的贷款。因此，为存款人和借款人设定定价机制非常重要。对银行而言，贷款位于财务报表的资产端，而存款位于负债端。因此，这通常被称为**资产负债管理**（**ALM**）。
- en: 'In this book, we will focus on only one part of the entire ALM function – the
    funding aspect – without covering other risks such as liquidity risk, interest
    rate risk, and foreign exchange risk. The following are the objectives of the
    ALM function of a bank:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书中，我们将仅关注整个ALM功能中的一部分——资金方面——而不涉及流动性风险、利率风险和外汇风险等其他风险。以下是银行ALM功能的目标：
- en: The first objective of ALM is to ensure that loans are supported by deposits
    and that the bank will have sufficient deposits, in case the depositors ask for
    their money back. In terms of the total quantity, approximately, a $100 deposit
    supports a $70 loan. Referencing the ratios from some of the biggest banks, the
    ratios should be around 1.2:1 to 1.5:1 for a customer deposit to a customer loan.
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ALM（资产负债管理）的首要目标是确保贷款有存款支持，并且银行将有足够的存款，以防存款人要求取回他们的钱。从总量来看，大约$100的存款支持$70的贷款。参考一些大银行的比率，客户存款与客户贷款的比率应该在1.2:1到1.5:1之间。
- en: Secondly, there is another aspect with regard to how long deposits are placed
    for and loans are lent out. The question of how long is referred to as the **duration**.
    To meet long-term loan commitments, the bank also needs deposits to be locked
    in for a long enough time to ensure that loans are supported by deposits in a
    long-term manner.
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 其次，还有一个方面是关于存款的存放期限和贷款的借出期限。存放多长时间的问题被称为**期限**。为了满足长期贷款承诺，银行还需要存款在足够长的时间内被锁定，以确保贷款能够长期得到存款的支持。
- en: Thirdly, the ALM function needs to be profitable, which means the ALM income
    should be higher than the ALM cost. The *cost* is the ALM pricing that you are
    giving out. This cost is, in fact, the income for ALMs/banks, while the deposit
    rate quoted to the client is the bank's expense.
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第三，ALM功能需要是盈利的，这意味着ALM收入应高于ALM成本。*成本*是你给出的ALM定价。实际上，这个成本是ALM/银行的收入，而银行给客户报价的存款利率是银行的支出。
- en: 'Part of a bank''s well-known secret for profit is to convert the short-term
    deposit (lower-priced) into a long-term loan (higher interest income). The following
    curve shows the pricing aspect for a bank for its deposits and loans:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 银行盈利的一个知名秘诀是将短期存款（低价）转化为长期贷款（高利息收入）。以下曲线显示了银行存款和贷款的定价情况：
- en: '![](img/b5ae9587-1f39-45f6-8620-e8c2db1b43df.png)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b5ae9587-1f39-45f6-8620-e8c2db1b43df.png)'
- en: In the preceding graph, the *x* axis shows how long (in days) the deposit/loan
    position will remain with the bank, while the *y* axis shows the annualized interest
    rate.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的图表中，*x*轴表示存款/贷款在银行中保持的时间（以天为单位），而*y*轴表示年化利率。
- en: Interest rate calculation
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 利率计算
- en: Though there are many ways to calculate the interest to be paid on the deposit,
    the most common way to calculate interest is to quote the interest in its annualized
    form; that is, as if the interest has been put in place for a year, regardless
    of how long it will be placed for.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管有许多方法来计算存款应支付的利息，但最常见的计算利息的方法是以年化形式报价；也就是说，无论存款时间有多长，都假设利息是以一年的时间来计算的。
- en: 'For example, if the 7-day interest rate for a deposit is 1%, this means that
    within 7 days, we will get the following:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果存款的7天利率为1%，这意味着在7天内，我们将获得以下收益：
- en: '![](img/40783a18-fb4d-4228-ae8d-c4d25bd24962.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![](img/40783a18-fb4d-4228-ae8d-c4d25bd24962.png)'
- en: We only need to divide the annualized interest rate by 7 days in order to get
    what we shall get for the 7-day period. The reason behind this is that it is useful
    for a market dealer to have a standardized way to quote pricing.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 我们只需将年化利率除以7天，就能得到7天期间的利率。其背后的原因是，市场交易员需要一种标准化的方式来报价。
- en: We will use this formula for interest pricing and deposit pricing in the *Funding
    a loan using reinforcement learning* section, later in this chapter. However,
    there are a lot of other fine details with regard to interest pricing, with different
    ways of compounding (interest can be earned from interest) and day-count conventions
    (365 days, actual calendar or actual working days, 360 days, 220 days, and so
    on). For illustration purposes, we will assume a year is made up of 365 days and
    we will use simple interest rates without compounding.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在本章后面“*使用强化学习为贷款融资*”一节中使用此公式进行利息定价和存款定价。然而，关于利息定价，还有很多其他细节问题，包括不同的复利方式（利息可以从利息中赚取）和天数计数规则（365天、实际日历或实际工作日、360天、220天等）。为了简化说明，我们假设一年有365天，并且使用不计复利的简单利率。
- en: Credit rating
  id: totrans-41
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 信用评级
- en: Besides the cost of lending described in ALM, another role of the bank is to
    assess the level of risk when getting involved with a client. This riskiness is
    added to the cost of funding. This concept is known as **credit rating** in banks.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 除了在ALM中描述的借贷成本外，银行的另一个职能是评估在与客户打交道时所承担的风险水平。这种风险性会被加到资金成本中。这个概念在银行中被称为**信用评级**。
- en: The Basel Committee assesses and imposes global regulations on risk management
    in banks. According to the definition provided by the *Definition on Defaul**t/Loss*
    by the Basel Committee ([https://www.bis.org/bcbs/qis/qis3qa_f.htm](https://www.bis.org/bcbs/qis/qis3qa_f.htm)),
    credit rating predicts the probability of a borrower (who is the one being rated)
    going bankrupt in a year's time. Borrowers usually default on a loan due to the
    bankruptcy of companies. So, we normally use default and bankruptcy interchangeably.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 巴塞尔委员会评估并实施全球银行风险管理的相关规定。根据巴塞尔委员会提供的*违约/损失定义*（[https://www.bis.org/bcbs/qis/qis3qa_f.htm](https://www.bis.org/bcbs/qis/qis3qa_f.htm)），信用评级预测借款人（即被评级者）在一年内破产的概率。借款人通常因公司破产而违约。因此，我们通常将违约和破产互换使用。
- en: The essential question is, given the required information, how likely is it
    that the company could go bankrupt within 1 year, thus failing to meet its repayment
    obligation? This could be driven by many reasons, but one obvious reason is that
    the financial health of the company is not good.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 关键问题是，考虑到所需信息，公司在1年内破产、无法履行偿还义务的可能性有多大？这可能由多种原因驱动，但一个显而易见的原因是公司的财务状况不好。
- en: A financial statement is like the report card of a company – even though it
    takes time to produce, it conforms to a certain internationally accepted standard
    and comes with the guarantee of quality by the auditors.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 财务报表就像公司的成绩单——尽管它需要时间来制作，但它符合某种国际公认的标准，并且有审计师的质量保证。
- en: AI modeling techniques
  id: totrans-46
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 人工智能建模技术
- en: Now that we've understood the functions of a business, it's time to move onto
    some technical concepts. In this section, we will learn about AI modeling techniques,
    including Monte Carlo simulation, the logistic regression model, decision trees,
    and neural networks.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经了解了业务的功能，是时候了解一些技术概念了。在这一部分中，我们将学习人工智能建模技术，包括蒙特卡洛模拟、逻辑回归模型、决策树和神经网络。
- en: Monte Carlo simulation
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 蒙特卡洛模拟
- en: Monte Carlo simulation uses heavy computation to predict the behavior of objects
    by assuming random movements that can be described by probability. This approach
    is a standard tool that's used to study the movements of molecules in physics,
    which can only be predicted with a certainty of the movement pattern, which is
    described by probability.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 蒙特卡洛模拟通过假设可以用概率描述的随机运动，使用大量计算预测物体的行为。这种方法是研究分子在物理学中运动的标准工具，分子的运动只能以模式的确定性描述，通常使用概率来预测。
- en: Finance professionals adopt this method to describe the pricing movement of
    securities. We will use it to simulate pricing in the *Funding the loan using
    reinforcement learning* section, later in this chapter.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 金融专业人士采用这种方法来描述证券价格的变动。我们将在本章稍后的*使用强化学习为贷款提供资金*部分中使用该方法进行定价模拟。
- en: The logistic regression model
  id: totrans-51
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 逻辑回归模型
- en: The logistic regression model is one of the most popular adoptions of AI in
    banking, especially in the domain of credit risk modeling. The target variable
    of the model will be a binary outcome of 1 or 0, with a probability of meeting
    the target of 1\. The decision of what 1 and 0 refer to depends on how we prepare
    the data.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 逻辑回归模型是人工智能在银行业中最常见的应用之一，尤其是在信用风险建模领域。该模型的目标变量将是1或0的二元结果，1的概率表示满足目标。1和0的具体含义取决于我们如何准备数据。
- en: In this case, the target variable can be a company filing for bankruptcy within
    1 year. The model is called logistic because the function that models the 1 and
    0 is called **logit**. It is called regression because it belongs to a statistical
    model called the regression model, which strives to determine the causation of
    factors of an outcome.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，目标变量可以是公司在1年内破产的情况。该模型称为逻辑回归，因为用于建模1和0的函数被称为**logit**。它被称为回归模型，因为它属于一种统计模型——回归模型，旨在确定影响结果的因果关系。
- en: Decision trees
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 决策树
- en: The decision tree algorithm actually belongs to the supervised learning group
    of algorithms. However, due to the nature of the algorithm, it is commonly used
    to solve regression and classification problems. Regression and classification
    often require decision-making based on the situation at hand. So, these problems
    are commonly solved using reinforcement learning algorithms.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 决策树算法实际上属于监督学习算法组。然而，鉴于该算法的性质，它常用于解决回归和分类问题。回归和分类通常需要根据当前情况做出决策。因此，这些问题通常使用强化学习算法来解决。
- en: 'The beneficial element of having a decision tree is that we can actually visualize
    the decision tree''s representation. The decision-making process starts at the
    top of the tree and branches out toward the leaf nodes of the tree. The leaf nodes
    are the point at which the target variables will end up. All the values of a variable
    that are classified to the same leaf node contain the same probability of defaulting.
    The following is an example visualization of a decision tree algorithm that is
    making a decision to give a loan to the applicant:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 决策树的有益之处在于我们实际上可以可视化决策树的表示。决策过程从树的顶部开始，向树的叶子节点分支。叶子节点是目标变量最终落点的地方。所有被分类到同一叶子节点的变量值，具有相同的违约概率。以下是一个决策树算法可视化示例，展示了如何做出是否向申请人发放贷款的决策：
- en: '![](img/d40afa56-e04a-40ae-9fe9-7de7d29a8c63.png)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d40afa56-e04a-40ae-9fe9-7de7d29a8c63.png)'
- en: The most common way to move forward in the decision tree is to look at the minimal
    leaf size, which refers to the size of the bucket that each of the training samples
    is being classified in. If the bucket contains too few samples than `min_samples_leaf`
    dictates, then it will be scrapped. This can be done to reduce the number of buckets
    (known as the **leaf node of a decision tree**).
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 决策树中最常见的前进方式是查看最小叶子大小，这指的是每个训练样本被分类到的桶的大小。如果桶内的样本数量少于`min_samples_leaf`所规定的数量，则该桶将被舍弃。这样做可以减少桶的数量（称为**决策树的叶子节点**）。
- en: Reading the decision tree is easy. However, it is quite amazing to realize how
    the machine learns about the various conditions used for splitting.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 阅读决策树很容易。然而，令人惊讶的是，机器如何学习用于分裂的各种条件。
- en: Neural networks
  id: totrans-60
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 神经网络
- en: 'A simple neural network looks like the one shown in the following diagram:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 一个简单的神经网络如下面的图所示：
- en: '![](img/0fe31c9c-dd00-4146-9426-10c46bd80f44.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0fe31c9c-dd00-4146-9426-10c46bd80f44.png)'
- en: It consists of three layers, namely the **input layer**, the **hidden layer**,
    and the **output layer**. Each layer is made up of nodes. The artificial neural
    network that is used to solve AI problems mimics the physical neural network present
    in the human brain. The neurons in the human brain are represented by nodes in
    the artificial neural network. The connections between the neurons are represented
    in the artificial neural network by weights.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 它由三层组成，即**输入层**、**隐藏层**和**输出层**。每一层由节点构成。用于解决AI问题的人工神经网络模仿人脑中存在的物理神经网络。人脑中的神经元由人工神经网络中的节点表示。神经元之间的连接则通过权重在人工神经网络中表示。
- en: Let's understand the significance of each of the layers in the neural network.
    The input layer is used to feed the input into the model. It is also responsible
    for presenting the condition that the model is being trained for. Every neuron
    or node in the input layer represents one independent variable that has influence
    over the output.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们理解神经网络中每一层的意义。输入层用于将输入数据馈送到模型中。它还负责呈现模型正在训练的条件。输入层中的每个神经元或节点代表一个对输出有影响的独立变量。
- en: The hidden layer is the most crucial because its job is to process the data
    it has received from the input layer and is responsible for extracting the necessary
    features from the input data. The hidden layer consists of one or more layers.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 隐藏层是最关键的，因为它的工作是处理从输入层接收到的数据，并负责从输入数据中提取必要的特征。隐藏层由一个或多个层组成。
- en: In the case of solving a problem with linearly represented data, the activation
    function (which processes the input data) can be included in the input layer itself.
    However, for processing complex representations of data, one or more hidden layers
    are required. The number of hidden layers depends on the complexity of the data.
    The hidden layer passes on the processed data to the output layer.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 在解决线性表示数据的问题时，激活函数（处理输入数据）可以包含在输入层本身中。然而，对于复杂数据表示的处理，则需要一个或多个隐藏层。隐藏层的数量取决于数据的复杂性。隐藏层将处理后的数据传递给输出层。
- en: The output layer is responsible for collecting and transmitting information.
    The pattern that the output layer presents can be traced back to the input layer.
    The number of nodes in the output layer depends on the number of decisions to
    be made eventually.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 输出层负责收集和传递信息。输出层展示的模式可以追溯到输入层。输出层的节点数取决于最终需要做出的决策数量。
- en: Reinforcement learning
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 强化学习
- en: 'In the case of reinforcement learning, the model receives feedback on every
    step that it takes. First, let''s understand the entities involved in reinforcement
    learning:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 在强化学习中，模型会在每一步行动后收到反馈。首先，让我们理解强化学习中涉及的实体：
- en: '**Agent**: This is someone who acts; in our case, it is the bank.'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**代理**：这是执行操作的主体；在我们的案例中，它是银行。'
- en: '**Actions**: This is the actual work done by the agent. In our case, actions
    refer to the pricing grid offered by the bank.'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**动作**：这是代理实际执行的工作。在我们的案例中，动作指的是银行提供的定价网格。'
- en: '**Utility function**: This assigns numbers to represent the desirability of
    a state. The utility function is learned via interactions from the feedback given
    by the actual **Profit and Loss** (**P&L**)/funding status versus pricing grids
    (both deposit and loan) offered.'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**效用函数**：它为状态的期望度分配数值。效用函数通过与实际**盈亏**（**P&L**）/资金状况与所提供的定价网格（包括存款和贷款）之间的反馈交互来学习。'
- en: '**Rewards**: This is the numeric representation of the desirability of the
    outcome. In our case, it is cumulative P&L (the binary result of meeting or failing
    the self-funding target, with 1 representing meeting and 0 representing failing).
    The cumulative P&L will equal 0 if the bank fails the self-funding requirements.'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**奖励**：这是结果的期望度的数字表示。在我们的案例中，它是累计盈亏（即达到或未达到自我融资目标的二元结果，其中1表示达到，0表示未达到）。如果银行未能满足自我融资要求，则累计盈亏将为0。'
- en: '**Policy**: Choose the action based on the utilities estimated. In our case,
    our policy does not evolve as it strives to take the pricing grid that provides
    the maximum next states'' rewards. The policy we have leads to exploitation, not
    exploration, which means the policy does not give away current P&L to generate
    long-term P&L. This is because the depositors and borrowers will display a certain
    level of stickiness if they witness non-profitability in the short term while
    gaining P&L over the long term. Exploration is a normal action among relationship
    bankers, who treasure the long-term profitability of relationships.'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**策略**：根据估算的效用选择行动。在我们的案例中，我们的策略不会变化，因为它努力选择提供最大下一个状态奖励的定价网格。我们采用的策略导致了“利用”，而非“探索”，这意味着该策略不会放弃当前的盈亏来产生长期的盈亏。这是因为如果存款人和借款人在短期内看到无盈利，而长期则能获得盈亏，他们会表现出一定程度的粘性。探索是关系银行家常见的行动，他们看重关系的长期盈利能力。'
- en: Deep learning
  id: totrans-75
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 深度学习
- en: With each of the models or techniques that we are learning, the complexity increases.
    In this example, we will assume that there will be 36 variables/features in the
    input layer. There will be two variables/features in the output layer – one for
    profitability and one for the self-funding status. There will be two hidden layers
    in-between the input and output layers – one next to the input layer with 10 neurons,
    followed by another layer with 15 neurons. This example will form a neural network
    that makes general pricing decisions for banks.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 随着我们学习的每个模型或技术的复杂性不断增加。在这个例子中，我们假设输入层有36个变量/特征。输出层将有两个变量/特征——一个用于盈利能力，另一个用于自筹资金状态。在输入层和输出层之间将有两个隐藏层——一个紧接着输入层，有10个神经元，另一个层有15个神经元。这个例子将形成一个神经网络，用于为银行做出一般的定价决策。
- en: To estimate the profitability and self-funding status of the neural network,
    there are 127 variables in the input layer, three hidden layers each with 15 neurons,
    and one output layer with one output neuron to generate profitability (cumulative
    profit and loss for the day) or the percentage of client deposit to client loan.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 要估算神经网络的盈利能力和自筹资金状态，输入层有127个变量，三个隐藏层每个层有15个神经元，输出层有一个输出神经元，用于生成盈利能力（当天的累计盈亏）或客户存款与客户贷款的比例。
- en: In comparison to the logistic regression model, the input features are much
    more complex in the case of deep learning and the number of parameters involved
    is in the magnitude of 10 times more or above.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 相比于逻辑回归模型，深度学习中的输入特征要复杂得多，涉及的参数数量大约是逻辑回归模型的10倍或更多。
- en: 'The following table shows a summary of the pricing model:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格展示了定价模型的总结：
- en: '| **Layer** | **Shape** | **No of parameters** |'
  id: totrans-80
  prefs: []
  type: TYPE_TB
  zh: '| **层** | **形状** | **参数数量** |'
- en: '| Input | (1, 36) | 0 |'
  id: totrans-81
  prefs: []
  type: TYPE_TB
  zh: '| 输入层 | (1, 36) | 0 |'
- en: '| Hidden 1 | (1, 10) | 370 |'
  id: totrans-82
  prefs: []
  type: TYPE_TB
  zh: '| 隐藏层 1 | (1, 10) | 370 |'
- en: '| Hidden 2 | (1, 15) | 165 |'
  id: totrans-83
  prefs: []
  type: TYPE_TB
  zh: '| 隐藏层 2 | (1, 15) | 165 |'
- en: '| Hidden 3 | (1, 15) | 240 |'
  id: totrans-84
  prefs: []
  type: TYPE_TB
  zh: '| 隐藏层 3 | (1, 15) | 240 |'
- en: '| **Total parameters** | **775** |'
  id: totrans-85
  prefs: []
  type: TYPE_TB
  zh: '| **总参数数量** | **775** |'
- en: In the preceding table, the first column lists which layer it is – input or
    hidden. The second column represents the shape of the layer in terms of the number
    of parameters connected from the previous layer to the current layer.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的表格中，第一列列出了是哪一层——输入层还是隐藏层。第二列表示该层的形状，即从上一层到当前层的参数数量。
- en: To calculate the number of parameters, let's consider the **Hidden 1** layer.
    In this case, 36 features from the previous layer connect to 10 neurons in the
    current layer. We also need constants equal to the number of features in the current
    layer to achieve scaling across features. So, the total parameters come to 36*10
    + 10 = 370 parameters in the **Hidden 1** layer.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 要计算参数的数量，我们来考虑**隐藏层 1**。在这种情况下，上一层的36个特征连接到当前层的10个神经元。我们还需要与当前层特征数量相等的常数，以实现跨特征的缩放。因此，**隐藏层
    1**的总参数数量是36*10 + 10 = 370个参数。
- en: Knowing how to count the parameters helps us see whether the amount of training
    data is sufficient enough to train the network. It is strongly suggested that
    we ensure that the number of parameters is at least equal to *number of records*
    * *number of epochs*. Think of how many formulas will be required to determine
    a problem with two variables – at least two. The formula is like training data
    in deep learning, while the variables are like the parameters of the network.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 知道如何计算参数有助于我们了解训练数据是否足够充足以训练网络。强烈建议确保参数数量至少等于 *记录数* * *训练轮数*。想一想，解决两个变量问题需要多少个公式
    – 至少需要两个。公式就像是深度学习中的训练数据，而变量就像是网络的参数。
- en: Metrics of model performance
  id: totrans-89
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 模型性能的度量标准
- en: When we build an AI model, the most important aspect of the process is to define
    a way to measure the performance of a model. This enables the data scientist to
    decide how to improve and pick the best model.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们构建一个 AI 模型时，最重要的步骤之一就是定义一种衡量模型性能的方法。这使得数据科学家能够决定如何改进并选择最佳模型。
- en: In this section, we will learn about three common metrics that are commonly
    used in the industry to assess the performance of the AI model.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将学习三种常见的度量标准，这些标准在工业界通常用于评估 AI 模型的性能。
- en: Metric 1 – ROC curve
  id: totrans-92
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 度量标准 1 – ROC 曲线
- en: The **Receiver Operating Characteristic** (**ROC**) metric measures how well
    the classifier performs its classification job versus a randomized classifier.
    The classifier that's used in this metric is a binary classifier. The binary classifier
    classifies the given set of data into two groups on the basis of a predefined
    classification rule.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '**接收者操作特征** (**ROC**) 度量标准衡量分类器在执行分类任务时，与随机分类器相比的表现。该度量标准使用的分类器是二元分类器。二元分类器根据预定义的分类规则将给定的数据集分为两组。'
- en: This is linked to a situation where, say, we compare this model against flipping
    a fair coin to classify the company as being default or non-default, with heads
    indicating default and tails indicating non-default. Here, there's a 50% chance
    of classifying default and a 50% chance of classifying non-default.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 这与以下情况相关，比如我们将这个模型与抛硬币进行比较，用来分类公司是否违约或非违约，正面表示违约，反面表示非违约。在这种情况下，违约和非违约的分类概率各为
    50%。
- en: For a completely randomized predictive system such as coin flipping, it is very
    likely that the probability of hitting a true positive is the same as hitting
    a false positive rate. But in the case of companies defaulting in 1 year, in the
    following example, it is 6.3% (123 out of 1,828), which means we have an actual
    count of 1,828 non-default cases and 123 default cases. A truly random model will
    predict half of the default cases as non-default.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 对于一个完全随机的预测系统，比如抛硬币，真正率和假正率的概率很可能是相同的。但是在如公司一年内违约的案例中，例如以下例子，违约率为 6.3%（1,828
    中的 123），这意味着我们实际有 1,828 个非违约案例和 123 个违约案例。一个完全随机的模型将会把一半的违约案例预测为非违约。
- en: Let's plot a chart that shows the true positive and false positive rate as an
    ROC chart. True or false means the prediction that was made for the default event
    is factually true or false. Positive means that the classifier is positive (equals
    1, which is default, in this case).
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们绘制一个图表，展示 ROC 图表中的真正率和假正率。真正和假定意味着针对默认事件所做的预测是否事实正确。正意味着分类器为正（在此情况下等于 1，即默认值）。
- en: When we make no prediction, the true positive and false positive rate is 0\.
    When we have gone through 50% of the sample, which is given as 1,951/2, we should
    be getting 50% of the sample by default, where 50% of the guesses are false positive.
    When we get to 100% of the sample, we should have 100% of the sample as true positive
    and 100% as false positive.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们没有进行预测时，真正率和假正率都是 0。当我们完成样本的 50% 时，假设为 1,951/2，我们默认会得到 50% 的样本，其中 50% 的猜测为假正。当我们到达
    100% 样本时，我们应该得到 100% 的样本作为真正，100% 作为假正。
- en: 'This randomized classifier''s performance is denoted by the dotted line in
    this diagram:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 该随机分类器的性能由图中的虚线表示：
- en: '![](img/17680b0a-71e6-4d56-a749-03dcb6b3a1f0.png)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![](img/17680b0a-71e6-4d56-a749-03dcb6b3a1f0.png)'
- en: In the most ideal classifier case, we should be able to improve the true positive
    rate to 100%, with the false positive rate at 0% (denoted by the yellow line in
    the preceding diagram).
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 在最理想的分类器情况下，我们应该能够将真正率提高到 100%，并将假正率降到 0%（由前面图中的黄色线表示）。
- en: For the worst classifier, which classifies everything as 100% incorrect, the
    true positive rate should be 0% and the false positive rate should be 100% (denoted
    by the red dot). The use of ROC is also prevalent in credit risk model validation.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 对于最差的分类器（将所有情况都分类为100%错误），真实正例率应为0%，假正例率应为100%（由红点表示）。ROC曲线的使用在信用风险模型验证中也很常见。
- en: Metric 2 – confusion matrix
  id: totrans-102
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 指标2 – 混淆矩阵
- en: 'The confusion matrix is the most popular metric used to measure the performance
    of a classifier and has two outcomes:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 混淆矩阵是衡量分类器性能的最常用指标，具有两种结果：
- en: '|  |  | **Actual: Ground Truth** |'
  id: totrans-104
  prefs: []
  type: TYPE_TB
  zh: '|  |  | **实际情况：真实值** |'
- en: '|  |  | True Default | False/Non-default |'
  id: totrans-105
  prefs: []
  type: TYPE_TB
  zh: '|  |  | 真实违约 | 假负例/非违约 |'
- en: '| **Prediction by Classifier** | Positive/Default | 62 | 27 |'
  id: totrans-106
  prefs: []
  type: TYPE_TB
  zh: '| **分类器预测** | 正例/违约 | 62 | 27 |'
- en: '| Negative/Non-default | 61 | 1,801 |'
  id: totrans-107
  prefs: []
  type: TYPE_TB
  zh: '| 非违约/负面 | 61 | 1,801 |'
- en: '|  |  | True Positive Rate = 62/(62+61) | False Positive Rate = 27/(27+1,801)
    |'
  id: totrans-108
  prefs: []
  type: TYPE_TB
  zh: '|  |  | 真实正例率 = 62/(62+61) | 假正例率 = 27/(27+1,801) |'
- en: The confusion matrix also provides results similar to the ROC curve. The major
    idea behind this is to separate prediction and the ground truth by rows and columns.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 混淆矩阵还提供了类似于ROC曲线的结果。其主要思想是通过行和列将预测结果与实际真值区分开。
- en: Metric 3 – classification report
  id: totrans-110
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 指标3 – 分类报告
- en: 'The classification report is another way to appraise the performance of the
    model, with the following indicators:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 分类报告是另一种评估模型性能的方式，包含以下指标：
- en: '![](img/239d7cff-13cb-44bb-bc07-04f493ccef0c.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![](img/239d7cff-13cb-44bb-bc07-04f493ccef0c.png)'
- en: 'The details of the indicators are as follows:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 指标的详细信息如下：
- en: '**Precision and recall:** Precision addresses the true positive rate of the
    model prediction, while recall addresses the coverage of the model. Precision
    measures the percentage of the predicted value being the predicted value. Recall
    measures the percentage of the target values being predicted as the expected values.'
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**精度和召回率**：精度衡量模型预测的真实正例率，而召回率衡量模型的覆盖率。精度表示预测值为正确值的百分比。召回率表示目标值被预测为期望值的百分比。'
- en: '**F1-score**: One of the most important measures of the overall accuracy of
    the model is the F1-score. It is the harmonic mean of precision and recall. This
    is what we use to compare the performance of models.'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**F1-score**：F1-score是评估模型整体准确性的重要指标之一。它是精度和召回率的调和均值。这是我们用来比较模型性能的标准。'
- en: '**Support**: This is another term that means the number of records that are
    of the value listed in the leftmost column. There are 123 actual default cases
    (with target *value = 1* under the *default* column).'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Support**：这是另一个术语，表示在最左列中列出的值所对应的记录数量。这里有123个实际违约案例（在*default*列下目标值为*value
    = 1*）。'
- en: Building a bankruptcy risk prediction model
  id: totrans-117
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 构建破产风险预测模型
- en: The bank, as the lender, needs to dictate the interest rates that will cover
    the cost of lending. The bank provides the interest rate by considering its cost
    of borrowing from others, plus the risk that the company might file for bankruptcy
    after taking the loan from the bank.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 银行作为贷款方，需要确定能够覆盖借款成本的利率。银行通过考虑向其他机构借款的成本，以及公司从银行借款后可能申请破产的风险来确定利率。
- en: In this example, we shall assume the role of a banker to assess the probability
    of the borrowers becoming bankrupt. The data for this has been obtained from data.world
    ([https://data.world](https://data.world)), which provides us with the data for
    the bankruptcy predictions for different companies. The data available at this
    link was collected from the **Emerging Markets Information Services** (**EMIS**).
    The EMIS database has information about the emerging markets in the world.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们假设自己是一个银行家，用来评估借款人破产的可能性。数据来源于data.world（[https://data.world](https://data.world)），提供了不同公司破产预测的数据。该链接中的数据来自于**新兴市场信息服务**（**EMIS**）。EMIS数据库包含了关于全球新兴市场的信息。
- en: EMIS analyzed bankrupt companies for the period 2000-2012 and operating companies
    for the period 2007-2013\. After the data was collected, five classifications
    were made based on the forecasting period. The first year class is the data that
    contains the financial rates from the year of the forecasting period. Another
    class label shows what the bankruptcy status would be after 5 years.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: EMIS分析了2000年至2012年期间的破产公司和2007年至2013年期间的运营公司。在数据收集后，基于预测期对数据进行了五类分类。第一类是包含预测期内财务数据的年份数据。另一类标签显示5年后破产状态的预测。
- en: Obtaining the data
  id: totrans-121
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 获取数据
- en: 'We are going to use an open source program for data conversion, followed by
    another program to train a model from the data downloaded:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用一个开源程序进行数据转换，然后使用另一个程序基于下载的数据训练模型：
- en: We begin by obtaining the data that has been downloaded from a new data source.
    However, it is downloaded via a browser, and not via a data feed. Files ending
    with `.arff` will be obtained from data.world. The URL for this is [https://data.world/uci/polish-companies-bankruptcy-data](https://data.world/uci/polish-companies-bankruptcy-data).
    Usually, we can use 1-year bankruptcy data as the model predicts bankruptcy within
    1 year. For the sake of our example, we will use a dataset containing 5 years'
    worth of data.
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们首先获得从新数据源下载的数据。然而，这些数据是通过浏览器下载的，而不是通过数据流获取的。以`.arff`结尾的文件将从data.world获得。其网址为[https://data.world/uci/polish-companies-bankruptcy-data](https://data.world/uci/polish-companies-bankruptcy-data)。通常，我们可以使用1年的破产数据，因为模型预测的是1年内的破产情况。为了举例说明，我们将使用一个包含5年数据的数据集。
- en: We will then preprocess the data, as well as performing feature engineering
    by extraction, transformation, and loading. In this case, the file that will be
    downloaded from data.world is in `.arff` file format, which can't be read easily
    by Python. The code that can be used to convert the file type can be found on
    GitHub ([https://github.com/jeffreynghm/AIFinance_Packt](https://github.com/jeffreynghm/AIFinance_Packt)).
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们将对数据进行预处理，并通过提取、转换和加载进行特征工程。在这种情况下，从data.world下载的文件为`.arff`文件格式，Python无法直接读取。用于转换文件格式的代码可以在GitHub上找到([https://github.com/jeffreynghm/AIFinance_Packt](https://github.com/jeffreynghm/AIFinance_Packt))。
- en: Building the model
  id: totrans-125
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 构建模型
- en: 'In this example, we will try out three types of models: logistic regression,
    decision tree, and neural network.'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个示例中，我们将尝试三种模型：逻辑回归、决策树和神经网络。
- en: Before the computing power becomes readily available, it is quite common to
    choose the model according to the problem we are trying to solve, as well as what
    answers we need from the machine. However, nowadays, we tend to try out all possible
    models and pick the best model that delivers the best performance.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 在计算能力尚未普及之前，通常会根据我们试图解决的问题以及机器需要提供的答案来选择模型。然而，如今，我们倾向于尝试所有可能的模型，并选择性能最佳的模型。
- en: In this case, we can label it as something we want to predict. The target behavior
    that we wish to predict is the company default—this is called a target variable
    in the machine learning world. We will establish how accurate the model is at
    predicting the target variable when given the input data by deploying common metrics
    to compare performance across different models.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，我们可以将其标记为我们想要预测的内容。我们希望预测的目标行为是公司违约——在机器学习领域，这称为目标变量。我们将通过使用常见的评估指标，比较不同模型的性能，来评估模型在给定输入数据时预测目标变量的准确性。
- en: 'In this example, we will need the following libraries:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 在本示例中，我们将需要以下库：
- en: '`os`: For file path manipulation.'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`os`：用于文件路径操作。'
- en: '`re`: Regular expression for matching column headers.'
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`re`：用于匹配列头的正则表达式。'
- en: '`pandas`: DataFrame to keep the data.'
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pandas`：用于保存数据的DataFrame。'
- en: '`matplotlib.pyplot`: For plotting the model''s result to showcase its accuracy.'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`matplotlib.pyplot`：用于绘制模型结果，展示其准确性。'
- en: '`seaborn`: A beautiful visualization tool for data analysis.'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`seaborn`：一个美观的数据分析可视化工具。'
- en: '`sklearn`: A machine learning library, including very strong data preparation
    for splitting, training, and testing sets, rescaling the data values to feed to
    the neural network, handling missing values or value abnormality, and so on.'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sklearn`：一个机器学习库，包含强大的数据准备功能，用于拆分、训练和测试数据集、重新缩放数据值以供神经网络使用、处理缺失值或异常值等。'
- en: '`pickle`: The file format that''s used to save the model generated from the
    machine learning process.'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pickle`：用于保存机器学习过程生成的模型的文件格式。'
- en: '`graphviz`: Used to visualize the decision tree.'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`graphviz`：用于可视化决策树。'
- en: 'The steps are as follows:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 步骤如下：
- en: 'Import all the relevant libraries using the following code:'
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下代码导入所有相关库：
- en: '[PRE0]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: For logistic regression, when it comes to deciding which features are to be
    chosen, we will rely on testing the accuracy of different features. The combination
    that delivers the highest accuracy will be chosen.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 对于逻辑回归，决定选择哪些特征时，我们将依赖于测试不同特征的准确性。提供最高准确性的组合将被选中。
- en: 'Define the `optimize_RFE()` function, which will perform the feature selection
    process. This function will try out different combinations of features that give
    the highest true positive and the lowest possible false positive. We will measure
    the performance in order to decide on the number of features that generate the
    best performance. The following is the code for the function definitions:'
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义`optimize_RFE()`函数，它将执行特征选择过程。该函数将尝试不同的特征组合，选择出能给出最高真正例和最低假正例的组合。我们将通过衡量性能来决定生成最佳性能的特征数量。以下是该函数定义的代码：
- en: '[PRE1]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Besides a logic regression model, we will also build a decision tree. Feature
    selection will be performed by the algorithm at the time of training. Therefore,
    unlike the logistic regression model, we do not need to limit the number of features
    that are provided as input to the training process:'
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 除了逻辑回归模型外，我们还将构建一个决策树。特征选择将在训练时由算法执行。因此，与逻辑回归模型不同，我们不需要限制作为输入提供给训练过程的特征数量：
- en: '[PRE2]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Lastly, we will add a neural network into the mix of models. It is similar
    to the decision tree. Feature selection will be performed by the algorithm at
    training time. However, it is important to perform a grid search for hyperparameter
    tuning. The hyperparameters that we are searching for belong to the neural network
    architecture; that is, how many layers we need to build to deliver the maximum
    performance. The following code is used to train the logistic regression model:'
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，我们将在模型中加入一个神经网络。它与决策树类似。特征选择将在训练时由算法执行。然而，进行超参数调优时，执行网格搜索是很重要的。我们正在寻找的超参数属于神经网络的架构，即我们需要构建多少层以实现最佳性能。以下代码用于训练逻辑回归模型：
- en: '[PRE3]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: For all the models listed in this chapter, we also need to measure the accuracy.
    We are going to use two different approaches to measure accuracy. Various metrics
    are used in this classification problem. However, we need to be certain when it
    comes to building a machine learning model that classifies a company as default
    or non-default.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 对于本章中列出的所有模型，我们还需要衡量其准确性。我们将使用两种不同的方法来衡量准确性。在这个分类问题中，使用了各种度量指标。然而，当构建一个机器学习模型来判断一家公司是否违约时，我们需要确保其准确性。
- en: 'After defining these functions, we use the following code sample to actually
    call the function. All three models are built one by one. The results are stored
    in `f1_list` so that they can be printed out later:'
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在定义了这些函数之后，我们使用以下代码示例来实际调用函数。所有三个模型将依次构建。结果将存储在`f1_list`中，以便稍后打印出来：
- en: '[PRE4]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Visualize the performance of each model using the following code:'
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下代码可视化每个模型的性能：
- en: '[PRE5]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Use the following code sample to visualize the model:'
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下代码示例来可视化模型：
- en: '[PRE6]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: In the next section, we will use reinforcement learning to decide whether the
    loan to the customer shall be funded or not.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将使用强化学习来决定是否向客户提供贷款。
- en: Funding a loan using reinforcement learning
  id: totrans-156
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用强化学习进行贷款资金的提供
- en: Assuming that our role is the head of the bank, it becomes important to figure
    out the cost of funding the loan. The problem we are solving is comprised of three
    parties (or as we call them, **agents**)—the bank, depositors, and borrowers.
    To begin with, we assume that there is only one bank but many depositors and borrowers.
    The depositors and borrowers will be created through randomized generated data.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们的角色是银行的负责人，那么确定贷款资金的成本变得非常重要。我们要解决的问题涉及三个方（或者我们称之为**代理人**）——银行、存款人和借款人。首先，我们假设只有一个银行，但有许多存款人和借款人。存款人和借款人将通过随机生成的数据创建。
- en: When it comes to simulating different behaviors for these parties in machine
    learning, each of these is called an agent or an instance of an object. We need
    to create thousands of agents, with some being depositors, some being borrowers,
    one being a bank, and one being a market. These represent the collective behavior
    of competing banks. Next, we will describe the behavior of each type of agent.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 在模拟机器学习中这些方的不同行为时，每个方都被称为一个代理人或一个对象实例。我们需要创建成千上万的代理人，其中一些是存款人，一些是借款人，一个是银行，一个是市场。这些代理人代表了竞争银行的集体行为。接下来，我们将描述每种代理人类型的行为。
- en: Let's say we assume the role of treasurer of the bank or head of the treasury.
    The job of the head of the treasury is to quote the risk-free funding cost. The
    banker dealing with the customer will take the cost of funding and add the credit
    risk premium to make up the total cost of financing. Any extra margin higher than
    this total cost of financing shall be the net contribution of the banker. But
    when it comes to reporting on financial statements, actual interest income from
    the client will net off the net interest cost paid to by depositor or borrower
    to the bank.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们扮演银行财务主管或财务部门负责人的角色。财务部门负责人的工作是报价无风险融资成本。与客户打交道的银行人员会把融资成本加上信用风险溢价，形成总融资成本。任何高于这个总融资成本的额外利润，都是银行人员的净贡献。但在财务报表中，来自客户的实际利息收入将会抵消存款人或借款人支付给银行的净利息成本。
- en: What we want to produce is loan and deposit pricings for each maturity (1 day,
    2 days, and so on) before the bank opens for business. There is no such dataset
    in the public domain. Therefore, we will simulate the data. Maturity, amount of
    loan or deposit, starting date, and interest rate will all be simulated.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 我们希望生成的是每个到期日（1天、2天等）之前的贷款和存款定价，在银行开门营业之前。公共领域没有这样的数据集。因此，我们将模拟这些数据。到期日、贷款或存款金额、起始日期和利率都会被模拟出来。
- en: Understanding the stakeholders
  id: totrans-161
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解利益相关者
- en: While defining the solution using AI modeling, we usually simulate the behavior
    of the entities involved. It becomes critical for us to understand the behavior
    of stakeholders first. For the sake of this example, we must understand the behavioral
    aspects of three entities – the bank, the depositor, and the borrower.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用人工智能建模定义解决方案时，我们通常会模拟参与实体的行为。首先理解利益相关者的行为变得至关重要。为了这个例子，我们需要了解三个实体的行为方面——银行、存款人和借款人。
- en: 'A bank has two objectives:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 一家银行有两个目标：
- en: Generate the pricing grid for the deposit and the loan.
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 生成存款和贷款的定价表格。
- en: Calculate its profit/loss, as well as its self-funding status at any point in
    time.
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 计算其利润/亏损，并在任何时刻评估其自筹资金的状况。
- en: The pricing grid for the deposit and the loan is assumed to be priced at a different
    maturity.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 存款和贷款的定价表格假设在不同的到期日进行定价。
- en: In this example, reinforcement learning has been introduced to update the pricing,
    as well as to take on feedback by considering the impact of recent actions on
    the profit and loss and asset and liability ratios. Depositors are assumed to
    have varying expectations for the deposit interest as and when the deposit matures.
    At the end of the day, we assume the depositor is claiming their own interest
    income, along with the amount of deposit reported in the bank's account.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，引入了强化学习来更新定价，并通过考虑近期行为对盈亏、资产和负债比例的影响来进行反馈。假设存款人对存款利息的预期会随着存款到期而变化。到最后，我们假设存款人会领取他们的利息收入，并且银行账户中报告的存款金额也会随之变动。
- en: During the day before the market opens and on the maturity date of the deposit,
    the depositor will consider whether they want to stay or withdraw the deposit.
    At this point, we simulate the decision by randomizing the decision by generating
    a % chance of expected interest. There is a 50% chance of expectation for interest
    increasing and a 50% demand for the interest reducing. This expectation will then
    be compared against the bank's offer rate at that specific maturity. If the bank
    meets this expectation, then the deposit will stay; otherwise, the deposit will
    leave the bank for the same maturity period.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 在市场开盘前的当天以及存款到期日，存款人会考虑是否继续存款或提取存款。此时，我们通过随机化决策来模拟这一行为，生成期望利息的百分比概率。有50%的概率期望利息增加，50%的概率期望利息减少。然后，这一预期将与银行在特定到期日的报价进行比较。如果银行满足这一预期，那么存款将继续留存；否则，存款将在相同的到期期内离开银行。
- en: 'With regard to how the interest rate expectation changes, there are two variations
    used for depositors: one is completely linear, while the other follows a normal
    distribution. If the deposit leaves the bank, we assume that the same amount of
    deposit will be placed in another bank. So, on the maturity date of the deposit
    in the other bank, the depositors will set their expectations and evaluate whether
    to stay or go back to the original bank.'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 关于利率预期如何变化，存款人使用了两种不同的变化方式：一种是完全线性的，另一种则是符合正态分布的。如果存款离开了银行，我们假设相同金额的存款将被存入另一家银行。因此，在另一家银行存款到期时，存款人会设定他们的预期，并评估是继续留在该银行还是返回原银行。
- en: For the borrower, the behavior is assumed to be the same as the depositors',
    with the same day-end accrual activities. However, during the day, borrowers whose
    loans mature on the same day will reconsider their intention to stay or not. This
    is represented by the interest rate expectation and the exact method of simulation
    is the same as depositors'—but with the difference that the loan offered by the
    bank has to be lower than the expected pricing of the borrowers for it to stay
    for refinancing.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 对于借款人，假设其行为与存款人相同，具有相同的日终应计活动。然而，在一天之内，贷款到期的借款人会重新考虑是否留下。这通过利率预期来表示，模拟的具体方法与存款人的相同——但不同之处在于，银行提供的贷款必须低于借款人预期的定价，借款人才能选择留下并进行再融资。
- en: Arriving at the solution
  id: totrans-171
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 得出解决方案
- en: 'The following are the steps for creating the borrowers and depositors to close
    the bank''s book on a daily basis:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是创建借款人和存款人以便银行每天结账的步骤：
- en: 'First, we need to import the data from the list of loans and deposits to generate
    a list of borrowers and depositors. In this step, scenarios are loaded from a
    spreadsheet to simulate the borrowers and depositors that come in on different
    days. The following code sample shows the function definition for generating the
    list of borrowers and depositors:'
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们需要从贷款和存款列表中导入数据，以生成借款人和存款人的列表。在这一步中，从电子表格加载场景，以模拟不同天数的借款人和存款人。以下代码示例展示了生成借款人和存款人列表的函数定义：
- en: '[PRE7]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'At the beginning of each iteration (except the first day of business), the
    market pricing is provided and the bank needs to provide pricing as well. We generate
    a fixed amount of simulation (1,000 times). In each simulation, we assume a period
    of 10 years (3,650 days = 365days/year x 10 years). On any given day, depositors
    and borrowers set their expectations by referencing the market rate. When we begin
    the first day of each simulation, depositors and borrowers are created from the
    list of deposits and loans. The following code runs 1,000 simulations:'
  id: totrans-175
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在每次迭代的开始（除了营业的第一天），会提供市场定价，银行也需要提供定价。我们生成一定数量的模拟（1,000次）。在每次模拟中，我们假设一个10年的周期（3,650天
    = 365天/年 × 10年）。在任何给定的日子，存款人和借款人通过参考市场利率来设定他们的预期。当我们开始每次模拟的第一天时，存款人和借款人会从存款和贷款列表中创建。以下代码运行1,000次模拟：
- en: '[PRE8]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Executing the preceding code will create an object of the bank. At that time,
    two neural networks are initialized inside the bank – one for the deposit pricing
    and one for the loan pricing. The same thing is done for the bank called **market**.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 执行上述代码将创建银行对象。此时，银行内部会初始化两个神经网络——一个用于存款定价，另一个用于贷款定价。对于名为**market**的银行也执行相同的操作。
- en: Market pricing is randomized based on the initial pricing input into the market
    by Monte Carlo simulation. Based on the market pricing, borrowers and depositors
    set their expectations by referencing the market pricing, along with the tendency
    to attribute. After setting their expectations, two variations of the deposit
    pricing and loan pricing grids are generated.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 市场定价基于蒙特卡洛模拟初始定价的输入随机化。根据市场定价，借款人和存款人通过参考市场定价以及归因倾向来设定他们的预期。在设定预期之后，生成两种存款定价和贷款定价网格的变化。
- en: 'Deposit pricing and loan pricing are generated by two neural networks and Monte
    Carlo simulations. The neural network dictates the required grid movement for
    the loan and deposit pricing grids. However, the `bank` object also generates
    randomized pricing based on the pricing generated by the neural network. The following
    code is used to build the model:'
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 存款定价和贷款定价是通过两个神经网络和蒙特卡洛模拟生成的。神经网络决定了贷款和存款定价网格所需的网格移动。然而，`bank`对象还会基于神经网络生成的定价生成随机定价。以下代码用于构建模型：
- en: '[PRE9]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: With this, the environment has been created. Here, the environment object contains
    the neural network model that provides the reward estimation for the given pricing
    grids (loan and deposit), as well as external environments such as market pricing,
    maturing borrowers, and depositors.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 这样，环境就已创建。在这里，环境对象包含提供给定定价网格（贷款和存款）回报估计的神经网络模型，以及市场定价、到期的借款人和存款人等外部环境。
- en: 'Generate a pricing grid for the day:'
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 生成当天的定价网格：
- en: '[PRE10]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: The pricing model of the bank is based on the machine learning model. The market
    is based on the randomized process referencing the initial values we hardcoded. At
    the same time, the maturity profile (loan and deposit maturing today) will be
    calculated and the customers' expectation for pricing is established. This expectation
    is based on market pricing and the internal demand randomized by the helper function
    defined.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 银行的定价模型基于机器学习模型。市场是基于随机化过程，参考我们硬编码的初始值。同时，将计算到期概况（今天到期的贷款和存款），并建立客户对定价的期望。这一期望基于市场定价以及由定义的辅助函数随机化的内部需求。
- en: 'Generate the list of possible pricings, predict the reward, and pick the best
    pricing. This step is called **action** in the reinforcement learning domain.
    Action is the act of quoting prices to customers and market peers. Based on the
    pricing generated in the previous step, we create a lot more variations (20, in
    our case) with a randomized process:'
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 生成可能的定价列表，预测回报，并选择最佳定价。此步骤在强化学习领域中被称为**行动**。行动是向客户和市场同行报价的行为。根据上一步生成的定价，我们创建更多的变体（在我们的案例中是20个），通过随机化过程：
- en: '[PRE11]'
  id: totrans-186
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Using the environment object's machine learning model, we can predict the outcome
    of each of the variations and choose the best variation to maximize the profitability,
    satisfying the funding requirements with the deposit.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 使用环境对象的机器学习模型，我们可以预测每个变体的结果，并选择最佳变体，以最大化盈利性，满足存款的资金需求。
- en: 'Execute the pricing grid. Income and expenses are generated based on the chosen
    pricing grid that generates the maximum estimated net profit while meeting the
    self-funding balance objective. Once the bank''s pricing grid has been chosen,
    it is executed with the maturing borrowers and depositors. Some will stay and
    some will leave the bank:'
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行定价网格。收入和支出根据所选的定价网格生成，该网格在满足自筹资金平衡目标的同时，生成最大估计净利润。一旦选择了银行的定价网格，就会与到期的借款人和存款人一起执行。有些人会留在银行，有些人则会离开：
- en: '[PRE12]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: At the end of the day, interest will be accrued for those who stay with the
    bank and will be updated in the bank's accounting book (variables in the `bank`
    object). The daily position is also output to the log file.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 在一天结束时，对于那些继续留在银行的客户，将会累计利息，并更新在银行的会计账簿中（`bank`对象中的变量）。当天的仓位也会输出到日志文件中。
- en: The winning combination will be fed to the model for further reinforcement learning
    both for the bank and the environment. The feedback will contain the actual P&L
    for the bank for both deposit and loan grid pricing; for the environment, the
    actual profitability and self-funding status will be fed back to the reward model.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 胜出的组合将被送入模型进行进一步的强化学习，既适用于银行，也适用于环境。反馈将包含银行的实际损益（P&L），包括存款和贷款网格定价；对于环境来说，将反馈实际的盈利性和自筹资金状态到回报模型。
- en: The actual P&L and self-funding statuses are provided as feedback to the `environment`
    object and `bank` object in order to predict the reward and pricing more accurately.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 实际的损益和自筹资金状态将作为反馈提供给`environment`对象和`bank`对象，以便更准确地预测回报和定价。
- en: 'After each simulation, the results are saved in an output file and we get to
    monitor the progress of reinforcement learning. At the end of each simulation,
    the last day''s snapshot result is output. Use the following code to generate
    the output:'
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 每次模拟后，结果会保存在输出文件中，我们可以监控强化学习的进展。在每次模拟结束时，会输出最后一天的快照结果。使用以下代码生成输出：
- en: '[PRE13]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Each bar on the *x* axis represents the average P&L of 10 simulations. The P&L
    of the simulation peaked at the eighth bar. By performing a detailed analysis
    of each simulation result in the log file, we can see that the improvement of
    P&L stopped at the eighty-seventh simulation since P&L plateaued and stabilized
    at the eightieth plus simulation. With further training, the P&L dropped, thus
    showing signs of over-training.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: '*x*轴上的每一条柱形代表10次模拟的平均盈亏。模拟的盈亏在第八条柱形时达到了峰值。通过对日志文件中每次模拟结果的详细分析，我们可以看到，从第八十七次模拟开始，盈亏的改善停止了，因为盈亏在第八十次及以后趋于平稳和稳定。随着进一步的训练，盈亏下降，显示出过度训练的迹象。'
- en: Summary
  id: totrans-196
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we learned about different AI modeling techniques through two
    examples—the first with regard to predicting the chances of the borrower going
    bankrupt and the other with regard to figuring out the funding for the loan. We
    also learned about reinforcement learning in this chapter. Other artificial intelligence
    techniques, including deep learning, neural networks, the logistic regression
    model, decision trees, and Monte Carlo simulation were also covered. We also learned
    about the business functions of the bank in the context of the examples provided
    in this chapter.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一章中，我们通过两个例子了解了不同的人工智能建模技术——第一个例子是预测借款人破产的几率，另一个是确定贷款资金的来源。我们还在这一章中学习了强化学习。其他人工智能技术，包括深度学习、神经网络、逻辑回归模型、决策树和蒙特卡洛模拟也被涵盖在内。我们还在本章提供的例子背景下了解了银行的业务职能。
- en: In the next chapter, we will continue to learn about more AI modeling techniques.
    We will learn about the linear optimization and linear regression models and use
    them to solve problems regarding investment banking. We will also learn how AI
    techniques can become instrumental in mechanizing capital market decisions.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将继续学习更多的人工智能建模技术。我们将学习线性优化和线性回归模型，并运用这些模型解决投资银行领域的问题。我们还将学习人工智能技术如何在资本市场决策的机械化中发挥重要作用。
