- en: TD Learning in Healthcare
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 医疗领域中的TD学习
- en: Artificial intelligence and medicine—two worlds that have decidedly distant
    origins, but which have already started a close relationship of collaboration,
    with the fundamental objective of improving the health and life expectancy of
    the world population. This is a relationship that is destined to be further strengthened
    over the next few decades, especially since the challenges facing medicine in
    the 21^(st) century are extremely demanding. In this chapter, we will address
    some of these problems with reinforcement learning. We will learn how to use reinforcement
    learning in healthcare. Then, we will learn how to model healthcare insurance
    as a Markov decision process. Finally, we will understand how to plan sanitation
    in operating rooms using TD learning.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 人工智能与医学——这两个领域虽然有着截然不同的起源，但它们已经开始建立起紧密的合作关系，基本目标是提高全球人口的健康水平和预期寿命。这种关系将在未来几十年内进一步加强，尤其是在21世纪医学面临的挑战极为严峻的背景下。在本章中，我们将通过强化学习来解决其中的一些问题。我们将学习如何在医疗领域应用强化学习。接着，我们将学习如何将医疗保险建模为马尔可夫决策过程。最后，我们将了解如何利用TD学习规划手术室卫生安排。
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将讨论以下主题：
- en: Introducing reinforcement learning in healthcare
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在医疗领域引入强化学习
- en: Modeling healthcare insurance plans
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 医疗保险计划建模
- en: Using the transition model in health insurance
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在健康保险中使用转移模型
- en: Operating room sanitation scheduling
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 手术室卫生安排
- en: Technical requirements
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'Check out the following video to see the Code in Action:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 请查看以下视频，观看代码示范：
- en: '[http://bit.ly/2PE4NHe](http://bit.ly/2PE4NHe)'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://bit.ly/2PE4NHe](http://bit.ly/2PE4NHe)'
- en: Introducing reinforcement learning in healthcare
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在医疗领域引入强化学习
- en: In recent years, enormous attention to artificial intelligence has been paid
    by the healthcare world—in fact, we have observed the collaboration between Google's
    DeepMind project and the United Kingdom's National Health Service, as well as
    IBM's continuous investments in the areas of genomics and drug discovery through
    the assistance of articular intelligence.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 近年来，医疗行业对人工智能的关注巨大——事实上，我们已经观察到谷歌的DeepMind项目与英国国家医疗服务体系（NHS）的合作，以及IBM通过人工智能在基因组学和药物发现领域的持续投资。
- en: Many ask themselves what concrete improvements can be brought by the innovations
    introduced by machine learning in healthcare to patients' lives. In the span of
    5-10 years, it is believed that healthcare will be totally revolutionized. Will
    executives, doctors, nurses, and others be prepared for this new challenge?
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 很多人会问，机器学习在医疗领域带来的创新能够为患者的生活带来哪些具体的改善。在5到10年的时间里，人们普遍认为医疗行业将会发生彻底的革命。高层管理人员、医生、护士等是否已经为这一新挑战做好准备？
- en: Numerous experts predict that, between 2025 and 2030, the world of health will
    be invaded by new technologies based on artificial intelligence and machine learning.
    This time frame, in reality, coincides with many other forecasts that indicate
    how the use of digital intelligence will influence many other fields of culture
    and human activities.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 许多专家预测，在2025到2030年之间，健康领域将被基于人工智能和机器学习的新技术所席卷。这个时间框架实际上与许多其他预测一致，表明数字智能的使用将影响文化和人类活动的许多其他领域。
- en: At this moment, in the western world, there are many companies actively involved
    in the development of machine learning systems aimed specifically at healthcare
    uses. In addition to these established companies, we also have a certain number
    of university start-ups and spin-offs that, almost daily, turn their attention
    to the world of medicine.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 此刻，在西方世界，许多公司积极参与开发专门面向医疗领域的机器学习系统。除了这些知名公司外，我们还有一定数量的大学创业公司和衍生企业，几乎每天都在将注意力转向医学领域。
- en: We'll take a look at some of the possible uses of machine learning in the field
    of healthcare in the following sections.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的章节中，我们将探讨机器学习在医疗领域的一些可能应用。
- en: Diagnosis of diseases
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 疾病诊断
- en: Diagnosing a disease is a difficult process and requires a great deal of experience.
    It serves to recognize a disease or psychopathology based on symptoms or phenomena,
    the former being subjective manifestations present in the patient, and the latter
    also being evident to the doctor or psychologist. The set of symptoms and signs
    of which some are specific or pathognomonic and others are more or less generic
    characterize the clinical picture of a disease. The set of diagnostic methods
    is called diagnostics. Diagnostics is known to be instrumental when it uses special
    equipment or instruments, such as in imaging or clinical diagnostics, when it
    is based on the direct examination of the patient by the doctor.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 诊断疾病是一个困难的过程，且需要大量经验。它旨在根据症状或现象识别疾病或心理病理，前者是病人身上的主观表现，后者也是医生或心理学家可以察觉的现象。症状和体征的集合，其中一些是特定的或*病理特征性的*，而其他则是更或更少具有通用性的，构成了疾病的临床表现。诊断方法的集合称为诊断学。诊断学在使用特殊设备或仪器时尤为重要，如影像学或临床诊断，尤其是在通过医生直接检查病人时。
- en: Information technology offers great support for diagnosis. Various centers around
    the world make use of the space and computing power of the most powerful supercomputers
    in the world to obtain fast and accurate diagnoses, which draw and process information
    starting from the enormous knowledge base available in search engines and internet
    databases, including the same anonymous electronic patient records.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 信息技术在诊断方面提供了极大的支持。世界各地的各种中心利用全球最强大的超级计算机的空间和计算能力，获取快速而准确的诊断，这些诊断从搜索引擎和互联网数据库中庞大的知识库中提取和处理信息，包括匿名的电子病历。
- en: In recent years, a large contribution has been made by machine-based algorithms.
    Through these algorithms, the identification and classification of a pathology
    are less affected by errors. In this way, the early diagnosis of a disorder can
    make treatment much more effective.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 近年来，基于机器的算法做出了巨大贡献。通过这些算法，病理的识别和分类受到的错误影响较小。通过这种方式，疾病的早期诊断可以使治疗更加有效。
- en: Prediction of epidemic events
  id: totrans-20
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 流行病事件的预测
- en: The term epidemic means the onset of a disease that rapidly spreads by direct
    or indirect infection, to the point of affecting a large number of people in a
    more or less vast territory, and is extinguished after a more or less long duration.
    This definition generally applies to the case of infectious diseases, although
    currently there is a tendency to transfer this terminology to the field of non-infectious
    diseases, especially since their frequency in certain populations has undergone
    a clear and unexpected increase, coinciding with quantitative variations and qualitative
    of causal factors.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 流行病一词指的是通过直接或间接传染迅速传播的疾病，直到影响到一个更或更广泛的地区的大量人群，并且在持续一段时间后消失。这一定义通常适用于传染性疾病，尽管目前有将这一术语转移到非传染性疾病领域的趋势，特别是当某些人群中这些疾病的发生频率发生明显且意外的增加时，这与因果因素的数量和质量变化相吻合。
- en: The spread of diseases depends on phenomena characterized by territorial influences
    and population displacement. Correlating all of this information becomes a burdensome
    task. For this, we need the aid of artificial intelligence, which can predict
    how an epidemic can expand by taking into account the place in which it developed.
    The results of this analysis can help the authorities to prepare pandemic risk
    containment plans.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 疾病的传播依赖于由领土影响和人口流动所表征的现象。将所有这些信息关联起来是一个繁重的任务。为此，我们需要人工智能的帮助，人工智能可以通过考虑疾病发生地来预测流行病如何扩散。这项分析的结果可以帮助当局制定疫情风险控制计划。
- en: Experimentation with new drugs
  id: totrans-23
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 新药实验
- en: Machine learning has a very important utility with regards to the identification
    of new drugs, starting from their study of the composition up to predicting their
    effects.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 机器学习在新药的识别方面具有非常重要的作用，从药物成分的研究到预测其效果。
- en: The Royal Society, which is based in the United Kingdom, states that machine
    learning is an optimal solution in the production of drugs through biological
    methods. In this way, pharmaceutical companies are important helpers in the drug
    production process, especially, with regards to timing and lowering production
    costs.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 总部位于英国的皇家学会表示，机器学习是通过生物方法生产药物的最佳解决方案。通过这种方式，制药公司在药物生产过程中扮演着重要的助手角色，尤其是在时效性和降低生产成本方面。
- en: In precision medicine, the MIT Clinical Machine Learning Group uses algorithms
    to identify the best ways to produce drugs and cures, mainly for diabetes.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 在精准医学中，MIT临床机器学习小组使用算法来识别生产药物和疗法的最佳方法，主要针对糖尿病。
- en: Another example is given by the Hanover project by Microsoft, which uses machine
    learning in several cases, especially in technologies for therapies aimed at treating
    cancer and, more specifically, the identification of personalized treatments for
    acute myeloid leukemia.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个例子是微软的汉诺威项目，该项目在多个案例中使用了机器学习，特别是在治疗癌症的疗法技术中，尤其是在为急性髓性白血病识别个性化治疗方案方面。
- en: DeepMind Health
  id: totrans-28
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: DeepMind健康
- en: DeepMind can process millions of pieces of medical information in just a few
    minutes, greatly speeding up medical processes that are clinical in nature, such
    as folder archiving and diagnostics. The researchers at DeepMind are also working
    on models to emulate the ability to imagine the consequences of an action before
    undertaking it—practically speaking, they are trying to understand what intelligence
    and imagination are to convert them into algorithms. Verily, the Google branch
    of life science, is also working on a project called the **Baseline Study** to
    collect genetic data. The aim is to adopt some of Google's algorithms to analyze
    what allows people to be healthy. For this project, researchers also use disease
    monitoring technologies, such as intelligent contact lenses to measure blood sugar
    levels.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: DeepMind可以在短短几分钟内处理数百万条医疗信息，大大加快了临床性质的医疗过程，如档案归档和诊断。DeepMind的研究人员还在开发模拟预测行动后果能力的模型——实际上，他们正在试图理解什么是智能和想象力，并将其转化为算法。谷歌的生命科学分支Verily也在进行一个名为**基线研究**的项目，以收集基因数据。该项目的目的是采用一些谷歌的算法来分析是什么使人保持健康。为了这个项目，研究人员还使用了疾病监测技术，例如智能隐形眼镜来测量血糖水平。
- en: Now, the time has come to apply reinforcement learning algorithms to practical
    cases related to health care.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，应用强化学习算法到与医疗保健相关的实际案例的时机已经到来。
- en: Modeling healthcare insurance plans
  id: totrans-31
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 建模健康保险计划
- en: The term **long term care** (**LTC**) refers to a set of interventions that
    are necessary to guarantee adequate assistance to, mainly elderly, individuals
    in conditions of non-self-sufficiency caused by an accident or a disease, but
    also only by aging. These interventions, provided by public or private institutions,
    may fall within the overall health services and/or in the context of the complex
    of welfare services, both at home and in specific institutions designed to face
    these risks.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '**长期护理**（**LTC**）一词指的是一系列必要的干预措施，旨在确保为主要是老年人提供足够的帮助，这些人因事故、疾病或仅仅因衰老而处于非自理状态。这些干预措施由公共或私人机构提供，可能包括整体健康服务和/或社会福利服务的内容，无论是在家中还是在专门为应对这些风险而设立的机构中。'
- en: The importance of these forms of insurance, both private and public, is essentially
    due to the demographic aging process that has affected all industrialized countries.
    This process is creating strong financial and coverage problems in various sectors
    of the welfare state. Examples include the pension system, the demand for health
    services and, more particularly, the demand for those long-term social and health
    services that the elderly need in the event of total or partial loss of their
    autonomy.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 这些形式的保险，无论是私人还是公共保险，其重要性本质上是由于人口老龄化进程，这一进程已经影响了所有工业化国家。这个过程正在各个福利国家的各个领域造成强烈的财务和保障问题。例如，包括养老金系统、健康服务的需求，更特别的是，当老年人在完全或部分失去自理能力时，他们所需的长期社会和健康服务的需求。
- en: Health insurance basis
  id: totrans-34
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 健康保险基础
- en: '**Health insurance** means a wide range of insurance coverage that allows an
    insurer to intervene when the health condition of the insured is affected due
    to illness or injury, resulting in high medical expenses and inability to generate
    income, thereby causing economic damage to the insured.'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '**健康保险**指的是一类广泛的保险覆盖，允许保险公司在被保险人的健康状况因疾病或伤害而受到影响，导致高额医疗费用并无法产生收入，从而造成经济损失时进行干预。'
- en: The objective of these forms of insurance is to protect the insured from those
    risks connected to their health conditions and to their relative working capacity,
    which, due to the onset of diseases or the occurrence of accidents, can be interrupted
    for longer or shorter periods, temporarily or permanently.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 这些保险形式的目标是保护被保险人免受与其健康状况和相对工作能力相关的风险，这些风险由于疾病的发生或事故的发生，可能会在较长或较短的时间内暂时或永久中断。
- en: Some insurances companies provide financial support for alternative health solutions
    to those offered by public health systems, such as medical expenses reimbursement
    insurance; others provide revenue in the form of income or capital, which compensates,
    at least in part, for the loss of income caused by periods of incapacity for work.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 一些保险公司为替代公共卫生系统提供的健康解决方案提供财务支持，例如医疗费用报销保险；其他公司则提供收入或资本形式的收益，至少部分地补偿因工作能力丧失而导致的收入损失。
- en: To monetize an insurance contract, the intervention of a specialist is required
    to study the technical organization of life insurance companies and, in general,
    the social security institutions  by establishing the bases and checking the results
    from a statistical, financial, and mathematical point of view. This figure is
    called the actuary.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使保险合同货币化，需要专家介入，研究寿险公司及一般社会保障机构的技术组织，通过建立基础并从统计、财务和数学的角度检验结果。这个角色被称为精算师。
- en: The first actuarial calculation models for life insurance are, in fact, dated
    between the end of the seventeenth century and the first half of the eighteenth
    century. Over the centuries, different models have been formulated. In the next
    section, we will analyze a model based on multiple decrements.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个生命保险精算模型实际上是在17世纪末和18世纪上半叶之间的时期出现的。几个世纪以来，已提出了不同的模型。在下一节中，我们将分析一个基于多重递减的模型。
- en: Introducing multiple decrement models
  id: totrans-40
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 引入多重递减模型
- en: The theory of multiple decrements developed from the second half of the eighteenth century.
    The theory of multiple decrements has posed, in terms of mathematical formulation,
    an issue that is also relevant to any other type of insurance activity. It first
    developed in the field of continuous-time models and only later, toward the end
    of the eighteenth century, in the context of discrete-time models. The latter
    were mainly taken into consideration at the end of the nineteenth century for
    the first applications of actuarial calculation to public pension systems.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 多重递减理论始于18世纪下半叶。这一理论在数学表述上提出了一个与其他任何类型保险活动都相关的问题。它首先在连续时间模型领域发展起来，直到18世纪末，才在离散时间模型的背景下发展。后者主要是在19世纪末期开始被考虑，用于精算计算在公共养老金系统中的首次应用。
- en: The calculation of insurance premiums is based on the rule of large numbers
    that states the proportion of successes in *n* independent realizations of an
    event *E* converges, for what tends to infinity, to the probability that the event
    *E* takes place. This means that, when the reference sample is sufficiently numerous
    and the probabilities of disease are independent of each other, the proportion
    of individuals who contract the disease approaches the probability of contracting
    the disease so that this percentage of the population will contract the disease.
    Thanks to this principle, the insurance company can calculate the expected repayments
    and increase the homogeneity. The number of the insured also increases the accuracy
    of the estimate. Therefore, the insurance company does not know who will contract
    the disease but only the percentage of individuals who will fall ill.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 保险费的计算基于大数法则，该法则指出，在事件*E*的*n*次独立试验中，成功的比例会随着* n*趋近于无穷大而趋向事件*E*发生的概率。这意味着，当参考样本足够大且疾病的概率彼此独立时，感染疾病的个体比例接近感染该疾病的概率，从而这部分人口将会患病。正因为有了这个原理，保险公司能够计算预期的赔付金额并提高同质性。被保险人的数量也增加了估算的准确性。因此，保险公司并不知晓谁会得病，而仅知道会生病的个体的百分比。
- en: The calculation of premiums must be accepted by both parties, that is, the insured
    and the insurer. In the simplest situation, it is assumed that the interest rate
    is constant throughout the active period of the policy and the benefit due to
    the individual depends on the event of death. In the model based on common collectivity,
    the service is paid in the same way to each group. In such cases, it is necessary
    to define when to pay the benefit. Two possible solutions are payment on the first
    death in the group and payment on the last death in the group. In both cases,
    the only random variable is represented by the future life expectancy.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 保费的计算必须得到双方的同意，即被保险人和保险人。在最简单的情况下，假设利率在保单的活动期内是恒定的，且个人的利益取决于死亡事件的发生。在基于共同集体的模型中，服务以相同的方式支付给每个群体。在这种情况下，必须定义何时支付利益。有两种可能的解决方案：支付群体中第一次死亡时的利益，或者支付群体中最后一次死亡时的利益。在这两种情况下，唯一的随机变量是由未来的预期寿命表示的。
- en: Life tables are used to calculate life expectancy. A life table is a table that
    shows, for each age, what the probability is that a person of that age will die
    before their next birthday. Therefore, in the life table, there is a single exit
    mode. This table is defined as a single decrement table. When we expect different
    causes of decrement on a group of individuals, we can model the system with a
    more general family of models based on multiple decrements.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 寿命表用于计算预期寿命。寿命表是一种表格，显示每个年龄段的人在下一次生日之前死亡的概率。因此，在寿命表中，只有单一的退出模式。这个表格被定义为单一递减表。当我们预期一组个体有不同的递减原因时，我们可以通过基于多种递减原因的模型族来对系统进行建模。
- en: In multiple decrement models, there is a simultaneous different causes of decrement.
    A life ends because of one of these decreases functioning. In the following section,
    we will calculate the benefit that will be paid to an insured person by modeling
    the problem as a Markov decision process.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在多重递减模型中，存在同时发生的不同递减原因。一个人的生命结束是由于这些递减功能之一。在接下来的部分中，我们将通过将问题建模为马尔可夫决策过程来计算将支付给被保险人的利益。
- en: Using a transition model in health insurance
  id: totrans-46
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在健康保险中使用转移模型
- en: A decrement model can be seen as a special case of multi-state models. In fact,
    just like what happens in a multi-state model, we can consider an individual of
    age *x* who, at time *t*, is in one of the *n + 1* potential states. In a multiple
    decrement model, starting from the state 0 (active), all of the other transition
    states are defined as absorbent states, which, once reached, can no longer be
    exited.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 递减模型可以看作是多状态模型的一种特殊情况。实际上，就像多状态模型中发生的那样，我们可以考虑一个年龄为*x*的个体，在时间*t*时处于*n + 1*个潜在状态之一。在多重递减模型中，从状态0（活动）开始，所有其他转移状态都被定义为吸收状态，一旦到达这些状态，就不能再退出。
- en: 'In our case, three states are provided: active, unable to work, and dead. The
    starting point is obviously represented by the active state, while the other two
    (unable and dead) are absorbent states, as shown in the following diagram:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的例子中，提供了三种状态：活动、无法工作和死亡。起始点显然是由活动状态表示，而其他两种（无法工作和死亡）是吸收状态，如下图所示：
- en: '![](img/607a8e60-ab4b-46cb-92ee-d0894e9ce96a.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![](img/607a8e60-ab4b-46cb-92ee-d0894e9ce96a.png)'
- en: We have previously stated that all the transition states except the active state
    are absorbent. This means that it is no longer possible to return to the active
    state. A transition from the unable to work state is possible—unfortunately, it's
    not pleasant as it involves death. Now, let's learn how to set up a decrease table.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 我们之前已经提到，除了活动状态，所有的转移状态都是吸收状态。这意味着无法再返回活动状态。从无法工作状态转移是可能的——不幸的是，这并不愉快，因为它涉及死亡。现在，让我们学习如何设置递减表。
- en: Setting up the decrement table
  id: totrans-51
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置递减表
- en: To deal with this problem, it is essential to have a decrement table. The decrement
    table contains the probabilities that the individual passes from one state to
    another, which sounds like a transition matrix. We analyzed transition matrices
    in detail in [Chapter 3](7ee860fd-cd4c-4034-8dd6-9c803e129418.xhtml), *Markov
    Decision Processes in Action*.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 为了处理这个问题，必须有一个递减表。递减表包含个体从一个状态转移到另一个状态的概率，这听起来像是一个转移矩阵。我们在[第3章](7ee860fd-cd4c-4034-8dd6-9c803e129418.xhtml)中详细分析了转移矩阵，*马尔可夫决策过程的实际应用*。
- en: 'To begin, we will learn how to construct the table of decrements. You may recall
    that the decrement matrix differs from the life expectancy table in that, in addition
    to containing the probability of death as a function of the subject''s age, it
    also contains the probabilities of transition in the other predicted states:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们将学习如何构建减量表。你可能还记得，减量矩阵与寿命预期表的不同之处在于，除了包含死亡概率作为受试者年龄的函数外，它还包含其他预测状态下的转移概率：
- en: 'We will create vectors that contain this information and start from age:'
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将创建包含这些信息的向量，并从年龄开始：
- en: '[PRE0]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Here, we used the `seq()` function, which generates regular sequences. Three
    parameters are used, as follows:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们使用了`seq()`函数，它会生成规则的序列。使用了三个参数，具体如下：
- en: '`from`: The starting values of the sequence.'
  id: totrans-57
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`from`：序列的起始值。'
- en: '`to`: The end values of the sequence.'
  id: totrans-58
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`to`：序列的结束值。'
- en: '`by`: The increment of the sequence. By default, this is 1.'
  id: totrans-59
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`by`：序列的增量。默认值为1。'
- en: 'In our case, we could have omitted the `by` parameter, but we have inserted
    it to make the code more readable. We considered only a part of working life,
    that is,the one that starts from 30 to reach 50\. Of course, we could have extended
    this interval to the whole working life but, for our purposes, it is fine. Now,
    we can create vectors that contain the probabilities of transition from one state
    to another. We start from the active state, and we have three transition states:
    from active to unable, from active to dead, and from active to active.'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的例子中，我们本可以省略`by`参数，但我们插入了它以提高代码的可读性。我们只考虑了一部分工作生涯，即从30岁开始到达50岁的这一段。当然，我们本可以将这个区间扩展到整个工作生涯，但对于我们的目的来说，这样就足够了。现在，我们可以创建包含从一个状态到另一个状态转移概率的向量。我们从活跃状态开始，接着有三个转移状态：从活跃到无法，从活跃到死亡，以及从活跃到活跃。
- en: 'We will use the `seq()` function again, as follows:'
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将再次使用`seq()`函数，具体如下：
- en: '[PRE1]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Once again, we used the `seq()` function, but this time, we used a new parameter:
    `length.out`. This parameter was used to set the desired length of the sequence.'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 我们再次使用了`seq()`函数，但这次使用了一个新的参数：`length.out`。此参数用于设置序列的期望长度。
- en: Let's analyze the newly created vectors. The first vector is the probability
    of transition from the active to unable state and presents increasing values with
    age. The second vector represents the probability of transition from the active
    to dead state and presents increasing values with age, once again. Finally, the
    third vector represents the probability of transition from the active state to
    active and was obtained as a difference between 1 and the sum of the previous
    values. This is because the sum of the three transition probabilities must return
    1.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们分析一下新创建的向量。第一个向量是从活跃状态到无法状态的转移概率，并且随着年龄的增长值不断增加。第二个向量是从活跃状态到死亡状态的转移概率，同样随着年龄的增长而增加。最后，第三个向量是从活跃状态到活跃状态的转移概率，得自于1减去前两个值的和。这是因为三个转移概率的总和必须等于1。
- en: 'Now, let''s move on to the unable state. Once again, we have three transitions:
    unable to active, unable to dead, and unable to unable. Let''s create the three
    vectors:'
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们进入无法状态。同样地，我们有三个转移：无法到活跃，无法到死亡，以及无法到无法。我们来创建这三个向量：
- en: '[PRE2]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: As we can see, the first vector contains only zeros. This is because, as we
    anticipated, the unable state does not allow transit to the active state; in this
    sense, it is an absorbing state. The second vector represents the probability
    of transition from the unable to dead state and presents increasing values with
    age. Finally, the third  vector represents the probability of transition from
    the unable state to unable and was obtained as a difference between 1 and the
    sum of the previous values. This is because the sum of the three transition probabilities
    must return 1.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所见，第一个向量仅包含零。这是因为，正如我们预料的那样，无法状态不允许转移到活跃状态；从这个意义上来说，它是一个吸收状态。第二个向量表示从无法状态到死亡状态的转移概率，且随着年龄的增长而增加。最后，第三个向量表示从无法状态到无法状态的转移概率，它是通过1减去前两个值的和得到的。这是因为三个转移概率的总和必须等于1。
- en: 'Finally, let''s move on to the dead state. Once again, we have three transitions:
    dead to active, dead to unable, and dead to dead. Let''s create the three vectors:'
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，让我们进入死亡状态。同样地，我们有三个转移：死亡到活跃，死亡到无法，以及死亡到死亡。我们来创建这三个向量：
- en: '[PRE3]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: The dead state is definitely absorbent compared to the other two states. To
    confirm this, the first two vectors contain zeros, while the third contains ones.
    This is because the rule that the sum of the probabilities of state transitions
    must return 1 remains valid.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 与其他两个状态相比，死态无疑是最具吸引力的。为了验证这一点，前两个向量包含零，而第三个向量包含一。这是因为状态转移概率的和必须等于1这一规则仍然有效。
- en: 'At this point, we just have to use these vectors to create the decrement table,
    as follows:'
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此时，我们只需要使用这些向量来创建递减表，如下所示：
- en: '[PRE4]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Let''s take a look at the table we just created; we can use the `str()` function,
    which shows a compact display of the internal structure of an R object:'
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们看一下我们刚刚创建的表格；我们可以使用`str()`函数，它显示了R对象内部结构的紧凑表示：
- en: '[PRE5]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The results are shown in the following code block:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 结果显示在以下代码块中：
- en: '[PRE6]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The dataframe contains 21 observations of 10 variables. Each observation represents
    ages from 30 to 50\. The variables are age and nine transition probabilities between
    the three states: active, unable, and dead. As we can see, the variables contained
    in the table are identified by their names. To refer to variables with their names
    in a dataframe, we can interpose a dollar sign ($) between the data frame''s name
    and the variable''s name. Furthermore, we can read other information: the type
    attributed to each variable. In this case, we have 10 numerical type variables.'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 数据框包含21个观察值和10个变量。每个观察值表示从30岁到50岁的年龄。变量包括年龄和三个状态（活跃、无法工作和死亡）之间的九个转移概率。正如我们所看到的，表中包含的变量由其名称标识。要在数据框中引用变量，可以在数据框名称和变量名称之间插入美元符号（$）。此外，我们还可以读取其他信息：每个变量的类型。在本例中，我们有10个数值型变量。
- en: 'More information can be obtained using the `summary()` function, which produces
    summaries of the distribution of the variables:'
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 可以使用`summary()`函数获取更多信息，该函数生成变量分布的摘要：
- en: '[PRE7]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The following results are returned:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 以下结果被返回：
- en: '![](img/a03c9bb8-04a0-44e4-a33d-1742ae2b8449.png)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a03c9bb8-04a0-44e4-a33d-1742ae2b8449.png)'
- en: The `summary()` function invokes particular methods that depend on the class
    of the first argument. For each feature, the following descriptors are returned—minimum,
    first quartile, median, mean third quartile, and maximum. A quick look at these
    values allows us to understand the statistical distribution of the values assumed
    by the variable.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '`summary()`函数调用特定的方法，这些方法依赖于第一个参数的类别。对于每个特征，返回以下描述符——最小值、第一四分位数、中位数、均值、第三四分位数和最大值。快速查看这些值可以帮助我们理解变量所采用值的统计分布。'
- en: 'To understand how this table appears, we can print the head of the decrement
    table, as follows:'
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了理解这个表格是如何显示的，我们可以打印递减表的前几行，如下所示：
- en: '[PRE8]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'The following results are printed:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是打印的结果：
- en: '![](img/62682d37-5036-4d5a-b6c5-22ba98b8656d.png)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![](img/62682d37-5036-4d5a-b6c5-22ba98b8656d.png)'
- en: As we can see, every observation corresponds to a worker's age, and for each
    age, the probabilities of transition from one state to another are reported. Now,
    we can set the basics of the model in the next section.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所见，每个观察值对应一个工人的年龄，对于每个年龄，都会报告从一个状态到另一个状态的转移概率。现在，我们可以在下一部分设置模型的基础。
- en: Markov decision process model
  id: totrans-88
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 马尔可夫决策过程模型
- en: 'Our goal is to treat the problem as a Markov decision process. To do this,
    we must define the states. Previously, we said that there are three states in
    which a worker can be found—active, unable to work, and dead. Let''s follow these
    steps:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的目标是将这个问题视为一个马尔可夫决策过程。为此，我们必须定义状态。此前我们提到，工人可以处于三个状态——活跃、无法工作和死亡。让我们按照以下步骤进行：
- en: 'We will create a variable that contains this information:'
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将创建一个包含这些信息的变量：
- en: '[PRE9]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: A Markovian process is represented by a transition matrix that defines the probabilities
    of transition from one state to another. We have said that our system is defined
    by three states, so the transition matrix will be 3x3 in size. The information
    we need is contained in the decrements table.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 马尔可夫过程由一个转移矩阵表示，该矩阵定义了从一个状态到另一个状态的转移概率。我们已经说过，我们的系统由三个状态定义，因此转移矩阵的大小将是3x3。我们需要的信息包含在递减表中。
- en: 'Then, we will extract the transition matrix at a specific age of the worker:'
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们将提取在特定年龄时工人的转移矩阵：
- en: '[PRE10]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'To do this, we simply extracted the final nine columns of the decrement table
    in correspondence with the observation identified by the value of the age variable
    equal to 35\. We have used the `matrix` () function to arrange the extracted data
    into a 3x3 matrix (`nrow = 3, ncol = 3`) and we have fixed the values for progressive
    lines (`byrow = TRUE`). Let''s see the result:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 为此，我们仅提取了与年龄变量值为35对应的观察值相关的递减表的最后九列。我们使用`matrix()`函数将提取的数据安排成一个3x3的矩阵（`nrow
    = 3, ncol = 3`），并固定了逐行的值（`byrow = TRUE`）。让我们看看结果：
- en: '[PRE11]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'By analyzing the preceding matrix, we can see that it has a particular shape;
    in fact, all of the elements below the main diagonal are equal to zero. This type
    of matrix is called the upper triangular and has the following properties:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 通过分析前面的矩阵，我们可以看到它具有一个特殊的形状；实际上，主对角线下方的所有元素都等于零。此类矩阵称为上三角矩阵，并且具有以下特性：
- en: The rank is equal to the number of non-null elements present in the main diagonal.
  id: totrans-98
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 秩等于主对角线上非零元素的数量。
- en: The determinant is equal to the product of the elements present in the main
    diagonal.
  id: totrans-99
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 行列式等于主对角线上元素的乘积。
- en: The eigenvalues are represented by the elements present in the main diagonal.
  id: totrans-100
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 特征值由主对角线上的元素表示。
- en: 'At this point, we can define the model:'
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此时，我们可以定义模型：
- en: '[PRE12]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: The `markovchain` class has been designed to handle homogeneous Markov chain
    processes.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '`markovchain` 类是专门设计用来处理同质马尔科夫链过程的。'
- en: 'The following arguments are passed:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 传递以下参数：
- en: '`transitionMatrix`: This is the square transition matrix containing the probabilities
    of the transition matrix.'
  id: totrans-105
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`transitionMatrix`：这是一个方形转移矩阵，包含转移概率的元素。'
- en: '`states`: This is the name of the states and must be the same as the `colnames`
    and `rownames` of the transition matrix. This is a character vector, listing the
    states for which transition probabilities are defined.'
  id: totrans-106
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`states`：这是状态的名称，必须与转移矩阵的`colnames`和`rownames`相同。这是一个字符向量，列出了定义转移概率的状态。'
- en: '`name`: This is an optional character element to name the discrete-time Markov
    chains.'
  id: totrans-107
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`name`：这是一个可选的字符元素，用于命名离散时间马尔科夫链。'
- en: 'To show a summary of the model we''ve just created, let''s use the following
    command:'
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了显示我们刚刚创建的模型的总结，让我们使用以下命令：
- en: '[PRE13]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The following results are returned:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 返回以下结果：
- en: '[PRE14]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'As we saw in [Chapter 3](7ee860fd-cd4c-4034-8dd6-9c803e129418.xhtml), *Markov
    Decision Processes in Action*, to get the states of the `markovchain` object,
    we can use the `states` method, as follows:'
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如我们在[第3章](7ee860fd-cd4c-4034-8dd6-9c803e129418.xhtml)《*马尔科夫决策过程实战*》中所见，要获取`markovchain`对象的状态，我们可以使用`states`方法，如下所示：
- en: '[PRE15]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'The following result is returned:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 返回以下结果：
- en: '[PRE16]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'To get the dimension of the `markovchain` object, we can use the `dim()` method,
    as follows:'
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要获取`markovchain`对象的维度，可以使用`dim()`方法，如下所示：
- en: '[PRE17]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'The following result is returned:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 返回以下结果：
- en: '[PRE18]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'To see which elements are contained in the object we have created, we can use
    the `str()` function, which shows a compact view of the internal structure of
    an object, R:'
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要查看对象中包含哪些元素，可以使用`str()`函数，它展示了对象的内部结构的紧凑视图：
- en: '[PRE19]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'The following results are printed:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 打印以下结果：
- en: '[PRE20]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'To retrieve the elements contained in each one, it will be enough to use the
    name of the object (`MCModel35`), followed by the name of the slot, separated
    by the `@` symbol. For example, to print the transition matrix, we will write
    the following:'
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要检索每个元素，只需使用对象的名称（`MCModel35`），后跟插槽的名称，中间用`@`符号分隔。例如，要打印转移矩阵，我们可以写如下代码：
- en: '[PRE21]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'The following results are returned:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 返回以下结果：
- en: '[PRE22]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'We can evaluate the absorbent state like so:'
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以这样评估吸收状态：
- en: '[PRE23]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'The following state is returned:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 返回以下状态：
- en: '[PRE24]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'As we know, from this state, we can''t go back. At this point, we can predict
    the status of the worker. It''s a simulation, so let''s see what happens:'
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 正如我们所知，从这个状态，我们无法回到之前的状态。此时，我们可以预测工人的状态。这是一个模拟，接下来让我们看看会发生什么：
- en: '[PRE25]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: The `set.seed()` command defines the seed of the random number generator. In
    this way, all of the random numbers that are used in the algorithm will always
    be the same each time the code is executed, making the example reproducible.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: '`set.seed()`命令定义了随机数生成器的种子。这样，每次执行代码时，所有使用的随机数都会是相同的，从而确保例子的可重复性。'
- en: 'We will extract the statistics from the results:'
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将从结果中提取统计数据：
- en: '[PRE26]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'The following results are returned:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 返回以下结果：
- en: '[PRE27]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Let''s see what happens to a 50-year-old worker:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看50岁工人的情况：
- en: 'First, we will extract the transition matrix at the worker''s age of 50:'
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们将提取工人50岁时的转移矩阵：
- en: '[PRE28]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'Then, we will set the model:'
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们将设置模型：
- en: '[PRE29]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'Finally, we will simulate the working life:'
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，我们将模拟工作生活：
- en: '[PRE30]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'Now, we can extract the results:'
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们可以提取结果：
- en: '[PRE31]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'The following results are printed:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 以下结果被打印出来：
- en: '[PRE32]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'Now, we can make predictions about working life, simulating the status of a
    worker over time:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以预测工作生活，模拟一个工人在不同时间段的状态：
- en: The first thing we need to do is create a `markovchain` object for each available
    working age. We will refer to the interval between 30 and 50 years since we have
    the data for it.
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们需要做的第一件事是为每个可用的工作年龄创建一个`markovchain`对象。我们将参考30到50岁之间的区间，因为我们有该数据。
- en: 'To speed up this procedure, we will create an iterative cycle and insert each
    `markovchain` object in a list:'
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了加快这个过程，我们将创建一个迭代循环，并将每个`markovchain`对象插入一个列表中：
- en: '[PRE33]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: To start, we have initialized the list and a counter that will allow us to update
    the list.
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们初始化了一个列表和一个计数器，它将帮助我们更新列表。
- en: Then, we extracted the values contained in the decrements table to obtain the
    transition matrix at each age.
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们从减少表中提取值，以获得每个年龄的转移矩阵。
- en: 'Finally, we created the `markovchain` object for that age. At this point, we
    can create a `markovchainList` object, as follows:'
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，我们为该年龄段创建了`markovchain`对象。在这一点上，我们可以创建一个`markovchainList`对象，如下所示：
- en: '[PRE34]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: A `markovchainlist` object is a list of `markovchain` objects. These objects
    can be used to model non-homogeneous discrete-time Markov chains when transition
    probabilities change by time.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '`markovchainlist`对象是一个`markovchain`对象的列表。这些对象可以用来建模非齐次离散时间马尔科夫链，当转移概率随时间变化时。'
- en: 'Now, we can simulate the transition between the states where the worker can
    be found:'
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们可以模拟工人可能处于的状态之间的转移：
- en: '[PRE35]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: The `rmarkovchain()` function generates a sequence of states from homogeneous
    or non-homogeneous Markov chains. In our case, we have generated a sequence of
    10,000 simulations.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '`rmarkovchain()`函数生成一个从齐次或非齐次马尔科夫链生成的状态序列。在我们的例子中，我们已经生成了10,000次模拟的序列。'
- en: 'Let''s see what the newly created object contains:'
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们看看新创建的对象包含了什么：
- en: '[PRE36]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'The following results are printed:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 以下结果被打印出来：
- en: '[PRE37]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: This is a dataframe containing 210,000 observations of two variables. We are
    interested in the second value variable, which contains the states of the simulations.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个包含210,000个观察值的二维数据框。我们对第二个值变量感兴趣，该变量包含模拟的状态。
- en: 'Next, we will extract some simple statistics that allow us to obtain the count
    of the occurrences of each state in all of the simulations that are carried out:'
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将提取一些简单的统计数据，帮助我们获取所有模拟中每个状态出现的次数：
- en: '[PRE38]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'The following results are returned:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 以下结果被返回：
- en: '[PRE39]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'With the data available, it is really easy to calculate the expected times
    a worker will be in the `Unable` state:'
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 利用现有数据，计算工人处于`Unable`状态的预期时间非常容易：
- en: '[PRE40]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: Here, we have divided the number of unable occurrences by the number of rows
    contained in the `StatesSequence` object. The number of rows contained in the
    `StatesSequence` object is equal to the product of the number of simulations (10,000)
    for the number of years of working life (21, from 30 to 50).
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，我们将无法出现的次数除以`StatesSequence`对象中包含的行数。`StatesSequence`对象中的行数等于模拟次数（10,000）与工作年限（21年，从30岁到50岁）的乘积。
- en: 'The following result is returned:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 以下结果被返回：
- en: '[PRE41]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: Starting from the simulations we've carried out, the insurance companies can
    forecast the expected premiums.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 从我们进行的模拟开始，保险公司可以预测预期的保费。
- en: In the next section, we learn to optimize the use of an operating room in a
    hospital.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一部分中，我们将学习如何优化医院手术室的使用。
- en: Operating room sanitation planning
  id: totrans-178
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 手术室卫生规划
- en: Every year, around 8,000 deaths are associated with surgical room infections
    in the United States. Infections increase the duration of hospitalization, hence
    increasing costs and initiating legal action by patients. The hospital is a building
    in which the appropriate cleaning conditions contribute both to a better quality
    of life for the patient and those who work there and to decrease the probability
    of spreading microorganisms.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 每年，大约8,000例死亡与手术室感染相关。在美国，感染会增加住院时长，从而增加费用，并导致患者提起法律诉讼。医院是一个建筑，其中适当的清洁条件有助于患者及工作人员的生活质量，并减少微生物传播的概率。
- en: 'Environmental sanitation concerns the complexity of practical and sanitary
    procedures, and operations aimed at making a plant or a specific environment healthy
    through cleaning and detergent activities. When a disinfectant is used later,
    it is called sanitation. An adequate cleaning cycle must be performed before disinfection,
    and in any case, combined with it. Each environment has an optimal standard which
    is a consequence of the intended use of the environment itself. Hence, the sanitation
    of the operating rooms is completely different from that of the hospital rooms,
    which in turn is different from those of the common areas. The hospital can be
    divided into three areas of infectious risk: low, medium, and high. Low-risk areas
    include common areas such as corridors, offices, and waiting rooms. Areas of medium
    risk include hospital rooms, clinics, and laboratories. High-risk areas include
    operating rooms, intensive care rooms, resuscitation rooms, and recovery rooms.'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 环境卫生涉及到实际和卫生程序的复杂性，以及通过清洁和去污活动使植物或特定环境保持健康的操作。当使用消毒剂时，这被称为卫生处理。必须在消毒之前进行充分的清洁周期，并且在任何情况下，都必须与消毒操作结合进行。每个环境都有一个最佳标准，这是环境本身预期用途的结果。因此，手术室的卫生与病房的卫生完全不同，后者又与公共区域的卫生不同。医院可以分为三类感染风险区：低、中、高风险区。低风险区包括走廊、办公室和候诊室等公共区域。中风险区包括病房、诊所和实验室。高风险区包括手术室、重症监护室、复苏室和恢复室。
- en: Prevention of infections in a surgical room is a significant and current problem since
    it represents an important and frequent complication of surgery with serious consequences
    for patients' health and increased costs, understood as hospital and extra-hospital.
    For the patient, a hospital infection results in additional illness; for the doctor
    or the nurse, these infections can invalidate the efficacy of the treatment carried
    out, question their professionalism, and make them responsible for increased mortality
    in the treated patients. For these reasons, the need to implement preventive interventions
    aimed at containing infections must represent a common and shared goal.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 手术室感染的预防是一个重要且当前的问题，因为它代表着手术过程中常见的严重并发症，会对患者的健康造成严重后果，并增加住院和院外的费用。对于患者而言，医院感染意味着额外的疾病；对于医生或护士来说，这些感染可能会使治疗效果失效，质疑他们的专业性，并使他们对所治疗患者的死亡率增加负有责任。基于这些原因，实施旨在控制感染的预防性干预措施必须成为一个共同且共享的目标。
- en: We will frame the problem by defining the data we have available and what we
    want to achieve.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将通过定义可用的数据和希望实现的目标来框定问题。
- en: Defining the context
  id: totrans-183
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 定义背景
- en: 'In this example, we will deal with the problem of planning the sanitation and
    sterilization activities of an operating room. This is a routine operation that
    has costs in terms of resources used and the time in which the operating room
    remains inactive. In the planning of hygiene maintenance activities in the operating
    room, two main objectives must be pursued: the first objective is to avoid infection
    by patients treated in the room, while the second goal is to save on the costs
    of sanitizing and sterilizing operations.'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们将处理手术室的卫生和灭菌活动规划问题。这是一项常规操作，涉及到资源使用和手术室空闲时间的成本。在手术室卫生维护活动的规划中，必须追求两个主要目标：第一个目标是避免手术室内患者发生感染，第二个目标是节省卫生和灭菌操作的成本。
- en: 'The two objectives are, in any case, correlated since a possible infection
    in the operating room activates an intervention protocol that requires additional
    operations that impose a stop to the activities for 9 hours. On the other hand,
    standard activities provide a 3-hour stop in activities. Sanitation and sterilization
    operations are carried out every 30 days. Given the latest cases of infection,
    the operating room manager wants to know whether the planning of additional operations
    before the deadline can lead to an improvement. Two actions are available: do
    not perform additional operations (NoSS = No Sanitation-Sterilization) or perform
    additional operations (SS = Sanitation-Sterilization).'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 这两个目标在任何情况下都是相关的，因为手术室可能发生的感染会启动一个干预协议，该协议需要额外的操作，并会导致活动停止9小时。另一方面，标准操作会导致活动停止3小时。卫生消毒操作每30天进行一次。鉴于最近的感染案例，手术室管理者希望了解在截止日期之前进行额外操作的规划是否能够改善情况。有两个可用的操作：不执行额外操作（NoSS
    = 无卫生消毒）或执行额外操作（SS = 卫生消毒）。
- en: 'The interval between two operations (30 days) was divided into three sub-intervals
    that correspond to three states in which the operating theater is located:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 两次操作之间的间隔（30天）被划分为三个子间隔，分别对应手术室所处的三个状态：
- en: 'state 1: Interval between 0-10 days from the last intervention'
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 状态1：上次干预后的0-10天间隔
- en: 'state 2: Interval between 11-20 days from the last intervention'
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 状态2：上次干预后的11-20天间隔
- en: 'state 3: Interval between 21-30 days from the last intervention'
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 状态3：上次干预后的21-30天间隔
- en: Immediately after a Sanitation-Sterilization operation, the room enters state
    1\. If no additional operations are performed at the end of the first 10 days,
    the room goes to state 2, and finally, after 10 more days, it passes to state
    3, at the end of which an intervention is expected in all cases. If, between one
    operation and the other,  patient becomes infected, the ongoing operations in
    the operating room are interrupted and an emergency operation is carried out,
    bringing the system back to state 1\. The problem is how to manage the Sanitation-Sterilization
    operations in addition to those already foreseen in a long-term vision to maximize
    the reward.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 在卫生消毒操作之后，房间进入状态1。如果在前10天内没有进行其他操作，房间将进入状态2，最后，在接下来的10天后，房间进入状态3，届时预期在所有情况下都需要进行干预。如果在两次操作之间，患者感染了，手术室的持续操作将被中断，并进行紧急操作，将系统恢复到状态1。问题是如何在长期视角下，除了已经预见的操作之外，管理卫生消毒操作，以最大化奖励。
- en: Transition probability and rewards
  id: totrans-191
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 过渡概率和奖励
- en: 'This problem can be treated as a Markov decision-making process. To begin,
    we must define the transition matrix *P* (*s*, *s''*, *a*). Remember that it tells
    us what the probabilities are of passing from one state to another. Since two
    actions are available (NoSS and SS), we will define two matrices of transitions.
    We denote the probability of infection with *ps*, whose probability depends on
    the state of the operating room. The longer the time spent by the last intervention,
    the higher the probability that there is an infection. In this regard, we will
    define three probabilities of infection: p1 = 0.2, p2 = 0.3, and p3 = 0.4\. Recall
    that since there''s two possible actions, we will define two transition matrices.
    The transition matrix relating to the choice of action 1 (NoSS) will be as follows:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 这个问题可以看作一个马尔科夫决策过程。首先，我们必须定义过渡矩阵 *P* (*s*, *s'*, *a*)。记住，它告诉我们从一个状态到另一个状态的概率是多少。由于有两个可用的操作（NoSS
    和 SS），我们将定义两个过渡矩阵。我们用 *ps* 表示感染的概率，感染的概率取决于手术室的状态。上次干预的时间越长，感染的概率越高。在这方面，我们将定义三个感染概率：p1
    = 0.2，p2 = 0.3 和 p3 = 0.4。请记住，由于有两个可能的操作，我们将定义两个过渡矩阵。与操作1（NoSS）选择相关的过渡矩阵如下：
- en: '![](img/eefb173c-7d26-40af-9b90-bae2102d3a79.png)'
  id: totrans-193
  prefs: []
  type: TYPE_IMG
  zh: '![](img/eefb173c-7d26-40af-9b90-bae2102d3a79.png)'
- en: If we are in state 1, then we will have a probability *p1* that remains in that
    state if an infection occurs. The remaining probability *1-p1* involves moving
    to the next state if no infection occurs. While the probability of passing to
    the state 3 is equal to 0, it is not possible to pass directly from state 1 to
    3\. Recall that, in the matrix of transitions, the sum of all of the probabilities
    in a state that is in a row must be equal to 1\. If we are in state 2, we will
    have a probability *p2* that passes into state 1 if an infection occurs. The remaining
    probability *1-p2* involves moving to the next state, such as 3 if no infection
    occurs. In this case, the probability of remaining in state 2 is equal to 0\.
    Finally, if we are in state 3, we will have a probability of *p3* of going to
    state 1 if an infection occurs.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们处于状态1，那么我们将有概率*p1*保持在该状态，如果发生感染。剩余的概率*1-p1*则意味着如果没有感染，我们将转移到下一个状态。而进入状态3的概率为0，不能直接从状态1转到状态3。回想一下，在过渡矩阵中，处于同一行中的所有概率之和必须等于1。如果我们处于状态2，我们将有概率*p2*转移到状态1，如果发生感染。剩余的概率*1-p2*则意味着如果没有感染，我们将转移到下一个状态，如状态3。在这种情况下，保持在状态2的概率为0。最后，如果我们处于状态3，我们将有概率*p3*转移到状态1，如果发生感染。
- en: The remaining probability *1-p3* expects to remain in state 3 if no infection
    occurs. After this state, a Sanitation-Sterilization operation is still performed,
    while the probability of passing to state 2 is equal to 0.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 剩余的概率*1-p3*预计如果没有发生感染，仍然保持在状态3。在这个状态之后，仍然会进行消毒-灭菌操作，而进入状态2的概率为0。
- en: 'By substituting the values of the three probabilities associated with the three
    states in the transition matrix, we obtain the following matrix:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 通过替换与过渡矩阵中的三个状态相关联的三个概率值，我们得到以下矩阵：
- en: '![](img/4cb7aeac-aee5-45e3-be83-a08cd93c162f.png)'
  id: totrans-197
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4cb7aeac-aee5-45e3-be83-a08cd93c162f.png)'
- en: 'Now, let''s define the transition matrix related to the choice of action 2
    (SS):'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们定义与选择动作2（SS）相关的过渡矩阵：
- en: '![](img/4c2551b8-8dcf-42b3-b3c6-59131e2ec38e.png)'
  id: totrans-199
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4c2551b8-8dcf-42b3-b3c6-59131e2ec38e.png)'
- en: 'In this case, the form of the transition matrix is more immediate: it is the
    action that foresees a Sanitation-Sterilization operation, which, as we anticipated,
    reports the room in any case in state 1\. This is the person who died in all three
    states we have, which means that the probability that we move to state 1 is unitary.'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，过渡矩阵的形式更为直接：它是预见进行消毒-灭菌操作的行动，正如我们预期的那样，无论如何，房间都处于状态1。这是我们所有三个状态中死去的人，这意味着我们转到状态1的概率是1。
- en: 'With the transition matrices, we are finished. Now, we must define the rewards
    matrix. It is a 3x2 matrix: three states and two actions. Action 1 (NoSS) plans
    not to carry out additional operations; in this case, we will have a decreasing
    reward as we approach the end of the period in which the routine operation is
    scheduled (30 days). Then, the first column of the rewards matrix will take the
    following form:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 有了过渡矩阵，我们就完成了。现在，我们必须定义奖励矩阵。它是一个3x2的矩阵：三个状态和两个动作。动作1（NoSS）计划不进行额外操作；在这种情况下，随着我们接近常规操作计划的结束期（30天），奖励会递减。然后，奖励矩阵的第一列将呈现以下形式：
- en: '![](img/0e714634-9520-4bc9-92dc-2f638082b64b.png)'
  id: totrans-202
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0e714634-9520-4bc9-92dc-2f638082b64b.png)'
- en: 'Its meaning is obvious: if the chosen action is not to carry out the Sanitation-Sterilization
    operations, then we will have 3 of the reward for the first state, 2 of the reward
    for the second state, and the minimum reward for state 3\. In the case where the chosen action
    is to carry out Sanitation-Sterilization operations, we will have the following instead:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 其含义显而易见：如果选择的行动是不给予消毒-灭菌操作，那么在第一种状态下我们将获得3的奖励，在第二种状态下我们将获得2的奖励，而在第三种状态下将获得最小奖励。如果选择的行动是进行消毒-灭菌操作，那么我们将得到以下结果：
- en: '![](img/56d4446b-14be-426b-a4f4-6df0b5207a96.png)'
  id: totrans-204
  prefs: []
  type: TYPE_IMG
  zh: '![](img/56d4446b-14be-426b-a4f4-6df0b5207a96.png)'
- en: 'As we can see, things have been reversed with respect to the previous case:
    if the action that''s chosen is to carry out Sanitation-Sterilization operations,
    we will have 1 reward for the first state, 2 for the second state, and the maximum
    reward for the state 3.'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所见，情况与之前的情况相反：如果选择的行动是进行消毒-灭菌操作，那么在第一种状态下我们将获得1的奖励，在第二种状态下获得2的奖励，在第三种状态下获得最大奖励。
- en: 'Under these conditions, the rewards matrix becomes the following:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 在这些条件下，奖励矩阵变为以下形式：
- en: '![](img/c91f8b3e-9a6f-4a42-b4c5-20f9535be667.png)'
  id: totrans-207
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c91f8b3e-9a6f-4a42-b4c5-20f9535be667.png)'
- en: After defining the indispensable tools to be able to treat the problem as a
    Markov process, let's elaborate about the model.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 在定义了处理该问题所需的必要工具后，让我们继续构建模型。
- en: Model setting
  id: totrans-209
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 模型设置
- en: 'As we already mentioned, our goal is to calculate a policy that allows us to
    obtain the maximum prize based on the settings we just developed. This means reducing
    the risk of infection by minimizing the costs of Sanitation-Sterilization operations
    in the operating room. Let''s get started:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们已经提到的，我们的目标是计算一个策略，使我们能够根据刚刚开发的设置获得最大奖励。这意味着通过最小化手术室卫生消毒操作的成本，减少感染风险。让我们开始吧：
- en: 'Let''s take a look at the code that allows us to do this:'
  id: totrans-211
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们看一下允许我们执行此操作的代码：
- en: '[PRE42]'
  id: totrans-212
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'We will analyze the code line by line to understand the meaning of each command.
    Let''s start by importing the library:'
  id: totrans-213
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将逐行分析代码，以理解每条命令的含义。首先，导入库：
- en: '[PRE43]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: The **Markov decision process** (**MDP**) toolbox contains many functions that
    allow us to tackle the resolution of discrete-time Markov decision processes.
    We introduced the package in [Chapter 3](7ee860fd-cd4c-4034-8dd6-9c803e129418.xhtml),
    *Markov Decision Processes in Action*.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: '**马尔可夫决策过程**（**MDP**）工具箱包含许多功能，帮助我们解决离散时间马尔可夫决策过程的问题。我们在[第3章](7ee860fd-cd4c-4034-8dd6-9c803e129418.xhtml)中介绍了该包，*马尔可夫决策过程的实际应用*。'
- en: The first thing to do is define the matrices *P* for the transition matrix and
    *R* for the reward matrix. Both have been adequately introduced in the transition
    probability and rewards section.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 首先要做的是定义转移矩阵*P*和奖励矩阵*R*。这两个矩阵已经在转移概率和奖励部分进行了充分介绍。
- en: 'The transition matrix is a 3x3 matrix. To start, we will create a new matrix
    and initialize it to zero:'
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转移矩阵是一个3x3矩阵。首先，我们将创建一个新矩阵并初始化为零：
- en: '[PRE44]'
  id: totrans-218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'We need to define the transition matrix related to the action 1 (NoSS):'
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们需要定义与动作 1（NoSS）相关的转移矩阵：
- en: '[PRE45]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'The following matrix is defined:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 定义如下矩阵：
- en: '[PRE46]'
  id: totrans-222
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'Let''s define the transition matrix related to the action 2 (SS):'
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们定义与动作 2（SS）相关的转移矩阵：
- en: '[PRE47]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'The following matrix is defined:'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 定义如下矩阵：
- en: '[PRE48]'
  id: totrans-226
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'Let''s move on to the definition of the rewards matrix, as follows:'
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来我们定义奖励矩阵，如下所示：
- en: '[PRE49]'
  id: totrans-228
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'The following matrix is introduced:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 引入以下矩阵：
- en: '[PRE50]'
  id: totrans-230
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: Before proceeding with the development of the model, it is necessary to verify
    that `P` and `R` satisfy the criteria necessary for the problem to be of the MDP
    type.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 在继续开发模型之前，需要验证`P`和`R`是否满足将问题归类为MDP类型所必需的标准。
- en: 'To do this, we''ll use the `mdp_check()` function:'
  id: totrans-232
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为此，我们将使用`mdp_check()`函数：
- en: '[PRE51]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'This function performs a check on the MDP process that we defined by setting
    the transition probability matrix (*P*) and the reward matrix (*R*). If `P` and
    `R` have been set correctly, then the function returns an empty message. If `P`
    and `R` were not set correctly, then the function returns an error message describing
    the problem. The following result is returned:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 该函数对我们定义的MDP过程进行检查，通过设置转移概率矩阵(*P*)和奖励矩阵(*R*)。如果`P`和`R`设置正确，则函数返回一个空消息。如果`P`和`R`没有正确设置，函数将返回一条描述问题的错误消息。返回的结果如下：
- en: '[PRE52]'
  id: totrans-235
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'So, the problem has been set. Now, we can try to solve the problem by using
    the `mdp_Q_learning()` function, as follows:'
  id: totrans-236
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 所以，问题已经设置好了。现在，我们可以使用`mdp_Q_learning()`函数尝试解决问题，如下所示：
- en: '[PRE53]'
  id: totrans-237
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: The `mdp_Q_learning()` function solves discounted MDP with the Q-learning algorithm.
    As we mentioned in [Chapter 7](9a0709b1-fdad-4fba-8a06-30d68361b3b2.xhtml), *Temporal
    Difference Learning*, Q-learning is one of the most used reinforcement learning
    algorithms. Thanks to this technique, it is possible to find an optimal action
    for every given state in a finished MDP.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: '`mdp_Q_learning()`函数使用Q-learning算法解决折扣MDP。正如我们在[第7章](9a0709b1-fdad-4fba-8a06-30d68361b3b2.xhtml)中提到的，*时序差分学习*，Q-learning是最常用的强化学习算法之一。得益于这一技术，我们能够为每个给定状态在一个完成的MDP中找到最佳动作。'
- en: A general solution to the reinforcement learning problem is to estimate, thanks
    to the learning process, an evaluation function. This function must be able to
    evaluate, through the sum of the rewards, the convenience or otherwise of a particular
    policy. In fact, Q-learning tries to maximize the value of the Q function (action-value
    function), which represents the maximum discounted future reward when we perform
    actions *a* in the state *s*.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 强化学习问题的一般解法是通过学习过程估计一个评估函数。该函数必须能够通过奖励的总和来评估某一特定策略的优劣。实际上，Q-learning 试图最大化 Q
    函数（动作值函数）的值，该函数表示当我们在状态 *s* 下执行动作 *a* 时的最大折扣未来奖励。
- en: 'Q-learning estimates the function value 𝑞 (𝑠, 𝑎) incrementally, updating the
    value of the state-action pair at each step of the environment, by following the
    logic of updating the general formula for estimating the values for the TD methods.
    Q-learning has off-policy characteristics, that is, while the policy is improved
    according to the values estimated by 𝑞 (𝑠, 𝑎), the value function updates the
    estimates by following a strictly greedy secondary policy: given a state, the
    chosen action is always the one that maximizes the value max𝑞 (𝑠, 𝑎). However,
    the π policy has an important role in estimating values because through it, the
    state-action pairs to be visited and updated are determined.'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: Q-learning 通过逐步更新环境中状态-动作对的值，按照估算 TD 方法值的通用公式的更新逻辑，递增地估计函数值 𝑞(𝑠, 𝑎)。Q-learning
    具有离策略特性，即尽管策略是根据 𝑞(𝑠, 𝑎) 估算的值来改进的，但值函数通过遵循严格贪婪的二级策略来更新估算值：给定一个状态，选择的动作始终是最大化值
    max𝑞(𝑠, 𝑎) 的动作。然而，π 策略在估算值时扮演着重要角色，因为通过它可以确定要访问和更新的状态-动作对。
- en: 'The following arguments are passed:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 传入以下参数：
- en: '**P**: Transition probability array'
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**P**：转移概率数组'
- en: '**R**: Reward array'
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**R**：奖励数组'
- en: '**discount**: Discount factor—discount is a real number, which belongs to ]0;
    1['
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**折扣**：折扣因子——折扣是一个实数，属于 ]0; 1['
- en: 'The `mdp_Q_learning()` function computes the Q matrix, the mean discrepancy,
    and gives the optimal value function and the optimal policy when allocated enough
    iterations. The following results are returned:'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: '`mdp_Q_learning()` 函数计算 Q 矩阵、平均偏差，并在分配足够的迭代次数后给出最优值函数和最优策略。返回以下结果：'
- en: '**Q**: Action-value function'
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Q**：动作值函数'
- en: '**V**: Value function'
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**V**：值函数'
- en: '**policy**: Policy'
  id: totrans-248
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**policy**：策略'
- en: '`mean_discrepancy`: Discrepancy means over 100 iterations'
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`mean_discrepancy`：偏差表示经过100次迭代后的偏差'
- en: 'Now, we will look at the results:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们来看一下结果：
- en: 'Let''s analyze the results we''ve obtained, starting with the action-value
    function:'
  id: totrans-251
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们从动作值函数开始分析我们得到的结果：
- en: '[PRE54]'
  id: totrans-252
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: 'The following table is printed:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 打印出以下表格：
- en: '[PRE55]'
  id: totrans-254
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: The Q function represents the essential element of the procedure; it is a matrix
    of the same dimensions as the rewards matrix, that is, an SxA matrix. The value-action
    function returns the utility we expect to achieve by taking a given action in
    a given state and following an optimal policy.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: Q 函数代表了该过程的核心要素；它是与奖励矩阵相同维度的矩阵，即一个 SxA 矩阵。值-动作函数返回我们在给定状态下采取某个特定动作并遵循最优策略时期望达到的效用。
- en: 'Let''s print the value function:'
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们打印出值函数：
- en: '[PRE56]'
  id: totrans-257
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: 'The following vector is printed:'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 打印出以下向量：
- en: '[PRE57]'
  id: totrans-259
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: A value function represents how good a state is for an agent. It is equal to
    the total reward expected for an agent from the status *s*. The value function
    depends on the policy that the agent selects the actions to be performed with.
    *V* is an *S* length vector.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 值函数表示一个状态对于智能体的好坏。它等于智能体从状态 *s* 中期望获得的总奖励。值函数取决于智能体选择的策略，该策略决定了要执行的动作。*V* 是一个
    *S* 长度的向量。
- en: 'Then, we will extract the policy:'
  id: totrans-261
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们将提取策略：
- en: '[PRE58]'
  id: totrans-262
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: 'The following results are returned:'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 返回以下结果：
- en: '[PRE59]'
  id: totrans-264
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: A policy is an *S* length vector. Each element is an integer corresponding to
    an action that maximizes the value function. A policy defines the behavior of
    the learning agent at a given time. It maps the detected states of the environment
    and the actions to take when they are in those states. This corresponds to what,
    in psychology, would be called a set of rules or associations of stimulus response.
    The policy is the fundamental part of a reinforcing learning agent in the sense
    that it alone is enough to determine behavior.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 策略是一个 *S* 长度的向量。每个元素是一个整数，对应于最大化价值函数的动作。策略定义了在给定时刻学习代理的行为。它将环境的检测状态与在这些状态下采取的行动相对应。这与心理学中所说的刺激反应规则或关联集合相对应。策略是强化学习代理的基本部分，因为仅凭它就足以决定行为。
- en: So, the policy suggested by the method is not to carry out the Sanitation-Sterilization
    operations in the first two states, but to execute it if we are in state 3\. This
    is due to the low probability of developing an infection in the first two states,
    which becomes important in state 3.
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，方法建议的策略是在前两个状态下不进行卫生消毒操作，而是在处于状态 3 时执行。原因是，在前两个状态下感染的概率较低，而在状态 3 中则变得重要。
- en: 'Finally, we print the discrepancy means over 100 iterations:'
  id: totrans-267
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，我们打印了 100 次迭代中的不一致均值：
- en: '[PRE60]'
  id: totrans-268
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: 'The following table is printed:'
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格已打印：
- en: '![](img/15318d02-95bf-41bb-a472-89d352bee333.png)'
  id: totrans-270
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15318d02-95bf-41bb-a472-89d352bee333.png)'
- en: The `mean_discrepancy` value is a vector of *V* discrepancy mean over 100 iterations.
    Here, the length of the vector for the default value of *N* is 100.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: '`mean_discrepancy` 值是 *V* 的不一致均值向量，经过 100 次迭代。这里，默认的 *N* 值下，向量的长度为 100。'
- en: Summary
  id: totrans-272
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we learned how to use reinforcement learning in the field of
    health care. We began by analyzing an overview of the uses of machine learning-based
    algorithms in healthcare. We saw how these algorithms are used for the diagnosis
    of diseases, the prediction of epidemic events, and the testing of new drugs.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了如何在医疗领域使用强化学习。我们首先分析了基于机器学习算法在医疗中的应用概况。我们看到这些算法如何用于疾病诊断、流行病事件预测以及新药物测试。
- en: We then dealt with two practical cases. First, we saw how to tackle a problem
    related to healthcare insurance by modeling it as a Markov process. In this way,
    it is possible to foresee the probabilities with which a worker can be injured
    and quantify the premium that will have to be paid. In the second example, we
    determined the best policy to be adopted in the planning of operations for sanitizing
    an operating theater. The problem was solved through the use of the Q-learning
    technique.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们处理了两个实际案例。首先，我们看到如何通过将医疗保险问题建模为马尔科夫过程来解决问题。通过这种方式，可以预测工人受伤的概率，并量化需要支付的保费。在第二个例子中，我们确定了在手术室消毒操作计划中应该采用的最佳策略。这个问题通过
    Q-learning 技术得以解决。
- en: In the next chapter, we will explore the world of deep reinforcement learning
    and how neural networks can be used to make the best policy research operations
    even more efficient.
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将探索深度强化学习的世界，以及如何利用神经网络使最佳策略研究操作更加高效。
