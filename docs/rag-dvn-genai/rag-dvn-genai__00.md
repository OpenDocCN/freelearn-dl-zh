# 前言

设计和管理受控、可靠、多模态生成式 AI 管道是复杂的。*RAG 驱动的生成式 AI*为构建有效的 LLM、计算机视觉和生成式 AI 系统提供了路线图，这些系统将在性能和成本之间取得平衡。

从基础概念到复杂实现，本书详细探讨了 RAG 如何通过追踪每个输出到其源文档来控制和增强 AI 系统。RAG 的可追溯过程允许人类反馈以持续改进，最小化不准确、幻觉和偏见。这本 AI 书籍展示了如何从头开始构建 RAG 框架，提供了关于向量存储、分块、索引和排名的实用知识。你将发现优化性能和成本的技术，通过整合人类反馈提高模型准确性，平衡成本与何时微调，以及通过利用嵌入索引的知识图提高准确性和检索速度。

使用 LlamaIndex、Pinecone 和 Deep Lake 等框架以及 OpenAI 和 Hugging Face 等生成式 AI 平台，体验理论与实践的结合。

在本书结束时，你将掌握实施智能解决方案的技能，使你在从生产到客户服务的任何项目中保持竞争力。

# 这本书面向谁

这本书非常适合数据科学家、AI 工程师、机器学习工程师和 MLOps 工程师，以及从事 LLM 和计算机视觉项目、希望学习和应用 RAG 进行实际应用解决方案架构师、软件开发人员、产品和项目经理。与大型语言模型和文本生成一起工作的研究人员和自然语言处理从业者也会发现这本书很有用。

# 这本书涵盖的内容

*第一章*，*为什么需要检索增强生成式 AI？*介绍了 RAG 的基础概念，概述了其在不同数据类型上的适应性，并探讨了将 RAG 框架集成到现有 AI 平台中的复杂性。到本章结束时，你将获得对 RAG 的扎实理解，并在使用 Python 构建用于简单、高级和模块化 RAG 的多种配置方面获得实践经验，为你后续章节中更高级的应用做好准备。

*第二章*，*使用 Deep Lake 和 OpenAI 构建 RAG 嵌入向量存储*，深入探讨了由 RAG 驱动的生成式 AI 的复杂性，重点关注嵌入向量和它们的存储解决方案。我们通过使用 Activeloop Deep Lake 和 OpenAI 模型，探讨了从原始数据到组织化向量存储的过渡过程，详细介绍了创建和管理捕获深层语义意义的嵌入的过程。你将通过剖析 RAG 生态系统为独立组件，从零开始学习在 Python 中构建可扩展的多团队 RAG 管道。到本书结束时，你将能够处理大型数据集，并具备复杂的检索能力，通过嵌入文档向量增强生成式 AI 的输出。

*第三章*，*使用 LlamaIndex、Deep Lake 和 OpenAI 构建基于索引的 RAG*，深入探讨了基于索引的 RAG，重点关注通过索引增强 AI 的精确性、速度和透明度。我们将看到 LlamaIndex、Deep Lake 和 OpenAI 如何集成以构建可追踪和高效的 RAG 管道。通过实际案例，包括特定领域的无人机技术项目，你将学习如何管理和优化基于索引的检索系统。到结束时，你将熟练使用各种索引类型，并了解如何增强 AI 输出的数据完整性和质量。

*第四章*，*多模态模块化 RAG 在无人机技术中的应用*，通过引入一个针对无人机技术量身定制的多模态模块化 RAG 框架，提高了所有生成式 AI 应用的门槛。我们将开发一个生成式 AI 系统，它不仅处理文本信息，还整合了高级图像识别能力。你将学习如何使用 LlamaIndex、Deep Lake 和 OpenAI 等工具构建和优化基于 Python 的多模态模块化 RAG 系统，以生成丰富、上下文感知的查询响应。

*第五章*，*通过专家人类反馈提升 RAG 性能*，介绍了自适应 RAG，这是对标准 RAG 的创新增强，它将人类反馈整合到生成式 AI 过程中。通过直接集成专家反馈，我们将使用 Python 创建一个混合自适应 RAG 系统，探索将人类反馈循环整合以持续优化数据并提高 AI 响应的相关性和准确性。

*第六章*，*使用 Pinecone 扩展 RAG 银行客户数据*，引导你构建一个推荐系统以最小化银行客户流失，从使用 Kaggle 数据集进行数据获取和探索性分析开始。你将学习如何使用 Pinecone 和 OpenAI 的技术嵌入和更新大量数据，最终通过开发 GPT-4o 驱动的推荐系统达到高潮。到结束时，你将了解如何实施高级向量存储技术以及 AI 驱动的分析来增强客户保留策略。

*第七章*，*使用 Wikipedia API 和 LlamaIndex 构建可扩展的知识图谱 RAG*，详细介绍了三个管道的开发：从 Wikipedia 收集数据、填充 Deep Lake 向量存储以及实现基于知识图谱索引的 RAG。你将学习如何自动化数据检索和准备，创建和查询知识图谱以可视化复杂的数据关系，并通过结构化数据洞察增强 AI 生成的响应。到结束时，你将具备构建和管理基于知识图谱的 RAG 系统，提供精确、上下文感知的输出的能力。

*第八章*，*使用 Chroma 和 Hugging Face Llama 的动态 RAG*，探讨了使用 Chroma 和 Hugging Face 的 Llama 技术实现的动态 RAG。它介绍了每天创建临时数据集的概念，这些数据集针对特定会议或任务进行了优化，避免了长期数据存储问题。你将学习如何构建一个 Python 程序，有效地管理和查询这些短暂的数据集，确保最相关和最新的信息支持每一次会议或决策点。到结束时，你将能够实现增强数据驱动环境中响应速度和精确度的动态 RAG 系统。

*第九章*，*赋予 AI 模型力量：微调 RAG 数据和人类反馈*，专注于微调技术以简化 RAG 数据，强调如何将大量非参数原始数据转换为更易于管理的参数格式，并具有适合持续 AI 交互的经过训练的权重。你将探索准备和微调数据集的过程，使用 OpenAI 的工具将数据转换为机器学习的提示和完成对。此外，本章将指导你使用 OpenAI 的 GPT-4o-mini 模型进行微调，评估其效率和成本效益。

*第十章*，*使用 Pinecone 和 OpenAI 进行视频素材生产的 RAG*，探讨了 RAG 在视频素材生产中的集成，结合人类创造力和 AI 驱动的自动化。它详细介绍了构建一个 AI 系统，该系统可以生产、评论和标记视频内容，使用 OpenAI 的文本到视频和视觉模型以及 Pinecone 的向量存储功能。从视频生成和技术评论开始，这一过程扩展到在 Pinecone 向量存储中管理嵌入式视频数据。

# 为了充分利用这本书

你应该具备基本的**自然语言处理**（**NLP**）知识，并有一些 Python 经验。此外，本书中的大多数程序都提供为 Jupyter 笔记本。要运行它们，你需要一个免费的 Google Gmail 账户，允许你在 Google Colaboratory 的免费**虚拟机**（**VM**）上执行笔记本。你还需要为 OpenAI、Activeloop 和 Pinecone 生成 API 令牌。

运行笔记本时需要安装以下模块：

| **模块** | **版本** |
| --- | --- |
| `deeplake` | `3.9.18 (包含 Pillow)` |
| `openai` | `1.40.3 (需要定期升级)` |
| `transformers` | `4.41.2` |
| `numpy` | `>=1.24.1 (升级以满足 chex 要求)` |
| `deepspeed` | `0.10.1` |
| `bitsandbytes` | `0.41.1` |
| `accelerate` | `0.31.0` |
| `tqdm` | `4.66.1` |
| `neural_compressor` | `2.2.1` |
| `onnx` | `1.14.1` |
| `pandas` | `2.0.3` |
| `scipy` | `1.11.2` |
| `beautifulsoup4` | `4.12.3` |
| `requests` | `2.31.0` |

## 下载示例代码文件

该书的代码包托管在 GitHub 上，地址为[`github.com/Denis2054/RAG-Driven-Generative-AI`](https://github.com/Denis2054/RAG-Driven-Generative-AI)。我们还有其他丰富的书籍和视频代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。请查看它们！

## 下载彩色图像

我们还提供了一份包含本书中使用的截图/图表彩色图像的 PDF 文件。您可以从这里下载：[`packt.link/gbp/9781836200918`](https://packt.link/gbp/9781836200918)。

## 使用的约定

本书使用了多种文本约定。

`CodeInText`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。例如：“`self`指的是当前类的实例，以便访问其变量、方法和函数”。

代码块设置如下：

```py
# Cosine Similarity
score = calculate_cosine_similarity(query, best_matching_record)
print(f"Best Cosine Similarity Score: {score:.3f}") 
```

任何命令行输入或输出都按以下方式编写：

```py
Best Cosine Similarity Score: 0.126 
```

**粗体**：表示新术语、重要单词或您在屏幕上看到的单词。例如，菜单或对话框中的文本如下所示。以下是一个示例：“**模块化 RAG**实现灵活的检索方法”。

警告或重要提示如下所示。

技巧和窍门如下所示。

# 联系我们

读者反馈始终欢迎。

**一般反馈**：请发送电子邮件至`feedback@packtpub.com`，并在邮件主题中提及书名。如果您对此书的任何方面有疑问，请通过`questions@packtpub.com`发送电子邮件给我们。

**勘误**：尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在此书中发现错误，我们将不胜感激，如果您能向我们报告，我们将不胜感激。请访问[`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，选择您的书籍，点击勘误提交表单链接，并输入详细信息。

**盗版**：如果您在互联网上以任何形式遇到我们作品的非法副本，我们将不胜感激，如果您能提供位置地址或网站名称，我们将不胜感激。请通过`copyright@packtpub.com`与我们联系，并提供材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且有兴趣撰写或参与一本书，请访问[`authors.packtpub.com`](http://authors.packtpub.com)。

# 分享您的想法

一旦您阅读了《RAG-Driven Generative AI》，我们很乐意听到您的想法！请[点击此处直接进入此书的亚马逊评论页面](https://packt.link/r/1836200919)并分享您的反馈。

您的评论对我们和科技社区都很重要，并将帮助我们确保我们提供高质量的内容。

# 下载此书的免费 PDF 副本

感谢您购买此书！

您喜欢在路上阅读，但又无法携带您的印刷书籍到处走吗？

您的电子书购买是否与您选择的设备不兼容？

别担心，现在每购买一本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何时间、任何设备上阅读。直接从您最喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠远不止这些，您还可以获得独家折扣、时事通讯和每日邮箱中的优质免费内容。

按照以下简单步骤获取优惠：

1.  扫描下面的二维码或访问以下链接：

![](img/B31169_Free_PDF_QR.png)

[`packt.link/free-ebook/9781836200918`](https://packt.link/free-ebook/9781836200918)

1.  提交您的购买证明。

1.  就这样！我们将直接将您的免费 PDF 和其他优惠发送到您的邮箱。
