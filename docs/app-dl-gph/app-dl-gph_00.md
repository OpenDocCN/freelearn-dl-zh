# 序言

近年来，社交网络、分子结构、推荐系统和计算机视觉等领域网络化数据的快速增长，凸显了更好地处理图结构数据方法的需求。传统的深度学习模型在处理网格状数据（如图像）和序列数据（如文本）时表现良好，但这些模型在处理不规则结构（如图）时却力不从心。

欢迎来到*图谱深度学习应用*，本书通过探讨图论和深度学习交叉领域的前沿技术，解决了这一挑战，提供了来自领先公司实际应用的策略和见解。

本书的作者凭借在 Adobe、沃尔玛和 Meesho 等公司实施基于图的解决方案的经验，亲眼见证了这些技术如何转变业务应用。本书提供了理解和应用图深度学习的清晰、全面的指南，将理论基础与来自大规模行业实施的实践见解相结合。

# 本书适合的读者

本书面向多种技术受众。数据科学家、机器学习从业者以及希望将自己的专业知识扩展到图形数据分析的研究人员，将找到有实践指导的真实世界例子。此外，参与图相关应用的软件工程师，也能从这里提供的动手操作方法和实现细节中获益。

本书同样对技术领导者和企业家有着同样的价值，他们需要理解图深度学习的战略意义。我们提供了图方法如何应用于各个领域的全面概述，帮助决策者识别机会并构建适合特定业务需求的解决方案。本书弥合了理论概念和实际应用之间的差距，成为技术执行和战略规划的多功能参考书。

# 本书内容

*第一章*，*图谱学习简介*，介绍了图谱学习，解释了图谱如何比传统的表格数据结构更有效地表示复杂关系，并通过多种类型的图、它们的属性和计算表示来加以说明。

*第二章*，*图谱学习在实际应用中的探索*，全面探讨了图谱学习的三个基本层次：节点层（预测单个节点的属性）、边缘层（分析节点之间的关系）和图层（研究整个图结构），并结合在推荐系统、知识图谱、网络安全和**自然语言** **处理**（**NLP**）等方面的实际应用。

*第三章*，*图表示学习*，解释了图表示学习技术，重点介绍了浅层编码方法，如 DeepWalk 和 Node2Vec，这些方法通过随机游走在图中生成节点嵌入。

*第四章*，*图的深度学习模型*，详细探讨了**图神经网络**（**GNNs**），包括消息传递机制和三种关键架构：**图卷积网络**（**GCNs**）、GraphSAGE 和**图注意力网络**（**GATs**）。

*第五章*，*图深度学习的挑战*，详尽地介绍了图深度学习中的主要挑战，包括数据相关问题、模型架构局限性、计算约束、特定任务的问题以及图神经网络（GNNs）的可解释性问题。

*第六章*，*利用大型语言模型进行图学习*，探讨了如何通过特征增强、预测能力和**检索增强生成**（**RAG**）方法，利用**大型语言模型**（**LLMs**）来提升图学习任务。

*第七章*，*图深度学习实践*，展示了如何使用 PyTorch Geometric 在社交网络分析中实施图深度学习技术，重点介绍了大学生网络中的节点分类和链接预测任务。

*第八章*，*图深度学习在自然语言处理中的应用*，探讨了图深度学习技术如何应用于 NLP 任务，包括语言学图结构、文本摘要、信息抽取和对话系统。

*第九章*，*使用图深度学习构建推荐系统*，全面介绍了如何使用图深度学习构建和实现推荐系统，包括基本概念、图结构、模型架构和训练技术。

*第十章*，*图深度学习在计算机视觉中的应用*，介绍了如何通过将视觉数据表示为图，利用图神经网络（GNNs）增强计算机视觉任务，相比传统基于网格的**卷积神经网络**（**CNN**）方法，可以更好地建模关系和结构属性。

*第十一章*，*新兴应用*，探讨了图深度学习在六个主要领域中的最新应用：生物学/医疗、社交网络、金融服务、网络安全、能源系统和**物联网**（**IoT**）。

*第十二章*，*图学习的未来*，探讨了图学习的未来发展趋势，涵盖了新兴趋势、先进架构、**人工智能**（**AI**）集成以及量子计算、**通用人工智能**（**AGI**）和元宇宙应用等领域的潜在突破。

# 为了从本书中获得最大收益

为了最大化地利用本书，你应该具备机器学习基础、基本图论和编程概念的基础。我们假设你已经熟悉 Python 编程，并且有神经网络和深度学习原理的工作理解。提前了解数据结构和算法将是有益的，但不是必须的。

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Jupyter Lab/Google Colab | Windows、macOS 或 Linux |
| Python |

为了成功地使用本书中的示例，你需要为你的 Python 环境设置几个必备的软件包。首先安装核心库：

+   **PyTorch** 用于深度学习操作

+   **PyTorch Geometric** 用于基于图的神经网络

+   **NetworkX** 用于图的操作和分析

+   **NumPy** 和 **pandas** 用于数据处理和数值计算

这些可以通过 **pip** 或 **conda** 包管理器进行安装。

为了获得最佳性能，确保你的系统至少有 8 GB 的内存和相对现代的 CPU。虽然对于运行较小的示例来说，GPU 并不是绝对必要的，但拥有 GPU 会显著加速较大模型和更复杂图操作的训练过程。

**如果你正在使用本书的数字版，我们建议你自己输入代码或从本书的 GitHub 仓库中访问代码（下一节提供了链接）。这样做有助于避免与代码复制和粘贴相关的潜在错误。**

# 下载示例代码文件

你可以从 GitHub 下载本书的示例代码文件，网址为 [`github.com/PacktPublishing/Applied-Deep-Learning-on-Graphs`](https://github.com/PacktPublishing/Applied-Deep-Learning-on-Graphs)。如果代码有更新，它会在 GitHub 仓库中进行更新。

我们还提供了其他来自我们丰富书籍和视频目录的代码包，访问地址为 [`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)。快去看看吧！

# 使用的约定

本书中使用了若干文本约定。

**文本中的代码**：表示文本中的代码单词、数据库表名、文件夹名称、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 账号。示例如下：“我们使用 **model.eval()** 设置模型为评估模式。”

一段代码块如下所示：

```py
model.eval()
_, pred = model(data.x, data.edge_index).max(dim=1)
correct = float(pred[data.test_mask].eq(
    data.y[data.test_mask]).sum().item())
accuracy = correct / data.test_mask.sum().item()
print(f'Accuracy: {accuracy:.4f}')
```

当我们希望你注意代码块中特定部分时，相关行或项会以粗体显示：

```py
import torch
import torch.nn.functional as F
from torch_geometric.datasets import Planetoid
from torch_geometric.nn import GCNConv
# Load the Cora dataset
dataset = Planetoid(root='data/Cora', name='Cora')
```

任何命令行输入或输出如下所示：

```py
pip install torch torch_geometric scikit-learn matplotlib networkx
```

**粗体**：表示一个新术语、一个重要词汇，或你在屏幕上看到的词汇。例如，菜单或对话框中的词语通常以**粗体**显示。比如：“在一个电子商务系统中，一个可能的用例是预测客户的**生命周期价值**（**LTV**），这基于他们与产品及其他功能的互动。”

提示或重要事项

显示如下。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**：如果你对本书的任何部分有疑问，请通过电子邮件联系我们，customercare@packtpub.com，并在邮件主题中注明书名。

**勘误表**：尽管我们已尽最大努力确保内容的准确性，但错误仍然可能发生。如果你在本书中发现了错误，我们将非常感谢你向我们报告。请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表格。

**盗版**：如果你在互联网上遇到我们作品的任何非法复制品，我们将非常感谢你提供其网址或网站名称。请通过版权@packt.com 与我们联系，并提供材料链接。

**如果你有兴趣成为作者**：如果你在某个领域有专业知识，并且有兴趣写书或参与书籍的编写，请访问[authors.packtpub.com](http://authors.packtpub.com)。

# 分享你的想法

一旦你读完了*《应用深度学习：图形分析》*，我们很想听听你的想法！请[点击这里直接进入亚马逊评论页面](https://packt.link/r/1-835-88597-7)并分享你的反馈。

你的评论对我们和技术社区非常重要，将帮助我们确保提供优质的内容。

# 下载本书的免费 PDF 副本

感谢你购买本书！

你喜欢随时随地阅读，但又无法随身携带纸质书籍吗？

你的电子书购买是否与你选择的设备不兼容？

别担心，现在每本 Packt 书籍都可以免费获得无 DRM 保护的 PDF 版本。

在任何地方、任何设备上随时阅读。直接在应用程序中搜索、复制并粘贴你最喜欢的技术书籍中的代码。

福利不止于此，你还可以获得独家折扣、新闻通讯，并每天在邮箱中收到精彩的免费内容。

按照以下简单步骤来享受福利：

1.  扫描二维码或访问以下链接

![img](img/B22118_QR_Free_PDF.jpg)

[`packt.link/free-ebook/978-1-83588-596-3`](https://packt.link/free-ebook/978-1-83588-596-3)

1.  提交你的购买凭证

1.  就这些！我们将直接把免费的 PDF 和其他福利发送到你的电子邮件。

# 第一部分：图学习的基础

在本书的第一部分，您将概览图学习的基本概念，包括基础定义、现实世界的应用和核心表示技术。您将了解理解图形机器学习所需的基本构建块，跨行业的实际应用案例，以及在机器学习环境中表示图数据的各种方法。

本部分包括以下章节：

+   *第一章*，*图学习简介*

+   *第二章*，*图学习在现实世界中的应用*

+   *第三章*，*图表示学习*
