# 前言

Python 是最广泛使用的自然语言处理（**自然语言处理**）语言，这得益于其丰富的文本分析和提取计算机可用数据的工具和库。本书将向您介绍一系列文本处理技术，从基本的词性分析到复杂的话题，如主题建模、文本分类和可视化。

本书从自然语言处理概述开始，提供了将文本划分为句子、词干提取和词形还原、去除停用词以及词性标注的食谱，以帮助您准备数据。然后，您将了解提取和表示语法信息的方法，例如依存句法分析和反身代词消解；发现使用词袋、TF-IDF、词嵌入和 BERT 等不同方式表示语义的不同方法；并发展使用关键词、SVM、LSTM 等其他技术进行文本分类的技能。

随着您的进步，您还将了解如何从文本中提取信息，实现无监督和监督的主题建模技术，并对短文本，如推文进行主题建模。此外，本书还涵盖了文本数据的可视化。

最后，本书介绍了基于 Transformer 的模型及其如何利用它们执行另一组新颖的自然语言处理任务。这些基于编码器-解码器的模型是深度神经网络模型，并在大型文本语料库上进行了训练。这些模型在各种自然语言处理任务上已经实现了或超过了最先进的技术。特别是基于解码器的生成模型，它们具有根据提供的上下文生成文本的能力。其中一些模型内置了推理能力。这些模型将把自然语言处理带入下一个时代，使其成为主流技术应用的一部分。

在阅读完这本自然语言处理书籍之后，您将掌握使用强大的文本处理工具集的技能。

# 本书面向的对象

数据科学家、机器学习工程师和熟悉基本编程和数据科学概念的开发者可以从本书中获得实际见解。本书作为入门书籍，介绍了自然语言处理的概念及其实际应用。

本书的目标角色如下：

**数据科学家**：作为数据科学家，您将了解如何处理文本。具备中级 Python 知识将帮助您充分利用本书。如果您已经是自然语言处理从业者，本书将在您进行项目开发时作为代码参考。

**软件工程师和架构师**：希望在该领域建立自然语言处理能力的开发者将了解自然语言处理在文本处理中的所有基本和高级应用。这将帮助您提升知识水平，并在需要时开发使用自然语言处理技术的解决方案。

**产品经理**：尽管这本书包含了食谱的代码示例，但每个食谱都附有解释为什么执行某些步骤以及这些步骤的最终输出是什么。这使得它成为产品经理的有用资源，他们想了解使用某种自然语言处理食谱可以实现什么，这将使他们能够设想使用它的新颖解决方案。

# 本书涵盖的内容

[*第一章*](B18411_01.xhtml#_idTextAnchor013)，*学习NLP基础*，介绍了自然语言处理的基本知识。本章中的食谱展示了进行进一步自然语言处理工作所需的基本预处理步骤。我们展示了如何标记文本，或将其划分为句子和单词；为单个单词分配词性；词元化它们，或获取它们的规范形式；以及去除停用词。

[*第二章*](B18411_02.xhtml#_idTextAnchor042)，*玩转语法*，展示了如何从文本中获取语法信息。这些信息在确定文本中提到的不同实体之间的关系时可能很有用。我们首先展示如何确定一个名词是单数还是复数。然后，我们展示如何获取一个句子中词语之间关系的依存句法分析。接着，我们演示如何获取名词短语，即带有其依赖词（如形容词）的名词。之后，我们研究如何解析句子的主语和宾语。最后，我们展示如何使用正则表达式风格的匹配器从句子中提取语法短语。

[*第三章*](B18411_03.xhtml#_idTextAnchor067)，*表示文本 – 捕捉语义*，探讨了在自然语言处理模型中进一步处理文本的不同方法。由于计算机不能直接处理单词，我们需要将它们编码成向量形式。为了展示不同编码方法的有效性，我们首先创建了一个简单的分类器，然后使用不同的编码方法。我们考虑以下编码方法：词袋模型、N-gram模型、TF-IDF、词嵌入、BERT和OpenAI嵌入。我们还展示了如何训练自己的词袋模型，并演示了如何创建一个简单的**检索增强生成**（**RAG**）解决方案。

[*第四章*](B18411_04.xhtml#_idTextAnchor106)，*文本分类*，展示了执行文本分类的各种方法，这是最常见的一种自然语言处理任务。首先，我们展示如何预处理数据集以准备分类。然后，我们演示不同的分类器，包括基于规则的分类器、通过K-means的无监督分类器、训练用于分类的支持向量机（SVM）、训练用于文本分类的spaCy模型，以及最终使用OpenAI GPT模型进行文本分类。

[*第5章*](B18411_05.xhtml#_idTextAnchor128)，*信息提取入门*，展示了如何从文本中提取信息，这是另一个非常重要的NLP任务。我们首先使用正则表达式进行简单的信息提取。然后我们看看如何使用Levenshtein距离来处理拼写错误。然后，我们展示了如何从不同的文本中提取特征关键词。我们探讨了如何使用spaCy提取命名实体，以及如何训练自己的定制spaCy NER模型。最后，我们展示了如何微调BERT NER模型。

[*第6章*](B18411_06.xhtml#_idTextAnchor156)，*主题建模*，展示了如何使用各种无监督方法确定文本的主题，包括LDA、基于BERT嵌入的社区检测、K-means聚类和BERTopic。最后，我们使用与多语言模型和输入一起工作的上下文主题模型。

[*第7章*](B18411_07.xhtml#_idTextAnchor177)，*可视化文本数据*，专注于使用各种工具创建文本数据和处理的富有信息性的可视化。我们创建了依存句法分析、词性和命名实体的图形表示。我们还创建了混淆矩阵图和词云。最后，我们使用pyLDAvis和BERTopic来可视化文本中的主题。

[*第8章*](B18411_08.xhtml#_idTextAnchor205)，*Transformer及其应用*，提供了对Transformer的介绍。本章首先演示了如何将文本转换为适合Transformer模型内部处理的格式。然后探讨了使用预训练的Transformer模型进行文本分类的技术。此外，本章深入探讨了使用Transformer进行文本生成，解释了如何调整生成参数以产生连贯且自然的声音的文本。最后，它涵盖了Transformer在语言翻译中的应用。

[*第9章*](B18411_09.xhtml#_idTextAnchor231)，*自然语言理解*，涵盖了帮助推断文本中包含的信息的NLP技术。本章首先讨论了开放和封闭域中的问答，然后讨论了使用提取和抽象方法从文档来源回答问题的方法。随后的部分涵盖了文本摘要和句子蕴涵。本章以可解释性技术结束，这些技术展示了模型如何做出分类决策以及文本的不同部分如何有助于分配给定的类别标签。

[*第10章*](B18411_10.xhtml#_idTextAnchor277)，*生成式AI和大型语言模型*，介绍了开源**大型语言模型**（**LLMs**）如Mistral和Llama，演示了如何使用提示根据简单的人类定义要求生成文本。它进一步探讨了从自然语言指令生成Python代码和SQL语句的技术。最后，它介绍了利用来自OpenAI的复杂闭源LLM来编排自定义任务代理的方法。这些代理协同工作，通过网络搜索和基本算术来回答需要复杂问题的解决方案。

## 为了充分利用本书

您需要了解Python编程语言以及如何管理和安装其包。了解Jupyter Notebook会有所帮助，尽管这不是必需的。对于包管理，建议了解`poetry`包管理，尽管您也可以通过`pip`使示例工作。为了能够在系统中使用GPU（如果有的话），请确保已安装最新的GPU设备驱动程序以及CUDA/cuDNN依赖项。

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Python 3.10 | Windows、macOS或Linux |
| Poetry | Windows、macOS或Linux |
| Jupyter Notebook（可选） | Windows、macOS或Linux |

**如果您使用的是本书的数字版，我们建议您亲自输入代码或从书的GitHub仓库（下一节中提供链接）获取代码。这样做将帮助您避免与代码的复制和粘贴相关的任何潜在错误。**

# 下载示例代码文件

您可以从GitHub下载本书的示例代码文件[https://github.com/PacktPublishing/Python-Natural-Language-Processing-Cookbook-Second-Edition](https://github.com/PacktPublishing/Python-Natural-Language-Processing-Cookbook-Second-Edition)。如果代码有更新，它将在GitHub仓库中更新。

我们还有其他来自我们丰富的书籍和视频目录的代码包，可在[https://github.com/PacktPublishing/](https://github.com/PacktPublishing/)找到。查看它们吧！

# 使用的约定

本书使用了几个文本约定。

`文本中的代码`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟URL、用户输入和*Twitter/X*用户名。以下是一个示例：“实例化一个`bert-base-cased`类型的分词器。”

代码块设置如下：

```py
from transformers import pipeline
import torch
```

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

```py
from transformers import T5Tokenizer, T5ForConditionalGeneration
import torch
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
```

任何命令行输入或输出都应如下编写：

```py
Classification Results
{'accuracy': 0.88,
'precision': 0.92,
'recall': 0.84}
```

**粗体**：表示新术语、重要单词或屏幕上看到的单词。例如，菜单或对话框中的单词以**粗体**显示。以下是一个示例：“从**管理**面板中选择**系统信息**。”

小贴士或重要注意事项

看起来像这样。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**：如果您对此书的任何方面有疑问，请通过[customercare@packtpub.com](mailto:customercare@packtpub.com)给我们发邮件，并在邮件主题中提及书名。

**勘误表**：尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在此书中发现错误，我们将不胜感激，如果您能向我们报告，请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表格。

**盗版**：如果您在互联网上以任何形式发现我们作品的非法副本，如果您能提供位置地址或网站名称，我们将不胜感激。请通过[版权@packt.com](mailto:copyright@packt.com)与我们联系，并提供材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问 [authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

一旦您阅读了《Python自然语言处理食谱》，我们非常乐意听到您的想法！请[点击此处直接转到此书的亚马逊评论页面](https://packt.link/r/1-803-24574-3)并分享您的反馈。

您的评论对我们和科技社区非常重要，并将帮助我们确保我们提供高质量的内容。

# 下载此书的免费PDF副本

感谢您购买此书！

您喜欢在路上阅读，但无法携带您的印刷书籍到处走？

您的电子书购买是否与您选择的设备不兼容？

别担心，现在每本Packt书籍都附带一本无DRM的PDF版本，无需额外费用。

在任何地方、任何设备上阅读。直接从您喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠不止于此，您还可以获得独家折扣、时事通讯和每日免费内容的每日电子邮件。

按照以下简单步骤获取优惠：

1.  扫描二维码或访问以下链接

![图片](img/B18411_QR_Free_PDF.jpg)

[https://packt.link/free-ebook/978-1-80324-574-4](https://packt.link/free-ebook/978-1-80324-574-4)

1.  提交您的购买证明

1.  就这些！我们将直接将您的免费PDF和其他优惠发送到您的电子邮件。
