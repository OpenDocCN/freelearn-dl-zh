使用 LangChain 进行生成式 AI

第二版

使用 Python、LangChain 和 LangGraph 构建生产就绪的 LLM 应用程序和高级代理

本·奥夫阿特

列昂尼德·库利金

![新 Packt 标志](img/New_Packt_Logo.png)

使用 LangChain 进行生成式 AI

第二版

版权所有 © 2025 Packt Publishing

*版权所有。未经出版者事先书面许可，本书的任何部分不得以任何形式或通过任何手段进行复制、存储在检索系统中或以任何方式传播，除非在评论或评论中嵌入的简短引用。*

在准备本书的过程中，已尽一切努力确保所提供信息的准确性。然而，本书中的信息销售不附带任何明示或暗示的保证。作者、Packt Publishing 或其经销商和分销商不对由此书直接或间接造成的任何损害承担责任。

Packt Publishing 尽力通过适当使用大写字母提供本书中提到的所有公司和产品的商标信息。然而，Packt Publishing 不能保证此信息的准确性。

**投资组合总监:** Gebin George

**关系负责人:** Ali Abidi

**项目经理:** Prajakta Naik

**内容工程师:** Tanya D’cruz

**技术编辑:** Irfa Ansari

**编辑:** Safis Editing

**索引者:** Manju Arasan

**校对:** Tanya D’cruz

**生产设计师:** Ajay Patule

**增长负责人**: Nimisha Dua

首次出版：2023 年 12 月

第二版：2025 年 5 月

生产参考：1190525

由 Packt Publishing Ltd. 出版

格罗斯文诺大厦

11 圣保罗广场

伯明翰

B3 1RB，英国。

ISBN 978-1-83702-201-4

[www.packtpub.com](https://www.packtpub.com/)

*致在我一生中指导我的人——特别是托尼·林德贝格，他的个人正直和毅力是我巨大的灵感源泉——以及我的儿子尼古拉斯和我的伴侣黛安。*

*——本·奥夫阿特*

*致我的妻子克谢尼亚，她坚定不移的爱和乐观一直是我多年来的坚定支持；致我的岳母塔蒂亚娜，她对我的信念——即使在我最疯狂的努力中——是一种难以置信的力量源泉；以及我的孩子们，马特维和米莱娜：我希望你们有一天能读到它。*

*——列昂尼德·库利金*

# 第一章：贡献者

# 关于作者

本·奥夫阿特博士，拥有超过 15 年的工作经验，是一位 AI 实施专家。作为切尔西 AI 风险投资公司的创始人，他专注于帮助小型和中型企业实施能够带来切实回报的企业级 AI 解决方案。他的系统已经防止了数百万的欺诈损失，并以低于 300 毫秒的延迟处理交易。凭借计算神经科学的背景，本为实用 AI 应用带来了罕见的深度——从超级计算机脑模型到结合技术卓越与商业战略的生产系统。

首先和最重要的是，我要感谢我的合著者，Leo——一位超级程序员，他在整个过程中都表现出了耐心，并在需要建议时总是随时准备着。如果没有 Packt 的同事们，这本书也不会成为现在这个样子，特别是我们的编辑 Tanya，她总是在需要时提供洞察力和鼓励的话语。最后，审稿人们非常乐于助人，他们的批评非常慷慨，确保我们没有遗漏任何内容。任何剩余的错误或疏忽都是完全我的责任。

Leonid Kuligin 是谷歌云的一名员工 AI 工程师，专注于生成式 AI 和经典机器学习解决方案，如需求预测和优化问题。Leonid 是 LangChain 在谷歌云集成方面的关键维护者，并在 CDTM（慕尼黑工业大学和慕尼黑大学联合机构）担任客座讲师。在谷歌之前，Leonid 在德国、俄罗斯和美国的科技、金融和零售公司积累了超过 20 年的基于复杂机器学习和数据处理解决方案（如搜索、地图和投资管理）构建 B2C 和 B2B 应用的经验。

我想要向所有在谷歌工作的同事们表达我真诚的感激之情，与他们一起工作是一种乐趣和快乐，他们在本书的创作以及许多其他事业中支持了我。特别感谢 Max Tschochohei、Lucio Floretta 和 Thomas Cliett。我的感激之情也延伸到整个 LangChain 社区，特别是 Harrison Chase，他持续开发 LangChain 框架，使我的工程师工作大大简化。

# 关于审稿人

Max Tschochohei 为企业客户提供如何在谷歌云实现他们的 AI 和 ML 雄心的建议。作为谷歌云咨询的工程经理，他领导着 AI 工程师团队在关键客户项目上工作。虽然他的工作涵盖了谷歌云产品组合中所有 AI 产品和解决方案的全范围，但他特别对代理系统、机器学习运营和 AI 在医疗保健中的应用感兴趣。在慕尼黑加入谷歌之前，Max 在 KPMG 和波士顿咨询集团担任了多年的顾问，他还领导了新加坡政府组织 NTUC Enterprise 的数字化转型。Max 持有来自考文垂大学的*经济学博士*学位。

Rany ElHousieny 是一位拥有超过二十年在 AI、NLP 和 ML 领域经验的 AI 解决方案架构师和 AI 工程经理。在他的职业生涯中，他专注于 AI 模型的开发和部署，撰写了多篇关于 AI 系统架构和道德 AI 部署的文章。他在微软等公司领导了开创性的项目，在那里他推动了 NLP 和语言理解智能服务（LUIS）的进步。目前，他在 Clearwater Analytics 公司扮演着关键角色，推动生成式 AI 和 AI 驱动的金融和投资管理解决方案的创新。

尼古拉斯·比埃弗（Nicolas Bievre）是 Meta 的机器学习工程师，在 AI、推荐系统、LLMs 和生成式 AI 方面拥有丰富的经验，这些应用领域包括广告和医疗保健。他在 Meta 和 PayPal 担任过关键的 AI 领导角色，设计和实施用于为上亿用户个性化内容的大型推荐系统。他毕业于斯坦福大学，在该校发表了被同行评审的 AI 和生物信息学领域的领先期刊的研究成果。尼古拉斯因其在国际上的贡献而获得认可，获得了“核心广告增长隐私”奖和“海外杰出人才”奖等荣誉。他还担任法国政府的 AI 咨询师，以及顶级 AI 组织的审稿人。

# 加入我们的 Discord 和 Reddit 社区

对本书有任何疑问或想参与关于生成式 AI 和 LLMs 的讨论？加入我们的 Discord 服务器，网址为 [`packt.link/4Bbd9`](https://packt.link/4Bbd9)，以及我们的 Reddit 频道 [`packt.link/wcYOQ`](https://packt.link/wcYOQ)，与志同道合的 AI 专业人士建立联系、分享和协作。

| **Discord 二维码** | **Reddit 二维码** |
| --- | --- |
| ![](img/Discord_QR_Code_2.png) | ![](img/Reddit_QRcode.png) |
