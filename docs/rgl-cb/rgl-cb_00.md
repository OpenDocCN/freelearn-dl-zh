# 序言

你是否曾想过为什么如此多的机器学习项目在生产环境中失败？

在许多情况下，这是由于模型缺乏泛化能力，导致在面对新的、未见过的数据时做出意外的预测。这就是正则化的核心：确保即使面对新数据，模型也能提供预期的预测。

在本书中，我们将探讨多种形式的正则化。为了实现这一点，我们将根据本章中的方案，探索两条主要的正则化解决方案路径：

+   当给定一个机器学习模型时，我们如何进行正则化？正则化最适合用于模型已经被设定（无论是更新已有的遗留解决方案，还是有强需求）的应用场景，且训练数据是固定的，因此唯一的解决方案是对模型进行正则化。

+   给定一个机器学习任务，我们如何获得一个稳健、良好泛化的解决方案？这种方法最适合用于那些仅定义了问题但尚未提供强约束条件的应用场景，从而可以探索更多的解决方案。

希望这些方法能够为你提供必要的工具和技巧，以解决你可能面临的需要正则化的绝大多数机器学习问题，并且深入理解其中的基本概念。

# 本书适合谁阅读

本书适合任何有一定 Python 知识的人：充分理解本书所提出的解决方案的唯一要求是你能够阅读和运行简单的 Python 代码。对于每一种新方法或模型，都会提供一些背景和实用的解释，以便任何具有计算机科学背景的人都能完全理解自己在做什么。

虽然任何 Python 从业者都可以跟随本书学习，但主要目标读者是以下人群：

+   机器学习从业者，如机器学习工程师、应用科学家和数据科学家，他们希望在面对新问题或任务时，可以从本书中挑选现成的解决方法和代码。通过本书，希望他们能够通过稍微调整代码，处理许多不同的情况。

+   想要深入了解机器学习的爱好者，通过具体的实例和可运行的代码获得更深的理解。通过本书，他们可以通过动手实践，深入掌握知识，并构建一个扎实的项目组合。

# 本书的内容

*第一章*，*正则化概述*，为正则化提供了一个高层次的介绍，并提供了所有基本知识和词汇，帮助读者完全理解本书后续章节的内容。

*第二章*，*机器学习复习*，引导你通过一个典型的机器学习工作流程和最佳实践，从数据加载和划分到模型训练和评估。

*第三章*，*线性模型中的正则化*，介绍了常见线性模型的正则化：线性回归和逻辑回归。包括 L1 和 L2 惩罚的正则化，以及如何选择合适正则化方法的一些实用技巧。

*第四章*，*基于树的模型中的正则化*，提供了关于决策树（用于分类和回归）的提醒，以及如何对其进行正则化。接着介绍了集成方法，如随机森林和梯度提升，以及它们的正则化方法。

*第五章*，*数据正则化*，介绍了通过数据进行正则化，利用哈希及其特性和特征聚合。接着介绍了处理不平衡数据集的重采样方法。

*第六章*，*深度学习提醒*，提供了有关深度学习的概念性和实践性提醒。从感知机开始，然后我们训练回归和分类模型。

*第七章*，*深度学习正则化*，介绍了深度学习模型的正则化。探讨并解释了几种技术：L2 惩罚、提前停止、网络架构和 dropout。

*第八章*，*使用循环神经网络的正则化*，深入探讨了**循环神经网络**（**RNNs**）和**门控循环单元**（**GRUs**）。首先解释了它们是什么以及如何训练这些模型。接着介绍了正则化技术，例如 dropout 和最大序列长度。

*第九章*，*自然语言处理中的高级正则化*，探讨了专门针对**自然语言处理**（**NLP**）的正则化方法。介绍了使用 word2vec 嵌入和 BERT 嵌入的正则化技术。还探讨了使用 word2vec 和 GPT-3 的数据增强方法，并提出了零-shot 推理解决方案。

*第十章*，*计算机视觉中的正则化*，深入探讨了计算机视觉中的正则化和**卷积神经网络**（**CNNs**）。在概念和实践上解释了 CNNs 在分类中的应用，然后提供了适用于物体检测和语义分割的正则化方案。

*第十一章*，*计算机视觉中的正则化* *–* *合成图像生成*，深入探讨了用于正则化的合成图像生成。首先探讨了简单的数据增强方法。然后，使用仅有合成训练数据的 QR 码物体检测机制得到了构建。最后，我们探索了一种基于 Stable Diffusion 数据进行训练的实时风格迁移，并解释了如何独立使用该数据集进行工作。

# 为了从本书中获得最大的收获

您需要安装 Python 的某个版本。所有代码都已在 Ubuntu 22.04 上使用 Python 3.10 和 CUDA 12.1 版本进行测试。然而，代码应该能够在任何操作系统上使用 Python 3.9 及更高版本，并且支持 CUDA 11 及更高版本。

| **书中涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Python 3.9 | Windows, macOS 或 Linux（任意） |

对于深度学习章节，特别是从*第八章*开始，建议使用**图形处理单元**（**GPU**）。代码是在带有 24 GB 内存的 Nvidia GeForce RTX 3090 上测试的。根据您的硬件配置，代码可能需要相应调整。

**食谱从第二章开始。** **如果您使用的是本书的数字版，我们建议您自己输入代码或通过 GitHub 仓库访问代码（链接将在下一节提供）。这样做有助于避免因复制粘贴代码而导致的潜在错误。**

## 下载示例代码文件

您可以从 GitHub 下载本书的示例代码文件，网址为[`github.com/PacktPublishing/The-Regularization-Cookbook`](https://github.com/PacktPublishing/The-Regularization-Cookbook)。如果代码有更新，它将会在现有的 GitHub 仓库中进行更新。

我们还提供了来自我们丰富图书和视频目录中的其他代码包，您可以在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)查看！

# 使用的规范

本书中使用了多种文本规范。

`文本中的代码`：表示文本中的代码词语、数据库表名、文件夹名称、文件名、文件扩展名、路径名、虚拟网址、用户输入和 Twitter 账号。示例：“这两行应该下载一个`.zip`文件，然后解压其内容，以便获得名为`Tweets.csv`的文件。”

代码块设置如下：

```py
# Load data data = pd.read_csv('Tweets.csv')data[['airline_sentiment', 'text']].head()
```

任何命令行输入或输出如下所示：

```py
ip install pandas numpy scikit-learn matplotlib torch transformers
```

提示或重要说明

以这种方式显示。

# 章节

在本书中，您会看到几个常见的标题（*准备工作*，*如何操作...*，*它是如何工作的...*，*还有更多...*，以及*参见*）。

为了清楚地说明如何完成食谱，使用以下各节：

## 准备工作

本节告诉您食谱中会涉及什么，并描述了为该食谱设置所需软件或任何预备设置的步骤。

## 如何操作…

本节包含执行该食谱所需的步骤。

## 它是如何工作的…

本节通常包含对上一节发生内容的详细解释。

## 还有更多…

本节包含有关食谱的额外信息，以帮助您更深入地了解该食谱。

## 参见

本节提供了其他有用信息的链接，供您参考。

# 联系我们

我们欢迎读者的反馈。

**一般反馈**：如果您对本书的任何方面有疑问，请在邮件主题中注明书名，并通过电子邮件联系 customercare@packtpub.com。

**勘误**：尽管我们已尽力确保内容的准确性，但错误仍然可能发生。如果您在本书中发现了错误，我们将不胜感激。如果您发现错误，请访问 [www.packtpub.com/support/errata](https://www.packtpub.com/support/errata)，选择您的书籍，点击“勘误提交表单”链接并填写详细信息。

**盗版**：如果您在互联网上发现我们作品的任何非法版本，请提供该地址或网站名称。请通过 copyright@packt.com 联系我们，并附上材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域拥有专业知识，并且有兴趣撰写或参与编写一本书，请访问 [authors.packtpub.com](https://authors.packtpub.com)。

# 分享您的想法

一旦您阅读了*《正则化手册》*，我们很想听听您的想法！请 [点击此处直接前往 Amazon 评价页面](https://packt.link/r/1837634084)，分享您的反馈。

您的评价对我们和技术社区都很重要，它将帮助我们确保提供优质的内容。

.

# 下载本书的免费 PDF 副本

感谢您购买本书！

您喜欢随时随地阅读，但又无法携带印刷书籍吗？

您的电子书购买无法与您选择的设备兼容吗？

不用担心，现在购买每一本 Packt 书籍，您都能免费获得该书的无 DRM 版本 PDF。

在任何地方、任何设备上阅读。直接将您最喜欢的技术书籍中的代码搜索、复制并粘贴到您的应用程序中。

福利不止这些，您还可以每天在邮箱中获得独家折扣、时事通讯和精彩的免费内容。

按照以下简单步骤即可获得福利：

1.  扫描二维码或访问以下链接

![](img/B19629_QR_Free_PDF.jpg)

https://packt.link/free-ebook/9781837634088

1.  提交您的购买证明

1.  就是这样！我们将直接将免费的 PDF 和其他福利发送到您的电子邮件中
