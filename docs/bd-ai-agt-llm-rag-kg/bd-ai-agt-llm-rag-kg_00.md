# 前言

*使用 LLMs、RAG 和知识图谱构建 AI 代理*介绍了大型语言模型（LLMs）和 AI 代理不断发展的领域，提供了理论基础和实践指导。它首先解释了如何使用深度学习表示和处理文本数据，然后过渡到现代架构如 Transformer 模型。从那里，本书探讨了如何扩展 LLMs 的规模和微调，以及如何通过工具、外部记忆系统和基于代理的框架来扩展其功能。详细解释了检索增强生成（RAG）、GraphRAG 和多代理系统等技术，重点关注实际应用和部署。到本书结束时，你将清楚地了解如何构建智能的、使用工具的 AI 代理以及这些系统在塑造 AI 未来中所扮演的角色。

# 这本书面向谁

这本书旨在为想要理解和构建使用 LLMs 和 AI 代理的应用程序的软件工程师、数据科学家和研究人员而编写。建议具备基本的 Python 编程知识和机器学习基础概念，以便充分利用本书内容。虽然不需要在 NLP 方面有深入的专业知识，但熟悉神经网络、REST API 和一般的软件开发实践将有助于你理解示例并实现实际系统。无论你是想构建智能代理、探索 LLMs 的内部工作原理，还是大规模部署 AI 应用程序，本书都提供了开始的理论背景和实践指导。

# 这本书涵盖的内容

*第一章*，*使用深度学习分析文本数据*，介绍了如何将自然语言处理成适合机器学习模型格式的处理和表示方法。它涵盖了从基本的 one-hot 编码和词袋模型到更高级的表示方法，如 TF-IDF 和 word2vec。本章接着探讨了用于序列数据的深度学习关键架构，例如 RNNs、LSTMs、GRUs 和 CNNs，并展示了如何将它们应用于文本分类任务。到本章结束时，你将了解这些基础如何使现代语言模型如 ChatGPT 成为可能。

*第二章*，*Transformer：现代 AI 革命的模型背后*，介绍了注意力机制并解释了它们如何演变成 Transformer 架构。本章突出了早期模型如 RNNs 和 LSTMs 的局限性，并展示了 Transformer 如何克服这些局限性，成为现代 NLP 的基础。关键主题包括自注意力、掩码语言建模、训练技术以及内部模型可视化。本章最后通过展示实际应用和为理解今天的 LLMs 奠定基础来结束。

*第三章*, *探索 LLM 作为强大的 AI 引擎*，考察了大规模训练 transformer 模型如何导致今天 LLMs 的出现。本章探讨了它们的演变、能力和局限性，包括指令微调、微调和对齐等技术。它还介绍了更紧凑和高效的 LLM 变体、处理多种数据类型的多模态模型，以及幻觉、伦理担忧和提示工程等理解挑战。

*第四章*, *使用 LLM 构建网络爬虫代理*，介绍了 AI 代理作为 LLMs 的扩展概念，旨在克服它们执行动作的能力。本章探讨了代理的关键特征，以及单代理和多代理系统之间的区别。它还介绍了用于构建代理的主要库，并指导你创建一个能够从互联网检索信息的网络爬虫代理。

*第五章*, *使用 RAG 扩展您的代理以防止幻觉*，探讨了 RAG 如何克服 LLMs 的关键局限性，如知识过时和幻觉。本章解释了 RAG 如何通过嵌入和向量数据库使 LLM 能够访问外部信息源，从而提高准确性和适应性。它还比较了 RAG 与微调，并通过构建电影推荐代理展示了其实际应用。

*第六章*, *高级 RAG 技术用于信息检索和增强*，通过在管道的每个阶段引入增强来扩展基本的 RAG 架构——数据摄取、索引、检索和生成。本章探讨了模块化 RAG、用于扩展具有大型数据集和用户群的系统的技术，以及稳健性和隐私等关键问题。它还强调了围绕基于 RAG 的系统未来发展的当前挑战和开放性问题。

*第七章*, *将知识图谱与 AI 代理连接起来创建和连接知识图谱*，探讨了如何将文本知识结构化到知识图谱（KGs）中，以增强 AI 代理中的信息检索和推理。本章介绍了 GraphRAG 的概念，其中 KGs 用于通过结构化上下文数据来增强 LLMs。它涵盖了如何使用 LLMs 通过提取实体和关系来构建 KGs，如何使用图进行查询和推理，并讨论了结合不同方法的益处、局限性和未来方向。

*第八章*, *强化学习和人工智能代理*，探讨了代理如何通过与动态环境互动、根据经验调整其行为来学习。它介绍了强化学习的基本原理，解释了代理如何做出决策并在时间上改进，并展示了如何使用神经网络来引导行为。本章最后讨论了如何将 LLMs 与强化学习相结合来构建更强大的 AI 系统。

*第九章*, *创建单代理和多代理系统*，探讨了如何通过工具和其他模型扩展 LLMs 以形成自主代理。它介绍了单代理和多代理系统的概念，展示了 LLMs 如何与 API 或外部模型交互，并提出了如 HuggingGPT 等关键示例。本章还涵盖了代理协调策略、复杂领域的现实应用以及如 SaaS、MaaS、DaaS 和 RaaS 等新兴商业模式。

*第十章*, *构建人工智能代理应用*，探讨了在现实应用中扩展和部署人工智能代理所面临的挑战。它介绍了 Streamlit 作为一个快速原型设计框架，用于创建基于代理系统的前端和后端组件。本章还涵盖了关键操作方面，如异步编程、使用 Docker 的容器化以及构建可扩展、生产就绪的人工智能解决方案的最佳实践。

*第十一章*, *未来展望*，探讨了人工智能代理在医疗保健等行业以及更广泛的领域的变革潜力。基于前几章讨论的进展，它反思了 LLMs 和代理系统面临的剩余技术和伦理挑战。本章最后通过探讨智能人工智能代理的开发和部署中的开放问题和未来方向来结束。

# 为了充分利用本书

您应该具备基本的 Python 知识，并熟悉诸如函数、类和模块等基本编程概念。对机器学习和神经网络（如模型是什么以及训练是如何进行的）的一般了解将有助于理解更深层次的技术内容。虽然不需要有深度学习框架或 LLMs 的先前经验，但它将增强您应用所讨论技术的能力。本书旨在循序渐进，因此概念是逐步引入的，但技术思维是必不可少的。

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Python 3.10+ | Windows、macOS 或 Linux |
| PyTorch/Transformers | Windows、macOS 或 Linux |
| Streamlit | Windows、macOS 或 Linux |
| Docker | Windows、macOS 或 Linux |

对于没有访问本地 GPU 的读者，使用 Google Colab 是一个方便的选择。建议使用 Google Colab Pro 账户，因为它提供了访问更强大的 GPU，如 NVIDIA T4 或 A100，这可以在运行嵌入模型、微调或与代理一起工作时大大提高性能。

**如果你使用的是本书的数字版，我们建议你亲自输入代码或从书的 GitHub 仓库（下一节中有一个链接）获取代码。这样做将帮助你避免与代码的复制和粘贴相关的任何潜在错误。**

# 下载示例代码文件

你可以从 GitHub 下载本书的示例代码文件，网址为[`github.com/PacktPublishing/Modern-AI-Agents/tree/main`](https://github.com/PacktPublishing/Modern-AI-Agents/tree/main)。如果代码有更新，它将在 GitHub 仓库中更新。

我们还有其他来自我们丰富图书和视频目录的代码包可供在[`github.com/PacktPublishing/`](http://https://github.com/PacktPublishing/)下载。查看它们吧！

# 使用的约定

本书使用了多种文本约定。

`文本中的代码`: 表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 X/Twitter 用户名。以下是一个示例：“`process_frame`函数用于从游戏中预处理帧，使其更适合训练 RL 代理。”

代码块是这样设置的：

```py
self.critic_linear = nn.Linear(512, 1)
self.actor_linear = nn.Linear(512, num_actions)
```

当我们希望将你的注意力引到代码块的一个特定部分时，相关的行或项目将以粗体显示：

```py
[default]
exten => s,1,Dial(Zap/1|30)
exten => s,2,Voicemail(u100)
exten => s,102,Voicemail(b100)
exten => i,1,Voicemail(s0)
```

任何命令行输入或输出都应如下编写：

```py
streamlit run https://raw.githubusercontent.com/streamlit/my_apps/ master/my_app.py
```

**粗体**: 表示新术语、重要单词或你在屏幕上看到的单词。例如，菜单或对话框中的单词以**粗体**显示。以下是一个示例：“一旦我们准备好了标记，我们就可以输入问题并点击**提交**。”

小贴士或重要注意事项

它看起来像这样。

# 联系我们

欢迎读者反馈。

**一般反馈**: 如果你对此书任何方面有疑问，请通过 customercare@packtpub.com 给我们发邮件，并在邮件主题中提及书名。

**勘误**: 尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果你在这本书中发现了错误，我们将不胜感激，如果你能向我们报告这一点。请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表格。

**盗版**: 如果你在互联网上以任何形式遇到我们作品的非法副本，如果你能提供位置地址或网站名称，我们将不胜感激。请通过版权@packt.com 与我们联系，并提供材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问[authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

一旦您阅读了《使用 LLMs、RAG 和知识图谱构建 AI 代理》，我们非常乐意听到您的想法！请[点击此处直接转到该书的亚马逊评论页面](https://packt.link/r/1-835-08706-X)并分享您的反馈。

您的评论对我们和科技社区非常重要，并将帮助我们确保我们提供高质量的内容。

# 下载此书的免费 PDF 副本

感谢您购买此书！

您喜欢在路上阅读，但无法携带您的印刷书籍到处走吗？

您的电子书购买是否与您选择的设备不兼容？

别担心，现在购买每一本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何设备上阅读。直接从您喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠不止于此，您还可以获得独家折扣、时事通讯和每日免费内容的每日电子邮件访问权限。

按照以下简单步骤获取福利：

1.  扫描二维码或访问以下链接

![](img/B21257_QR_Free_PDF.jpg)

[`packt.link/free-ebook/978-1-83508-706-0`](https://packt.link/free-ebook/978-1-83508-706-0)

1.  提交您的购买证明

1.  就这些！我们将直接将您的免费 PDF 和其他福利发送到您的电子邮件中

# 第一部分：AI 代理引擎：从文本到大型语言模型

本部分为理解现代 AI 代理如何处理和生成语言奠定了基础。它首先探讨了原始文本如何以适合深度学习模型的数值形式表示，介绍了诸如词嵌入和基本神经网络架构等技术。然后，重点转向 Transformer 模型，并解释了注意力机制如何革新自然语言处理。最后，它探讨了通过扩展 Transformer 来构建大型语言模型（LLMs），讨论了训练策略、指令调整、微调和向通用推理模型演化的过程。这些章节共同为构建智能 AI 代理提供了技术和概念基础。

本部分包含以下章节：

+   *第一章**，使用深度学习分析文本数据*

+   *第二章**，Transformer：现代 AI 革命的模型背后*

+   *第三章**，探索 LLMs 作为强大的 AI 引擎*
