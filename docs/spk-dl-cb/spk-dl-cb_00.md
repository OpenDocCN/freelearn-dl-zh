# 前言

随着深度学习在现代工业中迅速获得广泛应用，组织正在寻求将流行的大数据工具与高效的深度学习库结合起来的方法。这将有助于深度学习模型以更高的效率和速度进行训练。

在*Apache Spark 深度学习实战*的帮助下，你将通过具体的实践步骤生成深度学习算法的结果，而不会陷入理论的困扰。从为深度学习设置 Apache Spark，到实现各种神经网络，本书将处理常见及不常见的问题，以便在分布式环境中进行深度学习。此外，你还将获得 Spark 中深度学习代码的访问权限，这些代码可以重复使用来解决类似问题，或稍作修改来解决不同问题。你还将学习如何使用 Spark 进行数据流处理和聚类。一旦掌握了基础知识，你将探索如何使用流行的库（如 TensorFlow 和 Keras）在 Spark 中实现和部署深度学习模型，如 CNN、RNN 和 LSTM。最终，本书是一本旨在教授如何在 Spark 上实际应用模型的实用手册，因此我们不会深入探讨理论和数学。

本章所使用模型的背后，我们会引用额外的资源以供参考。

每个模型的信息可以通过引用来获得。

本书结束时，你将具备在 Apache Spark 上训练和部署高效深度学习模型的专业知识。

# 本书的适用人群

本书适合那些具备基本机器学习和大数据概念理解的人，特别是那些希望通过自上而下的方式扩展知识的人。本书提供了深度学习和机器学习算法的即插即用方式。没有编程经验的人，尤其是没有 Python 经验的人，可以通过按步骤执行本书中的食谱轻松实现算法。本书中的大部分代码都可以自解释。每个代码块执行特定的功能，或在数据挖掘、操作、转换和拟合深度学习模型中执行某个动作。

本书旨在通过有趣的项目（如股票价格预测）为读者提供实践经验，同时帮助读者更牢固地理解深度学习和机器学习的概念。这是通过书中每章提供的许多在线资源链接实现的，包括已发布的论文、教程和指南。

# 本书内容

第一章，*为深度学习配置 Spark*，涵盖了你在虚拟 Ubuntu 桌面环境中开始开发 Spark 所需的所有内容。

第二章，*使用 Spark 创建神经网络*，解释了如何从零开始开发神经网络，而不使用任何深度学习库，如 TensorFlow 或 Keras。

第三章，*卷积神经网络的痛点*，讲解了在进行图像识别时，卷积神经网络的一些痛点，以及如何克服这些问题。

第四章，*循环神经网络的痛点*，介绍了前馈神经网络和循环神经网络。我们描述了一些循环神经网络中出现的痛点，以及如何通过使用 LSTM 来解决这些问题。

第五章，*使用 Spark ML 预测消防部门呼叫*，介绍了如何开发一个分类模型，预测来自旧金山的消防部门呼叫，使用 Spark 机器学习工具。

第六章，*在生成网络中使用 LSTM*，提供了一种实操方法，使用小说或大型文本语料库作为输入数据来定义和训练 LSTM 模型，同时使用训练好的模型生成自己的输出序列。

第七章，*使用 TF-IDF 进行自然语言处理*，讲解了将聊天机器人对话数据分类以进行升级的步骤。

第八章，*使用 XGBoost 进行房地产价值预测*，聚焦于使用 Kings County 房屋销售数据集训练一个简单的线性模型，并利用该模型预测房价，然后再深入探讨一个稍微复杂一点的模型，进一步提高预测准确度。

第九章，*使用 LSTM 预测苹果股票市场价格*，重点介绍了如何使用 Keras 中的 LSTM 创建深度学习模型来预测 AAPL 股票的股市价格。

第十章，*使用深度卷积神经网络进行人脸识别*，利用 MIT-CBCL 数据集中的 10 个不同被试的面部图像，训练和测试一个深度卷积神经网络模型。

第十一章，*使用 Word2Vec 创建和可视化词向量*，强调了向量在机器学习中的重要性，并指导用户如何利用 Google 的 Word2Vec 模型训练不同的模型并可视化从小说中生成的词向量。

第十二章，*使用 Keras 创建电影推荐引擎*，聚焦于使用深度学习库 Keras 为用户构建电影推荐引擎。

第十三章，*使用 TensorFlow 在 Spark 上进行图像分类*，重点介绍了利用迁移学习识别世界上排名前两位的足球运动员：克里斯蒂亚诺·罗纳尔多和利昂内尔·梅西。

# 为了从本书中获得最大收益

1.  利用所有提供的链接，更好地理解本书中使用的一些术语。

1.  互联网是当今世界上最大的大学。利用 YouTube、Udemy、edX、Lynda 和 Coursera 等网站，观看它们关于深度学习和机器学习概念的视频。

1.  不要只是阅读这本书然后忘记它。请在阅读时实践每一步。建议你在阅读每一章时打开 Jupyter Notebook，这样你可以在阅读过程中实践每个食谱，并同时检查每个步骤的输出。

# 下载示例代码文件

你可以从你的账户在 [www.packtpub.com](http://www.packtpub.com) 下载这本书的示例代码文件。如果你从其他地方购买了本书，可以访问 [www.packtpub.com/support](http://www.packtpub.com/support) 并注册，将文件直接发送到你的邮箱。

你可以按照以下步骤下载代码文件：

1.  登录或注册 [www.packtpub.com](http://www.packtpub.com/support)。

1.  选择“支持”标签。

1.  点击“代码下载与勘误”。

1.  在搜索框中输入书名，并按照屏幕上的指示操作。

文件下载后，请确保使用最新版本的解压工具解压或提取文件夹：

+   WinRAR/7-Zip for Windows

+   Zipeg/iZip/UnRarX for Mac

+   7-Zip/PeaZip for Linux

这本书的代码包也托管在 GitHub 上，地址是 [`github.com/PacktPublishing/Apache-Spark-Deep-Learning-Cookbook`](https://github.com/PacktPublishing/Apache-Spark-Deep-Learning-Cookbook)。如果代码有更新，它将会在现有的 GitHub 仓库中进行更新。

我们还提供来自我们丰富的书籍和视频目录的其他代码包，访问**[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)**，快来看看吧！

# 使用的约定

本书中使用了许多文本约定。

`CodeInText`：表示文本中的代码词汇、数据库表名、文件夹名称、文件名、文件扩展名、路径名、虚拟网址、用户输入和 Twitter 账号。例如："Save under the `trained` folder inside the working directory."

代码块的设置如下：

```py
print('Total Rows')
df.count()
print('Rows without Null values')
df.dropna().count()
print('Row with Null Values')
df.count()-df.dropna().count()
```

任何命令行输入或输出都写作如下：

```py
nltk.download("punkt")
nltk.download("stopwords")
```

**粗体**：表示新术语、重要单词或屏幕上显示的单词。例如，菜单或对话框中的词汇会以这种形式出现在文本中。这里有一个示例："Right-click on the page and click on Save As..."

警告或重要提示以此形式出现。

提示和技巧以此形式出现。

# 章节

本书中会有多个常见标题（*准备工作*、*如何操作...*、*原理...*、*更多内容...*和*另见*）。

为了清晰地说明如何完成食谱，请按以下方式使用这些部分：

# 准备工作

本节告诉你在本教程中可以期待什么，并描述了如何设置任何软件或完成食谱所需的任何初步设置。

# 如何操作...

本节包含遵循食谱所需的步骤。

# 原理...

本节通常包含对上一节发生内容的详细解释。

# 更多内容...

本节包含有关食谱的附加信息，帮助你更好地了解食谱。

# 另见

本节提供了有用的链接，指向食谱中其他有用的信息。

# 联系我们

我们欢迎读者的反馈。

**一般反馈**：请发送电子邮件至 `feedback@packtpub.com`，并在邮件主题中注明书名。如果你对本书的任何部分有问题，请通过 `questions@packtpub.com` 给我们发送邮件。

**勘误表**：尽管我们已尽最大努力确保内容的准确性，但错误难免。如果你发现本书中的错误，我们将感激你向我们报告。请访问 [www.packtpub.com/submit-errata](http://www.packtpub.com/submit-errata)，选择你的书籍，点击“勘误提交表格”链接，并填写相关信息。

**盗版**：如果你在互联网上发现任何形式的非法复制我们作品的内容，我们将感激你提供相关网址或网站名称。请通过`copyright@packtpub.com`联系我们，并附上相关材料的链接。

**如果你有兴趣成为作者**：如果你在某个领域有专业知识，且有兴趣写书或参与书籍的编写，请访问 [authors.packtpub.com](http://authors.packtpub.com/)。

# 评论

请留下评论。一旦你阅读并使用了本书，不妨在你购买书籍的网站上留下评论？潜在读者可以看到并参考你的公正意见来做出购买决策，我们在 Packt 可以了解你对我们产品的看法，作者也能看到你对他们书籍的反馈。谢谢！

如需了解更多关于 Packt 的信息，请访问 [packtpub.com](https://www.packtpub.com/)。
