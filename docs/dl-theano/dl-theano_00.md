# 前言

深入了解并实践神经网络架构设计，解决人工智能问题。理解深度学习中最先进网络背后的概念。利用 Python 语言和 Theano 技术，轻松计算导数并最小化你选择的目标函数。

# 本书内容概览

第一章，*Theano 基础*，帮助读者学习 Theano 的主要概念，以编写可以在不同硬件架构上编译的代码，并自动优化复杂的数学目标函数。

第二章，*使用前馈网络分类手写数字*，将介绍一个简单的、广为人知的经典例子，这是深度学习算法优越性证明的起点。最初的问题是识别手写数字。

第三章，*将词编码为向量*，神经网络面临的主要挑战之一是将现实世界的数据与神经网络的输入连接起来，尤其是对于类别性和离散数据。本章通过使用 Theano 进行训练，展示了如何构建一个嵌入空间的示例。

这样的嵌入非常有用，应用于机器翻译、机器人技术、图像描述等领域，因为它们将现实世界的数据转化为可以被神经网络处理的向量数组。

第四章，*使用递归神经网络生成文本*，通过一个简单的实践示例引入了神经网络中的递归性，来生成文本。

循环神经网络（RNN）是深度学习中的一个热门话题，为序列预测、序列生成、机器翻译、物联网等提供了更多可能性。自然语言处理（NLP）是另一个推动机器学习新技术研究的领域。

第五章，*使用双向 LSTM 分析情感*，将嵌入层和递归层应用于自然语言处理中的新任务——情感分析。它作为前面章节的一种验证。

同时，本章还展示了一种在 Theano 上构建神经网络的替代方法，使用一个更高级的库——Keras。

第六章, *使用空间变换网络进行定位*，将递归应用于图像，以便一次读取页面上的多个数字。这一次，我们借此机会重写了手写数字图像的分类网络，以及我们的递归模型，在 Lasagne 的帮助下，Lasagne 是一个为 Theano 设计的深度学习模块库。

Lasagne 库有助于更快地设计神经网络进行实验。在这个帮助下，我们将通过空间变换模块来解决物体定位这一常见的计算机视觉挑战，以提高我们的分类得分。

第七章, *使用残差网络进行图像分类*，能够以最佳精度对任何类型的图像进行分类。同时，为了更轻松地构建更复杂的网络，我们介绍了一个基于 Theano 框架的库——Lasagne，提供了许多已实现的组件，帮助加速 Theano 中的神经网络实现。

第八章, *通过编码-解码网络进行翻译与解释*，介绍了编码-解码技术：应用于文本时，这些技术在机器翻译和简单的聊天机器人系统中被广泛使用。应用于图像时，它们用于场景分割和物体定位。最后，图像字幕生成是一个混合过程，编码图像并解码为文本。

本章进一步介绍了一个非常流行的高级库——Keras，它进一步简化了 Theano 中神经网络的开发。

第九章, *通过注意力机制选择相关输入或记忆*，为了完成更复杂的任务，机器学习领域一直在寻求更高层次的智能，灵感来自自然：推理、注意力和记忆。本章将向读者介绍用于自然语言处理（NLP）中的人工智能的主要目的——语言理解的记忆网络。

第十章, *使用高级 RNN 预测时间序列*，时间序列是机器学习被广泛应用的重要领域。本章将介绍基于循环神经网络（RNN）的高级技术，以获得最先进的结果。

第十一章, *从环境中学习与强化学习*，强化学习是机器学习的一个广阔领域，主要通过训练一个智能体在一个环境中（例如视频游戏），通过在环境中执行特定动作（如按下手柄上的按钮）并观察发生的结果，来优化某一量（例如最大化游戏分数）。

强化学习这一新范式为设计算法以及计算机与现实世界之间的交互开辟了一条全新的路径。

第十二章, *使用无监督生成网络学习特征*，无监督学习是新型的训练算法，无需对数据进行标签化即可进行训练。这些算法尝试从数据中推断出隐藏的标签，称为“因子”，并且其中一些算法还能够生成新的合成数据。

无监督训练在许多情况下非常有用，无论是当没有标签数据时，还是当用人工进行标签化太昂贵时，或者当数据集太小且特征工程可能导致过拟合时。在最后一种情况下，更多的无标签数据有助于训练更好的特征，作为监督学习的基础。

第十三章, *使用 Theano 扩展深度学习*，扩展了 Theano 在深度学习中的应用范围。它介绍了如何为计算图创建新的操作符，可以在 Python 中为简便性实现，或者在 C 语言中以克服 Python 开销，为 CPU 或 GPU 实现。此外，还介绍了 GPU 并行编程的基本概念。最后，我们基于本书中首先开发的技能，开启了通用智能的领域，逐步开发新的技能，以进一步提升自身能力。

## 为什么选择 Theano？

投资时间和精力在 Theano 上是非常有价值的，要理解这一点，重要的是要解释为什么 Theano 属于最优秀的深度学习技术之一，而且它远不止是一个深度学习库。有三个原因使 Theano 成为一个值得投资的好选择：

+   它的性能与其他数值计算或深度学习库相当。

+   它融入了一个丰富的 Python 生态系统。

+   它使你能够在给定一个模型的情况下，评估任何由数据约束的函数，提供编译解决方案的自由，用于任何优化问题。

让我们首先关注**技术本身的性能**。目前深度学习领域最流行的库有 Theano（用于 Python）、Torch（用于 Lua）、Tensorflow（用于 Python）和 Caffe（用于 C++，并有 Python 包装器）。有很多基准测试用于比较不同的深度学习技术。

在 Bastien 等人 2012 年的论文（*Theano: 新特性与速度提升，Frédéric Bastien, Pascal Lamblin, Razvan Pascanu, James Bergstra, Ian Goodfellow, Arnaud Bergeron, Nicolas Bouchard, David Warde-Farley, Yoshua Bengio, 2012 年 11 月*）中，Theano 在速度上取得了显著进展，但在不同任务上的比较并未明确指出哪个技术优胜。Bahrampour 等人 2016 年的论文（*深度学习软件框架的比较研究，Soheil Bahrampour, Naveen Ramakrishnan, Lukas Schott, Mohak Shah, 2016 年 3 月*）得出结论：

+   对于基于 GPU 的卷积网络和全连接网络的已训练模型部署，Torch 最为适合，其次是 Theano。

+   对于基于 GPU 的卷积网络和全连接网络的训练，Theano 在小型网络中最快，而 Torch 在大型网络中最快。

+   对于基于 GPU 的递归网络（LSTM）的训练和部署，Theano 表现最佳。

+   对于基于 CPU 的任何已测试深度网络架构的训练和部署，Torch 表现最佳，其次是 Theano。

这些结果在开源的*rnn-benchmarks*（[`github.com/glample/rnn-benchmarks`](https://github.com/glample/rnn-benchmarks)）中得到了验证，训练（前向和反向传播）时，Theano 优于 Torch 和 TensorFlow。此外，Theano 在较小批量大小和较大隐藏单元数的情况下压倒性地超过 Torch 和 TensorFlow。对于更大的批量大小和隐藏层大小，差异较小，因为它们更多地依赖于 CUDA 性能，这是所有框架共同使用的底层 NVIDIA 图形库。最后，在最新的*soumith benchmarks*（[`github.com/soumith/convnet-benchmarks`](https://github.com/soumith/convnet-benchmarks)）中，Theano 在 CPU 上的 fftconv 表现最佳，而在 GPU 上表现最佳的卷积实现，如 cuda-convnet2 和 fbfft，都是 CUDA 扩展，底层库。这些结果应该能说服读者，尽管结果不一，Theano 在速度竞争中扮演着领先角色。

第二个偏向选择 Theano 而非 Torch 的理由是，它拥有**丰富的生态系统**，既受益于 Python 生态系统，也受益于为 Theano 开发的大量库。本书将介绍其中两个库，Lasagne 和 Keras。Theano 和 Torch 是最具可扩展性的框架，无论是在支持各种深度架构方面，还是在支持库方面。最后，Theano 并不以调试复杂而闻名，这与其他深度学习库相反。

第三点使得 Theano 成为计算机科学家无法比拟的工具，因为它不仅仅局限于深度学习。虽然 Theano 为深度学习提供了与其他库相同的方法，但其基本原理却大不相同：事实上，Theano 在目标架构上编译计算图。这个编译步骤使得 Theano 具有其特殊性，应被定义为一个**数学表达式编译器**，旨在支持机器学习。符号微分是 Theano 提供的最有用的功能之一，用于实现非标准的深度体系结构。因此，Theano 能够解决更广泛范围的数值问题，并能够在给定现有数据集的情况下找到最小化任何具有可微损失或能量函数的问题的解决方案。

# 你需要为这本书做准备

安装 Theano 需要使用`conda`或`pip`，并且在 Windows、Mac OS 和 Linux 下的安装过程是相同的。

代码已在 Mac OS 和 Linux Ubuntu 下进行了测试。对于 Windows，可能会有一些特殊之处，如修改路径，这些问题 Windows 开发者会很容易解决。

代码示例假定您的计算机上有一个共享文件夹，用于下载、解压缩和预处理可能非常庞大的数据库文件，这些文件不应该留在代码库中。这种做法有助于节省磁盘空间，多个代码目录和用户可以使用同一个数据库的副本。该文件夹通常在用户空间之间共享：

```py
sudo mkdir /sharedfiles
sudo chmod 777 /sharedfiles
```

# 这本书适合谁

本书旨在提供关于深度学习的广泛概述，以 Theano 作为支持技术。本书面向深度学习和人工智能的初学者，以及希望获取跨领域经验并熟悉 Theano 及其支持库的计算机程序员。本书帮助读者开始深度学习，并获取深度学习中相关且实用的信息。

需要具备一些基本的 Python 编程和计算机科学技能，以及初等代数和微积分技能。所有实验的基础技术都是 Theano，本书首先深入介绍了核心技术，然后介绍了一些库，以便重用现有模块。

本书的方法是介绍深度学习，描述不同类型的网络及其应用，同时探索 Theano 提供的可能性，这是一种深度学习技术，将支持所有的实现。本书总结了一些表现最佳的网络和最新的结果，并帮助读者全面了解深度学习，从简单到复杂的网络逐步深入。

由于 Python 已成为数据科学的主要编程语言，本书试图涵盖所有*Python 程序员*在使用 Python 和 Theano 进行深度学习时需要知道的内容。

本书将介绍两个基于 Theano 的抽象框架：Lasagne 和 Keras，它们可以简化更复杂网络的开发，但不会妨碍你理解底层概念。

# 约定

本书中，你会看到一些文本样式，用以区分不同类型的信息。以下是这些样式的一些示例以及它们的含义。

文本中的代码词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟网址、用户输入和 Twitter 用户名显示如下：“该操作符由继承自通用`theano.Op`类的类定义。”

一段代码块以如下方式显示：

```py
import theano, numpy

class AXPBOp(theano.Op):
    """
    This creates an Op that takes x to a*x+b.
    """
    __props__ = ("a", "b")
```

所有命令行输入或输出如下所示：

```py
gsutil mb -l europe-west1 gs://keras_sentiment_analysis
```

**新术语**和**重要词汇**以粗体显示。你在屏幕上看到的词汇，例如菜单或对话框中的内容，会在文本中这样显示：“点击**下一步**按钮将你带到下一屏幕。”

### 注释

警告或重要注释会以框体形式显示，如下所示。

### 提示

提示和技巧像这样呈现。

# 读者反馈

我们始终欢迎读者反馈。告诉我们你对这本书的看法——你喜欢或不喜欢什么。读者反馈对我们很重要，因为它帮助我们开发出你能够真正受益的书籍。

若想向我们提供一般反馈，请发送电子邮件至`<feedback@packtpub.com>`，并在邮件主题中注明书籍的标题。

如果你在某个领域拥有专业知识，并且有兴趣为书籍写作或贡献内容，请查看我们的作者指南：[www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

现在你已经是 Packt 书籍的骄傲拥有者，我们提供了一些资源，帮助你充分利用你的购买。

## 下载示例代码

你可以从你的帐户下载本书的示例代码文件，网址为：[`www.packtpub.com`](http://www.packtpub.com)。如果你是从其他地方购买本书，可以访问[`www.packtpub.com/support`](http://www.packtpub.com/support)，注册后直接通过电子邮件获取文件。

你可以通过以下步骤下载代码文件：

1.  使用你的电子邮件地址和密码登录或注册我们的网站。

1.  将鼠标指针悬停在顶部的**支持**标签上。

1.  点击**代码下载与勘误**。

1.  在**搜索**框中输入书名。

1.  选择你想下载代码文件的书籍。

1.  从下拉菜单中选择你购买本书的地点。

1.  点击**代码下载**。

你也可以通过点击本书网页上的**代码文件**按钮下载代码文件。你可以通过在搜索框中输入书名来访问此页面。请注意，你需要登录 Packt 账户。

下载文件后，请确保使用以下最新版本的工具解压或提取文件夹：

+   WinRAR / 7-Zip for Windows

+   Zipeg / iZip / UnRarX for Mac

+   7-Zip / PeaZip for Linux

本书的代码包也托管在 GitHub 上，网址为 [`github.com/PacktPublishing/Deep-Learning-with-Theano`](https://github.com/PacktPublishing/Deep-Learning-with-Theano)。我们还提供了来自我们丰富图书和视频目录的其他代码包，网址为 [`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)。快来看看吧！

## 勘误

虽然我们已经尽力确保内容的准确性，但错误仍然会发生。如果你发现我们书中的任何错误——无论是文本错误还是代码错误——我们将非常感激你向我们报告。通过这样做，你可以帮助其他读者避免困惑，并帮助我们改进本书的后续版本。如果你发现任何勘误，请访问 [`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata) 提交，选择你的书籍，点击**勘误提交表格**链接，输入勘误详情。勘误一旦验证通过，你的提交将被接受，勘误信息将上传至我们的网站或添加至该书的勘误列表中。

要查看之前提交的勘误信息，请访问 [`www.packtpub.com/books/content/support`](https://www.packtpub.com/books/content/support)，并在搜索框中输入书名。相关信息将出现在**勘误**部分。

## 盗版

网络上的版权材料盗版问题是一个跨媒体的持续性问题。在 Packt，我们非常重视版权和许可证的保护。如果你在互联网上遇到我们作品的任何非法复制品，请立即提供位置地址或网站名称，以便我们采取相应的补救措施。

请通过 `<copyright@packtpub.com>` 与我们联系，并提供涉嫌盗版材料的链接。

我们感谢你在保护我们的作者以及我们为你带来有价值内容方面的帮助。

## 问题

如果你对本书的任何部分有疑问，可以通过 `<questions@packtpub.com>` 联系我们，我们将尽力解决问题。
