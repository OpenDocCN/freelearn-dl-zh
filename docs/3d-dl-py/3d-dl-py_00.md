# 第一章：《使用 Python 进行 3D 深度学习》

使用 PyTorch3D 及更多工具，设计并开发您的计算机视觉模型，基于 3D 数据

Xudong Ma

Vishakh Hegde

Lilit Yolyan

![](img/Packt_Logo_SuperSite_2022_Orange.png)

伯明翰——孟买

# 《使用 Python 进行 3D 深度学习》

版权所有 © 2022 Packt 出版公司

*保留所有权利*。未经出版商事先书面许可，本书的任何部分不得以任何形式或通过任何手段复制、存储在检索系统中或传输，但在批评性文章或评论中引用短暂的摘录除外。

本书在准备过程中已尽力确保所提供信息的准确性。然而，本书中的信息是以无任何明示或暗示的保证出售的。作者、Packt 出版公司及其经销商和分销商对于因本书直接或间接引起的任何损害或被声称引起的损害不承担责任。

Packt 出版公司已尽力通过适当的使用大写字母提供关于本书中提到的所有公司和产品的商标信息。然而，Packt 出版公司不能保证这些信息的准确性。

**出版产品经理**：Dinesh Chaudhary

**内容开发编辑**：Joseph Sunil

**技术编辑**：Rahul Limbachiya

**文稿编辑**：Safis Editing

**项目协调员**：Farheen Fathima

**校对员**：Safis Editing

**索引员**：Rekha Nair

**制作设计师**：Ponraj Dhandapani

**市场协调员**：Shifa Ansari

首次出版：2022 年 11 月

制作参考：1211022

由 Packt 出版有限公司出版

Livery Place

35 Livery Street

伯明翰

英国 B3 2PB。

ISBN 978-1-80324-782-3

[www.packt.com](http://www.packt.com)

“献给我的妻子和家人，感谢他们在每一步的支持和鼓励。” - Vishakh Hegde

“献给我的家人和朋友，他们的爱和支持一直是我最大的动力。” - Lilit Yolyan

# 贡献者

# 关于作者

**Xudong Ma**是 Grabango Inc.（位于加利福尼亚伯克利）的工作人员机器学习工程师。他曾是 Facebook（Meta）Oculus 的高级机器学习工程师，并与 3D PyTorch 团队紧密合作，进行 3D 面部追踪项目。他在计算机视觉、机器学习和深度学习方面有多年经验，并拥有电气与计算机工程学博士学位。

**Vishakh Hegde**是一名机器学习和计算机视觉研究员。他在该领域拥有超过 7 年的经验，在此期间，他撰写了多篇广受引用的研究论文并申请了专利。他拥有斯坦福大学应用数学和机器学习专业的硕士学位，以及印度理工学院马德拉斯分校的物理学学士和硕士学位。他曾在 Schlumberger 和 Matroid 工作过。他现在是 Ambient.ai 的高级应用科学家，在那里他帮助构建了武器检测系统，该系统已经在多个全球财富 500 强公司中部署。他目前正在利用自己的专业知识和解决商业挑战的热情，在硅谷创办技术初创公司。你可以通过他的网站了解更多关于他的内容。

我要感谢那些突破性研究让我有机会撰写的计算机视觉研究人员。我要感谢评审们的反馈，以及 Packt Publishing 团队给予我创造性发挥的机会。最后，我要感谢我的妻子和家人，在我最需要的时候给予我所有的支持和鼓励。

**Lilit Yolyan**是 YSU 的机器学习研究员，目前正在攻读博士学位。她的研究重点是利用遥感数据为智慧城市构建计算机视觉解决方案。她在计算机视觉领域有 5 年的经验，并且参与了一个复杂的驾驶员安全解决方案，该解决方案将由多个知名汽车制造公司部署。

# 关于评审人

**Eya Abid**是一名专攻深度学习和计算机视觉的工程硕士生。她目前担任 NVIDIA 的 AI 讲师，以及在 CERN 从事量子机器学习的工作。

我要将这项工作献给我的家人、朋友以及在这个过程中帮助过我的每一个人。特别献给 Aymen，我将永远感激他。

**Ramesh Sekhar**是 Dapster.ai 的首席执行官兼联合创始人，这是一家构建可负担且易于部署的机器人公司的企业，这些机器人可以在仓库中执行最繁重的任务。Ramesh 曾在 Symbol、Motorola 和 Zebra 等公司工作，专注于构建计算机视觉、人工智能和机器人学交汇处的产品。他拥有电气工程学士学位和计算机科学硕士学位。Ramesh 于 2020 年创立了 Dapster.ai。Dapster 的使命是通过执行危险和不健康的任务来构建对人类产生积极影响的机器人。他们的愿景是解锁更好的工作，强化供应链，并更好地应对气候变化带来的挑战。

**乌特卡什·斯里瓦斯塔瓦**是人工智能/机器学习专业人士、培训师、YouTuber 和博主。他热衷于解决复杂问题，开发机器学习、自然语言处理和计算机视觉算法。他的职业生涯始于他的博客（datamahadev.com）和 YouTube 频道（datamahadev），之后在古吉拉特邦的一所机构担任高级数据科学培训师。此外，他还曾培训并辅导了 1,000 多名在职专业人士和学生，涵盖人工智能/机器学习领域。乌特卡什已完成 40 多个自由职业的数据科学与分析、AI/ML、Python 开发和 SQL 培训与开发项目。他来自卢克瑙，目前定居在印度班加罗尔，担任德勤 USI 咨询公司的分析师。

我要感谢我的母亲，Rupam Srivastava 女士，在我经历的困难与奋斗中，给予我持续的指导和支持。也感谢至尊 Para-Brahman。

**梅森·麦高夫**是 Lowe's 创新实验室的高级研发工程师和计算机视觉专家。他对成像充满热情，已经花费超过十年时间解决广泛行业和学术领域中的计算机视觉问题，包括地质学、生物信息学、游戏开发和零售。最近，他正在探索数字双胞胎和 3D 扫描在零售店中的应用。

我要感谢 Andy Lykos、Joseph Canzano、Alexander Arango、Oleg Alexander、Erin Clark 以及我的家人对我的支持。

# 目录

## 前言

## 第一部分：3D 数据处理基础

## 1

## 介绍 3D 数据处理

### 技术要求

### 设置开发环境

### 3D 数据表示

### 理解点云表示

### 理解网格表示

### 理解体素表示

### 3D 数据文件格式 – Ply 文件

### 3D 数据文件格式 – OBJ 文件

### 理解 3D 坐标系统

### 理解摄像机模型

### 摄像机模型和坐标系统的编码

### 总结

## 2

## 介绍 3D 计算机视觉和几何学

### 技术要求

### 探索渲染、光栅化和阴影处理的基本概念

### 理解重心坐标

### 光源模型

### 理解兰伯特光照模型

### 理解 Phong 光照模型

### 3D 渲染的编码练习

### 使用 PyTorch3D 异构批量和 PyTorch 优化器

### 异构小批量的编码练习

### 理解变换与旋转

### 变换和旋转的编码练习

### 总结

## 第二部分：使用 PyTorch3D 的 3D 深度学习

## 3

## 将可变形网格模型拟合到原始点云

### 技术要求

### 将网格拟合到点云——问题

### 将可变形网格拟合问题公式化为优化问题

### 正则化的损失函数

### 网格拉普拉斯平滑损失

### 网格法线一致性损失

### 网格边缘损失

### 实现 PyTorch3D 网格拟合

### 不使用任何正则化损失函数的实验

### 仅使用网格边缘损失的实验

### 总结

## 4

## 通过可微分渲染学习物体姿态检测与跟踪

### 技术要求

### 为什么我们希望使用可微分渲染

### 如何使渲染可微分

### 使用可微分渲染可以解决的问题

### 物体姿态估计问题

### 如何编码实现

### 物体姿态估计示例：轮廓拟合和纹理拟合

### 总结

## 5

## 理解可微分体积渲染

### 技术要求

### 体积渲染概述

### 理解光线采样

### 使用体积采样

### 探索光线行进器

### 可微分体积渲染

### 从多视角图像重建 3D 模型

### 总结

## 6

## 探索神经辐射场（NeRF）

### 技术要求

### 理解 NeRF

### 什么是辐射场？

### 用神经网络表示辐射场

### 训练 NeRF 模型

### 理解 NeRF 模型架构

### 理解使用辐射场的体积渲染

### 将射线投射到场景中

### 累积射线的颜色

### 总结

## 第三部分：使用 PyTorch3D 的最先进 3D 深度学习

## 7

## 探索可控神经特征场

### 技术要求

### 理解基于 GAN 的图像合成

### 介绍组合式 3D 感知图像合成

### 生成特征场

### 将特征场映射到图像

### 探索可控场景生成

### 探索可控汽车生成

### 探索可控面部生成

### 训练 GIRAFFE 模型

### Frechet 起始距离

### 训练模型

### 总结

## 8

## 3D 人体建模

### 技术要求

### 制定 3D 建模问题

### 定义良好的表示

### 理解线性混合蒙皮技术

### 理解 SMPL 模型

### 定义 SMPL 模型

### 使用 SMPL 模型

### 使用 SMPLify 估计 3D 人体姿态和形状

### 定义优化目标函数

### 探索 SMPLify

### 运行代码

### 探索代码

### 总结

## 9

## 使用 SynSin 进行端到端视图合成

### 技术要求

### 视图合成概述

### SynSin 网络架构

### 空间特征与深度网络

### 神经点云渲染器

### 细化模块与鉴别器

### 实践模型训练与测试

### 总结

## 10

## Mesh R-CNN

### 技术要求

### 网格与体素概述

### Mesh R-CNN 架构

### 图卷积

### 网格预测器

### PyTorch 下的 Mesh R-CNN 演示

### 演示

### 总结

## 索引

## 您可能喜欢的其他书籍
