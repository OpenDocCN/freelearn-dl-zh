

# ç¬¬ä¹ç« ï¼šåŠ é€Ÿå¼ºåŒ–å­¦ä¹ ï¼ˆRLï¼‰çš„æ–¹æ³•

åœ¨ç¬¬å…«ç« ä¸­ï¼Œä½ çœ‹åˆ°äº†ä¸€äº›å®žç”¨çš„æŠ€å·§ï¼Œå¯ä»¥ä½¿æ·±åº¦ Q ç½‘ç»œï¼ˆDQNï¼‰æ–¹æ³•æ›´åŠ ç¨³å®šå¹¶åŠ é€Ÿæ”¶æ•›ã€‚å®ƒä»¬æ¶‰åŠåŸºæœ¬çš„ DQN æ–¹æ³•ä¿®æ”¹ï¼ˆä¾‹å¦‚å‘ç½‘ç»œæ³¨å…¥å™ªå£°æˆ–å±•å¼€ Bellman æ–¹ç¨‹ï¼‰æ¥èŽ·å¾—æ›´å¥½çš„ç­–ç•¥ï¼ŒåŒæ—¶å‡å°‘è®­ç»ƒæ‰€éœ€çš„æ—¶é—´ã€‚ä½†åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†æŽ¢ç´¢å¦ä¸€ç§æ–¹æ³•ï¼šè°ƒæ•´æ–¹æ³•çš„å®žçŽ°ç»†èŠ‚ï¼Œä»¥æé«˜è®­ç»ƒé€Ÿåº¦ã€‚è¿™æ˜¯ä¸€ç§çº¯ç²¹çš„å·¥ç¨‹æ–¹æ³•ï¼Œä½†å®ƒåŒæ ·é‡è¦ï¼Œå› ä¸ºåœ¨å®žè·µä¸­éžå¸¸æœ‰ç”¨ã€‚

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ï¼š

+   å–ç”¨ä¸Šä¸€ç« ä¸­çš„ Pong çŽ¯å¢ƒï¼Œå¹¶å°½é‡ä»¥æœ€å¿«é€Ÿåº¦è§£å†³å®ƒ

+   ä»¥é€æ­¥çš„æ–¹å¼ï¼Œä½¿ç”¨å®Œå…¨ç›¸åŒçš„å•†å“ç¡¬ä»¶å°† Pong æ¸¸æˆçš„è§£å†³é€Ÿåº¦æé«˜è¿‘ 2 å€

# ä¸ºä»€ä¹ˆé€Ÿåº¦å¾ˆé‡è¦

é¦–å…ˆï¼Œæˆ‘ä»¬æ¥è°ˆè°ˆä¸ºä»€ä¹ˆé€Ÿåº¦å¦‚æ­¤é‡è¦ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ä¼˜åŒ–å®ƒã€‚ä¹Ÿè®¸å¹¶ä¸æ˜Žæ˜¾ï¼Œä½†è¿‡åŽ»äºŒåå¹´é‡Œç¡¬ä»¶æ€§èƒ½æœ‰äº†å·¨å¤§çš„æå‡ã€‚è¿‘äºŒåå¹´å‰ï¼Œæˆ‘æ›¾å‚ä¸Žä¸€ä¸ªé¡¹ç›®ï¼Œä¸“æ³¨äºŽä¸ºä¸€ä¸ªèˆªç©ºå‘åŠ¨æœºè®¾è®¡å…¬å¸æž„å»ºä¸€ä¸ªç”¨äºŽè®¡ç®—æµä½“åŠ›å­¦ï¼ˆCFDï¼‰ä»¿çœŸçš„è¶…çº§è®¡ç®—æœºã€‚è¯¥ç³»ç»Ÿç”± 64 å°æœåŠ¡å™¨ç»„æˆï¼Œå æ®äº†ä¸‰ç»„ 42 è‹±å¯¸çš„æœºæž¶ï¼Œå¹¶ä¸”éœ€è¦ä¸“é—¨çš„å†·å´å’Œç”µåŠ›å­ç³»ç»Ÿã€‚ä»…ç¡¬ä»¶éƒ¨åˆ†ï¼ˆä¸åŒ…æ‹¬å†·å´ï¼‰å°±èŠ±è´¹äº†å¤§çº¦ 100 ä¸‡ç¾Žå…ƒã€‚

åœ¨ 2005 å¹´ï¼Œè¿™å°è¶…çº§è®¡ç®—æœºåœ¨å‰è‹è”è¶…çº§è®¡ç®—æœºä¸­æŽ’åç¬¬å››ï¼Œæ˜¯ä¸šå†…å®‰è£…çš„æœ€å¿«ç³»ç»Ÿã€‚å®ƒçš„ç†è®ºæ€§èƒ½ä¸º 922 GFLOPSï¼ˆå‡ ä¹Žæ¯ç§’ä¸€ä¸‡äº¿æ¬¡æµ®ç‚¹è¿ç®—ï¼‰ï¼Œä½†ä¸Ž 12 å¹´åŽå‘å¸ƒçš„ GTX 1080 Ti ç›¸æ¯”ï¼Œè¿™å †é“å—çš„æ‰€æœ‰èƒ½åŠ›çœ‹èµ·æ¥æ˜¾å¾—å¾®ä¸è¶³é“ã€‚

ä¸€å—å•ç‹¬çš„ GTX 1080 Ti èƒ½å¤Ÿæ‰§è¡Œ 11,340 GFLOPSï¼Œæ€§èƒ½æ˜¯ 2005 å¹´çš„è¶…çº§è®¡ç®—æœºçš„ 12.3 å€ã€‚è€Œä¸”å®ƒå‘å¸ƒæ—¶ï¼Œæ¯ä¸ª GPU çš„ä»·æ ¼ä»…ä¸º $700ï¼å¦‚æžœæˆ‘ä»¬æŒ‰æ¯èŠ±è´¹ $1 çš„è®¡ç®—èƒ½åŠ›æ¥ç®—ï¼Œé‚£ä¹ˆæ¯ä¸ª GFLOP çš„ä»·æ ¼ä¸‹é™äº†è¶…è¿‡ 17,500 å€ã€‚è¿™ä¸ªæ•°å­—åœ¨æœ€æ–°çš„ï¼ˆæ’°å†™æ—¶ï¼‰H100 GPU ä¸Šæ›´ä¸ºæƒŠäººï¼ŒH100 æä¾›äº† 134 teraflops çš„æ€§èƒ½ï¼ˆä½¿ç”¨ FP32 æ“ä½œï¼‰ã€‚

è®¸å¤šäººå¤šæ¬¡æåˆ°ï¼Œäººå·¥æ™ºèƒ½ï¼ˆAIï¼‰çš„è¿›æ­¥ï¼ˆä»¥åŠæœºå™¨å­¦ä¹ ï¼ˆMLï¼‰çš„ä¸€èˆ¬è¿›å±•ï¼‰æ˜¯ç”±æ•°æ®å¯ç”¨æ€§å’Œè®¡ç®—èƒ½åŠ›çš„æå‡æ‰€æŽ¨åŠ¨çš„ï¼Œæˆ‘è®¤ä¸ºè¿™ç»å¯¹æ˜¯æ­£ç¡®çš„ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä¸€äº›è®¡ç®—åœ¨ä¸€å°æœºå™¨ä¸Šéœ€è¦ä¸€ä¸ªæœˆæ‰èƒ½å®Œæˆï¼ˆè¿™åœ¨è®¡ç®—æµä½“åŠ›å­¦ï¼ˆCFDï¼‰å’Œå…¶ä»–ç‰©ç†ä»¿çœŸä¸­éžå¸¸å¸¸è§ï¼‰ã€‚å¦‚æžœæˆ‘ä»¬èƒ½å°†é€Ÿåº¦æé«˜äº”å€ï¼Œé‚£ä¹ˆåŽŸæœ¬éœ€è¦è€å¿ƒç­‰å¾…ä¸€ä¸ªæœˆçš„æ—¶é—´å°†ç¼©çŸ­ä¸ºå…­å¤©ã€‚æé«˜ 100 å€çš„é€Ÿåº¦æ„å‘³ç€è¿™ä¸ªä¸€ä¸ªæœˆçš„è®¡ç®—å°†åªéœ€è¦å…«å°æ—¶å®Œæˆï¼Œé‚£ä¹ˆä½ ä¸€å¤©ä¹‹å†…å°±èƒ½å®Œæˆä¸‰æ¬¡è®¡ç®—ï¼å¦‚ä»Šï¼ŒåªèŠ±ç›¸åŒçš„é’±å°±èƒ½èŽ·å¾— 20,000 å€çš„è®¡ç®—èƒ½åŠ›ï¼ŒçœŸæ˜¯å¤ªé…·äº†ã€‚é¡ºä¾¿æä¸€ä¸‹ï¼Œé€Ÿåº¦æé«˜ 20,000 å€æ„å‘³ç€æˆ‘ä»¬åŽŸæœ¬éœ€è¦ä¸€ä¸ªæœˆçš„è®¡ç®—é—®é¢˜åªéœ€è¦ä¸¤åˆ°ä¸‰åˆ†é’Ÿå°±èƒ½å®Œæˆï¼

è¿™ç§æƒ…å†µä¸ä»…å‘ç”Ÿåœ¨â€œå·¨åž‹è®¡ç®—æœºâ€ï¼ˆä¹Ÿç§°ä¸ºé«˜æ€§èƒ½è®¡ç®—ï¼‰é¢†åŸŸï¼›åŸºæœ¬ä¸Šï¼Œå®ƒæ— å¤„ä¸åœ¨ã€‚çŽ°ä»£å¾®æŽ§åˆ¶å™¨çš„æ€§èƒ½ç‰¹ç‚¹å·²ç»ä¸Žæˆ‘ä»¬ 15 å¹´å‰ä½¿ç”¨çš„æ¡Œé¢è®¡ç®—æœºç›¸å½“ï¼ˆä¾‹å¦‚ï¼Œä½ å¯ä»¥èŠ± 50 ç¾Žå…ƒæ‰“é€ ä¸€å°ä¾¿æºè®¡ç®—æœºï¼Œé…å¤‡è¿è¡Œ 120 MHz çš„ 32 ä½å¾®æŽ§åˆ¶å™¨ï¼Œèƒ½å¤Ÿè¿è¡Œ Atari 2600 æ¨¡æ‹Ÿå™¨ï¼š[`hackaday.io/project/80627-badge-for-hackaday-conference-2018-in-belgrade`](https://hackaday.io/project/80627-badge-for-hackaday-conference-2018-in-belgrade)ï¼‰ ã€‚æˆ‘ç”šè‡³æ²¡æœ‰æåˆ°çŽ°ä»£æ™ºèƒ½æ‰‹æœºï¼Œå®ƒä»¬é€šå¸¸é…æœ‰å››åˆ°å…«ä¸ªæ ¸å¿ƒã€å›¾å½¢å¤„ç†å•å…ƒï¼ˆGPUï¼‰ä»¥åŠæ•° GB çš„å†…å­˜ã€‚

å½“ç„¶ï¼Œé‚£é‡Œæœ‰å¾ˆå¤šå¤æ‚çš„å› ç´ ã€‚è¿™ä¸ä»…ä»…æ˜¯å°†åå¹´å‰ç”¨è¿‡çš„ç›¸åŒä»£ç çŽ°åœ¨ç¥žå¥‡åœ°è®©å®ƒè¿è¡Œå¾—å¿«ä¸Šå‡ åƒå€ã€‚å¯èƒ½æ­£å¥½ç›¸åï¼šä½ ç”šè‡³å¯èƒ½å®Œå…¨æ— æ³•è¿è¡Œå®ƒï¼Œå› ä¸ºåº“ã€æ“ä½œç³»ç»ŸæŽ¥å£ä»¥åŠå…¶ä»–å› ç´ çš„å˜åŒ–ã€‚ï¼ˆä½ æ˜¯å¦æ›¾å°è¯•è¯»å–åå¹´å‰å†™å…¥çš„ CD-RW ç£ç›˜ï¼Ÿï¼‰å¦‚ä»Šï¼Œè¦å……åˆ†å‘æŒ¥çŽ°ä»£ç¡¬ä»¶çš„èƒ½åŠ›ï¼Œä½ éœ€è¦å°†ä»£ç å¹¶è¡ŒåŒ–ï¼Œè¿™æ„å‘³ç€ä½ å¿…é¡»å¤„ç†å¤§é‡å…³äºŽåˆ†å¸ƒå¼ç³»ç»Ÿã€æ•°æ®å±€éƒ¨æ€§ã€é€šä¿¡ä»¥åŠç¡¬ä»¶å’Œåº“å†…éƒ¨ç‰¹æ€§çš„ç»†èŠ‚ã€‚é«˜çº§åº“å°½åŠ›éšè—è¿™äº›å¤æ‚æ€§ï¼Œä½†å¦‚æžœä½ æƒ³é«˜æ•ˆåœ°ä½¿ç”¨è¿™äº›åº“ï¼Œå°±æ— æ³•å¿½è§†è¿™äº›é—®é¢˜ã€‚ç„¶è€Œï¼Œè¿™ç»å¯¹æ˜¯å€¼å¾—çš„â€”â€”è®°ä½ï¼Œä¸€æ•´ä¸ªæœˆçš„è€å¿ƒç­‰å¾…å¯ä»¥ç¼©çŸ­ä¸ºä¸‰åˆ†é’Ÿã€‚å¦ä¸€æ–¹é¢ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬è¦åŠ é€Ÿæ“ä½œï¼Œå¯èƒ½å¹¶ä¸å®Œå…¨æ˜Žæ˜¾ã€‚æ¯•ç«Ÿï¼Œä¸€ä¸ªæœˆå¹¶ä¸ç®—å¤ªé•¿ï¼›åªéœ€å°†è®¡ç®—æœºé”åœ¨æœåŠ¡å™¨å®¤ï¼Œç„¶åŽåŽ»åº¦ä¸ªå‡ï¼ä½†è¯·æƒ³ä¸€ä¸‹å‡†å¤‡å’Œä½¿è¿™ä¸ªè®¡ç®—è¿‡ç¨‹æ­£å¸¸è¿è¡Œçš„æ•´ä¸ªè¿‡ç¨‹ã€‚ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œå³ä½¿æ˜¯ç®€å•çš„æœºå™¨å­¦ä¹ é—®é¢˜ï¼Œåˆæ¬¡å°è¯•æ—¶ä¹Ÿå‡ ä¹Žä¸å¯èƒ½åšåˆ°å®Œç¾Žå®žçŽ°ã€‚

å®ƒä»¬éœ€è¦å¤šæ¬¡è¯•è¿è¡Œï¼Œæ‰èƒ½æ‰¾åˆ°åˆé€‚çš„è¶…å‚æ•°å¹¶ä¿®å¤æ‰€æœ‰çš„é”™è¯¯å’Œä»£ç ï¼Œå‡†å¤‡å¥½è¿›è¡Œå¹²å‡€çš„å‘å¸ƒã€‚åœ¨ç‰©ç†ä»¿çœŸã€å¼ºåŒ–å­¦ä¹ ç ”ç©¶ã€å¤§æ•°æ®å¤„ç†å’Œç¼–ç¨‹é¢†åŸŸï¼Œç¡®å®žå­˜åœ¨å®Œå…¨ç›¸åŒçš„è¿‡ç¨‹ã€‚å› æ­¤ï¼Œå¦‚æžœæˆ‘ä»¬èƒ½å¤Ÿè®©æŸä¸ªç¨‹åºè¿è¡Œå¾—æ›´å¿«ï¼Œå®ƒä¸ä»…å¯¹å•æ¬¡è¿è¡Œæœ‰åˆ©ï¼Œè¿˜èƒ½è®©æˆ‘ä»¬å¿«é€Ÿè¿­ä»£ï¼Œè¿›è¡Œæ›´å¤šçš„å®žéªŒï¼Œè¿™å¯èƒ½æ˜¾è‘—åŠ é€Ÿæ•´ä¸ªè¿‡ç¨‹ï¼Œå¹¶æé«˜æœ€ç»ˆç»“æžœçš„è´¨é‡ã€‚

æˆ‘è®°å¾—èŒä¸šç”Ÿæ¶¯ä¸­æœ‰ä¸€ä¸ªæƒ…å¢ƒï¼Œå½“æ—¶æˆ‘ä»¬åœ¨éƒ¨é—¨å†…éƒ¨éƒ¨ç½²äº†ä¸€ä¸ª Hadoop é›†ç¾¤ï¼Œæˆ‘ä»¬å½“æ—¶æ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘é¡µæœç´¢å¼•æ“Žï¼ˆç±»ä¼¼ Googleï¼Œä½†ç”¨äºŽä¿„ç½—æ–¯ç½‘ç«™ï¼‰ã€‚åœ¨éƒ¨ç½²ä¹‹å‰ï¼Œå³ä½¿æ˜¯è¿›è¡Œç®€å•çš„æ•°æ®å®žéªŒï¼Œä¹Ÿéœ€è¦å‡ ä¸ªæ˜ŸæœŸçš„æ—¶é—´ã€‚å‡  TB çš„æ•°æ®åˆ†å¸ƒåœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼›ä½ éœ€è¦åœ¨æ¯å°æœºå™¨ä¸Šè¿è¡Œå¤šæ¬¡ä»£ç ï¼Œæ”¶é›†å’Œåˆå¹¶ä¸­é—´ç»“æžœï¼Œå¤„ç†å¶å°”å‘ç”Ÿçš„ç¡¬ä»¶æ•…éšœï¼Œå¹¶å®Œæˆè®¸å¤šä¸Žé—®é¢˜æ— å…³çš„æ‰‹åŠ¨ä»»åŠ¡ã€‚å°† Hadoop å¹³å°é›†æˆåˆ°æ•°æ®å¤„ç†åŽï¼Œå®žéªŒæ‰€éœ€çš„æ—¶é—´å‡å°‘åˆ°äº†å‡ ä¸ªå°æ—¶ï¼Œè¿™å®Œå…¨æ”¹å˜äº†æ¸¸æˆè§„åˆ™ã€‚ä»Žé‚£æ—¶èµ·ï¼Œå¼€å‘äººå‘˜èƒ½å¤Ÿæ›´è½»æ¾ã€æ›´å¿«é€Ÿåœ°è¿›è¡Œæ›´å¤šå®žéªŒï¼Œè€Œä¸å¿…ä¸ºä¸å¿…è¦çš„ç»†èŠ‚çƒ¦æ¼ã€‚å®žéªŒçš„æ•°é‡ï¼ˆä»¥åŠè¿›è¡Œå®žéªŒçš„æ„æ„¿ï¼‰æ˜¾è‘—å¢žåŠ ï¼Œè¿™ä¹Ÿæé«˜äº†æœ€ç»ˆäº§å“çš„è´¨é‡ã€‚

å¦ä¸€ä¸ªæ”¯æŒä¼˜åŒ–çš„ç†ç”±æ˜¯æˆ‘ä»¬å¯ä»¥å¤„ç†çš„é—®é¢˜çš„è§„æ¨¡ã€‚è®©æŸç§æ–¹æ³•è¿è¡Œå¾—æ›´å¿«å¯èƒ½æ„å‘³ç€ä¸¤ä»¶äº‹ï¼šæˆ‘ä»¬å¯ä»¥æ›´å¿«å¾—åˆ°ç»“æžœï¼Œæˆ–è€…æˆ‘ä»¬å¯ä»¥å¢žåŠ é—®é¢˜çš„è§„æ¨¡ï¼ˆæˆ–å…¶ä»–è¡¡é‡é—®é¢˜å¤æ‚æ€§çš„æ ‡å‡†ï¼‰ã€‚å¤æ‚æ€§å¢žåŠ åœ¨ä¸åŒæƒ…å†µä¸‹å¯èƒ½æœ‰ä¸åŒçš„å«ä¹‰ï¼Œæ¯”å¦‚å¾—åˆ°æ›´å‡†ç¡®çš„ç»“æžœï¼Œå‡å°‘å¯¹çŽ°å®žä¸–ç•Œçš„ç®€åŒ–ï¼Œæˆ–è€…è€ƒè™‘æ›´å¤šçš„æ•°æ®ï¼Œä½†å‡ ä¹Žæ€»æ˜¯ï¼Œè¿™æ˜¯å¥½äº‹ã€‚

å›žåˆ°æœ¬ä¹¦çš„ä¸»é¢˜ï¼Œè®©æˆ‘ä»¬æ¦‚è¿°ä¸€ä¸‹å¼ºåŒ–å­¦ä¹ æ–¹æ³•å¦‚ä½•é€šè¿‡åŠ é€Ÿæ¥å—ç›Šã€‚é¦–å…ˆï¼Œå³ä½¿æ˜¯æœ€å…ˆè¿›çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•ä¹Ÿä¸æ˜¯éžå¸¸é«˜æ•ˆï¼Œè¿™æ„å‘³ç€è®­ç»ƒéœ€è¦å¤šæ¬¡ä¸ŽçŽ¯å¢ƒè¿›è¡Œäº¤äº’ï¼ˆåœ¨é›…è¾¾åˆ©çš„æƒ…å†µä¸‹æ˜¯æ•°ç™¾ä¸‡æ¬¡ï¼‰ï¼Œæ‰èƒ½å­¦åˆ°ä¸€ä¸ªå¥½çš„ç­–ç•¥ï¼Œè¿™å¯èƒ½éœ€è¦å‡ å‘¨çš„è®­ç»ƒã€‚å¦‚æžœæˆ‘ä»¬èƒ½åŠ é€Ÿè¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ›´å¿«åœ°å¾—åˆ°ç»“æžœï¼Œè¿›è¡Œæ›´å¤šçš„å®žéªŒï¼Œå¹¶æ‰¾åˆ°æ›´å¥½çš„è¶…å‚æ•°ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¦‚æžœæˆ‘ä»¬çš„ä»£ç æ›´å¿«ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥å¢žåŠ åº”ç”¨è¿™äº›æ–¹æ³•æ—¶é—®é¢˜çš„å¤æ‚æ€§ã€‚

åœ¨çŽ°ä»£å¼ºåŒ–å­¦ä¹ ï¼ˆRLï¼‰ä¸­ï¼Œé›…è¾¾åˆ©æ¸¸æˆè¢«è®¤ä¸ºå·²ç»è§£å†³ï¼›å³ä½¿æ˜¯æ‰€è°“çš„â€œå›°éš¾æŽ¢ç´¢æ¸¸æˆâ€ï¼Œå¦‚ã€Šè’™ç‰¹ç¥–çŽ›çš„å¤ä»‡ã€‹ï¼Œä¹Ÿå¯ä»¥è¢«è®­ç»ƒåˆ°è¶…äººç±»çš„å‡†ç¡®åº¦ã€‚å› æ­¤ï¼Œæ–°çš„ç ”ç©¶å‰æ²¿éœ€è¦æ›´å¤æ‚çš„é—®é¢˜ï¼Œå…·æœ‰æ›´ä¸°å¯Œçš„è§‚å¯Ÿå’Œè¡ŒåŠ¨ç©ºé—´ï¼Œè¿™å¿…ç„¶éœ€è¦æ›´å¤šçš„è®­ç»ƒæ—¶é—´å’Œç¡¬ä»¶ã€‚è¿™æ ·çš„ç ”ç©¶å·²ç»ç”± DeepMind å’Œ OpenAI å¼€å§‹ï¼ˆä»Žæˆ‘çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¹Ÿå¢žåŠ äº†é—®é¢˜çš„å¤æ‚æ€§ï¼Œå¯èƒ½æœ‰ç‚¹è¿‡å¤´äº†ï¼‰ï¼Œä»–ä»¬ä»Žé›…è¾¾åˆ©è½¬å‘äº†æ›´å…·æŒ‘æˆ˜æ€§çš„é—®é¢˜ï¼Œå¦‚è›‹ç™½è´¨æŠ˜å ï¼ˆAlphaFold ç³»ç»Ÿï¼‰å’Œå¤§åž‹è¯­è¨€æ¨¡åž‹ï¼ˆLLMsï¼‰ã€‚è¿™äº›é—®é¢˜éœ€è¦æˆåƒä¸Šä¸‡çš„ GPU å¹¶è¡Œå·¥ä½œã€‚

æˆ‘æƒ³ä»¥ä¸€ä¸ªå°å°çš„è­¦å‘Šç»“æŸè¿™æ®µä»‹ç»ï¼šæ‰€æœ‰çš„æ€§èƒ½ä¼˜åŒ–åªæœ‰åœ¨æ ¸å¿ƒæ–¹æ³•æ­£å¸¸å·¥ä½œçš„æƒ…å†µä¸‹æ‰æœ‰æ„ä¹‰ï¼ˆè¿™åœ¨å¼ºåŒ–å­¦ä¹ å’Œæœºå™¨å­¦ä¹ çš„æƒ…å†µä¸‹å¹¶ä¸æ€»æ˜¯æ˜¾è€Œæ˜“è§ï¼‰ã€‚æ­£å¦‚ä¸€ä½åœ¨çº¿è¯¾ç¨‹çš„è®²å¸ˆæ‰€è¯´ï¼šâ€œæœ‰ä¸€ä¸ªæ…¢è€Œæ­£ç¡®çš„ç¨‹åºï¼Œæ¯”ä¸€ä¸ªå¿«ä½†ä¸æ­£ç¡®çš„ç¨‹åºè¦å¥½å¾—å¤šã€‚â€

# åŸºå‡†çº¿

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä½ å·²ç»ç†Ÿæ‚‰çš„ Atari Pong çŽ¯å¢ƒï¼Œå¹¶å°è¯•åŠ é€Ÿå…¶æ”¶æ•›é€Ÿåº¦ã€‚ä½œä¸ºåŸºå‡†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç¬¬å…«ç« ä¸­ä½¿ç”¨çš„ç›¸åŒç®€å• DQNï¼Œè¶…å‚æ•°ä¹Ÿå°†ä¿æŒä¸€è‡´ã€‚ä¸ºäº†æ¯”è¾ƒæˆ‘ä»¬æ”¹åŠ¨çš„æ•ˆæžœï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸¤ä¸ªç‰¹å¾ï¼š

+   æ¯ç§’é’Ÿæˆ‘ä»¬ä»ŽçŽ¯å¢ƒä¸­æ¶ˆè€—çš„å¸§æ•°ï¼ˆFPSï¼‰ã€‚è¿™è¡¨ç¤ºæˆ‘ä»¬åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¸ŽçŽ¯å¢ƒçš„äº¤äº’é€Ÿåº¦ã€‚åœ¨å¼ºåŒ–å­¦ä¹ çš„æ–‡çŒ®ä¸­ï¼Œé€šå¸¸ä¼šæ ‡æ˜Žæ™ºèƒ½ä½“åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è§‚å¯Ÿåˆ°çš„å¸§æ•°ï¼Œæ­£å¸¸çš„æ•°å­—èŒƒå›´æ˜¯ 2500 ä¸‡åˆ° 5000 ä¸‡å¸§ã€‚å› æ­¤ï¼Œå¦‚æžœæˆ‘ä»¬çš„ FPS=200ï¼Œé‚£ä¹ˆéœ€è¦çš„æ—¶é—´ä¸º![--50â‹…106--- 200â‹…60â‹…60â‹…24](img/eq39.png) â‰ˆ 2.89 å¤©ã€‚åœ¨è¿™ç§è®¡ç®—ä¸­ï¼Œéœ€è¦è€ƒè™‘åˆ°å¼ºåŒ–å­¦ä¹ æ–‡çŒ®é€šå¸¸æŠ¥å‘Šçš„æ˜¯åŽŸå§‹çŽ¯å¢ƒå¸§æ•°ã€‚ä½†å¦‚æžœä½¿ç”¨äº†å¸§è·³è·ƒï¼ˆå‡ ä¹Žæ€»æ˜¯ä½¿ç”¨ï¼‰ï¼Œåˆ™å¸§æ•°éœ€è¦é™¤ä»¥è¿™ä¸ªå› å­ï¼Œé€šå¸¸æ˜¯ 4ã€‚åœ¨æˆ‘ä»¬çš„æµ‹é‡ä¸­ï¼Œæˆ‘ä»¬è®¡ç®—çš„æ˜¯æ™ºèƒ½ä½“ä¸ŽçŽ¯å¢ƒçš„äº¤äº’å¸§æ•°ï¼Œå› æ­¤â€œåŽŸå§‹çŽ¯å¢ƒ FPSâ€å°†æ˜¯å…¶å››å€ã€‚

+   æ¸¸æˆè§£å†³ä¹‹å‰çš„å¢™é’Ÿæ—¶é—´ã€‚å½“æœ€åŽ 100 ä¸ªå›žåˆçš„å¹³æ»‘å¥–åŠ±è¾¾åˆ° 18 æ—¶ï¼Œæˆ‘ä»¬åœæ­¢è®­ç»ƒï¼ˆPong æ¸¸æˆçš„æœ€é«˜åˆ†æ˜¯ 21ï¼‰ã€‚è¿™ä¸ªè¾¹ç•Œå€¼å¯ä»¥æé«˜ï¼Œä½†é€šå¸¸ 18 å·²ç»æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æŒ‡æ ‡ï¼Œè¡¨æ˜Žæ™ºèƒ½ä½“å‡ ä¹ŽæŽŒæ¡äº†æ¸¸æˆï¼Œè¿›ä¸€æ­¥ç²¾ç‚¼ç­–ç•¥ä»…ä»…æ˜¯è®­ç»ƒæ—¶é—´çš„é—®é¢˜ã€‚æˆ‘ä»¬æ£€æŸ¥å¢™é’Ÿæ—¶é—´ï¼Œå› ä¸ºå•çº¯çš„ FPS å¹¶ä¸æ˜¯è®­ç»ƒåŠ é€Ÿçš„æœ€ä½³æŒ‡æ ‡ã€‚

ç”±äºŽæˆ‘ä»¬åœ¨ä»£ç ä¸­è¿›è¡Œçš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥èŽ·å¾—éžå¸¸é«˜çš„ FPSï¼Œä½†æ”¶æ•›å¯èƒ½ä¼šå—åˆ°å½±å“ã€‚ä»…å‡­è¿™ä¸ªæ•°å€¼ä¹Ÿä¸èƒ½ä½œä¸ºæˆ‘ä»¬æ”¹è¿›æ•ˆæžœçš„å¯é æŒ‡æ ‡ï¼Œå› ä¸ºè®­ç»ƒè¿‡ç¨‹æ˜¯éšæœºçš„ã€‚å³ä½¿æŒ‡å®šäº†éšæœºç§å­ï¼ˆæˆ‘ä»¬éœ€è¦æ˜Žç¡®è®¾ç½® PyTorchã€Gym å’Œ NumPy çš„ç§å­ï¼‰ï¼Œå¹¶è¡ŒåŒ–ï¼ˆåœ¨åŽç»­æ­¥éª¤ä¸­ä¼šä½¿ç”¨ï¼‰ä¹Ÿä¼šä¸ºè¿‡ç¨‹å¢žåŠ éšæœºæ€§ï¼Œå‡ ä¹Žæ— æ³•é¿å…ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬èƒ½åšçš„æœ€å¥½çš„æ˜¯å¤šæ¬¡è¿è¡ŒåŸºå‡†æµ‹è¯•å¹¶å–å¹³å‡å€¼ã€‚ä½†å•æ¬¡è¿è¡Œçš„ç»“æžœä¸èƒ½ä½œä¸ºå†³ç­–çš„ä¾æ®ã€‚

ç”±äºŽä¸Šè¿°æåˆ°çš„éšæœºæ€§ï¼Œæœ¬ç« ä¸­çš„æ‰€æœ‰å›¾è¡¨éƒ½æ˜¯é€šè¿‡å¯¹åŒä¸€å®žéªŒçš„ 5 æ¬¡è¿è¡Œç»“æžœè¿›è¡Œå¹³å‡å¾—åˆ°çš„ã€‚æ‰€æœ‰åŸºå‡†æµ‹è¯•éƒ½ä½¿ç”¨ç›¸åŒçš„æœºå™¨ï¼Œé…ç½®ä¸º Intel i5-7600K CPUã€GTX 1080 Ti GPUï¼ŒCUDA ç‰ˆæœ¬ 12.3ï¼Œä»¥åŠ NVIDIA é©±åŠ¨ç‰ˆæœ¬ 545.29.06ã€‚

æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªåŸºå‡†å°†æ˜¯åŸºçº¿ç‰ˆæœ¬ï¼Œä½äºŽ Chapter09/01_baseline.pyã€‚æˆ‘è¿™é‡Œä¸æä¾›æºä»£ç ï¼Œå› ä¸ºå®ƒå·²ç»åœ¨å‰ä¸€ç« ä¸­ç»™å‡ºï¼Œå¹¶ä¸”åœ¨æ­¤ä¸Žå‰é¢ç›¸åŒã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œä»£ç ä¼šå‘ TensorBoard å†™å…¥å‡ ä¸ªæŒ‡æ ‡ï¼š

+   reward: æ¥è‡ªå‰§é›†çš„åŽŸå§‹æœªæŠ˜æ‰£å¥–åŠ±ï¼›x è½´æ˜¯å‰§é›†çš„ç¼–å·ã€‚

+   avg_reward: ä¸Žå¥–åŠ±ç›¸åŒï¼Œä½†é€šè¿‡ä½¿ç”¨ Î± = 0.98 çš„æ»‘åŠ¨å¹³å‡è¿›è¡Œå¹³æ»‘å¤„ç†ã€‚

+   steps: å‰§é›†æŒç»­çš„æ­¥æ•°ã€‚é€šå¸¸ï¼Œåœ¨å¼€å§‹æ—¶ï¼Œä»£ç†ä¼šè¿…é€Ÿå¤±è´¥ï¼Œæ‰€ä»¥æ¯ä¸ªå‰§é›†å¤§çº¦æœ‰ 1,000 æ­¥ã€‚ç„¶åŽï¼Œä»£ç†å­¦ä¼šäº†æ›´å¥½çš„è¡Œä¸ºï¼Œæ‰€ä»¥æ­¥æ•°å¢žåŠ åˆ° 3,000â€“4,000ï¼Œå¹¶ä¸”å¥–åŠ±ä¹Ÿå¢žåŠ ï¼›ä½†æ˜¯ï¼Œæœ€ç»ˆï¼Œå½“ä»£ç†æŽŒæ¡äº†æ¸¸æˆæ—¶ï¼Œæ­¥æ•°ä¼šé™å›žåˆ° 2,000 æ­¥ï¼Œå› ä¸ºç­–ç•¥è¢«ä¼˜åŒ–åˆ°å°½å¯èƒ½å¿«åœ°èŽ·èƒœï¼ˆç”±äºŽæŠ˜æ‰£å› å­ Î³ï¼‰ã€‚äº‹å®žä¸Šï¼Œè¿™ç§å‰§é›†é•¿åº¦çš„ä¸‹é™å¯èƒ½è¡¨æ˜Žè¿‡æ‹Ÿåˆäº†çŽ¯å¢ƒï¼Œè¿™åœ¨å¼ºåŒ–å­¦ä¹ ä¸­æ˜¯ä¸€ä¸ªå·¨å¤§çš„é—®é¢˜ã€‚ç„¶è€Œï¼Œå¤„ç†è¿™ä¸ªé—®é¢˜è¶…å‡ºäº†æˆ‘ä»¬å®žéªŒçš„èŒƒå›´ã€‚

+   loss: è®­ç»ƒä¸­çš„æŸå¤±ï¼Œæ¯ 100 æ¬¡è¿­ä»£é‡‡æ ·ä¸€æ¬¡ã€‚å®ƒåº”è¯¥åœ¨ 2â‹…10^(âˆ’3)â€¦1â‹…10^(âˆ’2) ä¹‹é—´ï¼Œå¶å°”ä¼šæœ‰å¢žåŠ ï¼Œå½“ä»£ç†å‘çŽ°æ–°çš„è¡Œä¸ºæ—¶ï¼Œå¯¼è‡´å¥–åŠ±ä¸Ž Q å€¼å­¦ä¹ çš„å¥–åŠ±ä¸åŒã€‚

+   avg_loss: æŸå¤±çš„å¹³æ»‘ç‰ˆæœ¬ã€‚

+   epsilon: å½“å‰ ðœ– çš„å€¼â€”â€”é‡‡å–éšæœºè¡ŒåŠ¨çš„æ¦‚çŽ‡ã€‚

+   avg_fps: ä»£ç†ä¸ŽçŽ¯å¢ƒé€šä¿¡çš„é€Ÿåº¦ï¼ˆæ¯ç§’è§‚å¯Ÿæ•°ï¼‰ï¼Œé€šè¿‡æ»‘åŠ¨å¹³å‡è¿›è¡Œå¹³æ»‘å¤„ç†ã€‚

åœ¨å›¾Â 9.1 å’Œå›¾Â 9.2 ä¸­ï¼Œå›¾è¡¨æ˜¯ä»Ž 5 æ¬¡åŸºçº¿è¿è¡Œä¸­å¹³å‡å¾—å‡ºçš„ã€‚å¦‚ä¹‹å‰æ‰€ç¤ºï¼Œæ¯ä¸ªå›¾è¡¨éƒ½ç»˜åˆ¶äº†ä¸¤ä¸ª x è½´ï¼šåº•éƒ¨æ˜¯å°æ—¶ä¸ºå•ä½çš„å¢™é’Ÿæ—¶é—´ï¼Œä¸Šé¢æ˜¯æ­¥æ•°ï¼ˆå›¾Â 9.1 ä¸­ä¸ºå‰§é›†æ•°ï¼Œå›¾Â 9.2 ä¸­ä¸ºè®­ç»ƒè¿­ä»£æ¬¡æ•°ï¼‰ï¼š

![PIC](img/B21150_09_01.png)

å›¾Â 9.1ï¼šåŸºçº¿ç‰ˆæœ¬ä¸­çš„å¥–åŠ±å’Œå‰§é›†é•¿åº¦

![PIC](img/B21150_09_02.png)

å›¾Â 9.2ï¼šåŸºçº¿ç‰ˆæœ¬è®­ç»ƒä¸­çš„æŸå¤±å’Œ FPS

# PyTorch ä¸­çš„è®¡ç®—å›¾

æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªä¾‹å­ä¸ä¼šé›†ä¸­åœ¨åŠ é€ŸåŸºçº¿ä¸Šï¼Œè€Œæ˜¯å±•ç¤ºä¸€ç§å¸¸è§çš„ã€å¹¶ä¸æ€»æ˜¯æ˜¾è€Œæ˜“è§çš„æƒ…å†µï¼Œè¿™ç§æƒ…å†µå¯èƒ½ä¼šå½±å“æ€§èƒ½ã€‚åœ¨ç¬¬Â 3 ç« ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº† PyTorch å¦‚ä½•è®¡ç®—æ¢¯åº¦ï¼šå®ƒä¼šæž„å»ºä½ å¯¹å¼ é‡æ‰§è¡Œçš„æ‰€æœ‰æ“ä½œçš„å›¾ï¼Œå½“ä½ è°ƒç”¨æœ€ç»ˆæŸå¤±çš„ backward() æ–¹æ³•æ—¶ï¼Œæ‰€æœ‰æ¨¡åž‹å‚æ•°ä¸­çš„æ¢¯åº¦ä¼šè¢«è‡ªåŠ¨è®¡ç®—å‡ºæ¥ã€‚

è¿™ç§æ–¹æ³•æœ‰æ•ˆï¼Œä½†å¼ºåŒ–å­¦ä¹ ä»£ç é€šå¸¸æ¯”ä¼ ç»Ÿçš„ç›‘ç£å­¦ä¹ è®­ç»ƒè¦å¤æ‚å¾—å¤šï¼Œå› æ­¤æˆ‘ä»¬å½“å‰è®­ç»ƒçš„å¼ºåŒ–å­¦ä¹ æ¨¡åž‹ä¹Ÿåœ¨ç”¨äºŽèŽ·å–ä»£ç†åœ¨çŽ¯å¢ƒä¸­éœ€è¦æ‰§è¡Œçš„åŠ¨ä½œã€‚ç¬¬Â 6 ç« ä¸­è®¨è®ºçš„ç›®æ ‡ç½‘ç»œä½¿å¾—è¿™ä¸€è¿‡ç¨‹æ›´åŠ å¤æ‚ã€‚å› æ­¤ï¼Œåœ¨ DQN ä¸­ï¼Œç¥žç»ç½‘ç»œï¼ˆNNï¼‰é€šå¸¸åœ¨ä¸‰ç§ä¸åŒçš„æƒ…å†µä¸­ä½¿ç”¨ï¼š

+   å½“æˆ‘ä»¬å¸Œæœ›è®¡ç®—ç”±ç½‘ç»œé¢„æµ‹çš„ Q å€¼ï¼Œä»¥æ ¹æ® Bellman æ–¹ç¨‹å¾—åˆ°ç›¸å¯¹äºŽå‚è€ƒ Q å€¼çš„æŸå¤±æ—¶

+   å½“æˆ‘ä»¬åº”ç”¨ç›®æ ‡ç½‘ç»œæ¥èŽ·å–ä¸‹ä¸€ä¸ªçŠ¶æ€çš„ Q å€¼ï¼Œä»¥è®¡ç®— Bellman è¿‘ä¼¼æ—¶

+   å½“ä»£ç†æƒ³è¦å†³å®šæ‰§è¡Œçš„åŠ¨ä½œæ—¶

åœ¨æˆ‘ä»¬çš„è®­ç»ƒä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹è®¡ç®—æ¢¯åº¦ã€‚åœ¨ç¬¬å…­ç« ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æ˜¾å¼è°ƒç”¨ detach()æ¥é¿å…è®¡ç®—æ¢¯åº¦ï¼Œè¿™ä¸ª detach éžå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒé˜²æ­¢äº†æ¢¯åº¦â€œä»Žæ„å¤–çš„æ–¹å‘â€æµå…¥æˆ‘ä»¬çš„æ¨¡åž‹ï¼Œå¦‚æžœæ²¡æœ‰å®ƒï¼ŒDQN å¯èƒ½æ ¹æœ¬æ— æ³•æ”¶æ•›ã€‚åœ¨ç¬¬ä¸‰ç§æƒ…å†µä¸‹ï¼Œæ¢¯åº¦é€šè¿‡å°†ç½‘ç»œç»“æžœè½¬æ¢ä¸º NumPy æ•°ç»„æ¥åœæ­¢ã€‚

æˆ‘ä»¬åœ¨ç¬¬å…­ç« ä¸­çš„ä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œä½†æˆ‘ä»¬é”™è¿‡äº†ä¸€ä¸ªç»†èŠ‚ï¼šä¸‰ç§æƒ…å†µä¸‹åˆ›å»ºçš„è®¡ç®—å›¾ã€‚è¿™ä¸ªé—®é¢˜ä¸å¤§ï¼Œä½†åˆ›å»ºè®¡ç®—å›¾ä»ç„¶ä¼šä½¿ç”¨ä¸€äº›èµ„æºï¼ˆæ— è®ºæ˜¯é€Ÿåº¦è¿˜æ˜¯å†…å­˜ï¼‰ï¼Œè€Œè¿™äº›èµ„æºä¼šæµªè´¹ï¼Œå› ä¸ºå³ä½¿æˆ‘ä»¬æ²¡æœ‰å¯¹æŸä¸ªå›¾è°ƒç”¨ backward()ï¼ŒPyTorch ä¹Ÿä¼šåˆ›å»ºè¿™ä¸ªè®¡ç®—å›¾ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ‰ä¸€ä¸ªéžå¸¸å¥½çš„é€‰é¡¹ï¼šè£…é¥°å™¨ torch.no_grad()ã€‚

Python ä¸­çš„è£…é¥°å™¨æ˜¯ä¸€ä¸ªéžå¸¸å¹¿æ³›çš„è¯é¢˜ã€‚å®ƒä»¬ä¸ºå¼€å‘è€…æä¾›äº†å¾ˆå¤šåŠŸèƒ½ï¼ˆå¦‚æžœä½¿ç”¨å¾—å½“ï¼‰ï¼Œä½†è¶…å‡ºäº†æœ¬ä¹¦çš„è®¨è®ºèŒƒå›´ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»…ç»™å‡ºä¸€ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªå‡½æ•°ï¼š

```py
>>> import torch 
>>> @torch.no_grad 
... def fun_a(t): 
... Â Â Â return t*2 
... 
>>> def fun_b(t): 
... Â Â Â return t*2 
...
```

è¿™ä¸¤ä¸ªå‡½æ•°åšçš„æ˜¯ç›¸åŒçš„äº‹æƒ…ï¼Œéƒ½æ˜¯å°†å‚æ•°ç¿»å€ï¼Œä½†ç¬¬ä¸€ä¸ªå‡½æ•°ä½¿ç”¨äº† torch.no_grad()è£…é¥°å™¨ï¼Œç¬¬äºŒä¸ªåˆ™æ˜¯æ™®é€šå‡½æ•°ã€‚è¿™ä¸ªè£…é¥°å™¨æš‚æ—¶ç¦ç”¨ä¼ é€’ç»™å‡½æ•°çš„æ‰€æœ‰å¼ é‡çš„æ¢¯åº¦è®¡ç®—ã€‚å¦‚ä½ æ‰€è§ï¼Œå°½ç®¡å¼ é‡ t éœ€è¦è®¡ç®—æ¢¯åº¦ï¼Œä½†ä»Ž fun_aï¼ˆè¢«è£…é¥°çš„å‡½æ•°ï¼‰è¿”å›žçš„ç»“æžœå¹¶æ²¡æœ‰æ¢¯åº¦ï¼š

```py
>>> t = torch.ones(3, requires_grad=True) 
>>> t 
tensor([1., 1., 1.], requires_grad=True) 
>>> a = fun_a(t) 
>>> b = fun_b(t) 
>>> b 
tensor([2., 2., 2.], grad_fn=<MulBackward0>) 
>>> a 
tensor([2., 2., 2.])
```

ä½†æ˜¯è¿™ä¸ªæ•ˆæžœä»…é™äºŽè£…é¥°å™¨å‡½æ•°å†…éƒ¨ï¼š

```py
>>> a*t 
tensor([2., 2., 2.], grad_fn=<MulBackward0>)
```

å‡½æ•° torch.no_grad()ä¹Ÿå¯ä»¥ä½œä¸ºä¸Šä¸‹æ–‡ç®¡ç†å™¨ä½¿ç”¨ï¼ˆè¿™æ˜¯å¦ä¸€ä¸ªå¼ºå¤§çš„ Python æ¦‚å¿µï¼Œæˆ‘å»ºè®®ä½ å­¦ä¹ å®ƒï¼‰ï¼Œç”¨äºŽåœæ­¢æŸæ®µä»£ç ä¸­çš„æ¢¯åº¦è®¡ç®—ï¼š

```py
>>> with torch.no_grad(): 
... Â Â Â c = t*2 
... 
>>> c 
tensor([2., 2., 2.])
```

è¿™ä¸ªåŠŸèƒ½ä¸ºä½ æä¾›äº†ä¸€ç§éžå¸¸æ–¹ä¾¿çš„æ–¹å¼ï¼Œèƒ½å¤ŸæŒ‡ç¤ºä½ ä»£ç ä¸­åº”è¯¥å®Œå…¨æŽ’é™¤æ¢¯åº¦è®¡ç®—çš„éƒ¨åˆ†ã€‚è¿™åœ¨ ptan.agent.DQNAgentï¼ˆä»¥åŠ PTAN æä¾›çš„å…¶ä»–ä»£ç†ï¼‰å’Œ common.calc_loss_dqn å‡½æ•°ä¸­å·²ç»å®Œæˆã€‚ä½†æ˜¯å¦‚æžœä½ æ­£åœ¨ç¼–å†™è‡ªå®šä¹‰ä»£ç†æˆ–å®žçŽ°è‡ªå·±çš„ä»£ç ï¼Œå¾ˆå®¹æ˜“å¿˜è®°è¿™ä¸€ç‚¹ã€‚

ä¸ºäº†è¯„ä¼°ä¸å¿…è¦çš„å›¾è®¡ç®—çš„æ•ˆæžœï¼Œæˆ‘åœ¨ Chapter09/00_slow_grads.py ä¸­æä¾›äº†ä¿®æ”¹åŽçš„åŸºå‡†ä»£ç ï¼Œå®ƒä¸ŽåŽŸä»£ç å®Œå…¨ç›¸åŒï¼Œä½†ä»£ç†å’ŒæŸå¤±è®¡ç®—éƒ¨åˆ†æ²¡æœ‰ä½¿ç”¨ torch.no_grad()ã€‚ä»¥ä¸‹å›¾è¡¨å±•ç¤ºäº†è¿™ä¸€æ•ˆæžœï¼š

![å›¾ç‰‡](img/B21150_09_03.png)

å›¾ 9.3ï¼šåŸºå‡†ç‰ˆæœ¬ä¸Žæ²¡æœ‰ torch.no_grad()ç‰ˆæœ¬ä¹‹é—´çš„å¥–åŠ±å’Œ FPS æ¯”è¾ƒ

æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œé€Ÿåº¦æŸå¤±å¹¶ä¸å¤§ï¼ˆå¤§çº¦ 10FPSï¼‰ï¼Œä½†åœ¨ç½‘ç»œæ›´å¤§ä¸”ç»“æž„æ›´å¤æ‚çš„æƒ…å†µä¸‹ï¼Œè¿™å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚æˆ‘æ›¾çœ‹åˆ°åœ¨æ›´å¤æ‚çš„é€’å½’ç¥žç»ç½‘ç»œä¸­ï¼ŒåŠ å…¥ torch.no_grad()åŽï¼Œæ€§èƒ½æå‡äº† 50%ã€‚

# å¤šä¸ªçŽ¯å¢ƒ

æˆ‘ä»¬é€šå¸¸ç”¨æ¥åŠ é€Ÿæ·±åº¦å­¦ä¹ è®­ç»ƒçš„ç¬¬ä¸€ä¸ªæ€è·¯æ˜¯å¢žåŠ æ‰¹é‡å¤§å°ã€‚è¿™åŒæ ·é€‚ç”¨äºŽæ·±åº¦å¼ºåŒ–å­¦ä¹ é¢†åŸŸï¼Œä½†ä½ éœ€è¦å°å¿ƒã€‚åœ¨æ™®é€šçš„ç›‘ç£å­¦ä¹ ä¸­ï¼Œç®€å•çš„è§„åˆ™â€œè¾ƒå¤§çš„æ‰¹é‡æ›´å¥½â€é€šå¸¸æ˜¯æˆç«‹çš„ï¼šåªè¦ä½ çš„ GPU å†…å­˜å…è®¸ï¼Œå°±å¢žåŠ æ‰¹é‡ï¼Œè¾ƒå¤§çš„æ‰¹é‡é€šå¸¸æ„å‘³ç€åœ¨å•ä½æ—¶é—´å†…å¤„ç†æ›´å¤šæ ·æœ¬ï¼Œè¿™å¾—ç›ŠäºŽå¼ºå¤§çš„ GPU å¹¶è¡Œè®¡ç®—ã€‚

å¼ºåŒ–å­¦ä¹ çš„æƒ…å†µç¨æœ‰ä¸åŒã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œä¸¤ä¸ªäº‹æƒ…æ˜¯åŒæ—¶å‘ç”Ÿçš„ï¼š

+   ä½ çš„ç½‘ç»œç»è¿‡è®­ç»ƒï¼Œå¯ä»¥åœ¨å½“å‰æ•°æ®ä¸ŠèŽ·å¾—æ›´å¥½çš„é¢„æµ‹

+   ä½ çš„ä»£ç†æŽ¢ç´¢çŽ¯å¢ƒ

éšç€ä»£ç†æŽ¢ç´¢çŽ¯å¢ƒå¹¶å­¦ä¹ å…¶è¡Œä¸ºçš„ç»“æžœï¼Œè®­ç»ƒæ•°æ®ä¼šå‘ç”Ÿå˜åŒ–ã€‚åœ¨å°„å‡»æ¸¸æˆçš„ä¾‹å­ä¸­ï¼Œä»£ç†å¯èƒ½ä¼šéšæœºè¿è¡Œä¸€æ®µæ—¶é—´ï¼Œè¢«æ€ªç‰©å‡»ä¸­å¹¶åœ¨è®­ç»ƒç¼“å†²åŒºä¸­åªèŽ·å¾—â€œæ­»äº¡æ— å¤„ä¸åœ¨â€çš„ç—›è‹¦ç»éªŒã€‚ä½†è¿‡äº†ä¸€æ®µæ—¶é—´ï¼Œä»£ç†ä¼šå‘çŽ°å®ƒæœ‰ä¸€æŠŠå¯ä»¥ä½¿ç”¨çš„æ­¦å™¨ã€‚è¿™ç§æ–°çš„ç»éªŒå¯èƒ½ä¼šæžå¤§åœ°æ”¹å˜æˆ‘ä»¬ç”¨äºŽè®­ç»ƒçš„æ•°æ®ã€‚å¼ºåŒ–å­¦ä¹ çš„æ”¶æ•›é€šå¸¸ä¾èµ–äºŽè®­ç»ƒå’ŒæŽ¢ç´¢ä¹‹é—´çš„å¾®å¦™å¹³è¡¡ã€‚å¦‚æžœæˆ‘ä»¬åªæ˜¯å¢žåŠ æ‰¹é‡å¤§å°è€Œæ²¡æœ‰è°ƒæ•´å…¶ä»–é€‰é¡¹ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“åœ¨å½“å‰æ•°æ®ä¸Šè¿‡æ‹Ÿåˆï¼ˆåœ¨å°„å‡»æ¸¸æˆçš„ä¾‹å­ä¸­ï¼Œä»£ç†å¯èƒ½å¼€å§‹è®¤ä¸ºâ€œæ—©æ­»â€æ˜¯æœ€å°åŒ–ç—›è‹¦çš„å”¯ä¸€é€‰æ‹©ï¼Œç”šè‡³æ°¸è¿œä¸ä¼šå‘çŽ°å®ƒæ‹¥æœ‰çš„æžªï¼‰ã€‚

å› æ­¤ï¼Œåœ¨ Chapter09/02_n_envs.py ä¸­çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬çš„ä»£ç†ä½¿ç”¨å¤šä¸ªç›¸åŒçŽ¯å¢ƒçš„å‰¯æœ¬æ¥æ”¶é›†è®­ç»ƒæ•°æ®ã€‚åœ¨æ¯æ¬¡è®­ç»ƒè¿­ä»£ä¸­ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰çŽ¯å¢ƒä¸­çš„æ ·æœ¬å¡«å……åˆ°é‡æ”¾ç¼“å†²åŒºï¼Œç„¶åŽæŒ‰æ¯”ä¾‹å¢žå¤§æ‰¹é‡å¤§å°ã€‚è¿™ä¹Ÿä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿç¨å¾®åŠ é€ŸæŽ¨ç†æ—¶é—´ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥åœ¨ç¥žç»ç½‘ç»œçš„ä¸€æ¬¡å‰å‘ä¼ é€’ä¸­ï¼Œå¯¹æ‰€æœ‰ N ä¸ªçŽ¯å¢ƒæ‰§è¡ŒåŠ¨ä½œå†³ç­–ã€‚åœ¨å®žçŽ°æ–¹é¢ï¼Œå‰é¢çš„é€»è¾‘åªéœ€è¦å¯¹ä»£ç è¿›è¡Œå‡ å¤„ä¿®æ”¹ï¼š

+   ç”±äºŽ PTAN åŽŸç”Ÿæ”¯æŒå¤šä¸ªçŽ¯å¢ƒï¼Œæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯å°† N ä¸ª Gym çŽ¯å¢ƒä¼ é€’ç»™ ExperienceSource å®žä¾‹

+   ä»£ç†ä»£ç ï¼ˆåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯ DQNAgentï¼‰å·²ç»ä¸ºç¥žç»ç½‘ç»œçš„æ‰¹å¤„ç†åº”ç”¨è¿›è¡Œäº†ä¼˜åŒ–

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¿®æ”¹äº†å‡ æ®µä»£ç ã€‚ç”Ÿæˆæ‰¹æ¬¡çš„å‡½æ•°çŽ°åœ¨åœ¨æ¯æ¬¡è®­ç»ƒè¿­ä»£ä¸­æ‰§è¡Œå¤šä¸ªæ­¥éª¤ï¼ˆç­‰äºŽçŽ¯å¢ƒæ€»æ•°ï¼‰ï¼š

```py
def batch_generator(buffer: ptan.experience.ExperienceReplayBuffer, 
                    initial: int, batch_size: int, steps: int): 
    buffer.populate(initial) 
    while True: 
        buffer.populate(steps) 
        yield buffer.sample(batch_size)
```

ç»éªŒæºæŽ¥å—å¤šä¸ªçŽ¯å¢ƒçš„æ•°ç»„ï¼Œè€Œä¸æ˜¯å•ä¸€çŽ¯å¢ƒï¼š

```py
 envs = [ 
        ptan.common.wrappers.wrap_dqn(gym.make(params.env_name)) 
        for _ in range(args.envs) 
    ] 
    params.batch_size *= args.envs 
    exp_source = ptan.experience.ExperienceSourceFirstLast( 
        envs, agent, gamma=params.gamma, env_seed=common.SEED)
```

å…¶ä»–å˜åŒ–ä»…æ˜¯å¯¹å¸¸é‡çš„å°è°ƒæ•´ï¼Œç”¨äºŽè°ƒæ•´ FPS è¿½è¸ªå™¨å’Œè¡¥å¿Îµè¡°å‡çš„é€Ÿåº¦ï¼ˆéšæœºæ­¥éª¤çš„æ¯”ä¾‹ï¼‰ã€‚ç”±äºŽçŽ¯å¢ƒæ•°é‡æ˜¯éœ€è¦è°ƒä¼˜çš„æ–°è¶…å‚æ•°ï¼Œæˆ‘è¿›è¡Œäº†å‡ ä¸ªå®žéªŒï¼ŒN çš„èŒƒå›´æ˜¯ä»Ž 2 åˆ° 6ã€‚ä»¥ä¸‹å›¾è¡¨å±•ç¤ºäº†å¹³å‡çš„åŠ¨æ€ï¼š

![å›¾ç‰‡](img/B21150_09_04.png)

å›¾ 9.4ï¼šåŸºå‡†ã€ä¸¤ä¸ªå’Œä¸‰ä¸ªçŽ¯å¢ƒä¸­çš„å¥–åŠ±ä¸Ž FPS

![å›¾ç‰‡](img/B21150_09_05.png)

å›¾ 9.5ï¼šn = 3â€¦6 æ—¶çš„å¥–åŠ±ä¸Ž FPS

æ­£å¦‚ä½ ä»Žå›¾è¡¨ä¸­çœ‹åˆ°çš„ï¼Œå¢žåŠ ä¸€ä¸ªé¢å¤–çš„çŽ¯å¢ƒæä¾›äº† 47%çš„ FPS å¢žç›Šï¼ˆä»Ž 227 FPS åˆ° 335 FPSï¼‰ï¼Œå¹¶åŠ é€Ÿäº†çº¦ 10%çš„æ”¶æ•›é€Ÿåº¦ï¼ˆä»Ž 52 åˆ†é’Ÿåˆ° 48 åˆ†é’Ÿï¼‰ã€‚åŒæ ·çš„æ•ˆæžœä¹Ÿæ¥è‡ªäºŽå¢žåŠ ç¬¬ä¸‰ä¸ªçŽ¯å¢ƒï¼ˆ398 FPSï¼Œ36 åˆ†é’Ÿï¼‰ï¼Œä½†æ˜¯å°½ç®¡ FPS è¿›ä¸€æ­¥å¢žåŠ ï¼Œå¢žåŠ æ›´å¤šçŽ¯å¢ƒå¯¹æ”¶æ•›é€Ÿåº¦äº§ç”Ÿäº†è´Ÿé¢å½±å“ã€‚å› æ­¤ï¼Œçœ‹èµ·æ¥ N = 3 å·®ä¸å¤šæ˜¯æˆ‘ä»¬çš„è¶…å‚æ•°çš„æœ€ä¼˜å€¼ï¼Œä½†å½“ç„¶ï¼Œä½ å¯ä»¥è‡ªç”±è°ƒæ•´å’Œå®žéªŒã€‚è¿™ä¹Ÿè¯´æ˜Žäº†ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ä»…ç›‘æŽ§ FPS çš„åŽŸå§‹é€Ÿåº¦ï¼Œè¿˜è¦è§‚å¯Ÿæ™ºèƒ½ä½“è§£å†³æ¸¸æˆçš„é€Ÿåº¦ã€‚

# åœ¨ä¸åŒè¿›ç¨‹ä¸­è¿›è¡Œæ¸¸æˆå’Œè®­ç»ƒ

ä»Žé«˜å±‚æ¬¡æ¥çœ‹ï¼Œæˆ‘ä»¬çš„è®­ç»ƒè¿‡ç¨‹åŒ…å«ä»¥ä¸‹æ­¥éª¤çš„é‡å¤ï¼š

1.  è¯·æ±‚å½“å‰ç½‘ç»œé€‰æ‹©åŠ¨ä½œï¼Œå¹¶åœ¨æˆ‘ä»¬çš„çŽ¯å¢ƒé˜µåˆ—ä¸­æ‰§è¡Œè¿™äº›åŠ¨ä½œã€‚

1.  å°†è§‚å¯Ÿå€¼æ”¾å…¥é‡æ”¾ç¼“å†²åŒºã€‚

1.  ä»Žé‡æ”¾ç¼“å†²åŒºéšæœºæŠ½å–è®­ç»ƒæ‰¹æ¬¡ã€‚

1.  åœ¨è¿™ä¸€æ‰¹æ¬¡ä¸Šè¿›è¡Œè®­ç»ƒã€‚

å‰ä¸¤æ­¥çš„ç›®çš„æ˜¯å°†çŽ¯å¢ƒä¸­çš„æ ·æœ¬ï¼ˆåŒ…æ‹¬è§‚å¯Ÿã€åŠ¨ä½œã€å¥–åŠ±å’Œä¸‹ä¸€ä¸ªè§‚å¯Ÿï¼‰å¡«å……åˆ°é‡æ”¾ç¼“å†²åŒºä¸­ã€‚æœ€åŽä¸¤æ­¥ç”¨äºŽè®­ç»ƒæˆ‘ä»¬çš„ç½‘ç»œã€‚

ä»¥ä¸‹æ˜¯å‰é¢æ­¥éª¤çš„ç¤ºæ„å›¾ï¼Œæ—¨åœ¨ä½¿æ½œåœ¨çš„å¹¶è¡Œæ€§æ›´ä¸ºæ˜Žæ˜¾ã€‚åœ¨å·¦ä¾§æ˜¾ç¤ºäº†è®­ç»ƒæµç¨‹ã€‚è®­ç»ƒæ­¥éª¤ä½¿ç”¨äº†çŽ¯å¢ƒã€é‡æ”¾ç¼“å†²åŒºå’Œæˆ‘ä»¬çš„ç¥žç»ç½‘ç»œï¼ˆNNï¼‰ã€‚å®žçº¿è¡¨ç¤ºæ•°æ®å’Œä»£ç æµåŠ¨ã€‚è™šçº¿ä»£è¡¨ç¥žç»ç½‘ç»œåœ¨è®­ç»ƒå’ŒæŽ¨ç†ä¸­çš„ä½¿ç”¨ã€‚

![å›¾ç‰‡](img/B21150_09_06.png)

å›¾ 9.6ï¼šè®­ç»ƒè¿‡ç¨‹çš„é¡ºåºå›¾

æ­£å¦‚ä½ æ‰€è§ï¼Œå‰ä¸¤ä¸ªæ­¥éª¤ä¸Žä¸‹éƒ¨ä»…é€šè¿‡é‡æ”¾ç¼“å†²åŒºå’Œç¥žç»ç½‘ç»œé€šä¿¡ã€‚è¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸¤éƒ¨åˆ†åœ¨ä¸åŒçš„å¹¶è¡Œè¿›ç¨‹ä¸­åˆ†å¼€ã€‚ä»¥ä¸‹å›¾æ˜¯è¯¥æ–¹æ¡ˆçš„ç¤ºæ„å›¾ï¼š

![å›¾ç‰‡](img/B21150_09_07.png)

å›¾ 9.7ï¼šè®­ç»ƒå’Œæ¸¸æˆæ­¥éª¤çš„å¹¶è¡Œç‰ˆæœ¬

åœ¨æˆ‘ä»¬çš„ Pong çŽ¯å¢ƒä¸­ï¼Œè¿™çœ‹èµ·æ¥åƒæ˜¯å¯¹ä»£ç çš„ä¸€ä¸ªä¸å¿…è¦çš„å¤æ‚åŒ–ï¼Œä½†è¿™ç§åˆ†ç¦»åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½éžå¸¸æœ‰ç”¨ã€‚æƒ³è±¡ä¸€ä¸‹ä½ æœ‰ä¸€ä¸ªéžå¸¸æ…¢ä¸”å¤æ‚çš„çŽ¯å¢ƒï¼Œæ¯ä¸€æ­¥éƒ½éœ€è¦æ•°ç§’çš„è®¡ç®—ã€‚è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªäººä¸ºçš„ä¾‹å­ï¼›ä¾‹å¦‚ï¼Œè¿‡åŽ»çš„ NeurIPS ç«žèµ›ï¼Œå¦‚ Learning to Runã€AI for Prosthetics Challenge å’Œ Learn to Moveï¼ˆ[`www.aicrowd.com/challenges/neurips-2019-learn-to-move-walk-around`](https://www.aicrowd.com/challenges/neurips-2019-learn-to-move-walk-around)ï¼‰ä¸­ä½¿ç”¨äº†éžå¸¸ç¼“æ…¢çš„ç¥žç»è‚Œè‚‰æ¨¡æ‹Ÿå™¨ï¼Œå› æ­¤ä½ å¿…é¡»å°†ç»éªŒæ”¶é›†ä¸Žè®­ç»ƒè¿‡ç¨‹åˆ†å¼€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥æœ‰è®¸å¤šå¹¶è¡Œçš„çŽ¯å¢ƒï¼Œå°†ç»éªŒä¼ é€’ç»™ä¸­å¤®è®­ç»ƒè¿‡ç¨‹ã€‚

ä¸ºäº†å°†æˆ‘ä»¬çš„ä¸²è¡Œä»£ç è½¬å˜ä¸ºå¹¶è¡Œä»£ç ï¼Œéœ€è¦åšä¸€äº›ä¿®æ”¹ã€‚åœ¨æ–‡ä»¶ Chapter09/03_parallel.py ä¸­ï¼Œä½ å¯ä»¥æ‰¾åˆ°è¿™ä¸ªç¤ºä¾‹çš„å®Œæ•´æºç ã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘å°†åªå…³æ³¨ä¸»è¦çš„åŒºåˆ«ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨ torch.multiprocessing æ¨¡å—æ¥æ›¿ä»£æ ‡å‡†çš„ Python multiprocessing æ¨¡å—ï¼š

```py
import torch.multiprocessing as mp 

@dataclass 
class EpisodeEnded: 
    reward: float 
    steps: int 
    epsilon: float 

def play_func(params: common.Hyperparams, net: dqn_model.DQN, 
              dev_name: str, exp_queue: mp.Queue): 
    env = gym.make(params.env_name) 
    env = ptan.common.wrappers.wrap_dqn(env) 
    device = torch.device(dev_name) 

    selector = ptan.actions.EpsilonGreedyActionSelector(epsilon=params.epsilon_start) 
    epsilon_tracker = common.EpsilonTracker(selector, params) 
    agent = ptan.agent.DQNAgent(net, selector, device=device) 
    exp_source = ptan.experience.ExperienceSourceFirstLast( 
        env, agent, gamma=params.gamma, env_seed=common.SEED) 

    for frame_idx, exp in enumerate(exp_source): 
        epsilon_tracker.frame(frame_idx//2) 
        exp_queue.put(exp) 
        for reward, steps in exp_source.pop_rewards_steps(): 
            ee = EpisodeEnded(reward=reward, steps=steps, epsilon=selector.epsilon) 
            exp_queue.put(ee)
```

æ ‡å‡†åº“ä¸­çš„ç‰ˆæœ¬æä¾›äº†å‡ ä¸ªç”¨äºŽå¤„ç†åœ¨ç‹¬ç«‹è¿›ç¨‹ä¸­æ‰§è¡Œçš„ä»£ç çš„åŽŸè¯­ï¼Œä¾‹å¦‚ mp.Queueï¼ˆåˆ†å¸ƒå¼é˜Ÿåˆ—ï¼‰ã€mp.Processï¼ˆå­è¿›ç¨‹ï¼‰ç­‰ã€‚PyTorch æä¾›äº†ä¸€ä¸ªå¯¹æ ‡å‡† multiprocessing åº“çš„å°è£…ï¼Œå®ƒå…è®¸åœ¨è¿›ç¨‹é—´å…±äº« torch å¼ é‡ï¼Œè€Œæ— éœ€å¤åˆ¶å®ƒä»¬ã€‚è¿™æ˜¯é€šè¿‡å…±äº«å†…å­˜å®žçŽ°çš„ï¼Œé’ˆå¯¹ CPU å¼ é‡ä½¿ç”¨å…±äº«å†…å­˜ï¼Œæˆ–è€…é’ˆå¯¹ GPU ä¸Šçš„å¼ é‡ä½¿ç”¨ CUDA å¼•ç”¨ã€‚è¿™ç§å…±äº«æœºåˆ¶æ¶ˆé™¤äº†åœ¨å•å°è®¡ç®—æœºå†…éƒ¨è¿›è¡Œé€šä¿¡æ—¶çš„ä¸»è¦ç“¶é¢ˆã€‚å½“ç„¶ï¼Œåœ¨çœŸæ­£åˆ†å¸ƒå¼çš„é€šä¿¡ä¸­ï¼Œä½ éœ€è¦è‡ªè¡Œåºåˆ—åŒ–æ•°æ®ã€‚

å‡½æ•° play_func å®žçŽ°äº†æˆ‘ä»¬çš„â€œæ’­æ”¾è¿›ç¨‹â€ï¼Œå¹¶å°†åœ¨ç”±ä¸»è¿›ç¨‹å¯åŠ¨çš„å•ç‹¬å­è¿›ç¨‹ä¸­è¿è¡Œã€‚å®ƒçš„èŒè´£æ˜¯ä»ŽçŽ¯å¢ƒä¸­èŽ·å–ç»éªŒå¹¶å°†å…¶æŽ¨é€åˆ°å…±äº«é˜Ÿåˆ—ä¸­ã€‚æ­¤å¤–ï¼Œå®ƒå°†å…³äºŽå›žåˆç»“æŸçš„ä¿¡æ¯å°è£…æˆä¸€ä¸ªæ•°æ®ç±»ï¼Œå¹¶å°†å…¶æŽ¨é€åˆ°åŒä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œä»¥ä¾¿è®­ç»ƒè¿‡ç¨‹å¯ä»¥èŽ·å¾—å…³äºŽå›žåˆå¥–åŠ±å’Œæ­¥æ•°çš„ä¿¡æ¯ã€‚

å‡½æ•° batch_generator è¢«ç±» BatchGenerator æ‰€æ›¿ä»£ï¼š

```py
class BatchGenerator: 
    def __init__(self, buffer_size: int, exp_queue: mp.Queue, 
                 fps_handler: ptan_ignite.EpisodeFPSHandler, 
                 initial: int, batch_size: int): 
        self.buffer = ptan.experience.ExperienceReplayBuffer( 
            experience_source=None, buffer_size=buffer_size) 
        self.exp_queue = exp_queue 
        self.fps_handler = fps_handler 
        self.initial = initial 
        self.batch_size = batch_size 
        self._rewards_steps = [] 
        self.epsilon = None 

    def pop_rewards_steps(self) -> tt.List[tt.Tuple[float, int]]: 
        res = list(self._rewards_steps) 
        self._rewards_steps.clear() 
        return res 

    def __iter__(self): 
        while True: 
            while self.exp_queue.qsize() > 0: 
                exp = self.exp_queue.get() 
                if isinstance(exp, EpisodeEnded): 
                    self._rewards_steps.append((exp.reward, exp.steps)) 
                    self.epsilon = exp.epsilon 
                else: 
                    self.buffer._add(exp) 
                    self.fps_handler.step() 
            if len(self.buffer) < self.initial: 
                continue 
            yield self.buffer.sample(self.batch_size)
```

è¿™ä¸ªç±»æä¾›äº†ä¸€ä¸ªæ‰¹æ¬¡çš„è¿­ä»£å™¨ï¼Œå¹¶ä¸”é€šè¿‡æ–¹æ³• pop_reward_steps()é¢å¤–æ¨¡æ‹Ÿäº† ExperienceSource æŽ¥å£ã€‚è¿™ä¸ªç±»çš„é€»è¾‘å¾ˆç®€å•ï¼šå®ƒæ¶ˆè´¹é˜Ÿåˆ—ï¼ˆç”±â€œæ’­æ”¾è¿›ç¨‹â€å¡«å……ï¼‰ï¼Œå¦‚æžœæŽ¥æ”¶åˆ° EpisodeEnded å¯¹è±¡ï¼Œå®ƒä¼šè®°ä½å…³äºŽ epsilon çš„ä¿¡æ¯å’Œæ¸¸æˆæ‰€ç»åŽ†çš„æ­¥éª¤æ•°ï¼›å¦åˆ™ï¼Œè¯¥å¯¹è±¡å°±æ˜¯ä¸€æ¡éœ€è¦æ·»åŠ åˆ°é‡æ”¾ç¼“å†²åŒºçš„ç»éªŒã€‚ä»Žé˜Ÿåˆ—ä¸­ï¼Œæˆ‘ä»¬æ¶ˆè´¹å½“å‰å¯ç”¨çš„æ‰€æœ‰å¯¹è±¡ï¼Œç„¶åŽä»Žç¼“å†²åŒºä¸­æŠ½æ ·è®­ç»ƒæ‰¹æ¬¡å¹¶è¿”å›žã€‚

åœ¨è®­ç»ƒè¿‡ç¨‹çš„å¼€å§‹ï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰ torch.multiprocessing ä½¿ç”¨å“ªç§å¯åŠ¨æ–¹æ³•ï¼š

```py
if __name__ == "__main__": 
    warnings.simplefilter("ignore", category=UserWarning) 
    mp.set_start_method(â€™spawnâ€™)
```

å®ƒä»¬æœ‰å‡ ä¸ªï¼Œä½† spawn æ˜¯æœ€çµæ´»çš„ã€‚

ç„¶åŽï¼Œåˆ›å»ºç”¨äºŽé€šä¿¡çš„é˜Ÿåˆ—ï¼Œå¹¶å°† play_func ä½œä¸ºå•ç‹¬çš„è¿›ç¨‹å¯åŠ¨ã€‚æˆ‘ä»¬ä¼ é€’çš„å‚æ•°åŒ…æ‹¬ç¥žç»ç½‘ç»œï¼ˆNNï¼‰ã€è¶…å‚æ•°ä»¥åŠç”¨äºŽç»éªŒçš„é˜Ÿåˆ—ï¼š

```py
 exp_queue = mp.Queue(maxsize=2) 
    proc_args = (params, net, args.dev, exp_queue) 
    play_proc = mp.Process(target=play_func, args=proc_args) 
    play_proc.start()
```

å…¶ä½™çš„ä»£ç å‡ ä¹Žç›¸åŒï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯æˆ‘ä»¬ä½¿ç”¨ BatchGenerator å®žä¾‹ä½œä¸º Ignite å’Œ EndOfEpisodeHandler çš„æ•°æ®æºï¼ˆåŽè€…éœ€è¦ä½¿ç”¨æ–¹æ³• pop_rewards_steps()ï¼‰ã€‚ä»¥ä¸‹å›¾è¡¨æ˜¯ä»Žæˆ‘çš„åŸºå‡†æµ‹è¯•ä¸­èŽ·å¾—çš„ï¼š

![PIC](img/B21150_09_08.png)

å›¾ 9.8ï¼šåŸºçº¿ç‰ˆæœ¬å’Œå¹¶è¡Œç‰ˆæœ¬ä¸­çš„å¥–åŠ±å’Œ FPS

å¦‚ä½ æ‰€è§ï¼Œåœ¨ FPS æ–¹é¢ï¼Œæˆ‘ä»¬èŽ·å¾—äº† 27% çš„æå‡ï¼šå¹¶è¡Œç‰ˆæœ¬çš„ FPS ä¸º 290ï¼Œè€ŒåŸºçº¿ä¸º 228ã€‚è§£å†³çŽ¯å¢ƒçš„å¹³å‡æ—¶é—´å‡å°‘äº† 41%ã€‚

å°± FPS å¢žåŠ è€Œè¨€ï¼Œå°½ç®¡å¹¶è¡Œç‰ˆæœ¬æ¯”å‰ä¸€èŠ‚ä¸­çš„æœ€ä½³ç»“æžœï¼ˆä½¿ç”¨ 3 ä¸ªæ¸¸æˆçŽ¯å¢ƒæ—¶ï¼Œæˆ‘ä»¬èŽ·å¾—äº†æŽ¥è¿‘ 400 FPSï¼‰çœ‹èµ·æ¥è¦å·®ï¼Œä½†æ”¶æ•›é€Ÿåº¦æ›´å¿«ã€‚

# è°ƒæ•´å°è£…å™¨

æˆ‘ä»¬å®žéªŒåºåˆ—ä¸­çš„æœ€åŽä¸€æ­¥æ˜¯è°ƒæ•´åº”ç”¨äºŽçŽ¯å¢ƒçš„å°è£…å™¨ã€‚è¿™ä¸ªæ­¥éª¤å¾ˆå®¹æ˜“è¢«å¿½è§†ï¼Œå› ä¸ºå°è£…å™¨é€šå¸¸æ˜¯å†™ä¸€æ¬¡æˆ–ä»Žå…¶ä»–ä»£ç å€Ÿç”¨åŽåº”ç”¨åˆ°çŽ¯å¢ƒä¸­çš„ï¼Œå¹¶ä¸”è¢«ç•™åœ¨é‚£é‡Œã€‚ä½†ä½ åº”è¯¥æ„è¯†åˆ°å®ƒä»¬åœ¨æ–¹æ³•çš„é€Ÿåº¦å’Œæ”¶æ•›æ€§æ–¹é¢çš„é‡è¦æ€§ã€‚ä¾‹å¦‚ï¼ŒDeepMind é£Žæ ¼çš„æ­£å¸¸ Atari æ¸¸æˆå°è£…å™¨å †æ ˆå¦‚ä¸‹ï¼š

1.  NoopResetEnvï¼šå¯¹æ¸¸æˆé‡ç½®åº”ç”¨éšæœºæ•°é‡çš„ NOOP æ“ä½œã€‚åœ¨æŸäº› Atari æ¸¸æˆä¸­ï¼Œéœ€è¦è¿™ä¸ªæ“ä½œæ¥åŽ»é™¤å¥‡æ€ªçš„åˆå§‹è§‚å¯Ÿå€¼ã€‚

1.  MaxAndSkipEnvï¼šå¯¹ N æ¬¡è§‚å¯Ÿåº”ç”¨æœ€å¤§å€¼ï¼ˆé»˜è®¤å››æ¬¡ï¼‰ï¼Œå¹¶å°†å…¶ä½œä¸ºè¯¥æ­¥çš„è§‚å¯Ÿè¿”å›žã€‚è¿™æ ·è§£å†³äº†æŸäº› Atari æ¸¸æˆä¸­çš„â€œé—ªçƒâ€é—®é¢˜ï¼Œå› ä¸ºè¿™äº›æ¸¸æˆåœ¨å¶æ•°å¸§å’Œå¥‡æ•°å¸§ä¸Šç»˜åˆ¶å±å¹•çš„ä¸åŒéƒ¨åˆ†ï¼ˆè¿™æ˜¯ Atari å¼€å‘è€…å¸¸ç”¨çš„åšæ³•ï¼Œä»¥å…‹æœå¹³å°çš„é™åˆ¶å¹¶å¢žåŠ æ¸¸æˆç²¾çµçš„å¤æ‚åº¦ï¼‰ã€‚

1.  EpisodicLifeEnvï¼šåœ¨æŸäº›æ¸¸æˆä¸­ï¼Œè¿™ä¼šæ£€æµ‹ä¸¢å¤±çš„ç”Ÿå‘½å¹¶å°†å…¶è½¬åŒ–ä¸ºè¯¥é›†çš„ç»“æŸã€‚è¿™æ˜¾è‘—æé«˜äº†æ”¶æ•›æ€§ï¼Œå› ä¸ºæˆ‘ä»¬çš„å›žåˆå˜å¾—æ›´çŸ­ï¼ˆä¸€æ¬¡ç”Ÿå‘½è€Œéžæ¸¸æˆé€»è¾‘ç»™å‡ºçš„å¤šæ¬¡ç”Ÿå‘½ï¼‰ã€‚è¿™ä»…å¯¹ Atari 2600 å­¦ä¹ çŽ¯å¢ƒæ”¯æŒçš„æŸäº›æ¸¸æˆç›¸å…³ã€‚

1.  FireResetEnvï¼šåœ¨æ¸¸æˆé‡ç½®æ—¶æ‰§è¡Œ FIRE æ“ä½œã€‚æœ‰äº›æ¸¸æˆéœ€è¦è¿™ä¸ªæ“ä½œæ‰èƒ½å¼€å§‹æ¸¸æˆã€‚å¦‚æžœæ²¡æœ‰è¿™ä¸ªæ“ä½œï¼Œæˆ‘ä»¬çš„çŽ¯å¢ƒå°±å˜æˆäº†éƒ¨åˆ†å¯è§‚å¯Ÿçš„é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼ˆPOMDPï¼‰ï¼Œè¿™ä½¿å¾—æ— æ³•æ”¶æ•›ã€‚

1.  WarpFrameï¼šä¹Ÿç§°ä¸º ProcessFrame84ï¼Œ å°†å›¾åƒè½¬æ¢ä¸ºç°åº¦å¹¶å°†å…¶è°ƒæ•´ä¸º 84 Ã— 84 å¤§å°ã€‚

1.  ClipRewardEnvï¼šå°†å¥–åŠ±è£å‰ªåˆ° âˆ’1â€¦1 èŒƒå›´ï¼Œè¿™ç»Ÿä¸€äº†ä¸åŒ Atari æ¸¸æˆä¸­åˆ†æ•°çš„å¹¿æ³›å˜åŒ–ã€‚ä¾‹å¦‚ï¼ŒPong çš„åˆ†æ•°èŒƒå›´å¯èƒ½æ˜¯ âˆ’21â€¦21ï¼Œè€Œ River Raid æ¸¸æˆçš„åˆ†æ•°å¯èƒ½æ˜¯ 0â€¦âˆžã€‚

1.  FrameStackï¼šå°† N ä¸ªè¿žç»­çš„è§‚å¯Ÿå †å åˆ°æ ˆä¸­ï¼ˆé»˜è®¤æ˜¯å››ä¸ªï¼‰ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ç¬¬å…­ç« ä¸­è®¨è®ºçš„é‚£æ ·ï¼Œåœ¨æŸäº›æ¸¸æˆä¸­ï¼Œè¿™æ˜¯å®žçŽ°é©¬å°”å¯å¤«æ€§è´¨æ‰€å¿…éœ€çš„ã€‚ä¾‹å¦‚ï¼Œåœ¨ Pong æ¸¸æˆä¸­ï¼Œä»Žå•ä¸€çš„ä¸€å¸§å›¾åƒä¸­æ— æ³•å¾—çŸ¥çƒçš„è¿åŠ¨æ–¹å‘ã€‚

è¿™äº›åŒ…è£…å™¨çš„ä»£ç ç»è¿‡äº†è®¸å¤šäººçš„ç²¾å¿ƒä¼˜åŒ–ï¼Œå¹¶ä¸”å­˜åœ¨å¤šä¸ªç‰ˆæœ¬ã€‚ä¸ªäººæœ€å–œæ¬¢çš„æ˜¯ Stable Baselines3ï¼Œå®ƒæ˜¯ OpenAI Baselines é¡¹ç›®çš„ä¸€ä¸ªåˆ†æ”¯ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å®ƒï¼š[`stable-baselines3.readthedocs.io/.`](https://stable-baselines3.readthedocs.io/.)

ä½†ä½ ä¸åº”è¯¥å°†è¿™æ®µä»£ç è§†ä¸ºæœ€ç»ˆçš„çœŸç†æºï¼Œå› ä¸ºä½ çš„å…·ä½“çŽ¯å¢ƒå¯èƒ½æœ‰ä¸åŒçš„éœ€æ±‚å’Œç»†èŠ‚ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœä½ æœ‰å…´è¶£åŠ é€Ÿ Atari å¥—ä»¶ä¸­çš„æŸä¸ªç‰¹å®šæ¸¸æˆï¼ŒNoopResetEnv å’Œ MaxAndSkipEnvï¼ˆæ›´å‡†ç¡®åœ°è¯´ï¼Œæ˜¯ MaxAndSkipEnv ä¸­çš„æœ€å¤§æ± åŒ–æ“ä½œï¼‰å¯èƒ½å¹¶ä¸éœ€è¦ã€‚å¦ä¸€ä¸ªå¯ä»¥è°ƒæ•´çš„åœ°æ–¹æ˜¯ FrameStack åŒ…è£…å™¨ä¸­çš„å¸§æ•°ã€‚é€šå¸¸åšæ³•æ˜¯ä½¿ç”¨å››å¸§ï¼Œä½†ä½ éœ€è¦ç†è§£ï¼Œè¿™ä¸ªæ•°å­—æ˜¯ DeepMind å’Œå…¶ä»–ç ”ç©¶äººå‘˜åœ¨å¯¹å®Œæ•´çš„ Atari 2600 æ¸¸æˆå¥—ä»¶è¿›è¡Œè®­ç»ƒæ—¶ä½¿ç”¨çš„ï¼Œè¯¥å¥—ä»¶ç›®å‰åŒ…å«è¶…è¿‡ 50 ä¸ªæ¸¸æˆã€‚å¯¹äºŽä½ çš„ç‰¹å®šæƒ…å†µï¼Œä½¿ç”¨ä¸¤å¸§çš„åŽ†å²å¯èƒ½è¶³ä»¥æä¾›æ€§èƒ½æå‡ï¼Œå› ä¸ºç¥žç»ç½‘ç»œéœ€è¦å¤„ç†çš„æ•°æ®ä¼šæ›´å°‘ã€‚

æœ€åŽï¼Œå›¾åƒè°ƒæ•´å¤§å°å¯èƒ½æ˜¯åŒ…è£…å™¨çš„ç“¶é¢ˆï¼Œå› æ­¤ä½ å¯èƒ½éœ€è¦ä¼˜åŒ–åŒ…è£…å™¨ä½¿ç”¨çš„åº“ï¼Œä¾‹å¦‚é‡æ–°æž„å»ºå®ƒä»¬æˆ–æ›¿æ¢ä¸ºæ›´å¿«é€Ÿçš„ç‰ˆæœ¬ã€‚2020 å¹´ä¹‹å‰ï¼Œå°† OpenCV2 åº“æ›¿æ¢ä¸º pillow-simd åº“èƒ½æé«˜å¤§çº¦ 50 å¸§æ¯ç§’çš„é€Ÿåº¦ã€‚å¦‚ä»Šï¼ŒOpenCV2 ä½¿ç”¨äº†ä¼˜åŒ–çš„é‡æ–°ç¼©æ”¾æ“ä½œï¼Œå› æ­¤è¿™ç§æ›¿æ¢å·²ä¸å†æœ‰æ•ˆã€‚ä½†ä½ ä»ç„¶å¯ä»¥å°è¯•ä¸åŒçš„ç¼©æ”¾æ–¹æ³•å’Œä¸åŒçš„åº“ã€‚

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†å¯¹ Pong çš„åŒ…è£…å™¨åº”ç”¨ä»¥ä¸‹æ›´æ”¹ï¼š

+   ç¦ç”¨ NoopResetEnv

+   ç”¨ç®€åŒ–ç‰ˆæœ¬æ›¿æ¢ MaxAndSkipEnvï¼Œåªè·³è¿‡å››å¸§è€Œä¸è¿›è¡Œæœ€å¤§æ± åŒ–ã€‚

+   åªä¿ç•™ä¸¤ä¸ªå¸§åœ¨ FrameStack ä¸­

ä¸ºäº†æ£€æŸ¥æˆ‘ä»¬è°ƒæ•´çš„ç»¼åˆæ•ˆæžœï¼Œæˆ‘ä»¬å°†æŠŠä¸Šé¢çš„æ›´æ”¹æ·»åŠ åˆ°å‰ä¸¤èŠ‚æ‰€åšçš„ä¿®æ”¹ä¸­ï¼šå¤šä¸ªçŽ¯å¢ƒå’Œå¹¶è¡Œæ‰§è¡Œæ¸¸æˆä¸Žè®­ç»ƒã€‚

ç”±äºŽè¿™äº›æ›´æ”¹å¹¶ä¸å¤æ‚ï¼Œæˆ‘ä»¬å°±ä¸å±•ç¤ºå…·ä½“ä»£ç äº†ï¼ˆå®Œæ•´ä»£ç å¯ä»¥åœ¨æ–‡ä»¶ Chapter09/04_wrappers_n_env.pyã€Chapter09/04_wrappers_parallel.py å’Œ Chapter09/lib/atari_wrappers.py ä¸­æ‰¾åˆ°ï¼‰ï¼š

+   åº“ atari_wrappers.py ç›¸å½“ç®€å•â€”â€”å®ƒåŒ…å«äº† PTAN ä¸­ wrap_dqn å‡½æ•°çš„å‰¯æœ¬å’Œ Stable Baselines3 ä¸­çš„ AtariWrapper ç±»ã€‚

+   åœ¨ AtariWrapper ä¸­ï¼ŒMaxAndSkipEnv ç±»è¢«ä¸€ä¸ªç®€åŒ–ç‰ˆæœ¬æ›¿ä»£ï¼ŒåŽ»é™¤äº†å¸§é—´çš„æœ€å¤§æ± åŒ–æ“ä½œã€‚

+   ä¸¤ä¸ªæ¨¡å—ï¼Œ04_wrappers_n_env.py å’Œ 04_wrappers_prallel.pyï¼Œä»…ä»…æ˜¯æˆ‘ä»¬ä¹‹å‰è§è¿‡çš„ 02_n_env.py å’Œ 03_parallel.py çš„å‰¯æœ¬ï¼ŒçŽ¯å¢ƒåˆ›å»ºç»è¿‡è°ƒæ•´ã€‚

å°±æ˜¯è¿™æ ·ï¼ä»¥ä¸‹æ˜¯ä¸¤ç§ç‰ˆæœ¬çš„å¥–åŠ±åŠ¨æ€å’Œ FPS å›¾è¡¨ï¼š

![PIC](img/B21150_09_09.png)

å›¾ 9.9ï¼šåŸºå‡†ç‰ˆå’Œâ€œ3 ä¸ªçŽ¯å¢ƒä¸Ž 2 å¸§ç‰ˆæœ¬â€çš„å¥–åŠ±ä¸Ž FPS

![PIC](img/B21150_09_10.png)

å›¾ 9.10ï¼šåŸºå‡†ç‰ˆå’Œâ€œå¹¶è¡Œä¸Ž 2 å¸§ç‰ˆæœ¬â€çš„å¥–åŠ±ä¸Ž FPS

å‡ºäºŽå¥½å¥‡ï¼Œæˆ‘è¿˜å°è¯•å°† FrameStack ä¸­ä¿æŒçš„å¸§æ•°å‡å°‘åˆ°ä»…ä¸€ä¸ªå¸§ï¼ˆä½ å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œå‚æ•° --stack 1 é‡å¤å®žéªŒï¼‰ã€‚ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œè¿™æ ·çš„ç‰ˆæœ¬ä¹Ÿèƒ½è§£å†³æ¸¸æˆï¼Œä½†æ‰€éœ€çš„æ¸¸æˆæ¬¡æ•°æ˜¾è‘—å¢žåŠ ï¼Œè®­ç»ƒå˜å¾—ä¸ç¨³å®šï¼ˆå¤§çº¦ 8 æ¬¡è®­ç»ƒä¸­çš„ 3 æ¬¡å®Œå…¨æ²¡æœ‰æ”¶æ•›ï¼‰ã€‚è¿™å¯èƒ½è¡¨æ˜Žï¼Œåªæœ‰ä¸€ä¸ªå¸§çš„ Pong å¹¶ä¸æ˜¯ POMDPï¼Œä»£ç†ä»ç„¶å¯ä»¥ä»…å‡­ä¸€ä¸ªå¸§ä½œä¸ºè§‚å¯Ÿï¼Œå­¦ä¹ å¦‚ä½•èµ¢å¾—æ¸¸æˆã€‚ä½†è®­ç»ƒæ•ˆçŽ‡è‚¯å®šä¼šå—åˆ°å½±å“ã€‚

# åŸºå‡†ç»“æžœ

æˆ‘å·²å°†æˆ‘ä»¬çš„å®žéªŒæ€»ç»“åœ¨ä»¥ä¸‹è¡¨æ ¼ä¸­ã€‚ç™¾åˆ†æ¯”æ˜¾ç¤ºç›¸å¯¹äºŽåŸºå‡†ç‰ˆçš„å˜åŒ–ï¼š

| æ­¥éª¤ | FPS | FPS Î” | æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰ | æ—¶é—´ Î” |
| --- | --- | --- | --- | --- |
| åŸºå‡† | 229 |  | 52.2 |  |
| æ²¡æœ‰ torch.no.grad() | 219 | -4.3% | 51.0 | -2.3% |
| 3 ä¸ªçŽ¯å¢ƒ | 395 | +72.5% | 36.0 | -31.0% |
| å¹¶è¡Œç‰ˆæœ¬ | 290 | +26.6% | 31.2 | -40.2% |
| åŒ…è£…å™¨ + 3 ä¸ªçŽ¯å¢ƒ | 448 | +95.6% | 47.4 | -9.2% |
| åŒ…è£…å™¨ + å¹¶è¡Œ | 325 | +41.9% | 30.0 | -42.5% |

è¡¨ 9.1ï¼šä¼˜åŒ–ç»“æžœ

# æ‘˜è¦

åœ¨è¿™ä¸€ç« ä¸­ï¼Œä½ çœ‹åˆ°äº†å‡ ç§é€šè¿‡çº¯å·¥ç¨‹æ–¹æ³•æé«˜ RL æ–¹æ³•æ€§èƒ½çš„æ–¹å¼ï¼Œè¿™ä¸Žç¬¬å…«ç« ä¸­ä»‹ç»çš„â€œç®—æ³•â€æˆ–â€œç†è®ºâ€æ–¹æ³•å½¢æˆå¯¹æ¯”ã€‚ä»Žæˆ‘çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¸¤ç§æ–¹æ³•æ˜¯äº’è¡¥çš„ï¼Œä¸€ä¸ªä¼˜ç§€çš„ RL ä»Žä¸šè€…éœ€è¦æ—¢äº†è§£ç ”ç©¶äººå‘˜å‘çŽ°çš„æœ€æ–°æŠ€å·§ï¼Œä¹Ÿè¦äº†è§£å®žçŽ°ç»†èŠ‚ã€‚

åœ¨ä¸‹ä¸€ç« ï¼Œæˆ‘ä»¬å°†å¼€å§‹å°†æˆ‘ä»¬çš„ DQN çŸ¥è¯†åº”ç”¨äºŽè‚¡ç¥¨äº¤æ˜“ä½œä¸ºå®žé™…ç¤ºä¾‹ã€‚
