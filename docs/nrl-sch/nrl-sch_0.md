# 前言

我们生活在数字时代，数据的创建变得越来越容易。根据《福布斯》报道，我们每天生成 2.5 quintillion 字节的数据，而这些数据来自各种来源。它可以是 Instagram 上的图片、Telegram 上的语音消息、视频、文本，甚至是它们的组合。这在互联网刚刚起步时显然不是这样。尽管数据创建的容易度发生了显著变化，但我们依然在使用相同的搜索技术。尽管数据生成爆炸式增长，我们的搜索技术却没有得到太多更新。

神经搜索是改变这一现状的方法。它利用我们当前所处的**机器学习**（**ML**）时代，运用最新的 AI 研究来提供创新的搜索技术。然而，尽管这是一项不错的技术，但它也带来了许多挑战。神经搜索是一个全新的概念，这意味着所需的知识和技术也都是新的。为了有效地部署神经搜索应用，负责此工作的工程师需要具备丰富的技能，从工程学到 Dev-Ops，再到机器学习的背景知识。

这正是 Jina AI 想要解决的问题。Jina 是一个开源解决方案，旨在使 AI 和神经搜索更加民主化，使许多开发者能够轻松拥有一个完整的端到端神经搜索应用，而无需具备机器学习、云计算和后端工程的背景。它特别为 Python 开发者设计，帮助他们充分发挥最新神经搜索技术的潜力。在本书中，我们将探索搜索的基础知识，从传统搜索到神经搜索。通过这些知识，我们将通过动手实践，创建一个完整的神经搜索应用。

# 本书适用人群

如果你是一位对使用现代软件架构构建任何类型的搜索系统（如文本、问答、图像、音频、PDF、3D 模型等）感兴趣的机器学习、**深度学习**（**DL**）或 AI 工程师，这本书适合你。本书同样适合对使用最先进的深度学习技术构建任何类型的搜索系统感兴趣的 Python 工程师。

# 本书涵盖的内容

*第一章*，*神经网络与神经搜索*，将介绍神经搜索是什么及其用途。你将看到它的实际应用概述、面临的挑战以及如何克服这些挑战。

*第二章*，*介绍向量表示基础*，将讲解机器学习中的向量概念。它还将介绍构建在向量表示基础上的常见搜索算法及其优缺点。

*第三章*，*系统设计与工程挑战*，将涵盖搜索系统设计的基础知识。在这一章中，您将学习与搜索相关的核心概念，如索引和查询，并学习如何使用这些概念保存和检索信息。

*第四章*，*学习 Jina 基础*，将涵盖实现自己搜索引擎所需的步骤。在这一章中，您将详细了解 Jina 的核心概念及其总体设计，并了解它们之间如何相互连接。

*第五章*，*多模态搜索*，将介绍多模态和跨模态搜索的概念，您可以结合文本、图像、音频和视频等多种模态，构建最先进的搜索系统。

*第六章*，*使用 Jina 的基础实践示例*，将涵盖基于前几章学到的概念，构建 Jina 神经搜索框架的适合初学者的现实应用。

*第七章*，*探索 Jina 的高级应用场景*，将通过前几章学到的概念，介绍 Jina 神经搜索框架的高级应用。重点讲解如何通过现实世界的例子来解释神经搜索中的挑战性概念。

# 为了从本书中获得最大收益

为了充分利用本书，您需要用 Python 编写程序，并具备机器学习（ML）和深度学习（DL）的知识。最好还要有信息检索和搜索问题的基本了解。

| **本书涉及的软件/硬件** | **操作系统要求** |
| --- | --- |
| Python 3.7 | 配备 WSL 的 Windows、macOS 或 Linux |
| Jina 3.7 |  |
| DocArray 0.13 |  |

**如果您使用的是本书的数字版，我们建议您自己输入代码，或通过本书 GitHub 仓库中的链接访问代码（下一节中会提供链接）。这样做有助于避免因复制粘贴代码而可能出现的错误**。

# 下载示例代码文件

您可以从 GitHub 下载本书的示例代码文件，网址是[`github.com/PacktPublishing/Neural-Search-From-Prototype-to-Production-with-Jina`](https://github.com/PacktPublishing/Neural-Search-From-Prototype-to-Production-with-Jina)。如果代码有更新，GitHub 仓库中的代码将会得到更新。

我们还提供了来自我们丰富书籍和视频目录中的其他代码包，您可以在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)查看！快来看看吧！

# 下载彩色图片

我们还提供了一个包含本书中使用的截图和图表的彩色 PDF 文件。您可以在这里下载：[`packt.link/minUU`](https://packt.link/minUU%0D)

# 使用的约定

本书中使用了多种文本约定。

`文本中的代码`：表示文本中的代码词汇、数据库表名、文件夹名称、文件名、文件扩展名、路径名、虚拟网址、用户输入和 Twitter 用户名。举个例子：“要通过 UI 在 Web 浏览器中与多模态应用程序进行交互，你可以使用`index.xhtml` HTML 文件，该文件位于`static`文件夹中。”

一段代码如下所示：

```py
  - name: keyValueIndexer
    uses:
      jtype: KeyValueIndexer
      metas:
        workspace: ${{ ENV.HW_WORKDIR }}
        py_modules:
          - ${{ ENV.PY_MODULE }}
    needs: segment
  - name: joinAll
    needs: [textIndexer, imageIndexer, keyValueIndexer]
```

当我们希望你关注代码块的某一部分时，相关行或项目将以粗体显示：

```py
  - name: keyValueIndexer
    uses:
      jtype: KeyValueIndexer
      metas:
        workspace: ${{ ENV.HW_WORKDIR }}
        py_modules:
          - ${{ ENV.PY_MODULE }}
    needs: segment
  - name: joinAll
    needs: [textIndexer, imageIndexer, keyValueIndexer]
```

任何命令行输入或输出将按如下方式书写：

```py
<jina.types.arrays.document.DocumentArray length=3 at 5701440528>

{'id': '6a79982a-b6b0-11eb-8a66-1e008a366d49', 'tags': {'id': 3.0}},
{'id': '6a799744-b6b0-11eb-8a66-1e008a366d49', 'tags': {'id': 2.0}},
{'id': '6a799190-b6b0-11eb-8a66-1e008a366d49', 'tags': {'id': 1.0}}
```

**粗体**：表示新术语、重要词汇或屏幕上出现的词汇。例如，菜单或对话框中的词汇通常以**粗体**显示。举个例子：“从**管理**面板中选择**系统信息**。”

提示或重要说明

如下所示。

# 联系我们

我们欢迎读者的反馈。

**一般反馈**：如果你对本书的任何内容有疑问，请通过电子邮件联系我们，邮箱地址为 [customercare@packtpub.com](https://customercare@packtpub.com)，并在邮件主题中提到书名。

**勘误**：虽然我们已尽一切努力确保内容的准确性，但错误难免发生。如果你在本书中发现了错误，我们将非常感激你能报告给我们。请访问 [www.packtpub.com/support/errata](https://www.packtpub.com/support/errata) 并填写表单。

**盗版**：如果你在互联网上发现任何非法的我们作品的副本，无论何种形式，我们将非常感激你能提供地址或网站名称。请通过 [copyright@packt.com](https://copyright@packt.com) 联系我们，并附上相关材料的链接。

**如果你有兴趣成为作者**：如果你在某个主题上有专业知识，并且对写书或为书籍做贡献感兴趣，请访问[authors.packtpub.com](https://authors.packtpub.com)。

# 分享你的想法

一旦你阅读完 *神经搜索 - 从原型到生产使用 Jina*，我们很想听听你的想法！请点击这里直接访问亚马逊书评页面并分享你的反馈。

你的评论对我们和技术社区来说都非常重要，帮助我们确保提供优质的内容。

# 第一部分：神经搜索基础介绍

在本部分中，你将了解什么是神经搜索以及它的用途。你将看到其实际应用的概述，面临的挑战以及如何克服这些挑战。以下章节包括在此部分中：

+   *第一章*，*神经网络与神经搜索*

+   *第二章*，*向量表示基础介绍*

+   *第三章*，*系统设计与工程挑战*
