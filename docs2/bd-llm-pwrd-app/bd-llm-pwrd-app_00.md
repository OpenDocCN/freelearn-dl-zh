# 前言

通过本书，我们开始探索**大型语言模型**（**LLMs**）及其在**人工智能**（**AI**）领域所代表的变革范式。这本全面指南帮助您深入了解这些尖端技术的坚实基础，从理论到 LLMs 提供的实际应用，最终聚焦于使用生成式 AI 解决方案时的伦理和责任考量。本书旨在为您提供对市场上新兴 LLMs 如何影响个人、大型企业和社会的坚实基础理解。它侧重于如何构建由 LLMs 驱动的强大应用程序，利用新的 AI 编排器如 LangChain，并揭示现代应用程序开发中的新趋势。

在本书结束时，您将能够更轻松地导航快速发展的生成式 AI 解决方案生态系统；此外，您还将拥有在日常工作以及业务中充分利用 LLMs 的工具。让我们开始吧！

# 本书面向的对象

本书旨在主要吸引具有一些基本 Python 代码基础的技术受众。然而，理论章节和动手实践基于生成式 AI 基础和行业引领的用例，这也可能对非技术受众产生兴趣。

总体而言，本书面向那些希望全面了解大型语言模型（LLMs）的变革力量及其定义，并能够自信地、有远见地导航快速发展的 AI 领域的个人。所有类型的读者都欢迎，但从中受益最大的读者包括：

+   **软件开发人员和工程师**：本书为希望利用 LLMs 构建应用程序的开发人员提供实用指南。它涵盖了将 LLMs 集成到应用程序后端、API、架构等方面的内容。

+   **数据科学家**：对于有兴趣将 LLMs 应用于现实世界使用的数据科学家，本书展示了如何将模型从研究阶段过渡到生产阶段。它涵盖了模型服务、监控和优化。

+   **AI/ML 工程师**：专注于 AI/ML 应用的工程师可以利用本书了解如何构建和部署 LLMs 作为智能系统和代理的一部分。

+   **技术创始人/CTO**：初创公司创始人和技术总监可以使用本书评估 LLMs 在其应用程序和产品中的应用，并探讨如何应用。它提供了技术概述，并考虑了商业因素。

+   **学生**：攻读 AI、ML、**自然语言处理**（**NLP**）或计算机科学的研究生和高年级本科生可以通过本书了解 LLMs 在实际中的应用。

+   **LLM 研究人员**：致力于新型 LLM 架构、训练技术等工作的研究人员将能够深入了解现实世界模型的使用及其相关挑战。

# 本书涵盖的内容

*第一章*，*大型语言模型简介*，介绍了 LLM，这是生成 AI 领域中强大的深度学习神经网络集合。它介绍了 LLM 的概念，它们与经典机器学习模型的区别，以及相关术语。它还讨论了最受欢迎的 LLM 的架构，接着探讨 LLM 是如何训练和消费的，并将基础 LLM 与微调 LLM 进行比较。到本章结束时，你将了解 LLM 是什么以及它们在 AI 领域的定位，为后续章节奠定基础。

*第二章*，*LLM 在 AI 应用中的使用*，探讨了 LLM 如何革命性地改变软件开发的世界，引领 AI 应用的新时代。到本章结束时，你将更清晰地了解 LLM 如何嵌入不同的应用场景，借助目前 AI 开发市场上可用的新的 AI 编排框架。 

*第三章*，*为您的应用选择 LLM*，强调了不同的 LLM 可能具有不同的架构、大小、训练数据、能力和限制。为您的应用选择正确的 LLM 不是一个简单的决定，因为它可以显著影响解决方案的性能、质量和成本。在本章中，我们将指导您选择正确的 LLM 的过程。我们将讨论市场上最有前途的 LLM，比较 LLM 时使用的最主要标准和工具，以及大小和性能之间的各种权衡。到本章结束时，你应该清楚地了解如何为您的应用选择正确的 LLM 以及如何有效地和负责任地使用它。

*第四章*，*提示工程*，解释了在设计基于 LLM 的应用时，提示工程是一项至关重要的活动，因为提示对 LLM 的性能有巨大影响。实际上，有几种技术可以实现，不仅能够完善你的 LLM 的响应，还能降低与幻觉和偏差相关的风险。在本章中，我们将涵盖提示工程领域的最新技术，从基本方法到高级框架。到本章结束时，你将具备构建功能强大且稳固的提示的基础，这些提示对于即将到来的章节也将是相关的。

*第五章*，*在您的应用程序中嵌入 LLMs*，讨论了随着使用 LLMs 开发应用程序的出现，软件开发领域引入的一系列新组件。为了使在应用程序流程中编排 LLMs 及其相关组件更加容易，出现了几个 AI 框架，其中 LangChain 是最广泛使用之一。在本章中，我们将深入研究 LangChain 及其使用方法，并学习如何通过 Hugging Face Hub 调用开源 LLM API，以及如何管理提示工程。到本章结束时，你将具备使用 LangChain 和开源 Hugging Face 模型开始开发 LLM 驱动应用程序的技术基础。

*第六章*，*构建对话式应用程序*，让我们通过第一个具体的 LLMs 驱动应用程序实现开始本书的实践部分。在整个章节中，我们将逐步实现一个对话式应用程序，使用 LangChain 及其组件。我们将配置一个简单聊天机器人的模式，添加记忆组件、非参数化知识和工具，使聊天机器人“具有代理性”。到本章结束时，你将能够仅用几行代码设置自己的对话式应用程序项目。

*第七章*，*使用 LLMs 构建搜索和推荐引擎*，探讨了 LLMs 如何通过嵌入和生成模型增强推荐系统。我们将讨论推荐系统的定义和演变，了解生成式 AI 如何影响这一研究领域，并理解如何使用 LangChain 构建推荐系统。到本章结束时，你将能够创建自己的推荐应用，并利用 LangChain 作为框架，利用最先进的 LLMs。

*第八章*，*使用结构化数据与 LLMs 结合*，探讨了 LLMs 处理结构化、表格数据的强大能力。我们将看到如何通过插件和代理方法，将 LLMs 作为我们与结构化数据之间的自然语言接口，缩小业务用户与结构化信息之间的差距。为了演示这一点，我们将使用 LangChain 构建一个数据库助手。到本章结束时，你将能够为你的数据资产构建自己的自然语言接口，结合非结构化与结构化来源。

*第九章*，*与代码一起工作*，涵盖了 LLMs 的另一个重要能力：与编程语言一起工作。在前一章中，我们已经看到了这种能力的一瞥，当时我们要求我们的 LLM 生成针对 SQL 数据库的 SQL 查询。在本章中，我们将探讨 LLMs 可以用代码以哪些其他方式使用，从“简单”的代码理解和生成到构建表现得像算法的应用程序。到本章结束时，你将能够为你的编码项目构建 LLM 驱动的应用，以及构建具有自然语言界面的 LLM 驱动的应用，以便与代码一起工作。

*第十章*，*使用 LLMs 构建多模态应用*，在 LLMs 的基础上，介绍了构建代理时的多模态概念。我们将看到不同 AI 领域的基础模型——语言、图像、音频——结合到一个单一代理背后的逻辑，该代理可以适应各种任务。你将学习如何使用 LangChain 构建一个多模态代理，使用单模态 LLMs。到本章结束时，你将能够构建自己的多模态代理，并为其提供执行各种 AI 任务所需的工具和 LLMs。

*第十一章*，*微调大型语言模型*，涵盖了微调 LLMs 的技术细节，从其背后的理论到使用 Python 和 Hugging Face 的动手实现。我们将深入探讨如何准备你的数据以微调基于你的数据的基础模型，以及讨论你的微调模型的托管策略。到本章结束时，你将能够使用自己的数据微调 LLM，以便构建由该 LLM 驱动的特定领域应用。

*第十二章*，*负责任的 AI*，介绍了减轻 LLMs（以及 AI 模型）潜在危害的学科基础——即负责任的 AI。这一点很重要，因为 LLMs 开启了新的风险和偏见的大门，这些风险和偏见在开发 LLM 驱动的应用时需要考虑。

我们将接着讨论与 LLMs 相关的风险以及如何使用适当的技术来预防或至少减轻它们。到本章结束时，你将更深入地了解如何防止 LLMs 使你的应用具有潜在的危害。

*第十三章*，*新兴趋势和创新*，探讨了生成 AI 领域最新的进步和未来趋势。

# 为了充分利用这本书

本书旨在提供 LLMs 是什么、它们的架构以及为什么它们正在改变 AI 领域的坚实基础理论。它采用了一种动手方法，为你提供了一步一步的指南，用于实现特定任务的 LLMs 驱动的应用，并使用像 LangChain 这样的强大框架。此外，每个示例都将展示不同 LLMs 的使用，以便你可以欣赏它们的差异化特点以及何时使用适当的模型来完成特定任务。

总体而言，本书将理论概念与实际应用相结合，对于希望在学习 LLMs 及其在自然语言处理中的应用方面打下坚实基础的人来说，是一本理想的资源。以下先决条件将帮助您充分利用本书：

+   对神经网络背后的数学（线性代数、神经元和参数以及损失函数）的基本理解

+   对机器学习概念的基本理解，例如训练集和测试集、评估指标以及自然语言处理

+   对 Python 的基本理解

## 下载示例代码文件

本书代码包托管在 GitHub 上，网址为[`github.com/PacktPublishing/Building-LLM-Powered-Applications`](https://github.com/PacktPublishing/Building-LLM-Powered-Applications)。我们还有其他来自我们丰富图书和视频目录的代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。查看它们吧！

## 下载彩色图像

我们还提供了一份包含本书中使用的截图/图表彩色图像的 PDF 文件。您可以从这里下载：[`packt.link/gbp/9781835462317`](https://packt.link/gbp/9781835462317)。

## 使用的约定

本书使用了多种文本约定。

`CodeInText:` 表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。例如：“我设置了两个变量`system_message`和`instructions`。”

代码块设置如下：

```py
[default]
$pip install openai == 0.28
import os
import openai
openai.api_key = os.environment.get('OPENAI_API_KEY')
response = openai.ChatCompletion.create(
    model="gpt-35-turbo", # engine = "deployment_name".
    messages=[
        {"role": "system", "content": system_message},
        {"role": "user", "content": instructions},
    ]
) 
```

任何命令行输入或输出都如下所示：

```py
{'text': "Terrible movie. Nuff Said.[…]
 'label': 0} 
```

**粗体:** 表示新术语、重要单词或屏幕上出现的单词。例如，菜单或对话框中的单词在文本中显示如下。例如：“[...]他发现重复提示末尾的主要指令可以帮助模型克服其内在的**近期偏差**。”

警告或重要注意事项显示如下。

技巧和窍门显示如下。

# 联系我们

欢迎读者反馈。

**一般反馈**: 请通过`feedback@packtpub.com`发送电子邮件，并在邮件主题中提及本书的标题。如果您对本书的任何方面有疑问，请通过`questions@packtpub.com`发送电子邮件给我们。

**勘误**: 尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，如果您能向我们报告，我们将不胜感激。请访问[`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，点击**提交勘误**，并填写表格。

**盗版**: 如果您在互联网上以任何形式遇到我们作品的非法副本，如果您能提供位置地址或网站名称，我们将不胜感激。请通过`copyright@packtpub.com`与我们联系，并附上材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问[`authors.packtpub.com`](http://authors.packtpub.com)。

# 分享您的想法

一旦您阅读了《构建基于 LLM 的应用程序》，我们非常期待听到您的想法！请[点击此处直接访问此书的亚马逊评论页面](https://packt.link/r/1835462316)并分享您的反馈。

您的评论对我们和科技社区非常重要，并将帮助我们确保我们提供高质量的内容。

# 下载此书的免费 PDF 副本

感谢您购买此书！

您喜欢随时随地阅读，但又无法携带您的印刷书籍到处走？

您的电子书购买是否与您选择的设备不兼容？

别担心，现在，随着每本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何地点、任何设备上阅读。直接从您最喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠远不止于此，您还可以获得独家折扣、时事通讯和每日邮箱中的优质免费内容。

按照以下简单步骤获取优惠：

1.  扫描下面的二维码或访问以下链接：

![](img/B21714_Free_PDF_QR.png)

[`packt.link/free-ebook/9781835462317`](https://packt.link/free-ebook/9781835462317)

1.  提交您的购买证明。

1.  就这些！我们将直接将您的免费 PDF 和其他优惠发送到您的邮箱。
