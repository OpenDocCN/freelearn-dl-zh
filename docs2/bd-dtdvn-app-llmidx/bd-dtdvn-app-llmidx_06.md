<html:html><html:head><html:title>索引我们的 PITS 学习资料 – 实战</html:title></html:head> <html:body><html:div class="epub-source"><html:h1 id="_idParaDest-129">索引我们的 PITS 学习资料 – 实战</html:h1> <html:div id="_idContainer052">from llama_index.core import ( VectorStoreIndex, TreeIndex, load_index_from_storage) from llama_index.core import StorageContext from global_settings import INDEX_STORAGE from document_uploader import ingest_documents def build_indexes(nodes): try storage_context = StorageContext.from_defaults( persist_dir=INDEX_STORAGE ) vector_index = load_index_from_storage( storage_context, index_id="vector" ) tree_index = load_index_from_storage( storage_context, index_id="tree" ) print("所有索引已从存储中加载.") except Exception as e: print(f"加载索引时发生错误：{e}") storage_context = StorageContext.from_defaults() vector_index = VectorStoreIndex( nodes, storage_context=storage_context ) vector_index.set_index_id("vector") tree_index = TreeIndex( nodes, storage_context=storage_context ) tree_index.set_index_id("tree") storage_context.persist( persist_dir=INDEX_STORAGE ) print("新索引已创建并持久化.") return vector_index, tree_index <html:p>在深入理解 LlamaIndex 中索引工作原理的基础上，我们现在准备在我们的<html:span class="No-Break">辅导应用程序</html:span>中实现索引逻辑。</html:p> <html:p>让我们创建<html:code class="literal">index_builder.py</html:code>模块。此模块负责索引创建。在当前实现中，它创建了两个索引：一个<html:code class="literal">VectorStoreIndex</html:code>和一个<html:code class="literal">TreeIndex</html:code>。如您所见，这是一个非常基本的实现，肯定有<html:a id="_idIndexMarker512"></html:a>改进的空间。让我们先处理<html:span class="No-Break">导入</html:span>：</html:p> <html:p>接下来，我们将实现我们的<html:span class="No-Break">索引构建函数</html:span>：</html:p> <html:p>我们首先检查索引是否已经持久化到磁盘。如果是肯定的，那么我们利用持久化来避免重建它们的额外成本<html:span class="No-Break">。</html:span></html:p> <html:p class="callout-heading">关于：注意 index_id 的使用</html:p> <html:p class="callout">因为我们已经在同一个存储文件夹<html:code class="literal">INDEX_STORAGE</html:code>中持久化了<html:a id="_idIndexMarker513"></html:a>多个索引，当使用<html:code class="literal">load_index_from_storage</html:code>时，我们需要指定它们的个别 ID，以便 LlamaIndex 可以识别<html:span class="No-Break">正确的索引</html:span>。</html:p> <html:p>如果我们无法在<html:code class="literal">INDEX_STORAGE</html:code>文件夹中找到它们，我们就从节点中构建它们。我们还使用<html:code class="literal">set_index_id</html:code>为每个索引设置一个 ID，以便我们可以在<html:a id="_idIndexMarker514"></html:a>未来的会话中<html:span class="No-Break">正确地加载</html:span>它们：</html:p> <html:p><html:code class="literal">build_indexes</html:code>函数返回我们将稍后在<html:span class="No-Break">我们的应用程序</html:span>中使用的两个索引对象。</html:p> <html:p>到此为止。我们将在<html:a id="_idIndexMarker515"></html:a>第六章中讨论下一步，第六章将讨论<html:em class="italic">查询我们的数据，第一部分 –</html:em> <html:span class="No-Break"><html:em class="italic">上下文检索</html:em></html:span> <html:span class="No-Break">。</html:span></html:p> <html:a id="_idTextAnchor129"></html:a></html:div></html:div></html:body></html:html><html:html><html:head><html:title>总结</html:title></html:head> <html:body><html:div class="epub-source"><html:h1 id="_idParaDest-130">总结</html:h1> <html:div id="_idContainer052"><html:p>在本章中，我们探讨了 LlamaIndex 中的各种索引策略和架构。索引为构建高性能<html:span class="No-Break">RAG 系统</html:span>提供了基本功能。</html:p> <html:p>在本章中，我们研究了<html:code class="literal">VectorStoreIndex</html:code>，这是最常用的索引类型。我们还了解了嵌入、向量存储、相似性搜索和存储上下文。这些都是与<html:span class="No-Break"><html:code class="literal">VectorStoreIndex</html:code></html:span>相关的关键概念<html:span class="No-Break">。</html:span></html:p> <html:p>我们还介绍了其他索引类型，如<html:code class="literal">SummaryIndex</html:code>用于简单线性扫描、<html:code class="literal">KeywordTableIndex</html:code>用于关键字搜索、<html:code class="literal">TreeIndex</html:code>用于层次数据、<html:code class="literal">KnowledgeGraphIndex</html:code>用于基于关系的查询。<html:code class="literal">ComposableGraph</html:code>被引入作为构建多层索引的工具，并讨论了成本估算技术和最佳实践。</html:p> <html:p>总的来说，本章概述了 LlamaIndex 的索引功能，为构建复杂和高效的<html:span class="No-Break">RAG 应用程序</html:span>奠定了基础。</html:p> <html:p>我们将在<html:a><html:span class="No-Break"><html:em class="italic">第六章</html:em></html:span></html:a>中见到您，我们将讨论在 LlamaIndex 中查询我们的数据<html:span class="No-Break">的方法</html:span>。</html:p></html:div></html:div></html:body></html:html> <html:html><html:head><html:title>第三部分：检索和使用索引数据</html:title></html:head> <html:body><html:div class="epub-source"><html:h1 id="_idParaDest-131" lang="en-US">第三部分：检索和使用索引数据</html:h1> <html:div id="_idContainer054"><html:p>本部分从探索 LlamaIndex 在 RAG 工作流程中的查询功能开始，重点关注检索机制、查询机制和高级检索策略，然后通过后处理技术对这些查询进行优化，并将它们集成到综合查询引擎中。它最终通过构建聊天机器人和智能代理的实践考察，涵盖了各种引擎模式、代理架构和对话功能的实现，从而为您提供了创建动态、对话<html:span class="No-Break">RAG 接口</html:span>的知识。</html:p> <html:p>本部分包含以下章节：</html:p> <html:ul><html:li><html:a><html:em class="italic">第六章</html:em></html:a>，<html:em class="italic">查询我们的数据，第一部分 – 上下文检索</html:em></html:li> <html:li><html:a><html:em class="italic">第七章</html:em></html:a>，<html:em class="italic">查询我们的数据，第二部分 – 后处理和响应合成</html:em></html:li> <html:li><html:a><html:em class="italic">第八章</html:em></html:a>，<html:em class="italic">使用 LlamaIndex 构建聊天机器人和代理</html:em></html:li></html:ul></html:div></html:div></html:body></html:html>
