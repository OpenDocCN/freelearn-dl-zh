- en: '22'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '22'
- en: Reasoning and Acting
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 推理与行动
- en: '**Reasoning and Acting** (**ReAct**) is a prompting technique developed by
    researchers from Princeton University and Google that enhances an LLM’s ability
    to perform reasoning and acting in simulated environments ([https://arxiv.org/pdf/2210.03629](https://arxiv.org/pdf/2210.03629)).
    It allows LLMs to mimic human-like operations in the real world, where we reason
    verbally and take actions to gain information. ReAct combines *reasoning* and
    *acting* to solve complex language reasoning and decision-making tasks.'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '**推理与行动**（**ReAct**）是由普林斯顿大学和谷歌的研究人员开发的一种提示技术，它增强了LLM在模拟环境中进行推理和行动的能力（[https://arxiv.org/pdf/2210.03629](https://arxiv.org/pdf/2210.03629)）。它允许LLM模仿现实世界中的类似人类操作，在那里我们用言语进行推理并采取行动以获取信息。ReAct将*推理*和*行动*结合起来，以解决复杂语言推理和决策任务。'
- en: While CoT prompting enables LLMs to generate reasoning traces, its lack of access
    to the external world can lead to issues such as fact hallucination. ReAct addresses
    this by allowing LLMs to generate both *verbal reasoning traces* and *text actions*
    for a task. These text actions enable the model to interact with its environment
    (for example, by querying an external knowledge source or using a tool), gather
    information, and adjust its reasoning accordingly.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然CoT提示使LLM能够生成推理轨迹，但其无法访问外部世界可能导致事实虚构等问题。ReAct通过允许LLM为任务生成*口头推理轨迹*和*文本动作*来解决此问题。这些文本动作使模型能够与其环境（例如，通过查询外部知识源或使用工具）交互，收集信息，并相应地调整其推理。
- en: 'The key characteristics of ReAct are as follows:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ReAct的关键特性如下：
- en: '**Reasoning traces**: LLMs generate text that explains their thought process
    step by step'
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**推理轨迹**：LLM生成逐步解释其思维过程的文本'
- en: '**Action generation**: LLMs produce text actions that represent interactions
    with external tools or environments'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**动作生成**：LLM产生代表与外部工具或环境交互的文本动作'
- en: '**Observation incorporation**: The results of actions (observations) are fed
    back into the LLM’s context, influencing subsequent reasoning and actions'
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**观察融合**：动作（观察）的结果被反馈到LLM的上下文中，影响后续的推理和动作'
- en: '**Iterative process**: ReAct typically involves multiple *Thought*/*Action*/*Observation*
    steps, allowing for dynamic problem solving'
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**迭代过程**：ReAct通常涉及多个*思考*/*动作*/*观察*步骤，允许动态问题解决'
- en: 'ReAct excels in the following scenarios:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: ReAct在以下场景中表现出色：
- en: When a task requires information beyond the LLM’s pre-trained knowledge (for
    example, multi-hop question answering or fact verification)
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当任务需要超出LLM预训练知识的信息时（例如，多跳问答或事实验证）
- en: When an LLM needs to navigate and interact with a simulated environment (for
    example, online shopping or text-based games)
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当一个LLM需要导航和与模拟环境（例如，在线购物或基于文本的游戏）交互时
- en: When you need to combine the power of LLMs with the capabilities of external
    tools (for example, search engines, calculators, and APIs)
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当你需要结合LLM的力量与外部工具（例如，搜索引擎、计算器和API）的能力时
- en: When the task requires a problem to be broken down into smaller steps and decisions
    must be made based on intermediate results
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当任务需要将问题分解成更小的步骤，并且必须根据中间结果做出决策时
- en: 'In this chapter, we’ll be covering the following topics:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主题：
- en: Implementing ReAct in LangChain
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在LangChain中实现ReAct
- en: Building ReAct agents with LangChain’s Expression Language
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用LangChain的表达语言构建ReAct代理
- en: Completing tasks and solving problems
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 完成任务和解决问题
- en: Evaluating ReAct’s performance
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 评估ReAct的性能
- en: Safety, control, and ethical considerations
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安全性、控制和伦理考虑
- en: Limitations and future directions
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 局限性和未来方向
- en: Implementing ReAct in LangChain
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在LangChain中实现ReAct
- en: 'The open source LLM framework LangChain ([https://www.langchain.com/](https://www.langchain.com/))
    provides a powerful and flexible implementation of the ReAct framework through
    its `Agent` class. Let’s explore how to create and use ReAct agents in LangChain:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 开源LLM框架LangChain ([https://www.langchain.com/](https://www.langchain.com/))
    通过其`Agent`类提供了一个强大且灵活的ReAct框架实现。让我们探索如何在LangChain中创建和使用ReAct代理：
- en: 'Install the necessary packages:'
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装必要的包：
- en: '[PRE0]'
  id: totrans-24
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '`wikipedia` enables language models to access and utilize information from
    Wikipedia, broadening their knowledge base'
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`wikipedia`使语言模型能够访问和利用维基百科的信息，扩大其知识库'
- en: '`langchainhub` is a central repository for sharing and discovering LangChain
    assets, such as prompts, chains, and agents'
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`langchainhub`是一个用于共享和发现LangChain资产（如提示、链和代理）的中心仓库'
- en: 'Initialize the language model and tools such as `wikipedia`, `ddg-search`,
    and `llm-math`. These are listed in the following code snippet:'
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 初始化语言模型和工具，如 `wikipedia`、`ddg-search` 和 `llm-math`。这些在以下代码片段中列出：
- en: '[PRE1]'
  id: totrans-28
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Here, we import the necessary modules from `langchain`. Then, a language model
    (`ChatOpenAI`) is initialized with the specified model (`gpt-4-1106-preview` and
    `temperature`. Finally, we load some tools that our agent will use.
  id: totrans-29
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在这里，我们从 `langchain` 导入必要的模块。然后，使用指定的模型（`gpt-4-1106-preview` 和 `temperature`）初始化语言模型（`ChatOpenAI`）。最后，我们加载一些代理将使用的工具。
- en: 'Initialize the ReAct agent. Here, the `initialize_agent` function creates and
    initializes an agent:'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 初始化 ReAct 代理。在这里，`initialize_agent` 函数创建并初始化了一个代理：
- en: '[PRE2]'
  id: totrans-31
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: In the preceding code, we list `tools` and `llm`, which refers to the language
    model, as well as specify the agent type as `AgentType.ZERO_SHOT_REACT_DESCRIPTION`.
    Here, `verbose=True` enables detailed logging of the agent’s thought process.
  id: totrans-32
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在前面的代码中，我们列出了 `tools` 和 `llm`，其中 `llm` 指的是语言模型，并指定代理类型为 `AgentType.ZERO_SHOT_REACT_DESCRIPTION`。在这里，`verbose=True`
    启用了代理思维过程的详细记录。
- en: 'Inspect the ReAct agent’s prompt. The following line prints the prompt template
    used by the ReAct agent. This prompt provides instructions to the LLM on how to
    use the available tools and follow the ReAct format (*Thought*, *Action*, *Action
    Input*, and *Observation*):'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查 ReAct 代理的提示。以下行打印 ReAct 代理使用的提示模板。此提示为 LLM 提供了如何使用可用工具并遵循 ReAct 格式（*Thought*，*Action*，*Action
    Input* 和 *Observation*）的说明：
- en: '[PRE3]'
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Inspecting the ReAct agent’s prompt is important because it reveals the structure
    and logic that guide the behavior of the language model during tool-augmented
    reasoning and action. By printing the prompt template with `print(agent.agent.llm_chain.prompt.template)`,
    you’re not just seeing arbitrary instructions – you’re inspecting the behavioral
    scaffold that governs how the agent sequences its reasoning and tool use. This
    includes how it interprets a user query, chooses a tool from its available action
    set, constructs the input to the tool, and integrates the tool’s output (Observation)
    into further reasoning. If the prompt is poorly constructed, the model may misinterpret
    the tools, take invalid actions, or fail to chain thoughts coherently. Additionally,
    the template often includes few-shot examples that demonstrate how to alternate
    between the ReAct components properly. These examples act as implicit instructions
    for formatting and logic, helping the model generalize to unseen tasks. Inspecting
    them can reveal whether the agent was trained or instructed using general patterns
    or highly specific use cases. It also helps developers debug unexpected behavior
    or hallucinations since modifying the template directly influences the agent’s
    action selection, reasoning fidelity, and overall alignment with the intended
    ReAct cycle.
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 检查 ReAct 代理的提示非常重要，因为它揭示了指导语言模型在工具辅助推理和动作期间行为的结构和逻辑。通过使用 `print(agent.agent.llm_chain.prompt.template)`
    打印提示模板，您不仅看到了任意的指令，而且检查了控制代理如何序列其推理和工具使用的行动框架。这包括它如何解释用户查询、从其可用动作集中选择工具、构建工具的输入，以及将工具的输出（观察）整合到进一步的推理中。如果提示构建不当，模型可能会误解工具、采取无效的动作或无法连贯地串联思维。此外，模板通常包括少量示例，展示如何正确地在
    ReAct 组件之间交替。这些示例作为格式和逻辑的隐式指令，帮助模型泛化到未见过的任务。检查它们可以揭示代理是否使用通用模式或高度具体的用例进行训练或指导。它还有助于开发者调试意外的行为或幻觉，因为直接修改模板会直接影响代理的动作选择、推理的准确性以及与预期
    ReAct 循环的整体一致性。
- en: 'The following code block demonstrates how to customize the prompt template.
    You can modify the instructions, examples, and formatting to better suit your
    specific use case:'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下代码块演示了如何自定义提示模板。您可以修改说明、示例和格式以更好地适应您的特定用例：
- en: '[PRE4]'
  id: totrans-37
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Here, `agent.agent.llm_chain.prompt.template = prompt` updates the agent’s prompt
    with the custom template.
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在这里，`agent.agent.llm_chain.prompt.template = prompt` 更新了代理的提示为自定义模板。
- en: 'Next, you can modify the descriptions of the tools to provide more specific
    guidance to the LLM on when and how to use each tool:'
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，您可以修改工具的描述，为 LLM 提供更具体的指导，说明何时以及如何使用每个工具：
- en: '[PRE5]'
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The following line executes the agent with a sample query. The agent will use
    the ReAct framework to perform reasoning, select tools, execute actions, and generate
    a final answer:'
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下行执行代理以一个示例查询。代理将使用 ReAct 框架进行推理、选择工具、执行动作并生成最终答案：
- en: '[PRE6]'
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Next, we’ll look at an example of using ReAct for document processing that leverages
    LangChain.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将通过一个示例来查看如何使用 ReAct 进行文档处理，该示例利用了 LangChain。
- en: ReAct Document Store
  id: totrans-44
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ReAct 文档存储
- en: 'LangChain also provides a `DocstoreExplorer` class for implementing ReAct logic
    with document stores such as Wikipedia. We’ll demonstrate an example by using
    `DocstoreExplorer` with Wikipedia for document-based ReAct:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: LangChain 还提供了一个 `DocstoreExplorer` 类，用于实现与维基百科等文档存储的 ReAct 逻辑。我们将通过使用 `DocstoreExplorer`
    和维基百科进行文档式 ReAct 的示例来演示：
- en: '[PRE7]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'This code sets up a LangChain agent designed to answer questions by interacting
    with Wikipedia. Here’s a breakdown:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 这段代码设置了一个 LangChain 代理，该代理通过与维基百科交互来回答问题。以下是分解：
- en: '**Wikipedia access**: First, it initializes a connection to Wikipedia, allowing
    the agent to retrieve information from it.'
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**维基百科访问**：首先，它初始化与维基百科的连接，使代理能够从中检索信息。'
- en: '`Search` and `Lookup`. The `Search` tool enables the agent to find relevant
    Wikipedia pages, whereas the `Lookup` tool lets it extract specific information
    from those pages.'
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`搜索` 和 `查找`。`搜索` 工具使代理能够找到相关的维基百科页面，而 `查找` 工具则允许它从这些页面中提取特定信息。'
- en: '`AgentType.REACT_DOCSTORE` explicitly configures the agent for document store
    interactions – in this case, those for Wikipedia.'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`AgentType.REACT_DOCSTORE` 明确配置代理以进行文档存储交互 – 在这种情况下，是维基百科的。'
- en: '`Search` tool to find relevant pages and the `Lookup` tool to extract the answer.'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `搜索` 工具查找相关页面和 `查找` 工具提取答案。
- en: Building ReAct agents with LangChain’s Expression Language
  id: totrans-52
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 LangChain 的表达式语言构建 ReAct 代理
- en: '**LangChain Expression Language** (**LCEL**) offers a declarative approach
    to constructing ReAct agents. Instead of manually orchestrating the steps, LCEL
    allows you to define a processing graph that handles user input, reasoning, action
    selection, and final response generation. This section demonstrates how to implement
    a ReAct agent using this powerful framework.'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '**LangChain 表达式语言**（**LCEL**）提供了一种声明式方法来构建 ReAct 代理。LCEL 允许你定义一个处理图，该图处理用户输入、推理、动作选择和最终响应生成。本节演示了如何使用这个强大的框架实现
    ReAct 代理。'
- en: The core idea is to establish a data pipeline that takes a user’s query, uses
    an LLM to reason through a series of steps, potentially leveraging external tools,
    and ultimately arrives at an answer. This pipeline can be succinctly expressed
    using LCEL.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 核心思想是建立一个数据管道，该管道接收用户的查询，使用 LLM 通过一系列步骤进行推理，可能利用外部工具，并最终得出答案。这个管道可以使用 LCEL 简洁地表达。
- en: 'The following is a Python code example demonstrating this process:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一个 Python 代码示例，演示了此过程：
- en: '[PRE8]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Let’s take a closer look at this setup:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们更详细地看看这个设置：
- en: A custom prompt template is defined to guide the LLM’s reasoning and action
    selection, instead of one being fetched from a hub. This template instructs the
    LLM on the expected format of the interaction (*Question*, *Thought*, *Action*,
    *Observation*, *Final Answer*).
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义了一个自定义提示模板来指导 LLM 的推理和动作选择，而不是从中心获取一个。这个模板指导 LLM 关于交互预期的格式（*问题*，*思考*，*动作*，*观察*，*最终答案*）。
- en: ChatOpenAI serves as the LLM, configured to halt generation upon encountering
    the `\nObservation:` string. This signal indicates that the agent has completed
    an action and is awaiting the result.
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ChatOpenAI 作为 LLM，配置为在遇到 `\nObservation:` 字符串时停止生成。这个信号表示代理已完成动作并等待结果。
- en: 'The agent pipeline is constructed via LCEL, which is the chaining operation
    (`|`). This pipeline orchestrates the flow of information:'
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 代理管道是通过 LCEL 构建的，这是链式操作（`|`）。这个管道协调信息流：
- en: It formats the input and agent’s scratchpad (previous reasoning steps)
  id: totrans-61
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它格式化输入和代理的草稿本（之前的推理步骤）
- en: It feeds the formatted input to the prompt
  id: totrans-62
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它将格式化的输入馈送到提示
- en: The LLM, with its configured stopping criteria, processes the prompt
  id: totrans-63
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: LLM，根据其配置的停止标准，处理提示
- en: Finally, `ReActSingleInputOutputParser` parses the LLM’s output, distinguishing
    between actions to be taken and the final answer
  id: totrans-64
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，`ReActSingleInputOutputParser` 解析 LLM 的输出，区分要采取的动作和最终答案
- en: Explaining ReActSingleInputOutputParser
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 解释 ReActSingleInputOutputParser
- en: 'This component is key for interpreting the LLM’s output and determining the
    next step in the ReAct loop:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 这个组件对于解释 LLM 的输出并确定 ReAct 循环中的下一步至关重要：
- en: '**Instantiation**: You create an instance of the parser, ready to process LLM-generated
    text'
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**实例化**：您创建解析器的实例，准备处理 LLM 生成的文本'
- en: '`AgentAction` object (requesting the execution of a tool) or an `AgentFinish`
    object (providing the final answer)'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`AgentAction`对象（请求执行工具）或`AgentFinish`对象（提供最终答案）'
- en: If it detects `AgentAction`, it extracts the tool’s name and the input to be
    passed to the tool
  id: totrans-69
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果它检测到`AgentAction`，则提取工具的名称和传递给工具的输入
- en: If it finds `AgentFinish`, it extracts the final answer
  id: totrans-70
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果它找到`AgentFinish`，则提取最终答案
- en: '`AgentAction` or `AgentFinish`'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`AgentAction`或`AgentFinish`'
- en: '`Action:` or `Final Answer:`), the parser raises an exception, indicating a
    problem with the LLM’s reasoning or the prompt'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Action:`或`Final Answer:`），解析器引发异常，表明LLM的推理或提示存在问题'
- en: Running the agent with AgentExecutor
  id: totrans-73
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用AgentExecutor运行代理
- en: In the following code, `AgentExecutor` is a component responsible for managing
    the execution of an agent’s actions, which are chosen based on the agent’s decision-making
    process. It acts as a driver for the agent, facilitating the interaction between
    the agent and external tools.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下代码中，`AgentExecutor`是一个负责管理代理动作执行（基于代理的决策过程选择）的组件。它作为代理的驱动程序，促进代理与外部工具之间的交互。
- en: 'Here’s an example:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一个例子：
- en: '[PRE9]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Here, the following occurs:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 这里发生以下情况：
- en: We create an `AgentExecutor` instance, providing it with the agent pipeline
    we defined earlier and the available tools, before setting `verbose=True` to see
    the agent’s thought process.
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们创建一个`AgentExecutor`实例，向其提供我们之前定义的代理管道和可用工具，然后在设置`verbose=True`以查看代理的思维过程之前。
- en: 'The `agent_executor.invoke` method starts the process. It takes a dictionary
    containing the user’s input (`"input": "Who is the current CEO of Microsoft and
    what is their` `age squared?"`).'
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`agent_executor.invoke`方法启动流程。它接受一个包含用户输入的字典（`"input": "Who is the current
    CEO of Microsoft and what is their age squared?"`）。'
- en: 'Then, `AgentExecutor` manages the ReAct loop:'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，`AgentExecutor` 管理ReAct循环：
- en: It feeds the input to the agent pipeline.
  id: totrans-81
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 它将输入传递给代理管道。
- en: The agent (LLM and parser) decides on an action (for example, using a search
    tool to find the CEO’s name).
  id: totrans-82
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 代理（LLM和解析器）决定采取的行动（例如，使用搜索工具查找CEO的名字）。
- en: The `AgentExecutor` executes the action (calls the search tool).
  id: totrans-83
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`AgentExecutor`执行动作（调用搜索工具）。'
- en: It passes the result back to the agent as an “`Observation`.”
  id: totrans-84
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 它将结果作为“`Observation`”返回给代理。
- en: This process repeats until the agent decides it has enough information to produce
    a final answer.
  id: totrans-85
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此过程会重复进行，直到代理决定它已经拥有足够的信息来生成最终答案。
- en: This example demonstrates the basic structure of a ReAct agent built with LCEL.
    It showcases how you can define a clear, modular pipeline for complex reasoning
    tasks by combining prompts, language models, parsers, and external tools. This
    approach promotes code readability, maintainability, and flexibility in designing
    intelligent agents. This particular example asks who the current CEO of Microsoft
    is and then what their age is squared, demonstrating simple multi-turn reasoning
    from name recall to arithmetic calculation.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 此示例演示了使用LCEL构建的ReAct代理的基本结构。它展示了如何通过结合提示、语言模型、解析器和外部工具来定义一个清晰、模块化的管道，以实现复杂的推理任务。这种方法促进了代码的可读性、可维护性和设计智能代理的灵活性。这个特定的例子询问微软的现任CEO是谁，然后计算他们的年龄平方，展示了从名称回忆到算术计算的简单多轮推理。
- en: Completing tasks and solving problems
  id: totrans-87
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 完成任务和解决问题
- en: 'The ReAct framework, with its ability to integrate reasoning and acting, is
    highly applicable in various task completion and problem-solving scenarios:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: ReAct框架，凭借其整合推理和行动的能力，在各种任务完成和问题解决场景中高度适用：
- en: '**Question-Answering (QA) with external knowledge**: ReAct can be used to create
    QA systems that can access and reason about external knowledge sources, such as
    Wikipedia or a search engine, to provide more accurate and up-to-date answers'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**带有外部知识的问答（QA）**：ReAct可用于创建可以访问和推理外部知识源（如维基百科或搜索引擎）的QA系统，以提供更准确和更新的答案'
- en: '**Web navigation and interaction**: ReAct agents can navigate websites, interact
    with web elements, and gather information, enabling tasks such as automated web
    research, data scraping, and online shopping assistance'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网页导航和交互**：ReAct代理可以导航网站，与网页元素交互，并收集信息，从而实现自动化网页研究、数据抓取和在线购物辅助等任务'
- en: '**Software application control**: By integrating with APIs and tools, ReAct
    agents can control software applications, automate workflows, and perform complex
    tasks that require interacting with multiple systems'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**软件应用控制**：通过集成API和工具，ReAct代理可以控制软件应用，自动化工作流程，并执行需要与多个系统交互的复杂任务'
- en: '**Robotics and physical world interaction**: While LLMs primarily operate in
    the textual domain, ReAct principles can be extended to controlling robots or
    other physical systems, where actions involve physical movements or interactions
    with the real world'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**机器人和物理世界交互**：虽然LLM主要在文本领域运行，但ReAct原则可以扩展到控制机器人或其他物理系统，其中行动涉及物理运动或与真实世界的交互'
- en: '**Multi-step problem solving**: ReAct is well-suited for tasks that require
    breaking down a complex problem into smaller steps, reasoning about each step,
    taking actions, and using the observations to inform subsequent steps'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**多步问题解决**：ReAct非常适合需要将复杂问题分解为更小步骤、对每个步骤进行推理、采取行动并使用观察结果来指导后续步骤的任务'
- en: Evaluating ReAct’s performance
  id: totrans-94
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 评估ReAct的性能
- en: 'Evaluating ReAct agents involves assessing both the quality of the reasoning
    and the effectiveness of the actions taken. The following metrics can be used:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 评估ReAct代理涉及评估推理的质量和采取行动的有效性。以下指标可以用来评估：
- en: '**Success rate**: The percentage of tasks successfully completed by the agent'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**成功率**：代理成功完成的任务百分比'
- en: '**Efficiency**: The number of steps or the amount of time taken to complete
    a task'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**效率**：完成任务所需的步骤数量或时间'
- en: '**Reasoning accuracy**: The correctness and relevance of the LLM’s reasoning
    traces'
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**推理准确性**：LLM推理轨迹的正确性和相关性'
- en: '**Action relevance**: The appropriateness of the actions chosen by the agent'
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**行动相关性**：代理选择的行动的适当性'
- en: '**Observation utilization**: How effectively the agent incorporates observations
    into its subsequent reasoning and actions'
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**观察利用**：代理如何有效地将其观察结果纳入后续推理和行动'
- en: '**Error analysis**: Identifying common failure modes or weaknesses in the agent’s
    performance'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**错误分析**：识别代理性能中的常见故障模式或弱点'
- en: 'Let’s consider some evaluation techniques that can be used:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们考虑一些可以使用的评估技术：
- en: '**Human evaluation**: Having human experts evaluate the agent’s reasoning,
    actions, and final outputs'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**人工评估**：让人类专家评估代理的推理、行动和最终输出'
- en: '**Automated metrics**: Using automated scripts or LLMs to assess specific aspects
    of the agent’s performance, such as the correctness of answers or the relevance
    of actions'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自动化指标**：使用自动化脚本或LLM评估代理性能的特定方面，例如答案的正确性或行动的相关性'
- en: '**Benchmarking**: Comparing the agent’s performance against predefined benchmarks
    or other agents on standardized tasks'
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基准测试**：将代理的性能与预定义的基准或其他代理在标准化任务上的性能进行比较'
- en: '**Ablation studies**: Systematically removing or modifying components of the
    ReAct framework (for example, removing the reasoning steps) to understand their
    contribution to overall performance'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**消融研究**：系统地删除或修改ReAct框架的组件（例如，删除推理步骤）以了解其对整体性能的贡献'
- en: Safety, control, and ethical considerations
  id: totrans-107
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安全、控制和伦理考量
- en: 'ReAct systems, especially when integrated with external tools, raise several
    safety, control, and ethical concerns:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: ReAct系统，尤其是当与外部工具集成时，会引发一些安全、控制和伦理问题：
- en: '**Unpredictable behavior**: The combination of LLM reasoning and external tool
    use can lead to unpredictable or unintended behavior'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**不可预测的行为**：LLM推理和外部工具使用的组合可能导致不可预测或非预期的行为'
- en: '**Safety of actions**: Actions taken by the agent may have real-world consequences,
    especially if the agent is connected to systems that can affect the physical world'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**行动的安全性**：代理采取的行动可能产生现实世界的后果，特别是如果代理连接到可以影响物理世界的系统'
- en: '**Bias and fairness**: ReAct agents may inherit and amplify biases present
    in the training data of the LLM or the external tools they use'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**偏见和公平性**：ReAct代理可能会继承并放大LLM或他们使用的外部工具训练数据中存在的偏见'
- en: '**Misuse potential**: Malicious actors could potentially use ReAct agents for
    harmful purposes, such as generating misinformation or automating attacks'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**滥用潜力**：恶意行为者可能将ReAct代理用于有害目的，例如生成虚假信息或自动化攻击'
- en: '**Accountability**: Determining responsibility for the actions and decisions
    of a ReAct agent can be challenging due to the non-deterministic nature of the
    underlying LLM models'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**责任归属**：由于底层LLM模型的不确定性，确定ReAct代理的行为和决策的责任可能具有挑战性'
- en: 'The following are some mitigation strategies for these issues:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一些缓解这些问题的策略：
- en: '**Sandboxing**: Running ReAct agents in isolated environments to limit their
    potential impact'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**沙盒**：在隔离环境中运行ReAct代理以限制其潜在影响'
- en: '**Human oversight**: Incorporating human review and approval into the ReAct
    process, especially for critical decisions or actions'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**人工监督**：将人工审查和批准纳入 ReAct 流程，特别是对于关键决策或动作'
- en: '**Safety rules and constraints**: Implementing rules and constraints to prevent
    the agent from taking harmful or unethical actions'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**安全规则和约束**：实施规则和约束以防止代理采取有害或不道德的行动'
- en: '**Monitoring and auditing**: Continuously monitoring the agent’s behavior and
    maintaining logs for auditing purposes'
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**监控和审计**：持续监控代理的行为并维护日志以供审计'
- en: '**Transparency and explainability**: Designing ReAct agents that can explain
    their reasoning and decision-making process to improve understanding and trust'
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**透明度和可解释性**：设计 ReAct 代理，使其能够解释其推理和决策过程，以提高理解和信任'
- en: Limitations and future directions
  id: totrans-120
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 局限性和未来方向
- en: 'While ReAct is a powerful framework, it has certain limitations:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然 ReAct 是一个强大的框架，但它有一定的局限性：
- en: '**Dependency on external tools**: ReAct’s effectiveness is partly dependent
    on the capabilities and reliability of the external tools it uses'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**对外部工具的依赖**：ReAct 的有效性部分取决于它所使用的工具的能力和可靠性'
- en: '**Error propagation**: Errors in tool use or interpretation of observations
    can propagate through the reasoning process, leading to incorrect conclusions
    or actions'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**错误传播**：工具使用或观察解释中的错误可能会在推理过程中传播，导致得出错误结论或采取错误行动'
- en: '**Token limitations**: The iterative nature of ReAct can lead to long sequences
    of text, potentially exceeding the token limits of some LLMs'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标记限制**：ReAct 的迭代性质可能导致文本序列过长，可能超过某些大型语言模型（LLMs）的标记限制'
- en: '**Computational cost**: Multiple rounds of reasoning, action, and observation
    can be computationally expensive, especially when using LLMs or complex tools'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**计算成本**：多轮推理、动作和观察可能具有很高的计算成本，尤其是在使用 LLMs 或复杂工具时'
- en: '**Prompt engineering challenges**: Designing effective ReAct prompts that properly
    guide the LLM’s reasoning and action selection can be challenging and may require
    experimentation'
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**提示工程挑战**：设计有效的 ReAct 提示，以正确引导 LLM 的推理和动作选择可能具有挑战性，可能需要进行实验'
- en: '*Figure 22**.1* shows the limitations of ReAct pattern:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 22*.1 显示了 ReAct 模式的局限性：'
- en: '![Figure 22.1 – Limitations of the ReAct pattern](img/B31249_22_01.jpg)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![图 22.1 – ReAct 模式的局限性](img/B31249_22_01.jpg)'
- en: Figure 22.1 – Limitations of the ReAct pattern
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 图 22.1 – ReAct 模式的局限性
- en: 'However, by combining the power of LLMs with the ability to take actions and
    incorporate external information, ReAct provides new possibilities for creating
    more capable and versatile AI systems:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，通过结合 LLMs 的力量和采取行动以及整合外部信息的能力，ReAct 为创建更强大和通用的 AI 系统提供了新的可能性：
- en: '**Improved tool integration**: Developing more seamless and robust methods
    for integrating LLMs with external tools'
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**改进的工具集成**：开发更无缝和稳健的方法来集成 LLMs 与外部工具'
- en: '**Enhanced reasoning capabilities**: Combining ReAct with other advanced reasoning
    techniques, such as ToT, to handle more complex scenarios'
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**增强推理能力**：将 ReAct 与其他高级推理技术（如 ToT）相结合，以处理更复杂的场景'
- en: '**Learning from experience**: Enabling ReAct agents to learn from their past
    interactions and improve their performance over time'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**从经验中学习**：使 ReAct 代理能够从过去的交互中学习并随着时间的推移提高其性能'
- en: '**Multi-agent ReAct**: Exploring scenarios where multiple ReAct agents collaborate
    or compete to solve problems'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**多代理 ReAct**：探索多个 ReAct 代理协作或竞争以解决问题的场景'
- en: '**Real-world deployment**: Moving beyond simulated environments and deploying
    ReAct agents in real-world applications with the appropriate safety and control
    mechanisms'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**现实世界部署**：超越模拟环境，将 ReAct 代理部署到具有适当安全和控制机制的现实中应用'
- en: Summary
  id: totrans-136
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 概述
- en: In this chapter, you learned about the ReAct framework, a powerful technique
    for prompting your LLMs to not only reason through complex scenarios but also
    plan and simulate the execution of actions, similar to how humans operate in the
    real world.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你学习了 ReAct 框架，这是一种强大的技术，可以提示你的 LLMs 不仅能够通过复杂场景进行推理，还能规划和模拟动作的执行，类似于人类在现实世界中的操作。
- en: The ReAct framework represents a significant advancement in the development
    of intelligent agents that can reason, plan, and interact with their environment.
    ReAct can also be considered a precursor to more advanced frameworks such as **Reasoning
    WithOut Observation** (**ReWOO**), something we’ll explore in the next chapter.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: ReAct框架代表了在开发能够推理、规划和与环境交互的智能代理方面的重大进步。ReAct也可以被视为更高级框架如**无需观察的推理**（**ReWOO**）的先驱，我们将在下一章中探讨这一点。
