# 前言

技术文献中常常充斥着冗长的代码列表、肤浅的解释和几乎触及不到表面概念。这本书正是有意偏离这种趋势。在这里，你不仅能找到代码，还能找到上下文——解释、理由和实用示例，这些内容将带你超越图书馆文档所能提供的内容。

为什么选择 spaCy？spaCy 是当今最强大和最通用的 NLP 库之一。它因其速度、易用性和适应广泛应用的灵活性而备受瞩目，从学术研究到企业级解决方案。但 spaCy 的真正潜力只有在超越基本使用并深入其架构、功能和可扩展性时才能得到释放。本书旨在成为你在这一旅程中的指南。

本书与众不同的地方在于其对现实应用性的关注。从一开始，我们就将专注于创建具体的 NLP 工作流程和组件，处理诸如句法解析、语义分析和训练自定义**命名实体识别**（`NER`）模型等任务。你不仅将学习如何使用 spaCy 的核心功能，还将学习如何整合**大型语言模型**（`LLMs`）和使用最新的数据和管理模型工具。

不论你是经验丰富的数据科学家还是 NLP 爱好者，本书旨在使复杂主题变得易于理解、引人入胜——最重要的是——实用。我们将一步步介绍 spaCy 的功能，并将它们转化为你可以应用于自己项目的可操作技能。

# 本书面向的对象

本书非常适合数据科学家、NLP 开发者和渴望掌握 spaCy 以应用于高级 NLP 应用的开发者。你应该对 NLP 概念和 Python 编程有基本的了解。本书结束时，你将能够构建高效且具有影响力的 NLP 解决方案，无论是提升现有技能还是首次踏入高级 NLP 的世界。

# 本书涵盖的内容

*第一章* ，*spaCy 入门*，涵盖了库的概述、如何安装它，以及如何使用 displaCy 可视化文本。

*第二章* ，*spaCy 核心操作*，涵盖了 spaCy 处理管道的基本知识。我们将深入探讨`Tokenizer`，通常是我们的文本处理管道的第一个组件。我们还将了解 spaCy 的主要容器，如`Doc`、`Token`和`Span`。

*第三章* ，*提取语言特征*，涵盖了（不出所料）语言特征。我们将学习如何使用 spaCy 的词性标注和依存句法标注来分析和提取文本信息。

*第四章* ，*掌握基于规则的匹配*，探讨了如何使用语言特征通过 spaCy 的匹配器和`SpanRuler`组件创建提取模块。

*第五章* ，*使用 spaCy 管道提取语义表示*，介绍了如何使用您在*第三章*和*第四章*中学到的所有知识进行话语的语义解析，创建您的第一个自定义 spaCy 管道组件以提取文本的意图。

*第六章* ，*使用 spaCy 与 Transformers*，教您如何使用`spacy-transformers`训练自定义 spaCy 组件。在本章中，您将了解 spaCy 配置文件和 spaCy 的 CLI，这些对于维护和重现 NLP 管道非常有用。

*第七章* ，*使用 spacy-llm 增强 NLP 任务*，介绍了如何在 NLP 管道中使用 LLMs（大型语言模型）与`spacy-llm`。

*第八章* ，*使用您自己的数据训练 NER 组件*，将重点介绍如何标记您自己的数据以训练 NER 组件。我们将看到如何准备数据，并了解标注工具，包括来自 spaCy 背后的团队 Explosion 的标注工具 Prodigy。

*第九章* ，*使用 Weasel 创建端到端 spaCy 工作流程*，介绍了如何使用 Weasel，这是一个帮助我们创建可重复和结构良好的项目工作流程的工具。我们还将看到如何使用 DVC Studio 来管理模型。DVC 是另一个用于数据/模型版本控制和实验跟踪的酷开源项目。

*第十章* ，*使用 spaCy 训练实体链接模型*，涵盖了 NLP 中的实体链接任务以及创建高质量 NLP 训练数据集的最佳实践。您还将学习如何使用自定义语料库读取器来训练 spaCy 组件。

*第十一章* ，*将 spaCy 与第三方库集成*，介绍了如何将 spaCy 项目与 Streamlit 集成以构建美观的 Web 界面，以及与 FastAPI 集成以构建 NLP 模型的 API。

# 为了充分利用这本书

首先，您需要在您的系统上安装并运行 Python 3。所有代码示例都使用 spaCy v3.7。对于辅助库，如 pandas，可以使用`pip`上可用的最新版本。

| **本书涵盖的软件/硬件` | `操作系统要求** |
| --- | --- |
| Python >= 3.12 | Windows, macOS, 或 Linux |
| spaCy v3.7 |
| spacy-transformers == 1.3.5 |
| spacy-streamlit >= 1.0.6 |
| FastAPI >= 0.112.0 |

**如果您使用的是这本书的数字版，我们建议您亲自输入代码或从书的 GitHub 仓库（下一节中有一个链接）获取代码。这样做将帮助您避免与代码复制粘贴相关的任何潜在错误。**

# 下载示例代码文件

您可以从 GitHub 下载本书的示例代码文件 [`github.com/PacktPublishing/Mastering-spaCy-Second-Edition`](https://github.com/PacktPublishing/Mastering-spaCy-Second-Edition) 。如果代码有更新，它将在 GitHub 仓库中更新。

我们还有其他来自我们丰富的图书和视频目录的代码包可供选择，请访问 [`github.com/PacktPublishing/`](https://github.com/PacktPublishing/) 。查看它们！

# 使用的约定

本书使用了多种文本约定。

**文本中的代码**：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter/X 用户名。以下是一个示例：“spaCy 标记器的输入是 Unicode 文本，结果是`Doc`对象。”

代码块设置如下：

```py
import spacy
nlp = spacy.load("en_core_web_md")
doc = nlp("It's been a crazy week!!!")
print([token.text for token in doc])
```

任何命令行输入或输出都应如下编写：

```py
python3 -m pip install dvc dvc_gdrive
```

**粗体**：表示新术语、重要单词或屏幕上看到的单词。例如，菜单或对话框中的单词以**粗体**显示。以下是一个示例：“确定句子边界比标记化更复杂。因此，spaCy 使用**依存句法分析器**进行句子分割。”

小贴士或重要注意事项

看起来是这样的。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**：如果您对本书的任何方面有疑问，请通过电子邮件发送给我们 customercare@packtpub.com，并在邮件主题中提及书名。

**勘误**：尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，我们将不胜感激，如果您能向我们报告这一点。请访问 [www.packtpub.com/support/errata](http://www.packtpub.com/support/errata) 并填写表格。

**盗版**：如果您在互联网上遇到我们作品的任何形式的非法副本，如果您能提供位置地址或网站名称，我们将不胜感激。请通过电子邮件发送给我们 copyright@packt.com，并提供材料的链接。

**如果您有兴趣成为作者**：如果您在某个主题上具有专业知识，并且您有兴趣撰写或为本书做出贡献，请访问 [authors.packtpub.com](http://authors.packtpub.com) 。

# 分享您的想法

读完 *Mastering spaCy* 后，我们非常乐意听到您的想法！请 [点击此处直接进入此书的亚马逊评论页面](https://packt.link/r/1835880479) 并分享您的反馈。

您的评论对我们和科技社区都至关重要，并将帮助我们确保我们提供高质量的内容。

# 下载本书的免费 PDF 副本

感谢您购买本书！

您喜欢在路上阅读，但无法携带您的印刷书籍到处走？

您的电子书购买是否与您选择的设备不兼容？

别担心，现在每购买一本 Packt 书籍，你都可以免费获得该书的 DRM-free PDF 版本。

在任何地方、任何设备上阅读。直接从你喜欢的技术书籍中搜索、复制和粘贴代码到你的应用程序中。

优惠远不止于此，你还可以获得独家折扣、时事通讯和每日免费内容的访问权限。

按照以下简单步骤获取优惠：

1.  扫描下面的二维码或访问以下链接![img](img/B22441_QR_Free_PDF.jpg)

[`packt.link/free-ebook/978-1-83588-046-3`](https://packt.link/free-ebook/978-1-83588-046-3)

1.  提交你的购买证明

1.  就这些！我们将直接将你的免费 PDF 和其他优惠发送到你的邮箱。

# 第一部分：spaCy 入门

本节将介绍使用 spaCy 的**自然语言处理**（`NLP`）的基础知识，并指导你完成设置环境的初始步骤。你将从学习 spaCy 的核心功能开始，包括其处理管道和数据结构，为后续更高级的主题提供坚实的基础。

本部分包含以下章节：

+   *第一章* ，*spaCy 入门*

+   *第二章* ，*使用 spaCy 进行核心操作*
