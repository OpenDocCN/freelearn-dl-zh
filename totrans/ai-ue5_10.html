<html><head></head><body>
  <div id="_idContainer182">
   <h1 class="chapter-number" id="_idParaDest-196">
    <a id="_idTextAnchor198">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     10
    </span>
   </h1>
   <h1 id="_idParaDest-197">
    <a id="_idTextAnchor199">
    </a>
    <span class="koboSpan" id="kobo.2.1">
     Improving Agents with the Perception System
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.3.1">
     The AI
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.4.1">
      Perception System
     </span>
    </strong>
    <span class="koboSpan" id="kobo.5.1">
     is a powerful
    </span>
    <a id="_idIndexMarker501">
    </a>
    <span class="koboSpan" id="kobo.6.1">
     tool in the Unreal Engine Gameplay Framework, as it allows AI-controlled actors to perceive and react to various stimuli in an environment.
    </span>
    <span class="koboSpan" id="kobo.6.2">
     It provides a way for AI agents to become aware of the presence of other actors – such as players or enemies – through different senses such as sight, hearing, or touch.
    </span>
    <span class="koboSpan" id="kobo.6.3">
     By properly configuring and using the Perception System, developers can create AI agents that respond appropriately to events in their surroundings.
    </span>
    <span class="koboSpan" id="kobo.6.4">
     What’s more, this system allows developers to implement and configure custom senses tailored to their game’s specific needs.
    </span>
    <span class="koboSpan" id="kobo.6.5">
     This flexibility enables developers to create unique and engaging
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.7.1">
      AI experiences.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.8.1">
     In this chapter, we will be covering the main components of the Unreal Engine Perception System, starting with a bit of theory and then applying this newly acquired knowledge to a real-world example.
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.9.1">
     In this chapter, we will be covering the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.10.1">
      following topics:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.11.1">
      Presenting the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.12.1">
       Perception System
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.13.1">
      Adding perception to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.14.1">
       an agent
      </span>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.15.1">
       Debugging perception
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.16.1">
      Creating
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.17.1">
       perception stimuli
      </span>
     </span>
    </li>
   </ul>
   <h1 id="_idParaDest-198">
    <a id="_idTextAnchor200">
    </a>
    <span class="koboSpan" id="kobo.18.1">
     Technical requirements
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.19.1">
     To follow along with the topics presented in this chapter, you should have completed the previous ones and understood
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.20.1">
      their content.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.21.1">
     Additionally, if you would prefer to begin with code from the companion repository for this book, you can download the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.22.1">
      .zip
     </span>
    </strong>
    <span class="koboSpan" id="kobo.23.1">
     project files provided in this book’s companion project
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.24.1">
      repository:
     </span>
    </span>
    <a href="https://github.com/PacktPublishing/Artificial-Intelligence-in-Unreal-Engine-5">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.25.1">
       https://github.com/PacktPublishing/Artificial-Intelligence-in-Unreal-Engine-5
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.26.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.27.1">
     To download the files from the end of the last chapter, click the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.28.1">
      Unreal Agility Arena –
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.29.1">
       Chapter 09
      </span>
     </strong>
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.30.1">
      -
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.31.1">
       End
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.32.1">
      link.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-199">
    <a id="_idTextAnchor201">
    </a>
    <span class="koboSpan" id="kobo.33.1">
     Presenting the Perception System
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.34.1">
     Dr.
    </span>
    <span class="koboSpan" id="kobo.34.2">
     Markus and Professor Viktoria
    </span>
    <a id="_idIndexMarker502">
    </a>
    <span class="koboSpan" id="kobo.35.1">
     seem to have a new chapter in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.36.1">
      their story:
     </span>
    </span>
   </p>
   <p>
    <em class="italic">
     <span class="koboSpan" id="kobo.37.1">
      Dr.
     </span>
     <span class="koboSpan" id="kobo.37.2">
      Markus and Professor Viktoria knew that allowing sophisticated synthetic beings such as their AI dummy puppets to roam unchecked could prove disastrous.
     </span>
     <span class="koboSpan" id="kobo.37.3">
      Therefore, they started working tirelessly to develop an intricate network of hidden security cameras that could monitor the movements and actions of their creations at all times.
     </span>
     <span class="koboSpan" id="kobo.37.4">
      With this vigilant surveillance system in place, they hoped to keep them under strict observation and maintain full control, ensuring the safety of their
     </span>
    </em>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.38.1">
       controversial research.
      </span>
     </em>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.39.1">
     One of the key components when creating intelligent and reactive AI agents in Unreal Engine is the AI Perception System; this powerful system allows AI controllers – and, consequently, AI agents – to perceive and respond to different stimuli in their
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.40.1">
      virtual environment.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.41.1">
     At the core of the AI Perception
    </span>
    <a id="_idIndexMarker503">
    </a>
    <span class="koboSpan" id="kobo.42.1">
     System are
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.43.1">
      senses
     </span>
    </strong>
    <span class="koboSpan" id="kobo.44.1">
     and
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.45.1">
      stimuli
     </span>
    </strong>
    <span class="koboSpan" id="kobo.46.1">
     .
    </span>
    <span class="koboSpan" id="kobo.46.2">
     A sense – such as sight or hearing – represents
    </span>
    <a id="_idIndexMarker504">
    </a>
    <span class="koboSpan" id="kobo.47.1">
     a way for an AI agent to perceive its surroundings and is configured to detect specific types of stimuli, which are sources of perception data emanating from other actors in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.48.1">
      game world.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.49.1">
     As an example,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.50.1">
      sight sense
     </span>
    </em>
    <span class="koboSpan" id="kobo.51.1">
     is preconfigured to detect any visible pawn actors, while
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.52.1">
      damage sense
     </span>
    </em>
    <span class="koboSpan" id="kobo.53.1">
     triggers when the associated AI controller’s pawn takes damage from an
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.54.1">
      external source.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.55.1">
     Note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.56.1">
     As a developer, you can create custom senses tailored to your game’s specific needs by extending the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.57.1">
      AISense
     </span>
    </strong>
    <span class="koboSpan" id="kobo.58.1">
     class, if you are working with C++, or the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.59.1">
      AISense_Blueprint
     </span>
    </strong>
    <span class="koboSpan" id="kobo.60.1">
     class, if you are working
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.61.1">
      with Blueprints.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-200">
    <a id="_idTextAnchor202">
    </a>
    <span class="koboSpan" id="kobo.62.1">
     AI Perception System components
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.63.1">
     The AI Perception System
    </span>
    <a id="_idIndexMarker505">
    </a>
    <span class="koboSpan" id="kobo.64.1">
     consists of the following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.65.1">
      main classes:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.66.1">
       AIPerceptionSystem
      </span>
     </strong>
     <span class="koboSpan" id="kobo.67.1">
      : This is the core manager that keeps track of all AI
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.68.1">
       stimuli sources.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.69.1">
       AIPerceptionComponent
      </span>
     </strong>
     <span class="koboSpan" id="kobo.70.1">
      : This represents the AI agent’s mind and handles processing perceived stimuli.
     </span>
     <span class="koboSpan" id="kobo.70.2">
      It needs to be attached to an AI controller to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.71.1">
       properly work.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.72.1">
       AIPerceptionStimuliSourceComponent
      </span>
     </strong>
     <span class="koboSpan" id="kobo.73.1">
      : This component is added to actors that can generate stimuli and is in charge of broadcasting perception data to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.74.1">
       listening elements.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.75.1">
       AIPerceptionSenseConfig
      </span>
     </strong>
     <span class="koboSpan" id="kobo.76.1">
      : This defines the properties of a specific sense, what actors can be perceived, and how perception decays over time
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.77.1">
       or distance.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.78.1">
     When an actor with
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.79.1">
      AIPerceptionStimuliSourceComponent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.80.1">
     generates a stimulus, nearby
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.81.1">
      AIPerceptionComponents
     </span>
    </strong>
    <span class="koboSpan" id="kobo.82.1">
     detect it through their configured senses.
    </span>
    <span class="koboSpan" id="kobo.82.2">
     This perceived data is then processed by the AI controller to trigger
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.83.1">
      desired behaviors.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.84.1">
     Once you have added
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.85.1">
      AIPerceptionComponent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.86.1">
     to an AI controller, you will need to add one or more
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.87.1">
      AIPerceptionSenseConfig
     </span>
    </strong>
    <span class="koboSpan" id="kobo.88.1">
     elements in order to give your AI agent dedicated senses.
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.89.1">
       Figure 10
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.90.1">
      .1
     </span>
    </em>
    <span class="koboSpan" id="kobo.91.1">
     shows an example where perception is based
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.92.1">
      on touch:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer170">
     <span class="koboSpan" id="kobo.93.1">
      <img alt="Figure 10.1 – The touch sense config" src="image/Figure_10.1_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.94.1">
     Figure 10.1 – The touch sense config
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.95.1">
     From the previous screenshot, you may have noticed a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.96.1">
      Dominant Sense
     </span>
    </strong>
    <span class="koboSpan" id="kobo.97.1">
     property; this property allows you to designate a specific sense that takes priority over others when determining the location of a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.98.1">
      sensed actor.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.99.1">
     Let’s explore the
    </span>
    <a id="_idIndexMarker506">
    </a>
    <span class="koboSpan" id="kobo.100.1">
     available sense configs that, as mentioned earlier, define the properties of each
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.101.1">
      specific sense:
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-201">
    <a id="_idTextAnchor203">
    </a>
    <span class="koboSpan" id="kobo.102.1">
     AIPerceptionSenseConfig types
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.103.1">
     Unreal Engine offers
    </span>
    <a id="_idIndexMarker507">
    </a>
    <span class="koboSpan" id="kobo.104.1">
     a range of predefined
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.105.1">
      AIPerceptionSenseConfig
     </span>
    </strong>
    <span class="koboSpan" id="kobo.106.1">
     classes that are highly likely to meet your specific requirements.
    </span>
    <span class="koboSpan" id="kobo.106.2">
     Let’s take a look at the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.107.1">
      available options:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.108.1">
       AIDamag
      </span>
     </strong>
     <span class="koboSpan" id="kobo.109.1">
      e: Use this configuration if your AI agent needs to respond to damage events such as
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.110.1">
       Any Damage
      </span>
     </em>
     <span class="koboSpan" id="kobo.111.1">
      ,
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.112.1">
       Point Damage
      </span>
     </em>
     <span class="koboSpan" id="kobo.113.1">
      , or
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.114.1">
        Radial Damage
       </span>
      </em>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.115.1">
       AIHearing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.116.1">
      : Use this configuration if you need to detect sounds generated in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.117.1">
       surrounding environment
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.118.1">
       AIPrediction
      </span>
     </strong>
     <span class="koboSpan" id="kobo.119.1">
      : Use this configuration when you need to predict the target actor location in the next
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.120.1">
       few moments
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.121.1">
       AISight
      </span>
     </strong>
     <span class="koboSpan" id="kobo.122.1">
      : Use this configuration when you want your AI agent to see things in
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.123.1">
       the level
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.124.1">
       AITeam
      </span>
     </strong>
     <span class="koboSpan" id="kobo.125.1">
      : Use this configuration if you want to notify the AI agent that some ally
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.126.1">
       is nearby
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.127.1">
       AITouch
      </span>
     </strong>
     <span class="koboSpan" id="kobo.128.1">
      : Use this configuration when the AI agent touches some other actor or, vice versa, when something is touching the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.129.1">
       AI agent
      </span>
     </span>
    </li>
   </ul>
   <h2 id="_idParaDest-202">
    <a id="_idTextAnchor204">
    </a>
    <span class="koboSpan" id="kobo.130.1">
     Stimuli source
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.131.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.132.1">
      AIPerceptionStimuliSourceComponent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.133.1">
     class allows an actor to register itself as a source
    </span>
    <a id="_idIndexMarker508">
    </a>
    <span class="koboSpan" id="kobo.134.1">
     of stimuli for one or more senses.
    </span>
    <span class="koboSpan" id="kobo.134.2">
     For instance, you can register an actor as a stimuli source for sight.
    </span>
    <span class="koboSpan" id="kobo.134.3">
     This registration allows an AI agent to visually perceive the actor in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.135.1">
      game level.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.136.1">
     A stimuli source can be registered – or unregistered – for a sense, making it detectable – or undetectable – by the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.137.1">
      Perception System.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.138.1">
     Note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.139.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.140.1">
      Pawn
     </span>
    </strong>
    <span class="koboSpan" id="kobo.141.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.142.1">
      Character
     </span>
    </strong>
    <span class="koboSpan" id="kobo.143.1">
     classes in Unreal Engine are inherently visible to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.144.1">
      AISight
     </span>
    </strong>
    <span class="koboSpan" id="kobo.145.1">
     perception due to their default behavior as stimuli sources.
    </span>
    <span class="koboSpan" id="kobo.145.2">
     This design choice streamlines AI behavior development by eliminating the need to manually configure visibility for each character or pawn.
    </span>
    <span class="koboSpan" id="kobo.145.3">
     However, if you want the AI to ignore specific characters, you’ll need to take additional steps to configure
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.146.1">
      them accordingly.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.147.1">
     In this section, we were introduced to the Perception System and its main elements.
    </span>
    <span class="koboSpan" id="kobo.147.2">
     In the next section, we
    </span>
    <a id="_idIndexMarker509">
    </a>
    <span class="koboSpan" id="kobo.148.1">
     will work on a fully functional AI agent that will let you sense other actors in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.149.1">
      your game.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-203">
    <a id="_idTextAnchor205">
    </a>
    <span class="koboSpan" id="kobo.150.1">
     Adding perception to an agent
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.151.1">
     In this section, we will
    </span>
    <a id="_idIndexMarker510">
    </a>
    <span class="koboSpan" id="kobo.152.1">
     create a new AI agent that will use the Perception System.
    </span>
    <span class="koboSpan" id="kobo.152.2">
     We will create a security camera that will probe nearby surrounding areas, looking for some possible targets for the dummy gunner that we created in
    </span>
    <a href="B31016_09.xhtml#_idTextAnchor170">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.153.1">
        Chapter 9
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.154.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.155.1">
      Extending Behavior Trees
     </span>
    </em>
    <span class="koboSpan" id="kobo.156.1">
     .
    </span>
    <span class="koboSpan" id="kobo.156.2">
     Think of it as some kind of infrared camera for a dark environment.
    </span>
    <span class="koboSpan" id="kobo.156.3">
     Once the camera spots a target, it will tag it so that the gunner will be able to locate it in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.157.1">
      the environment.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.158.1">
     We will start by creating an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.159.1">
      Actor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.160.1">
     class that will be used as the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.161.1">
      camera model.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-204">
    <a id="_idTextAnchor206">
    </a>
    <span class="koboSpan" id="kobo.162.1">
     Creating the BaseSecurityCam class
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.163.1">
     Even though we
    </span>
    <a id="_idIndexMarker511">
    </a>
    <span class="koboSpan" id="kobo.164.1">
     will be
    </span>
    <a id="_idIndexMarker512">
    </a>
    <span class="koboSpan" id="kobo.165.1">
     implementing the Perception System inside the AI controller, a nice model to display in the level will help your environment’s look and feel, so let’s start by creating a new C++ class, extending from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.166.1">
      Pawn
     </span>
    </strong>
    <span class="koboSpan" id="kobo.167.1">
     class and named
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.168.1">
      BaseSecurityCam
     </span>
    </strong>
    <span class="koboSpan" id="kobo.169.1">
     .
    </span>
    <span class="koboSpan" id="kobo.169.2">
     Once the class has been created, open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.170.1">
      BaseSecurityCam.h
     </span>
    </strong>
    <span class="koboSpan" id="kobo.171.1">
     file and add the following forward declaration after the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.172.1">
      #
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.173.1">
       include
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.174.1">
      declarations:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.175.1">
class UAIPerceptionComponent;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.176.1">
     Then, make the class a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.177.1">
      Blueprintable
     </span>
    </strong>
    <span class="koboSpan" id="kobo.178.1">
     one by changing the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.179.1">
      UCLASS()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.180.1">
     macro to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.181.1">
      the following:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.182.1">
UCLASS(Blueprintable)</span></pre>
   <p>
    <span class="koboSpan" id="kobo.183.1">
     After that, remove the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.184.1">
      BeginPlay()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.185.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.186.1">
      Tick()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.187.1">
     declarations, as we won’t be
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.188.1">
      using them.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.189.1">
     As a final step, add the following component declarations for the static meshes that will display the model just after the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.190.1">
       GENERATED_BODY()
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.191.1">
      macro:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.192.1">
UPROPERTY(VisibleAnywhere, BlueprintReadOnly, Category="Security Cam",   meta=(AllowPrivateAccess="true"))
   UStaticMeshComponent* SupportMeshComponent;
UPROPERTY(VisibleAnywhere, BlueprintReadOnly, Category="Security Cam",   meta=(AllowPrivateAccess="true"))
UStaticMeshComponent* CamMeshComponent;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.193.1">
     You can
    </span>
    <a id="_idIndexMarker513">
    </a>
    <span class="koboSpan" id="kobo.194.1">
     now
    </span>
    <a id="_idIndexMarker514">
    </a>
    <span class="koboSpan" id="kobo.195.1">
     open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.196.1">
      BaseSecurityCam.cpp
     </span>
    </strong>
    <span class="koboSpan" id="kobo.197.1">
     file to implement this class; as a first step, remove the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.198.1">
      BeginPlay()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.199.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.200.1">
      Tick()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.201.1">
     functions.
    </span>
    <span class="koboSpan" id="kobo.201.2">
     Then, locate the constructor and change this line
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.202.1">
      of code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.203.1">
PrimaryActorTick.bCanEverTick = true;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.204.1">
     Change it
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.205.1">
      to this:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.206.1">
PrimaryActorTick.bCanEverTick = false;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.207.1">
     Now, inside the constructor and just after the aforementioned line of code, add the following block
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.208.1">
      of code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.209.1">
SupportMeshComponent = CreateDefaultSubobject&lt;UStaticMeshComponent&gt;(TEXT("Support Mesh"));
RootComponent = SupportMeshComponent;
static ConstructorHelpers::FObjectFinder&lt;UStaticMesh&gt; SupportStaticMeshAsset(
    TEXT("/Game/_GENERATED/MarcoSecchi/SM_SecurityCam_Base.SM_SecurityCam_Base"));
if (SupportStaticMeshAsset.Succeeded())
{
    SupportMeshComponent-&gt;SetStaticMesh(SupportStaticMeshAsset.Object);
}
CamMeshComponent = CreateDefaultSubobject&lt;UStaticMeshComponent&gt;(TEXT("Cam Mesh"));
CamMeshComponent-&gt;SetRelativeLocation(FVector(61.f, 0.f, -13.f));
CamMeshComponent-&gt;SetupAttachment(RootComponent);
static ConstructorHelpers::FObjectFinder&lt;UStaticMesh&gt;   CamStaticMeshAsset(
    TEXT("/Game/_GENERATED/MarcoSecchi/SM_SecurityCam.SM_SecurityCam"));
if (CamStaticMeshAsset.Succeeded())
{
    CamMeshComponent-&gt;SetStaticMesh(CamStaticMeshAsset.Object);
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.210.1">
     You already know all about this from the previous chapters of the book, so I suppose there’s no need to explain it again.
    </span>
    <span class="koboSpan" id="kobo.210.2">
     With the security camera model created, we can now implement the
    </span>
    <a id="_idIndexMarker515">
    </a>
    <span class="koboSpan" id="kobo.211.1">
     corresponding
    </span>
    <a id="_idIndexMarker516">
    </a>
    <span class="koboSpan" id="kobo.212.1">
     AI controller, along with its
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.213.1">
      perception sense.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-205">
    <a id="_idTextAnchor207">
    </a>
    <span class="koboSpan" id="kobo.214.1">
     Creating the BaseSecurityCamAIController class
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.215.1">
     To add a proper
    </span>
    <a id="_idIndexMarker517">
    </a>
    <span class="koboSpan" id="kobo.216.1">
     controller
    </span>
    <a id="_idIndexMarker518">
    </a>
    <span class="koboSpan" id="kobo.217.1">
     for the security camera, let’s create a C++ class extending
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.218.1">
      AIController
     </span>
    </strong>
    <span class="koboSpan" id="kobo.219.1">
     and name it
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.220.1">
      BaseSecurityCamAIController
     </span>
    </strong>
    <span class="koboSpan" id="kobo.221.1">
     .
    </span>
    <span class="koboSpan" id="kobo.221.2">
     Once the class has been created, open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.222.1">
      BaseSecurityCamAIController.h
     </span>
    </strong>
    <span class="koboSpan" id="kobo.223.1">
     file and add the following forward declarations, just after the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.224.1">
      #
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.225.1">
       include
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.226.1">
      declarations:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.227.1">
struct FAIStimulus;
struct FActorPerceptionUpdateInfo;
class UBehaviorTree;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.228.1">
     Then, make the class
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.229.1">
      Blueprintable
     </span>
    </strong>
    <span class="koboSpan" id="kobo.230.1">
     by changing the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.231.1">
      UCLASS()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.232.1">
     macro to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.233.1">
      the following:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.234.1">
UCLASS(Blueprintable)</span></pre>
   <p>
    <span class="koboSpan" id="kobo.235.1">
     After that, add this block of code just after the already existing
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.236.1">
      constructor declaration:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.237.1">
protected:
    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Dummy AI Controller")
    TObjectPtr&lt;UBehaviorTree&gt; BehaviorTree;
   virtual void OnPossess(APawn* InPawn) override;
    UFUNCTION()
    void OnTargetPerceptionUpdate(AActor* Actor, FAIStimulus       Stimulus);</span></pre>
   <p>
    <span class="koboSpan" id="kobo.238.1">
     You are already familiar with the behavior tree property and the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.239.1">
      OnPosses()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.240.1">
     function from
    </span>
    <a href="B31016_08.xhtml#_idTextAnchor148">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.241.1">
        Chapter 8
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.242.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.243.1">
      Setting Up a Behavior Tree
     </span>
    </em>
    <span class="koboSpan" id="kobo.244.1">
     ; in addition, the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.245.1">
      OnTargetPerceptionUpdate()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.246.1">
     function will be used as an event handler when getting information from the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.247.1">
      Perception System.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.248.1">
     You can now open
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.249.1">
      BaseSecurityCamAIController.cpp
     </span>
    </strong>
    <span class="koboSpan" id="kobo.250.1">
     and add the following
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.251.1">
      #include
     </span>
    </strong>
    <span class="koboSpan" id="kobo.252.1">
     declarations to the top of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.253.1">
      the file:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.254.1">
#include "Perception/AIPerceptionComponent.h"
#include "Perception/AISenseConfig_Sight.h"</span></pre>
   <p>
    <span class="koboSpan" id="kobo.255.1">
     Now, locate the constructor, and inside of it, add the following block
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.256.1">
      of code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.257.1">
const auto SenseConfig_Sight = CreateDefaultSubobject&lt;UAISenseConfig_  Sight&gt;("SenseConfig_Sight");
SenseConfig_Sight-&gt;SightRadius = 1600.f;
SenseConfig_Sight-&gt;LoseSightRadius = 3000.f;
SenseConfig_Sight-&gt;PeripheralVisionAngleDegrees = 45.0f;
SenseConfig_Sight-&gt;DetectionByAffiliation.bDetectEnemies = true;
SenseConfig_Sight-&gt;DetectionByAffiliation.bDetectNeutrals = true;
SenseConfig_Sight-&gt;DetectionByAffiliation.bDetectFriendlies = true;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.258.1">
     As you can see, we
    </span>
    <a id="_idIndexMarker519">
    </a>
    <span class="koboSpan" id="kobo.259.1">
     are
    </span>
    <a id="_idIndexMarker520">
    </a>
    <span class="koboSpan" id="kobo.260.1">
     creating the sense config for the sight perception, along with some of its properties, such as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.261.1">
      SightRadius
     </span>
    </strong>
    <span class="koboSpan" id="kobo.262.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.263.1">
      LoseSightRadius
     </span>
    </strong>
    <span class="koboSpan" id="kobo.264.1">
     , which will determine the distance at which the Perception System can detect something and the distance at which detection will be lost, respectively.
    </span>
    <span class="koboSpan" id="kobo.264.2">
     As redundant as these two attributes may seem, keep in mind that, once a target has been detected, it will be more difficult to lose perception of it, unless both attributes have the same value.
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.265.1">
      PeripheralVisionAngleDegrees
     </span>
    </strong>
    <span class="koboSpan" id="kobo.266.1">
     will handle the cone that will be used to check whether an actor is in the line of sight or not.
    </span>
    <span class="koboSpan" id="kobo.266.2">
     Lastly, the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.267.1">
      DetectionByAffiliation
     </span>
    </strong>
    <span class="koboSpan" id="kobo.268.1">
     property is used to handle whether the detected actor is an enemy, friend, or neutral; in this case, we want to check all of them in order to detect anything that is in the line
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.269.1">
      of sight.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.270.1">
     Now, it’s time to add the actual perception component, so add the following piece of code just after the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.271.1">
      previous one:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.272.1">
PerceptionComponent = CreateDefaultSubobject&lt;UAIPerceptionComponent&gt;(TEXT("Perception"));
PerceptionComponent-&gt;ConfigureSense(*SenseConfig_Sight);
PerceptionComponent-&gt;SetDominantSense(SenseConfig_Sight-  &gt;GetSenseImplementation());
PerceptionComponent-&gt;OnTargetPerceptionUpdated.AddDynamic(this,   &amp;ABaseSecurityCamAIController::OnTargetPerceptionUpdate);</span></pre>
   <p>
    <span class="koboSpan" id="kobo.273.1">
     As you can see, we create the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.274.1">
      AIPerceptionComponent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.275.1">
     instance, and then we assign the previously created sight configuration.
    </span>
    <span class="koboSpan" id="kobo.275.2">
     Lastly, we register to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.276.1">
      OnTargetPerceptionUpdated
     </span>
    </strong>
    <span class="koboSpan" id="kobo.277.1">
     delegate that will notify the component of any changes detected by the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.278.1">
      Perception System.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.279.1">
     Now, it’s time
    </span>
    <a id="_idIndexMarker521">
    </a>
    <span class="koboSpan" id="kobo.280.1">
     to implement
    </span>
    <a id="_idIndexMarker522">
    </a>
    <span class="koboSpan" id="kobo.281.1">
     the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.282.1">
      OnPosses()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.283.1">
     function, something that we already know how
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.284.1">
      to handle:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.285.1">
void ABaseSecurityCamAIController::OnPossess(APawn* InPawn)
{
    Super::OnPossess(InPawn);
    if (ensureMsgf(BehaviorTree, TEXT("Behavior Tree is nullptr! </span><span class="koboSpan" id="kobo.285.2">Please assign BehaviorTree in your AI Controller.")))
    {
       RunBehaviorTree(BehaviorTree);
    }
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.286.1">
     The last step is to implement the event handler.
    </span>
    <span class="koboSpan" id="kobo.286.2">
     To do so, add the following block
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.287.1">
      of code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.288.1">
void ABaseSecurityCamAIController::OnTargetPerceptionUpdate(AActor* Actor, FAIStimulus Stimulus)
{
    if (Actor-&gt;Tags.Num() &gt; 0) return;
    const auto SightID = UAISense::GetSenseID&lt;UAISense_Sight&gt;();
    if (Stimulus.Type == SightID &amp;&amp; Stimulus.WasSuccessfullySensed())
    {
       Actor-&gt;Tags.Init({}, 1);
       Actor-&gt;Tags[0] = "ShootingTarget";
    }
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.289.1">
     This function
    </span>
    <a id="_idIndexMarker523">
    </a>
    <span class="koboSpan" id="kobo.290.1">
     first checks
    </span>
    <a id="_idIndexMarker524">
    </a>
    <span class="koboSpan" id="kobo.291.1">
     whether the target has already been tagged; in this case, it means that it has already been spotted.
    </span>
    <span class="koboSpan" id="kobo.291.2">
     It then retrieves the ID of the sight sense, calling
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.292.1">
      GetSenseID()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.293.1">
     , and checks whether the stimulus type is equal to the sight sense ID and whether the stimulus was successfully sensed.
    </span>
    <span class="koboSpan" id="kobo.293.2">
     If both conditions are
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.294.1">
      true
     </span>
    </strong>
    <span class="koboSpan" id="kobo.295.1">
     , it initializes the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.296.1">
      Tags
     </span>
    </strong>
    <span class="koboSpan" id="kobo.297.1">
     array, with the first element set to a value of
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.298.1">
      ShootingTarget
     </span>
    </strong>
    <span class="koboSpan" id="kobo.299.1">
     , in order to make it a viable target for the dummy gunner we have at
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.300.1">
      our disposal.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.301.1">
     The security camera is now ready to go; we just need a nice environment to test
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.302.1">
      it on.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.303.1">
     In this section, we’ve shown you how to properly create an AI agent, taking advantage of the Perception System.
    </span>
    <span class="koboSpan" id="kobo.303.2">
     In the next section, we will test this agent and learn how to properly
    </span>
    <a id="_idIndexMarker525">
    </a>
    <span class="koboSpan" id="kobo.304.1">
     debug
    </span>
    <a id="_idIndexMarker526">
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.305.1">
      perception information.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-206">
    <a id="_idTextAnchor208">
    </a>
    <span class="koboSpan" id="kobo.306.1">
     Debugging perception
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.307.1">
     It’s now time to test our
    </span>
    <a id="_idIndexMarker527">
    </a>
    <span class="koboSpan" id="kobo.308.1">
     perception logic and learn how to properly debug the Perception system at runtime.
    </span>
    <span class="koboSpan" id="kobo.308.2">
     In order to do this, we will need to add some small improvements to the base dummy character.
    </span>
    <span class="koboSpan" id="kobo.308.3">
     As previously mentioned, the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.309.1">
      Pawn
     </span>
    </strong>
    <span class="koboSpan" id="kobo.310.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.311.1">
      Character
     </span>
    </strong>
    <span class="koboSpan" id="kobo.312.1">
     classes are already registered with sight stimuli, so we won’t need to implement this logic.
    </span>
    <span class="koboSpan" id="kobo.312.2">
     However, we will need to handle damage, as we will be playing around with both
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.313.1">
      BP_RoamerDummyCharacter
     </span>
    </strong>
    <span class="koboSpan" id="kobo.314.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.315.1">
      BP_GunnerDummyCharacter
     </span>
    </strong>
    <span class="koboSpan" id="kobo.316.1">
     .
    </span>
    <span class="koboSpan" id="kobo.316.2">
     It appears that exciting and enjoyable times are just around
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.317.1">
      the corner!
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-207">
    <a id="_idTextAnchor209">
    </a>
    <span class="koboSpan" id="kobo.318.1">
     Enhancing the roamer behavior tree
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.319.1">
     The first step in
    </span>
    <a id="_idIndexMarker528">
    </a>
    <span class="koboSpan" id="kobo.320.1">
     improving our AI agents
    </span>
    <a id="_idIndexMarker529">
    </a>
    <span class="koboSpan" id="kobo.321.1">
     will be adding some logic to handle damage to the dummy roamer behavior tree.
    </span>
    <span class="koboSpan" id="kobo.321.2">
     In particular, we want the AI agent to sit down when it is hit by a Nerf gun projectile.
    </span>
    <span class="koboSpan" id="kobo.321.3">
     We will start by adding a new key to the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.322.1">
      dedicated Blackboard.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.323.1">
     Improving the Blackboard
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.324.1">
     A new flag is required for
    </span>
    <a id="_idIndexMarker530">
    </a>
    <span class="koboSpan" id="kobo.325.1">
     the Blackboard to effectively monitor and keep a record of the character that has been hit.
    </span>
    <span class="koboSpan" id="kobo.325.2">
     So, open up the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.326.1">
      BB_Dummy
     </span>
    </strong>
    <span class="koboSpan" id="kobo.327.1">
     asset and do
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.328.1">
      the following:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.329.1">
      Click the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.330.1">
       New Key
      </span>
     </strong>
     <span class="koboSpan" id="kobo.331.1">
      button, and from the dropdown menu,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.332.1">
       select
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.333.1">
        Bool
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.334.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.335.1">
      Name the newly created
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.336.1">
       key
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.337.1">
        IsHit
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.338.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.339.1">
     As you already know, this will expose a new key available to the behavior tree; additionally the key will be exposed to the AI controller, as we will see
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.340.1">
      later on.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.341.1">
     Improving the behavior tree
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.342.1">
     The behavior tree
    </span>
    <a id="_idIndexMarker531">
    </a>
    <span class="koboSpan" id="kobo.343.1">
     needs to manage the AI agent being hit; in our case, we want to play a montage with the character sitting down, as it has been eliminated from the game.
    </span>
    <span class="koboSpan" id="kobo.343.2">
     So, let’s start by opening the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.344.1">
      BT_RoamerDummy
     </span>
    </strong>
    <span class="koboSpan" id="kobo.345.1">
     asset and doing
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.346.1">
      the following:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.347.1">
      Right-click on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.348.1">
       Root Sequence
      </span>
     </strong>
     <span class="koboSpan" id="kobo.349.1">
      node and add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.350.1">
       Blackboard
      </span>
     </strong>
     <span class="koboSpan" id="kobo.351.1">
      decorator, naming it
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.352.1">
       Is
      </span>
     </strong>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.353.1">
        Not Hit?
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.354.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.355.1">
      With the decorator selected, do
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.356.1">
       the following:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.357.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.358.1">
         Notify Observer
        </span>
       </strong>
       <span class="koboSpan" id="kobo.359.1">
        attribute to
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.360.1">
         On
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.361.1">
          Value Change
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.362.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.363.1">
         Observer aborts
        </span>
       </strong>
       <span class="koboSpan" id="kobo.364.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.365.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.366.1">
          Self
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.367.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.368.1">
         Key Query
        </span>
       </strong>
       <span class="koboSpan" id="kobo.369.1">
        attribute to
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.370.1">
         Is
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.371.1">
          Not Set
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.372.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.373.1">
         Blackboard Key
        </span>
       </strong>
       <span class="koboSpan" id="kobo.374.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.375.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.376.1">
          IsHit
         </span>
        </strong>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="koboSpan" id="kobo.377.1">
      Rename the root sequence
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.378.1">
       In Game Sequence
      </span>
     </strong>
     <span class="koboSpan" id="kobo.379.1">
      and disconnect it from the
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.380.1">
        ROOT
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.381.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.382.1">
      Add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.383.1">
       Selector
      </span>
     </strong>
     <span class="koboSpan" id="kobo.384.1">
      node to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.385.1">
       ROOT
      </span>
     </strong>
     <span class="koboSpan" id="kobo.386.1">
      node and name it
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.387.1">
        Root Selector
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.388.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.389.1">
      Connect the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.390.1">
       Root Selector
      </span>
     </strong>
     <span class="koboSpan" id="kobo.391.1">
      node to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.392.1">
       In Game
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.393.1">
        Sequence
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.394.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.395.1">
      Connect the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.396.1">
       Root Selector
      </span>
     </strong>
     <span class="koboSpan" id="kobo.397.1">
      node to a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.398.1">
       PlayMontage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.399.1">
      task, and name the newly created node
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.400.1">
       Sit Montage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.401.1">
      .
     </span>
     <span class="koboSpan" id="kobo.401.2">
      This node should be at the right of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.402.1">
       In Game
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.403.1">
        Sequence
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.404.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.405.1">
      With the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.406.1">
       Sit Montage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.407.1">
      node selected, set the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.408.1">
       Anim Montage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.409.1">
      attribute to
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.410.1">
       AM_Sit
      </span>
     </strong>
     <span class="koboSpan" id="kobo.411.1">
      .
     </span>
     <span class="koboSpan" id="kobo.411.2">
      The modified portion of the behavior tree is depicted in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.412.1">
        Figure 10
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.413.1">
        .2
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.414.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer171">
     <span class="koboSpan" id="kobo.415.1">
      <img alt="Figure 10.2 – A modified behavior tree" src="image/Figure_10.2_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.416.1">
     Figure 10.2 – A modified behavior tree
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.417.1">
     As you can see, the behavior tree will keep on working as before, unless the AI agent has been hit; in that
    </span>
    <a id="_idIndexMarker532">
    </a>
    <span class="koboSpan" id="kobo.418.1">
     case, the character will sit down and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.419.1">
      stop wandering.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.420.1">
     It’s now time to improve the AI controller, in order to manage
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.421.1">
      incoming damage.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-208">
    <a id="_idTextAnchor210">
    </a>
    <span class="koboSpan" id="kobo.422.1">
     Enhancing BaseDummyAIController
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.423.1">
     The AI controller for
    </span>
    <a id="_idIndexMarker533">
    </a>
    <span class="koboSpan" id="kobo.424.1">
     any dummy character
    </span>
    <a id="_idIndexMarker534">
    </a>
    <span class="koboSpan" id="kobo.425.1">
     will need to handle any damage.
    </span>
    <span class="koboSpan" id="kobo.425.2">
     We are handling all of this inside the AI controller instead of the character for the sake of simplicity; we will need to communicate with the Blackboard, and this is much simpler and more direct when done from the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.426.1">
      controller itself.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.427.1">
     Let’s start by opening the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.428.1">
      BaseDummyAIController.h
     </span>
    </strong>
    <span class="koboSpan" id="kobo.429.1">
     file and adding the following declaration for the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.430.1">
      damage handler:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.431.1">
UFUNCTION()
void OnPawnDamaged(AActor* DamagedActor, float Damage, const   UDamageType* DamageType, AController* InstigatedBy, AActor*     DamageCauser);</span></pre>
   <p>
    <span class="koboSpan" id="kobo.432.1">
     Now, open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.433.1">
      BaseDummyAIController.cpp
     </span>
    </strong>
    <span class="koboSpan" id="kobo.434.1">
     file, and in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.435.1">
      OnPossess()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.436.1">
     function, add the following line
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.437.1">
      of code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.438.1">
GetPawn()-&gt;OnTakeAnyDamage.AddDynamic(this, &amp;ABaseDummyAIController::OnPawnDamaged);</span></pre>
   <p>
    <span class="koboSpan" id="kobo.439.1">
     Next, add the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.440.1">
      following implementation:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.441.1">
void ABaseDummyAIController::OnPawnDamaged(AActor* DamagedActor, float Damage, const UDamageType* DamageType,
    AController* InstigatedBy, AActor* DamageCauser)
{
    const auto BlackboardComp = GetBlackboardComponent();
    BlackboardComp-&gt;SetValueAsBool("IsHit", true);
    if (DamagedActor-&gt;Tags.Num() &gt; 0)
    {
       DamagedActor-&gt;Tags[0] = "Untagged";
    }
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.442.1">
     This function is called when a pawn associated with the AI controller is damaged; the function retrieves the Blackboard component of the AI controller and sets the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.443.1">
      IsHit
     </span>
    </strong>
    <span class="koboSpan" id="kobo.444.1">
     key to a value of
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.445.1">
      true
     </span>
    </strong>
    <span class="koboSpan" id="kobo.446.1">
     .
    </span>
    <span class="koboSpan" id="kobo.446.2">
     Then, it sets the first tag of the actor to a value of
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.447.1">
      Untagged
     </span>
    </strong>
    <span class="koboSpan" id="kobo.448.1">
     so that it won’t be a
    </span>
    <a id="_idIndexMarker535">
    </a>
    <span class="koboSpan" id="kobo.449.1">
     viable target anymore
    </span>
    <a id="_idIndexMarker536">
    </a>
    <span class="koboSpan" id="kobo.450.1">
     for the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.451.1">
      gunner dummy.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.452.1">
     With this AI controller all set up, it’s time to create a Blueprint for the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.453.1">
      security camera.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-209">
    <a id="_idTextAnchor211">
    </a>
    <span class="koboSpan" id="kobo.454.1">
     Creating security camera Blueprints
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.455.1">
     Now, get back to the
    </span>
    <a id="_idIndexMarker537">
    </a>
    <span class="koboSpan" id="kobo.456.1">
     Unreal Engine Editor, and
    </span>
    <a id="_idIndexMarker538">
    </a>
    <span class="koboSpan" id="kobo.457.1">
     after compilation has finished, create a Blueprint out of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.458.1">
      BaseSecurityCamAIController
     </span>
    </strong>
    <span class="koboSpan" id="kobo.459.1">
     class, naming it
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.460.1">
      AISecurityCamController
     </span>
    </strong>
    <span class="koboSpan" id="kobo.461.1">
     .
    </span>
    <span class="koboSpan" id="kobo.461.2">
     You don’t need to add a behavior tree, as all the logic is handled inside the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.462.1">
      controller itself.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.463.1">
     Now, create a Blueprint class from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.464.1">
      BaseSecurityCam
     </span>
    </strong>
    <span class="koboSpan" id="kobo.465.1">
     class, and name it
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.466.1">
      BP_SecurityCam
     </span>
    </strong>
    <span class="koboSpan" id="kobo.467.1">
     .
    </span>
    <span class="koboSpan" id="kobo.467.2">
     Once it has been created, open it, and in the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.468.1">
      Details
     </span>
    </strong>
    <span class="koboSpan" id="kobo.469.1">
     panel, locate the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.470.1">
      AI Controller Class
     </span>
    </strong>
    <span class="koboSpan" id="kobo.471.1">
     attribute and set its value
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.472.1">
      to
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.473.1">
       AISecurityCamController
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.474.1">
      .
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer172">
     <span class="koboSpan" id="kobo.475.1">
      <img alt="Figure 10.3 – The security cam Blueprint" src="image/Figure_10.3_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.476.1">
     Figure 10.3 – The security cam Blueprint
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.477.1">
     We have gathered all the necessary elements to bring our new gym to life, and we are ready to take the
    </span>
    <a id="_idIndexMarker539">
    </a>
    <span class="koboSpan" id="kobo.478.1">
     next steps and start the
    </span>
    <a id="_idIndexMarker540">
    </a>
    <span class="koboSpan" id="kobo.479.1">
     process of debugging the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.480.1">
      Perception System.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-210">
    <a id="_idTextAnchor212">
    </a>
    <span class="koboSpan" id="kobo.481.1">
     Creating the gym
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.482.1">
     We are now going
    </span>
    <a id="_idIndexMarker541">
    </a>
    <span class="koboSpan" id="kobo.483.1">
     to create a level to test and debug
    </span>
    <a id="_idIndexMarker542">
    </a>
    <span class="koboSpan" id="kobo.484.1">
     everything.
    </span>
    <span class="koboSpan" id="kobo.484.2">
     We want to achieve this kind
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.485.1">
      of behavior:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.486.1">
      One or more AI agents will move around
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.487.1">
       the level
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.488.1">
      A security cam will try to spot AI agents and tag them as
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.489.1">
       viable targets
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.490.1">
      A gunner will wait for the AI agents to be tagged, in order to shoot
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.491.1">
       at them
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.492.1">
     So, let’s start by creating
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.493.1">
      the gym:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.494.1">
      Create a level of your choice, starting from the Level Instances and Packed Level Actors I provided in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.495.1">
       project template.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.496.1">
      Add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.497.1">
       NavMeshBoundsVolume
      </span>
     </strong>
     <span class="koboSpan" id="kobo.498.1">
      actor so that it will cover all the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.499.1">
       walkable areas.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.500.1">
      Add some obstacles to make things
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.501.1">
       more interesting.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.502.1">
      Add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.503.1">
       BP_GunnerDummyCharacter
      </span>
     </strong>
     <span class="koboSpan" id="kobo.504.1">
      instance to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.505.1">
       the level.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.506.1">
      Add one or more
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.507.1">
        BP_RoamerDummyCharacter
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.508.1">
       instances.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.509.1">
      Add some
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.510.1">
       NS_Target
      </span>
     </strong>
     <span class="koboSpan" id="kobo.511.1">
      Niagara actors that will work as target points for the pathfinding system; just remember to tag them
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.512.1">
       TargetPoint
      </span>
     </strong>
     <span class="koboSpan" id="kobo.513.1">
      .
     </span>
     <span class="koboSpan" id="kobo.513.2">
      Make sure that the path will bring the AI agents in the line of sight of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.514.1">
       the gunner.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.515.1">
      Add one or more
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.516.1">
       BP_SecurityCam
      </span>
     </strong>
     <span class="koboSpan" id="kobo.517.1">
      instances to the walls.
     </span>
     <span class="koboSpan" id="kobo.517.2">
      The final result should be similar to
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.518.1">
        Figure 10
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.519.1">
        .4
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.520.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer173">
     <span class="koboSpan" id="kobo.521.1">
      <img alt="Figure 10.4 – The gym" src="image/Figure_10.4_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.522.1">
     Figure 10.4 – The gym
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.523.1">
     Considering the type of scenario, where the gunner character will shoot at targets located by the security camera, I have decided to make the gym a bit juicier by adding a post-process
    </span>
    <a id="_idIndexMarker543">
    </a>
    <span class="koboSpan" id="kobo.524.1">
     volume
    </span>
    <a id="_idIndexMarker544">
    </a>
    <span class="koboSpan" id="kobo.525.1">
     that simulates an infra-red scenario, as depicted in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.526.1">
       Figure 10
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.527.1">
       .5
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.528.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer174">
     <span class="koboSpan" id="kobo.529.1">
      <img alt="Figure 10.5 – The gym with a post-process volume" src="image/Figure_10.5_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.530.1">
     Figure 10.5 – The gym with a post-process volume
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.531.1">
     This is obviously not mandatory, and you are free to set your post-process environment as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.532.1">
      you wish.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.533.1">
     Now that
    </span>
    <a id="_idIndexMarker545">
    </a>
    <span class="koboSpan" id="kobo.534.1">
     the gym is finished, it’s time to start testing it and learn how to debug the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.535.1">
      Perception
     </span>
    </span>
    <span class="No-Break">
     <a id="_idIndexMarker546">
     </a>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.536.1">
      System.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-211">
    <a id="_idTextAnchor213">
    </a>
    <span class="koboSpan" id="kobo.537.1">
     Enabling perception debugging
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.538.1">
     If you start the
    </span>
    <a id="_idIndexMarker547">
    </a>
    <span class="koboSpan" id="kobo.539.1">
     simulation, you should see the following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.540.1">
      things happening:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.541.1">
      As the roamers wander around, the gunner, unaware of their presence,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.542.1">
       will cheer
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.543.1">
      As soon as one of the roamers enters the camera’s line of sight, the gunner will start aiming
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.544.1">
       at it
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.545.1">
      Every time a roamer is hit, it will sit down and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.546.1">
       stop wandering
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.547.1">
     You can tweak the security camera parameters to make it more or less attentive to what’s happening in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.548.1">
      the level.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.549.1">
     At this point, you might be curious about how we determine whether an agent is in the camera’s line of sight.
    </span>
    <span class="koboSpan" id="kobo.549.2">
     Well, it’s actually quite simple to observe once you enable the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.550.1">
      debugging tools!
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.551.1">
     So, let’s start by enabling the debugging tools, as explained in
    </span>
    <a href="B31016_06.xhtml#_idTextAnchor116">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.552.1">
        Chapter 6
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.553.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.554.1">
      Optimizing the
     </span>
    </em>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.555.1">
       Navigation Mesh
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.556.1">
      .
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.557.1">
     Note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.558.1">
     Once the simulation starts, you may be wondering why the security camera has a tiny red icon on top of it, while all the dummy puppets have a green one, as displayed in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.559.1">
       Figure 10
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.560.1">
      .6
     </span>
    </em>
    <span class="koboSpan" id="kobo.561.1">
     .
    </span>
    <span class="koboSpan" id="kobo.561.2">
     When the AI debugging tools are enabled, a green icon is displayed if a pawn has some AI logic set up and running; otherwise, the icon will be red.
    </span>
    <span class="koboSpan" id="kobo.561.3">
     In our case, the security cam is possessed by a dedicated AI controller, but it has no behavior tree, so the icon will
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.562.1">
      be red.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer175">
     <span class="koboSpan" id="kobo.563.1">
      <img alt="img" role="presentation" src="image/Figure_10.6_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="callout">
    <span class="No-Break">
     <span class="koboSpan" id="kobo.564.1">
      Figure 10
     </span>
    </span>
    <span class="koboSpan" id="kobo.565.1">
     .6 –
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.566.1">
      AI icons
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.567.1">
     Now, while the simulation is going on, select a security camera and enable the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.568.1">
      Perception
     </span>
    </strong>
    <span class="koboSpan" id="kobo.569.1">
     and
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.570.1">
      Perception System
     </span>
    </strong>
    <span class="koboSpan" id="kobo.571.1">
     tools by pressing the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.572.1">
      4
     </span>
    </em>
    <span class="koboSpan" id="kobo.573.1">
     and
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.574.1">
      5
     </span>
    </em>
    <span class="koboSpan" id="kobo.575.1">
     keys on your numpad, respectively.
    </span>
    <span class="koboSpan" id="kobo.575.2">
     You
    </span>
    <a id="_idIndexMarker548">
    </a>
    <span class="koboSpan" id="kobo.576.1">
     should immediately see a visualization of the security camera sight sense, as depicted in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.577.1">
       Figure 10
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.578.1">
       .7
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.579.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer176">
     <span class="koboSpan" id="kobo.580.1">
      <img alt="Figure 10.7 – Perception debugging tools" src="image/Figure_10.7_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.581.1">
     Figure 10.7 – Perception debugging tools
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.582.1">
     The display will show some important information on the AI agent perception, such as the active sense and its data.
    </span>
    <span class="koboSpan" id="kobo.582.2">
     Additionally, you will also see a visual representation of the agent sense.
    </span>
    <span class="koboSpan" id="kobo.582.3">
     In particular, the sight sense will show
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.583.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.584.1">
      A green circular area that represents the range of the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.585.1">
       agent sight.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.586.1">
      A pink circular area that represents the maximum range of the agent sight.
     </span>
     <span class="koboSpan" id="kobo.586.2">
      Once the spotted agent goes beyond this range, sight contact will
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.587.1">
       be lost.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.588.1">
      A green angle that represents the peripheral vision of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.589.1">
       the agent.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.590.1">
     Once an AI agent enters the green circle, it will be detected by the Perception System, and you should see a green line, starting from the security camera and ending at the detected pawn, as
    </span>
    <a id="_idIndexMarker549">
    </a>
    <span class="koboSpan" id="kobo.591.1">
     depicted in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.592.1">
       Figure 10
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.593.1">
       .8
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.594.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer177">
     <span class="koboSpan" id="kobo.595.1">
      <img alt="Figure 10.8 – A pawn detected" src="image/Figure_10.8_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.596.1">
     Figure 10.8 – A pawn detected
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.597.1">
     A green wireframe sphere will show the detection point, which will be updated as the detected AI agent
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.598.1">
      moves around.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.599.1">
     Once an AI agent moves out of sight, the detection point will stop following it, and you should see the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.600.1">
      age
     </span>
    </strong>
    <span class="koboSpan" id="kobo.601.1">
     label next to the sphere, updating its value; this is the time that has passed since detection was lost.
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.602.1">
       Figure 10
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.603.1">
      .9
     </span>
    </em>
    <span class="koboSpan" id="kobo.604.1">
     shows
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.605.1">
      this scenario:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer178">
     <span class="koboSpan" id="kobo.606.1">
      <img alt="Figure 10.9 – Detection lost" src="image/Figure_10.9_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.607.1">
     Figure 10.9 – Detection lost
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.608.1">
     Each sense has its own way of displaying info, so my advice is to start experimenting with each of them to get an understanding of how to debug and get information from the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.609.1">
      debugging tools.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.610.1">
     In this section, we have created a new gym and tested how the Perception System works; what’s more, I have shown you how to enable the debugging tools and get a better understanding of what’s happening in the level at runtime.
    </span>
    <span class="koboSpan" id="kobo.610.2">
     In the next section, we are going to take
    </span>
    <a id="_idIndexMarker550">
    </a>
    <span class="koboSpan" id="kobo.611.1">
     a look at perception stimuli, in order to make our levels more articulated
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.612.1">
      and engaging.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-212">
    <a id="_idTextAnchor214">
    </a>
    <span class="koboSpan" id="kobo.613.1">
     Creating perception stimuli
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.614.1">
     In the previous section, we
    </span>
    <a id="_idIndexMarker551">
    </a>
    <span class="koboSpan" id="kobo.615.1">
     utilized the out-of-the-box pawn feature that enables it to be visible to sight sense.
    </span>
    <span class="koboSpan" id="kobo.615.2">
     We will now analyze actors that are not perceivable by default; this means we will need to add
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.616.1">
      AIPerceptionStimuliSourceComponent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.617.1">
     to an actor.
    </span>
    <span class="koboSpan" id="kobo.617.2">
     What’s more, we will learn how to register or unregister these stimuli, in order to make the actor visible or invisible to the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.618.1">
      Perception System.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-213">
    <a id="_idTextAnchor215">
    </a>
    <span class="koboSpan" id="kobo.619.1">
     Creating the target actor
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.620.1">
     In this subsection, we
    </span>
    <a id="_idIndexMarker552">
    </a>
    <span class="koboSpan" id="kobo.621.1">
     will create a new actor that will serve as a target for the dummy gunner puppet, but with a twist – this actor will create some interference in the level and won’t be visible to the security camera.
    </span>
    <span class="koboSpan" id="kobo.621.2">
     Achieving this kind of feature is quite easy, once you know how to register and unregister an actor from the Perception System.
    </span>
    <span class="koboSpan" id="kobo.621.3">
     We are basically creating a scrambler device that will disturb – that is, it will be invisible to – the gunner
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.622.1">
      sight sense.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.623.1">
     To keep things simple, I will create a Blueprint class; when working with stimuli, it is often more convenient to configure settings directly from a Blueprint rather than using a C++ class.
    </span>
    <span class="koboSpan" id="kobo.623.2">
     By utilizing a Blueprint, we can easily adjust and fine-tune various aspects of the stimuli, making the whole process more flexible and accessible.
    </span>
    <span class="koboSpan" id="kobo.623.3">
     This approach allows for quicker iterations and modifications, ultimately resulting in a smoother and more
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.624.1">
      efficient workflow.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.625.1">
     To create our scrambler, open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.626.1">
      Blueprints
     </span>
    </strong>
    <span class="koboSpan" id="kobo.627.1">
     folder, create a new Blueprint class extending from
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.628.1">
      Actor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.629.1">
     , and name it
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.630.1">
      BP_Scrambler
     </span>
    </strong>
    <span class="koboSpan" id="kobo.631.1">
     .
    </span>
    <span class="koboSpan" id="kobo.631.2">
     Once the blueprint is opened, follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.632.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.633.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.634.1">
       Components
      </span>
     </strong>
     <span class="koboSpan" id="kobo.635.1">
      panel, add a static
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.636.1">
       mesh component.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.637.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.638.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.639.1">
      panel, set the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.640.1">
       Static Mesh
      </span>
     </strong>
     <span class="koboSpan" id="kobo.641.1">
      property to
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.642.1">
       SM_RoboGun_BaseRemote
      </span>
     </strong>
     <span class="koboSpan" id="kobo.643.1">
      and the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.644.1">
       Scale
      </span>
     </strong>
     <span class="koboSpan" id="kobo.645.1">
      property to
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.646.1">
       (3.0,
      </span>
     </strong>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.647.1">
        3.0, 3.0)
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.648.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.649.1">
      Add an
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.650.1">
        AIPerceptionStimuliSource
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.651.1">
       component.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.652.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.653.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.654.1">
      panel, locate the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.655.1">
       Register as Source for Senses
      </span>
     </strong>
     <span class="koboSpan" id="kobo.656.1">
      attribute, add a new element by clicking the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.657.1">
       +
      </span>
     </strong>
     <span class="koboSpan" id="kobo.658.1">
      button, and set the value
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.659.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.660.1">
        AISense_Sight
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.661.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.662.1">
      Leave the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.663.1">
       Auto Register as Source
      </span>
     </strong>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.664.1">
       attribute unchecked
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer179">
     <span class="koboSpan" id="kobo.665.1">
      <img alt="Figure 10.10 – The stimuli source" src="image/Figure_10.10_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.666.1">
     Figure 10.10 – The stimuli source
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.667.1">
     Now, open the Event
    </span>
    <a id="_idIndexMarker553">
    </a>
    <span class="koboSpan" id="kobo.668.1">
     Graph for this Blueprint and do
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.669.1">
      the following:
     </span>
    </span>
   </p>
   <ol>
    <li value="6">
     <span class="koboSpan" id="kobo.670.1">
      From the outgoing execution pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.671.1">
       Event Begin Play
      </span>
     </strong>
     <span class="koboSpan" id="kobo.672.1">
      node, add a
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.673.1">
        Delay
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.674.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.675.1">
      From the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.676.1">
       Completed
      </span>
     </strong>
     <span class="koboSpan" id="kobo.677.1">
      pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.678.1">
       Delay
      </span>
     </strong>
     <span class="koboSpan" id="kobo.679.1">
      node, add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.680.1">
       Register for Sense
      </span>
     </strong>
     <span class="koboSpan" id="kobo.681.1">
      node; this should automatically add an
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.682.1">
       AIPerception Stimuli Source
      </span>
     </strong>
     <span class="koboSpan" id="kobo.683.1">
      reference to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.684.1">
       Target
      </span>
     </strong>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.685.1">
       incoming pin.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.686.1">
      From the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.687.1">
       Duration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.688.1">
      pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.689.1">
       Delay
      </span>
     </strong>
     <span class="koboSpan" id="kobo.690.1">
      node, add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.691.1">
       Random Float in Range
      </span>
     </strong>
     <span class="koboSpan" id="kobo.692.1">
      node, setting its
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.693.1">
       Min
      </span>
     </strong>
     <span class="koboSpan" id="kobo.694.1">
      and
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.695.1">
       Max
      </span>
     </strong>
     <span class="koboSpan" id="kobo.696.1">
      values to
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.697.1">
       4.0
      </span>
     </strong>
     <span class="koboSpan" id="kobo.698.1">
      and
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.699.1">
        6.0
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.700.1">
       , respectively.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.701.1">
      From the dropdown menu of the incoming
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.702.1">
       Sense Class
      </span>
     </strong>
     <span class="koboSpan" id="kobo.703.1">
      pin, select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.704.1">
       AISense_Sight
      </span>
     </strong>
     <span class="koboSpan" id="kobo.705.1">
      .
     </span>
     <span class="koboSpan" id="kobo.705.2">
      The final graph should look like the one depicted in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.706.1">
        Figure 10
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.707.1">
        .11
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.708.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer180">
     <span class="koboSpan" id="kobo.709.1">
      <img alt="Figure 10.11 – The Event Graph" src="image/Figure_10.11_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.710.1">
     Figure 10.11 – The Event Graph
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.711.1">
     This graph will simply register the sight sense for this actor after a random interval, making the actor itself visible to the Perception System in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.712.1">
      the level.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.713.1">
     Note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.714.1">
     If you need to unregister a stimuli source, the corresponding Blueprint node is
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.715.1">
      Unregister
     </span>
    </strong>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.716.1">
       from Sense
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.717.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.718.1">
     Let’s test this
    </span>
    <a id="_idIndexMarker554">
    </a>
    <span class="koboSpan" id="kobo.719.1">
     functionality in a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.720.1">
      brand-new gym.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-214">
    <a id="_idTextAnchor216">
    </a>
    <span class="koboSpan" id="kobo.721.1">
     Testing the gym
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.722.1">
     To create the
    </span>
    <a id="_idIndexMarker555">
    </a>
    <span class="koboSpan" id="kobo.723.1">
     testing level, follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.724.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.725.1">
      Create a level of your choice, starting from the Level Instances and Packed Level Actors that I provided in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.726.1">
       project template.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.727.1">
      Add some obstacles to make things
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.728.1">
       more interesting.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.729.1">
      Add
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.730.1">
       BP_GunnerDummyCharacter
      </span>
     </strong>
     <span class="koboSpan" id="kobo.731.1">
      to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.732.1">
       the level.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.733.1">
      Add one
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.734.1">
       BP_Scrambler
      </span>
     </strong>
     <span class="koboSpan" id="kobo.735.1">
      instance so that the gunner puppet can shoot
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.736.1">
       at it.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.737.1">
      Add one
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.738.1">
       BP_SecurityCam
      </span>
     </strong>
     <span class="koboSpan" id="kobo.739.1">
      instance to the walls so that it is in the line of sight of the scrambler.
     </span>
     <span class="koboSpan" id="kobo.739.2">
      The final result should be similar to
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.740.1">
        Figure 10
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.741.1">
        .12
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.742.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer181">
     <span class="koboSpan" id="kobo.743.1">
      <img alt="Figure 10.12 – The scrambler gym" src="image/Figure_10.12_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.744.1">
     Figure 10.12 – The scrambler gym
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.745.1">
     By starting the simulation, you can see that the scrambler will go unnoticed by the security camera until it reveals itself after a random interval.
    </span>
    <span class="koboSpan" id="kobo.745.2">
     After that, the scrambler will be tagged as a viable target and the gunner will shoot at it.
    </span>
    <span class="koboSpan" id="kobo.745.3">
     Try enabling the debugging tools to check what’s happening to the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.746.1">
      Perception System.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.747.1">
     In this final section, I have presented how to make any actor detectable by the Perception System.
    </span>
    <span class="koboSpan" id="kobo.747.2">
     By following the steps and guidelines provided, you can seamlessly integrate the Perception
    </span>
    <a id="_idIndexMarker556">
    </a>
    <span class="koboSpan" id="kobo.748.1">
     System into your project, allowing your actors to be accurately recognized and interacted with within the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.749.1">
      virtual environment.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-215">
    <a id="_idTextAnchor217">
    </a>
    <span class="koboSpan" id="kobo.750.1">
     Summary
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.751.1">
     In this chapter, you learned the basics of the Unreal Engine Perception System.
    </span>
    <span class="koboSpan" id="kobo.751.2">
     Firstly, we showed the main elements that will let you add senses to your AI agents; after that, you built a pawn with a sight sense that detects moving characters around the level.
    </span>
    <span class="koboSpan" id="kobo.751.3">
     Then, you learned how to debug the active senses at runtime.
    </span>
    <span class="koboSpan" id="kobo.751.4">
     Finally, you added a stimuli source to an actor, in order to make it detectable by the Perception System itself.
    </span>
    <span class="koboSpan" id="kobo.751.5">
     All of this opens up a world of possibilities for creating immersive and dynamic experiences, using the power of the Unreal Engine
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.752.1">
      AI Framework.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.753.1">
     In the upcoming chapter, I’ll unveil a new method to gather data from the environment; brace yourself, as this cutting-edge feature is still in the experimental stage.
    </span>
    <span class="koboSpan" id="kobo.753.2">
     But fear not, my friend, for it is knowledge well
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.754.1">
      worth acquiring!
     </span>
    </span>
   </p>
  </div>
 </body></html>