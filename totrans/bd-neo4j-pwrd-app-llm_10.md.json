["```py\nCREATE CONSTRAINT customer_id_idx FOR (n:Customer) REQUIRE n.id IS UNIQUE ;\nCREATE CONSTRAINT postal_code_idx FOR (n:PostalCode) REQUIRE n.code IS UNIQUE ; \n```", "```py\nLOAD CSV WITH HEADERS FROM \"file:///customers.csv\" as row\nWITH row\nCALL {\n    WITH row\n    MERGE (c:Customer {id:row.customer_id})\n    SET c.age = row.age\n    FOREACH( ignoreME in CASE WHEN row.fashion_news_frequency = 'Regularly'  THEN [1] ELSE [] END |\n        SET c:FN_REGULAR\n    )\n    FOREACH( ignoreME in CASE WHEN row.club_member_status = 'ACTIVE'  THEN [1] ELSE [] END |\n        SET c:CLUB_ACTIVE\n    )\n    FOREACH( ignoreME in CASE WHEN row.club_member_status = 'PRE-CREATE'  THEN [1] ELSE [] END |\n        SET c:CLUB_PRE_CREATE\n    )\n    FOREACH( ignoreME in CASE WHEN row.Active <> 'ACTIVE'  THEN [1] ELSE [] END |\n        SET c:INACTIVE\n    )\n    MERGE(p:PostalCode {code:row.postal_code})\n    MERGE(c)-[:LIVES_IN]->(p)\n} IN TRANSACTIONS OF 1000 ROWS \n```", "```py\nCREATE CONSTRAINT product_code_idx FOR (n:Product) REQUIRE n.code IS UNIQUE ;\nCREATE CONSTRAINT article_id_idx FOR (n:Article) REQUIRE n.id IS UNIQUE ;\nCREATE CONSTRAINT product_type_id_idx FOR (n:ProductType) REQUIRE n.id IS UNIQUE ;\nCREATE CONSTRAINT colour_group_idx FOR (n:ColorGroup) REQUIRE n.id IS UNIQUE ;\nCREATE CONSTRAINT product_group_name_idx FOR (n:ProductGroup) REQUIRE n.name IS UNIQUE ;\nCREATE CONSTRAINT graphical_appearance_id_idx FOR (n:GraphicalAppearance) REQUIRE n.id IS UNIQUE ;\nCREATE CONSTRAINT perceived_colour_id_idx FOR (n:PerceivedColor) REQUIRE n.id IS UNIQUE ;\nCREATE CONSTRAINT department_id_idx FOR (n:Department) REQUIRE n.id IS UNIQUE ;\nCREATE CONSTRAINT section_id_idx FOR (n:Section) REQUIRE n.id IS UNIQUE ;\nCREATE CONSTRAINT garment_group_id_idx FOR (n:GarmentGroup) REQUIRE n.id IS UNIQUE ;\nCREATE CONSTRAINT article_index_id_idx FOR (n:Index) REQUIRE n.id IS UNIQUE ;\nCREATE CONSTRAINT article_index_group_id_idx FOR (n:IndexGroup) REQUIRE n.id IS UNIQUE ; \n```", "```py\nLOAD CSV WITH HEADERS FROM \"file:///articles.csv\" as row\nWITH row\nCALL {\n    WITH row \n```", "```py\nMERGE(a:Article {id:row.article_id})\n    SET a.desc = row.detail_desc\n    MERGE(p:Product {code:row.product_code})\n    SET p.name = row.prod_name\n    MERGE(a)-[:OF_PRODUCT]->(p)\n    MERGE(pt:ProductType {id:row.product_type_no})\n    SET pt.name = row.product_type_name\n    MERGE(p)-[:HAS_TYPE]->(pt)\n    WITH row, a, p\n    MERGE(pg:ProductGroup {name:row.product_group_name})\n    MERGE(p)-[:HAS_GROUP]->(pg) \n```", "```py\nWITH row, a\n    MERGE(g:GraphicalAppearance {id:row.graphical_appearance_no})\n    SET g.name = row.graphical_appearance_name\n    MERGE (a)-[:HAS_GRAPHICAL_APPEARANCE]->(g)\n    WITH row, a\n    MERGE (c:ColorGroup {id: row.colour_group_code})\n    SET c.name = row.colour_group_name\n    MERGE (a)-[:HAS_COLOR]->(c)\n    WITH row, a\n    MERGE (pc:PerceivedColor {id: row.perceived_colour_value_id})\n    SET pc.name = row.perceived_colour_value_name\n    MERGE (a)-[:HAS_PERCEIVED_COLOR]->(pc)\n    MERGE (pcm:PerceivedColor {id: row.perceived_colour_master_id})\n    SET pcm.name = row.perceived_colour_master_name\n    MERGE (pc)-[:HAS_MASTER]->(pcm) \n```", "```py\nWITH row, a\n    MERGE (d:Department {id:row.department_no})\n    SET d.name = row.department_name\n    MERGE (a)-[:HAS_DEPARTMENT]->(d)\n    WITH row, a\n    MERGE (i:Index {id: row.index_code})\n    SET i.name = row.index_name\n    MERGE (a)-[:HAS_INDEX]->(i)\n    MERGE (ig:IndexGroup {id: row.index_group_no})\n    SET ig.name = row.index_group_name\n    MERGE (i)-[:HAS_GROUP]->(ig) \n```", "```py\nWITH row, a\n    MERGE (s:Section {id: row.section_no})\n    SET s.name = row.section_name\n    MERGE (a)-[:HAS_SECTION]->(s)\n    WITH row, a\n    MERGE (gg:GarmentGroup {id: row.garment_group_no})\n    SET gg.name = row.garment_group_name\n    MERGE (a)-[:HAS_GARMENT_GROUP]->(gg)\n} IN TRANSACTIONS OF 1000 ROWS \n```", "```py\nLOAD CSV WITH HEADERS FROM \"file:///transactions_train.csv\" as row WITH row\nCALL {\n    WITH row\n    MATCH (c:Customer {id:row.customer_id})\n    MATCH (a:Article {id:row.article_id})\n    WITH a, c, row\n    CREATE (t:Transaction {date: row.t_dat, price: row.price, salesChannel: row.sales_channel_id})\n    CREATE (t)-[:HAS_ARTICLE]->(a)\n    WITH c, t\n    CALL {\n        WITH c, t\n        WITH c, t\n        WHERE exists((c)-[:START_TRANSACTION]->()) OR exists((c)-[:LATEST]->())\n        MATCH (c)-[r:LATEST]->(lt)\n        DELETE r\n        CREATE (lt)-[:NEXT]->(t)\n        CREATE (c)-[:LATEST]->(t)\n        UNION\n        WITH c, t\n        WITH c,t\n        WHERE NOT ( exists((c)-[:START_TRANSACTION]->()) OR exists((c)-[:LATEST]->()) )\n        CREATE (c)-[:START_TRANSACTION]->(t)\n        CREATE (c)-[:LATEST]->(t)\n    }\n} IN TRANSACTIONS OF 1000 ROWS \n```", "```py\n    MATCH (c:Customer)\n    WITH c\n    CALL {\n        WITH c\n        MATCH (c)-[:START_TRANSACTION]->(s)\n        MATCH (c)-[:LATEST]->(e)\n        WITH c,s,e\n        MATCH p=(s)-[:NEXT*]->(e)\n        WITH c, nodes(p) as nodes\n        UNWIND nodes as node \n    ```", "```py\n    WITH c, node, node.date as d\n        WITH c, node, toInteger(substring(d, 0,4)) as year, substring(d, 5,2) as month\n        WITH c, node,\n            CASE WHEN month=\"12\" THEN year\n                 WHEN month=\"01\" OR month=\"02\" THEN year-1\n                ELSE\n                    year\n            END as year, \n    ```", "```py\n    CASE WHEN month=\"12\" OR month=\"01\" OR month=\"02\" THEN \"WINTER\"\n                 WHEN month=\"03\" OR month=\"04\" OR month=\"05\" THEN \"SPRING\"\n                 WHEN month=\"06\" OR month=\"07\" OR month=\"08\" THEN \"SUMMER\"\n                 WHEN month=\"09\" OR month=\"10\" OR month=\"11\" THEN \"FALL\"\n            END as season\n        WITH c, node, season+'_'+year as relName \n    ```", "```py\n    WITH c, relName, head(collect(node)) as start\n        WHERE relName is not null \n    ```", "```py\n    CALL apoc.create.relationship(c, relName, {}, start) YIELD rel\n        WITH 1 as out\n        return DISTINCT out\n    } IN TRANSACTIONS OF 1000 ROWS\n    WITH 1 as r\n    RETURN DISTINCT r \n    ```", "```py\nMATCH (c:Customer)-[:SUMMER_2019]->(start), (c)-[:FALL_2019]->()<-[:NEXT]-(end)\nWITH c, start, end SKIP 100 LIMIT 1\nMATCH p=(start)-[:NEXT*]->(end)\nWITH nodes(p) as nodes, relationships(p) as rels\nUNWIND nodes as node\nMATCH p=(node)-[:HAS_ARTICLE]->(a)\nRETURN a.desc as article \n```"]