<html><head></head><body>
		<div><h1 id="_idParaDest-142"><em class="italic"><a id="_idTextAnchor155"/>Chapter <a id="_idTextAnchor156"/>8</em>: <a id="_idTextAnchor157"/>Utilizing the Bubble API in n8n</h1>
			<p>Regardless of how hard we try, we can't be good at everything! Some people are great organizers, others are fantastic planners, while still others excel at public speaking. When we notice that we are good at something, we tend to focus on that thing and pursue it, making us even better at it.</p>
			<p>No-code tools are like that as well. They discover what they are really good at and focus on it. n8n is really good at connecting systems and automating their tasks, which is the major focus of this tool. </p>
			<p>And sometimes, just as with people, if no-code tools want to get something accomplished but need a little help, they will turn to a friend.</p>
			<p>For us, we have turned to Bubble to be n8n's partner. Bubble is designed to be a really good web app development tool, allowing us to create a web frontend for n8n. It allows no-code builders to design web pages for submitting information to n8n or even complete web applications so that n8n can then connect the data to other systems and automate the processes.</p>
			<p>This chapter covers the following topics:</p>
			<ul>
				<li>Introducing the Bubble <strong class="bold">application programming interface</strong> (<strong class="bold">API</strong>)</li>
				<li>Understanding Bubble's data structure</li>
				<li>Understanding Bubble's workflow engine</li>
				<li>Using Bubble's Data API</li>
				<li>Using Bubble's Workflow API</li>
				<li>Receiving events and data from Bubble</li>
			</ul>
			<p>Once you have completed this chapter, you will know how to do the following:</p>
			<ul>
				<li>Communicate between Bubble and n8n.</li>
				<li>Access Bubble's data using the Data API.</li>
				<li>Use Bubble's workflows and interact with them using the Workflow API.</li>
				<li>Receive events and data from Bubble in n8n.</li>
			</ul>
			<h1 id="_idParaDest-143"><a id="_idTextAnchor158"/>Technical requirements</h1>
			<p><a id="_idTextAnchor159"/>You can find the completed code examples for the chapter on GitHub at <a href="https://github.com/PacktPublishing/Rapid-Product-Development-with-n8n/tree/main/Chapter%208">https://github.com/PacktPublishing/Rapid-Product-Development-with-n8n/tree/main/Chapter%208</a>.</p>
			<h1 id="_idParaDest-144"><a id="_idTextAnchor160"/>Introducing the Bubble API</h1>
			<p>If you have worked with other APIs in the past, you should feel entirely comfortable working<a id="_idIndexMarker394"/> with the Bubble API. It follows<a id="_idIndexMarker395"/> relatively standard API design practices, such as using regular <strong class="bold">HyperText Transfer Protocol</strong> (<strong class="bold">HTTP</strong>) responses and <strong class="bold">HTTP Secure</strong> (<strong class="bold">HTTPS</strong>) for over-the-wire<a id="_idIndexMarker396"/> encryption.</p>
			<p>However, some specifics about the API will make it easier for you to find success early if you learn them upfront.</p>
			<h2 id="_idParaDest-145"><a id="_idTextAnchor161"/>Bubble API endpoints</h2>
			<p>The primary endpoint<a id="_idIndexMarker397"/> for your app depends on a few factors, such as the<a id="_idIndexMarker398"/> following:</p>
			<ul>
				<li>Are you using a custom domain?</li>
				<li>Are you using the live or development environment?</li>
				<li>Which version of the API are you using?</li>
			</ul>
			<h3>Base URL</h3>
			<p>The first item to look<a id="_idIndexMarker399"/> at is whether you are using a custom domain or not for your Bubble<a id="_idIndexMarker400"/> app. This is used to figure out your base <strong class="bold">Uniform Resource Locator</strong> (<strong class="bold">URL</strong>). You can determine whether or not you are using a custom domain by opening up your Bubble app, going to the <strong class="bold">Settings</strong> menu, and then clicking on the <strong class="bold">Domain / email</strong> tab, as illustrated in the following screenshot:</p>
			<div><div><img src="img/Figure_8.01_B17493.jpg" alt="Figure 8.1 – Bubble domain settings without a custom domain&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.1 – Bubble domain settings without a custom domain</p>
			<p>If you have a custom<a id="_idIndexMarker401"/> domain, it is registered in this location. Otherwise, it displays the default settings, as shown in <em class="italic">Figure 8.1</em>.</p>
			<p>For default domain settings, the base <a id="_idTextAnchor162"/>URL is <code>https://&lt;appname&gt;.bubbleapps.io</code>, where <code>&lt;appname&gt;</code> is the name you have provided for your app. For example, if you named your application <code>fancyApp</code>, then the base URL is <a href="https://fancyApp.bubbleapps.io">https://fancyApp.bubbleapps.io</a>.</p>
			<p>If you have a custom domain for your app, then the URL is your custom domain.</p>
			<h3>Live or development</h3>
			<p>The next factor used<a id="_idIndexMarker402"/> to determine your API endpoint is whether you are using the live or development version of your Bubble application. By default, you will be in the development version. Once you are ready to make your application public, you can then switch it to the live version.</p>
			<p>Be aware that the API endpoints change when you go from the development version to the live version.</p>
			<p>If you use the live version<a id="_idIndexMarker403"/> of the application, then the path after the base URL is <code>/api</code>, but if you are performing some testing on the development version of your application, then this subdirectory is <code>/version-test/api</code>.</p>
			<h3>API version</h3>
			<p>Chances are, you are using the latest version of the API. Version 1.1 was released on January 19, 2017, and if you created your application after January 19, 2017, you are probably using version 1.1.</p>
			<p>The path after specifying<a id="_idIndexMarker404"/> your environment is your API version. This is either <code>/1.0</code> or <code>/1.1</code>, based on when your application was created.</p>
			<h3>Workflow or data</h3>
			<p>Bubble can be broken into two different pieces: workflow and data. Workflow<a id="_idIndexMarker405"/> deals with events that occur within Bubble (for example, a button is clicked), and then it performs specific actions based on how you have configured Bubble.</p>
			<p>The data piece refers to the built-in database that Bubble<a id="_idIndexMarker406"/> uses (for example, information about a newsletter). It is all about saving, changing, and deleting data within the Bubble environment.</p>
			<p>Once your API version is specified, you need to indicate whether you access the Workflow or Data API. This is done in the next part of the path. If you are accessing the Workflow data, the next part of the path is <code>/wf</code>. Meanwhile, if you want to access the Data portion of the API, this part of the path is <code>/obj</code>.</p>
			<h3>Name</h3>
			<p>The final part<a id="_idIndexMarker407"/> of the endpoint is to specify the name of the item you are accessing. Depending on whether you are accessing a workflow or a data item, this value specifies that item.</p>
			<p>For example, if you are accessing a data item named <code>users</code>, the path portion after <code>/obj</code> is <code>/users</code>.</p>
			<h3>Building your API endpoint</h3>
			<p>Now that we have a solid understanding of how the API endpoints are put together, let's demonstrate how to build an API endpoint using an example.</p>
			<p>Let's assume we are accessing<a id="_idIndexMarker408"/> the development version of the newsletter information collected by the <code>myApp</code> application we created in May 2019. There is a plan to use a custom domain for this application, but it hasn't been deployed yet.</p>
			<p>Since this application doesn't have a custom domain, the base URL is https://myApp.bubbleapps.io. We are accessing the development environment, so we add <code>/version-test/api</code> to the path. This application uses version 1.1 of the API as it was created after January 19, 2017, and this portion of the path is <code>/1.1</code>. We then add <code>/obj</code> to the path followed by the <code>/newsletter</code> data item name to access the Data API.</p>
			<p>Our final API endpoint in this example is <code>https://myApp.bubbleapps.io/version-test/api/1.1/obj/newsletter</code>.</p>
			<h2 id="_idParaDest-146"><a id="_idTextAnchor163"/>Bubble API settings</h2>
			<p>You can control several aspects<a id="_idIndexMarker409"/> of the Bubble API for your application. By going to <strong class="bold">Settings</strong> in the application<a id="_idIndexMarker410"/> and selecting the <strong class="bold">API</strong> tab, as illustrated in the following screenshot, you can make several changes:</p>
			<div><div><img src="img/Figure_8.02_B17493.jpg" alt="Figure 8.2 – Bubble API setting options&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.2 – Bubble API setting options</p>
			<h3>Enabling/disabling API access</h3>
			<p>You can enable or disable<a id="_idIndexMarker411"/> API access by selecting or deselecting the checkbox next to <strong class="bold">Enable Workflow API and backend workflows</strong> or <strong class="bold">Enable Data API</strong>.</p>
			<p>You can also specify workflows or data items by selecting or deselecting the checkbox next to their name.</p>
			<h3>API tokens</h3>
			<p>To secure your API access, it is essential<a id="_idIndexMarker412"/> to create a private API key. You can regenerate an API token in this section or create a new token altogether.</p>
			<p>You can authenticate using the API token by adding a header with a key of <code>Bearer &lt;API key&gt;</code>, as illustrated in the following screenshot:</p>
			<div><div><img src="img/Figure_8.03_B17493.jpg" alt="Figure 8.3 – Bubble API header authentication&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.3 – Bubble API header authentication</p>
			<p>Now that we have a better understanding of how Bubble's API works so that we can access data from other systems, let's delve a bit deeper into the actual structure of that data. This is important<a id="_idIndexMarker413"/> so that you know exactly what you are retrieving when using the API and you will be able to properly navigate around the API to retrieve specific data.</p>
			<h1 id="_idParaDest-147"><a id="_idTextAnchor164"/>Understanding Bubble's data structure</h1>
			<p>To properly use the Bubble API to access<a id="_idIndexMarker414"/> and modify data, it is crucial to understand how data is stored in Bubble.</p>
			<h2 id="_idParaDest-148"><a id="_idTextAnchor165"/>Data types</h2>
			<p>In Bubble, a data type<a id="_idIndexMarker415"/> is essentially the equivalent of a <strong class="bold">JavaScript Object Notation</strong> (<strong class="bold">JSON</strong>) object. It is defined in Bubble<a id="_idIndexMarker416"/> under the <strong class="bold">Data</strong> section for the application and provides a list of fields (represented by a key in JSON). Each field is a property of the data type. You can see a sample Bubble data type in the following screenshot:</p>
			<div><div><img src="img/Figure_8.04_B17493.jpg" alt="Figure 8.4 – Sample Bubble data type&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption"> </p>
			<p class="figure-caption">Figure 8.4 – Sample Bubble data type</p>
			<p>For example, the <strong class="bold">Newsletter</strong> data type in the preceding screenshot has six fields, two of which are custom, as follows:</p>
			<ul>
				<li><strong class="bold">Content </strong>—The actual body of the newsletter</li>
				<li><strong class="bold">Title </strong>—The newsletter's title</li>
			</ul>
			<p>Four of the fields<a id="_idIndexMarker417"/> are default fields, as follows:</p>
			<ul>
				<li><strong class="bold">Creator</strong>—The username of the person who created the record/newsletter entry</li>
				<li><strong class="bold">Modified Date</strong>—The date the record was last created, changed, or updated</li>
				<li><strong class="bold">Created Date</strong>—The date the record was initially created</li>
				<li><strong class="bold">Slug</strong>—Shortcut used for accessing the record, usually when using a URL form</li>
			</ul>
			<h2 id="_idParaDest-149"><a id="_idTextAnchor166"/>Data security (privacy)</h2>
			<p>There are two general privacy or data security settings<a id="_idIndexMarker418"/> for data types, as follows:</p>
			<ul>
				<li><strong class="bold">Public</strong></li>
				<li><strong class="bold">Private</strong></li>
			</ul>
			<p>The <strong class="bold">Public</strong> privacy setting gives everyone access to read the data in the data type. This is generally frowned upon unless the data is truly public and you do not care who can read the information.</p>
			<p>The <strong class="bold">Private</strong> privacy setting prevents<a id="_idIndexMarker419"/> anyone but the creator of the data type from actually interacting with the data. This is the preferred security setting for data types.</p>
			<p>The following screenshot shows Bubble private permissions with API access:</p>
			<div><div><img src="img/Figure_8.05_B17493.jpg" alt="Figure 8.5 – Bubble private permissions with API access&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.5 – Bubble private permissions with API access</p>
			<p>To access secured<a id="_idIndexMarker420"/> data via the API, you need to do a few<a id="_idIndexMarker421"/> things, as follows:</p>
			<ol>
				<li>Enable access to the data type in the <strong class="bold">Settings API</strong> tab for the application.</li>
				<li>Select at least one of the API settings (<strong class="bold">Modify by API</strong>, <strong class="bold">Delete via API</strong>, and <strong class="bold">Create via API</strong>) in the <strong class="bold">Privacy</strong> tab for the data type in the <strong class="bold">Data</strong> section of the application.</li>
				<li>Authenticate using the API key from the <strong class="bold">Settings API</strong> tab for the application.</li>
			</ol>
			<p>Understanding Bubble's data structure<a id="_idIndexMarker422"/> is a crucial step to enabling automation. While n8n is our preferred tool for automation, Bubble has its own workflow engine built into the system, which we will summarize next.</p>
			<h1 id="_idParaDest-150"><a id="_idTextAnchor167"/>Understanding Bubble's workflow engine</h1>
			<p>Bubble has its own version<a id="_idIndexMarker423"/> of automation built into the system. It is not as robust or functional as n8n, as it is designed to automate and communicate with itself and excels at this. Each workflow executes one or more steps to perform actions supported by the Bubble application.</p>
			<p>There are two different kinds of workflows in the Bubble environment. The first kind is frontend workflows. These are workflows designed to interact with users when they perform an action on one of Bubble's application pages. For example, when you click on the <strong class="bold">Submit</strong> button in Bubble, this executes a frontend workflow.</p>
			<p>Similarly, there are also backend workflows. These workflows are designed to be non-interactive with the user and perform automated tasks based on various triggers such as time of day, changes to data, or input/requests from an API.</p>
			<p>When interacting with Bubble's workflow engine, n8n specifically talks with backend API workflows.</p>
			<p>Depending on how the API workflow is configured, you can send data to the API, which will be used in the workflow. For example, the <code>send-email</code> workflow will accept the following inputs from the API: </p>
			<ul>
				<li><code>to</code></li>
				<li><code>subject</code></li>
				<li><code>body </code></li>
			</ul>
			<p>This is illustrated<a id="_idIndexMarker424"/> in the following screenshot:</p>
			<div><div><img src="img/Figure_8.06_B17493.jpg" alt="Figure 8.6 – Sample backend API workflow configuration screen&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.6 – Sample backend API workflow configuration screen</p>
			<p>So, now that we have a general<a id="_idIndexMarker425"/> understanding of the workflow engine, let's begin using the actual Bubble APIs, starting with the Data API.</p>
			<h1 id="_idParaDest-151"><a id="_idTextAnchor168"/>Using Bubble's Data API</h1>
			<p>Accessing Bubble's data<a id="_idIndexMarker426"/> with n8n is relatively trivial using the Data API. Depending upon the endpoint accessed and the HTTP method used, you can manipulate the data in the Bubble application in any way that you want.</p>
			<p>To load some sample n8n nodes to work with the Data API, please see the <code>Bubble_API.json</code> workflow at <a href="https://github.com/PacktPublishing/Rapid-Product-Development-with-n8n/blob/main/Chapter%208/Bubble_Data_API.json">https://github.com/PacktPublishing/Rapid-Product-Development-with-n8n/blob/main/Chapter%208/Bubble_Data_API.json</a>.</p>
			<h2 id="_idParaDest-152"><a id="_idTextAnchor169"/>Authentication</h2>
			<p>Before you can work with the Bubble Data API<a id="_idIndexMarker427"/> in n8n, you will need to create proper credentials. We will be using the <strong class="bold">HTTP Request</strong> node for all of our API interactions, so we need to create a <strong class="bold">Header Auth</strong> credential, as illustrated in the following screenshot:</p>
			<div><div><img src="img/Figure_8.07_B17493.jpg" alt="Figure 8.7 – Header Auth credential for accessing Bubble APIs&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.7 – Header Auth credential for accessing Bubble APIs</p>
			<p>It is important that the <strong class="bold">Name</strong> field under <strong class="bold">Credential Data</strong> be populated with <strong class="bold">Authorization</strong>, and the <strong class="bold">Value</strong> field must be populated with <strong class="bold">Bearer</strong>, followed by your API private key, which<a id="_idIndexMarker428"/> can be found in the <strong class="bold">Settings</strong> section under the <strong class="bold">API</strong> tab.</p>
			<p>You must also make certain that you provide access to the <strong class="bold">HTTP Request</strong> node.</p>
			<h2 id="_idParaDest-153"><a id="_idTextAnchor170"/>Data manipulation</h2>
			<p>Once you have created your<a id="_idIndexMarker429"/> credentials, you can now use them<a id="_idIndexMarker430"/> to work with Bubble data.</p>
			<p>Here is a list<a id="_idIndexMarker431"/> of the different ways in which you can retrieve and manipulate data in Bubble using the Data API:</p>
			<div><div><img src="img/Table_8.01_B17493.jpg" alt=""/>
				</div>
			</div>
			<p>In each of the endpoints, two special words represent actual unique values from your Bubble application, as follows:</p>
			<ul>
				<li><code>typename</code>—This is the actual name of the data type in Bubble. This is generally the name of the data type in lowercase with all spaces removed.</li>
				<li><code>id</code>—The <strong class="bold">unique identifier</strong> (<strong class="bold">UID</strong>) number for the record<a id="_idIndexMarker432"/> in Bubble.</li>
			</ul>
			<p>For example, if you had a data type of <code>1626690254917x279129440443256930</code>, you would be able to retrieve this record using the <code>https://appname.bubbleapps.io/api/1.1/obj/newsletter/1626690254917x279129440443256930</code> endpoint.</p>
			<p>We now have all the information<a id="_idIndexMarker433"/> we need to start working with the data in the Bubble application.</p>
			<p>n8n uses the <strong class="bold">HTTP Request</strong> node to perform all data manipulation, as illustrated in the following screenshot:</p>
			<div><div><img src="img/Figure_8.08_B17493.jpg" alt="Figure 8.8 – Using the n8n HTTP Request node to manipulate Bubble data&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.8 – Using the n8n HTTP Request node to manipulate Bubble data</p>
			<p>Using the information provided in the previous table, we can configure the <strong class="bold">HTTP Request</strong> node to work with<a id="_idIndexMarker434"/> the data however we wish. In the following<a id="_idIndexMarker435"/> screenshot, you can see the general settings for the <strong class="bold">HTTP Request</strong> node:</p>
			<div><div><img src="img/Figure_8.09_B17493.jpg" alt="Figure 8.9 – General HTTP Request node settings&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.9 – General HTTP Request node settings</p>
			<p>In general, all of the <strong class="bold">HTTP Request</strong> nodes will have the following<a id="_idIndexMarker436"/> settings in common:</p>
			<ul>
				<li><strong class="bold">Header Auth</strong>—Select the Bubble API credentials that you created earlier.</li>
				<li><strong class="bold">Authentication</strong>—<strong class="bold">Header Auth</strong>.</li>
				<li><strong class="bold">Ignore SSL Issues</strong>—<strong class="bold">False</strong>.</li>
				<li><strong class="bold">Response Format</strong>—<strong class="bold">JSON</strong>.</li>
				<li><strong class="bold">JSON/RAW Parameters</strong>—<strong class="bold">False</strong>.</li>
			</ul>
			<p>Once these are set, you can now go on to the custom settings for each action.</p>
			<p>To read all data from<a id="_idIndexMarker437"/> the API, set the <code>GET</code> and the URL to the endpoint<a id="_idIndexMarker438"/> of the data type (for example, <code>https://appname.bubbleapps.io/api/1.1/obj/typename</code>). This will generate a JSON object containing an array of all the records in the data type. The output will look something like this:</p>
			<pre>[
  {
    "response": {
      "cursor": 0,
      "results": [
        {
          "content_text": "Welcome to the n8n Newsletter!",
          "Modified Date": "2021-07-25T13:00:35.174Z",
          "title_text": "First n8n Newsletter",
          "_id": "1627217777235x670007482175516000"
        }
      ],
      "remaining": 0,
      "count": 1
    }
  }
]</pre>
			<p>This will return up to 100 records at a time.</p>
			<p>If you want to just get the information from a specific record, you can specify the ID by appending it to the end of the URL (for example, <code>https://appname.bubbleapps.io/api/1.1/obj/typename/1627217777235x670007482175516000</code>). This will only return a single record.</p>
			<p>To create a new<a id="_idIndexMarker439"/> record, set the <code>POST</code> and the URL to the endpoint<a id="_idIndexMarker440"/> of the data type (for example, <code>https://appname.bubbleapps.io/api/1.1/obj/typename</code>). Then, create a body parameter for each custom field along with the value you would like the field value to be. The process is illustrated in the following screenshot:</p>
			<div><div><img src="img/Figure_8.10_B17493.jpg" alt="Figure 8.10 – Body parameters for creating, updating, or replacing record data&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.10 – Body parameters for creating, updating, or replacing record data</p>
			<p>The API will return a status value and the ID of the new record in JSON format.</p>
			<p>You can also update a specific record in the data type by setting the <code>PATCH</code> and then submitting the request to the record's endpoint (for example, <code>https://appname.bubbleapps.io/api/1.1/obj/typename/1627217777235x670007482175516000</code>), along with one or more body parameters with the field information that needs to be updated. If this update is successful, it will not return any data and will respond with a <code>204</code> status code.</p>
			<p>Replacing an entire record is similar to updating a record with two exceptions. First, the value in the <code>PUT</code>, and second, the body must contain all custom field values. It also returns no data and a <code>204</code> reply code when successful.</p>
			<p>The last action that you can do<a id="_idIndexMarker441"/> with the API is delete a record. Much as with returning a single record, you<a id="_idIndexMarker442"/> use the record's endpoint (for example, <code>https://appname.bubbleapps.io/api/1.1/obj/typename/1627217777235x670007482175516000</code>) and set the <code>DELETE</code>.</p>
			<h2 id="_idParaDest-154"><a id="_idTextAnchor171"/>Searching for data</h2>
			<p>Sometimes, there are too many<a id="_idIndexMarker443"/> records to work through when requesting data using the <code>GET</code> request method when you don't know the record ID. Fortunately, there<a id="_idIndexMarker444"/> are a number of additional search options that will allow you to reduce the number of records returned in each API request.</p>
			<p>The search criteria are entered as query parameters in the <strong class="bold">HTTP Request</strong> node as name-value pairs, as illustrated in the following screenshot:</p>
			<div><div><img src="img/Figure_8.11_B17493.jpg" alt="Figure 8.11 – Setting search limits using query parameters&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.11 – Setting search limits using query parameters</p>
			<p>The first way of reducing the number of records returned is to use the <code>limit</code> parameter. For example, setting the <code>limit</code> parameter to <code>2</code> will only return one record at a time.</p>
			<p>This is all fine and good if the record<a id="_idIndexMarker445"/> you want is in the first set of records (referred to as a <code>cursor</code> parameter comes into play. The <code>cursor</code> parameter, you can start your search from a specific record. The record index counts up by one and starts at zero.</p>
			<p>Setting the <code>cursor</code> parameter can be useful when you determine its value by using the three key/value pairs<a id="_idIndexMarker447"/> returned by a previous <code>GET</code> query. These three pairs are described here:</p>
			<ul>
				<li><code>cursor</code>—The record index of the first item in the results</li>
				<li><code>remaining</code>—The number of records that are remaining after this page</li>
				<li><code>count</code>—The number of items returned</li>
			</ul>
			<p>You can also control the order in which the data is returned by using the <code>sort_field</code> parameter and setting it to the name of one of the data fields. Adding the <code>descending </code>parameter and setting it to either <code>true</code> or <code>false</code> will also control whether the data is sorted in descending or ascending order.</p>
			<p>If you set the <code>sort_field</code> parameter to <code>_random_sorting</code>, it will return the records in random order. So, to receive a single random record, you can set the <code>limit</code> parameter to <code>1</code> and the <code>sort_field</code> parameter to <code>_random_sorting</code>!</p>
			<p>Another way to limit the number of records that are returned from the API is to use the <code>contraints</code> parameter. This contains<a id="_idIndexMarker448"/> an array of one or more JSON objects that tells the API<a id="_idIndexMarker449"/> how to limit the incoming data. Each JSON object<a id="_idIndexMarker450"/> has three key-value pairs, as follows:</p>
			<ul>
				<li><code>key</code>—The name of the field to use for the constraint. You can use the <code>_all</code> keyword to check all fields.</li>
				<li><code>constraint_type</code>—The type of constraint to apply, which can be one of the following:<ul><li><code>equals</code></li><li><code>not equal</code></li><li><code>is_empty</code></li><li><code>is_not_empty</code></li><li><code>text contains</code></li><li><code>not text contains</code></li><li><code>greater than</code></li><li><code>less than</code></li><li><code>in</code></li><li><code>not in</code></li><li><code>contains</code></li><li><code>not contains</code></li><li><code>empty</code></li><li><code>not empty</code></li><li><code>geographic_search</code></li></ul></li>
				<li><code>value</code>—The value that is used<a id="_idIndexMarker451"/> to constrain the search.</li>
			</ul>
			<p>For example, if we wanted to only return records where the <code>title_text</code> field has the word <code>Newsletter</code> in it, we would set the <code>constraints</code> parameter to the following:</p>
			<pre>[
  { 
    "key": "title_text", 
    "constraint_type": "text contains", 
    "value": "Newsletter" 
  }
]</pre>
			<p>You can have as many<a id="_idIndexMarker452"/> JSON records as you wish<a id="_idIndexMarker453"/> in this array.</p>
			<p>By now, you should have a good understanding of how the Bubble Data API works, so let's take a closer look at the Workflow API.</p>
			<h1 id="_idParaDest-155"><a id="_idTextAnchor172"/>Using Bubble's Workflow API</h1>
			<p>The Workflow API is generally<a id="_idIndexMarker454"/> used to activate a Bubble workflow and sometimes<a id="_idIndexMarker455"/> to pass information to the Bubble app. You will use the same credentials and the <strong class="bold">HTTP Request</strong> node to activate workflows and send data.</p>
			<h2 id="_idParaDest-156"><a id="_idTextAnchor173"/>Activating a workflow</h2>
			<p>The <code>POST</code> request method<a id="_idIndexMarker456"/> to activate the workflow and will receive a <code>"status": "success"</code> response if it runs correctly.</p>
			<p>The <strong class="bold">URL</strong> field for the <strong class="bold">HTTP Request</strong> node will be made up of the following two parts:</p>
			<ul>
				<li><code>https://&lt;appname&gt;.bubbleapps.io/api/1.1/wf</code>, where <code>&lt;appname&gt;</code> is the name of your Bubble application.</li>
				<li><strong class="bold">Workflow name</strong>—This is the name of your workflow.</li>
			</ul>
			<p>So, for example, to activate the <code>send-email</code> workflow in my <code>n8n-book</code> app, I would use <code>https://n8n-book.bubbleapps.io/version-test/api/1.1/wf/send-email</code> for the URL.</p>
			<h2 id="_idParaDest-157"><a id="_idTextAnchor174"/>Sending data to a workflow</h2>
			<p>In order to send data<a id="_idIndexMarker457"/> to a workflow, the workflow needs to have the parameters<a id="_idIndexMarker458"/> defined in the API workflow (see <em class="italic">Figure 8.6</em>), and then the parameters need to be defined in the action as dynamic data.</p>
			<p>In our example, the three parameters that can be sent to the <code>send-email</code> workflow via the API are these: </p>
			<ul>
				<li><code>to</code></li>
				<li><code>subject</code></li>
				<li><code>body</code> </li>
			</ul>
			<p>This is illustrated in the following screenshot:</p>
			<div><div><img src="img/Figure_8.12_B17493.jpg" alt="Figure 8.12 – Sample workflow action with dynamic data&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.12 – Sample workflow action with dynamic data</p>
			<p>To send this information<a id="_idIndexMarker459"/> to the workflow via the Workflow API<a id="_idIndexMarker460"/> using the n8n <strong class="bold">HTTP Request</strong> node, add a body parameter for each of the values, as illustrated in the following screenshot:</p>
			<div><div><img src="img/Figure_8.13_B17493.jpg" alt="Figure 8.13 – Body parameters to send to the Workflow API&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.13 – Body parameters to send to the Workflow API</p>
			<p>When the <strong class="bold">HTTP Request</strong> node is executed, it will send the information to the workflow and use<a id="_idIndexMarker461"/> it as inputs to be processed<a id="_idIndexMarker462"/> accordingly, as follows:</p>
			<div><div><img src="img/Figure_8.14_B17493.jpg" alt="Figure 8.14 – Email sent using Bubble Workflow API and submitted data&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.14 – Email sent using Bubble Workflow API and submitted data</p>
			<p>You can get a copy of this sample workflow from the GitHub repository at <a href="https://github.com/PacktPublishing/Rapid-Product-Development-with-n8n/blob/main/Chapter%208/Bubble_Workflow_API.json">https://github.com/PacktPublishing/Rapid-Product-Development-with-n8n/blob/main/Chapter%208/Bubble_Workflow_API.json</a>.</p>
			<p>Now that we know how to activate workflows and send data to Bubble, let's flip things around and get Bubble to activate workflows and send data to n8n.</p>
			<h1 id="_idParaDest-158"><a id="_idTextAnchor175"/>Receiving events and data from Bubble</h1>
			<p>Bubble can send events to n8n and even send data.  By designing n8n<a id="_idIndexMarker463"/> to receive this information, Bubble<a id="_idIndexMarker464"/> can directly execute n8n<a id="_idIndexMarker465"/> workflows and extend<a id="_idIndexMarker466"/> its capabilities.</p>
			<h2 id="_idParaDest-159"><a id="_idTextAnchor176"/>Configuring n8n</h2>
			<p>To do this, first create<a id="_idIndexMarker467"/> a simple <strong class="bold">Webhook</strong> node with the following settings:</p>
			<ul>
				<li><strong class="bold">Authentication</strong>—<strong class="bold">None</strong></li>
				<li><code>POST</code></li>
				<li><code>bubble</code></li>
				<li><code>200</code></li>
				<li><strong class="bold">Response Mode</strong>—<strong class="bold">Last Node</strong></li>
				<li><strong class="bold">Response Data</strong>—<strong class="bold">First Entry JSON</strong></li>
			</ul>
			<p>You can also copy the test <strong class="bold">Webhook</strong> URL as you will need this information when configuring Bubble.</p>
			<p>Next, add a <code>n8n received the following data on {{new Date().toDateString()}} at {{new Date().toTimeString()}}: {{$json["body"]["data"]}}</code>.</p>
			<p>Now, save the workflow so that the Webhook initializes.</p>
			<p>You can get a copy of this workflow on GitHub from <a href="https://github.com/PacktPublishing/Rapid-Product-Development-with-n8n/blob/main/Chapter%208/Bubble_Events.json">https://github.com/PacktPublishing/Rapid-Product-Development-with-n8n/blob/main/Chapter%208/Bubble_Events.json</a>.</p>
			<h2 id="_idParaDest-160"><a id="_idTextAnchor177"/>Configuring Bubble</h2>
			<p>Now that n8n<a id="_idIndexMarker468"/> is ready to go, it's time to prepare Bubble.</p>
			<p>First, make sure that the <strong class="bold">API Connector</strong> plugin is installed in your Bubble application. If it isn't, install it now. You<a id="_idIndexMarker469"/> can read more about the <strong class="bold">API Connector</strong> plugin at <a href="https://manual.bubble.io/core-resources/bubble-made-plugins/api-connector">https://manual.bubble.io/core-resources/bubble-made-plugins/api-connector</a>.</p>
			<p>Next, we are going to configure the <strong class="bold">API Connector</strong> plugin. On the <strong class="bold">API Connector</strong> plugin page, click on the <strong class="bold">Add another API</strong> button. Set the <strong class="bold">API Name</strong> field to <strong class="bold">n8n Workflow</strong>. </p>
			<p>To configure the API call, click on <code>GET</code> to <code>POST</code> and then pass the test <strong class="bold">Webhook</strong> URL into the field next to it.</p>
			<p>Add a parameter to send to n8n by clicking on the <strong class="bold">Add parameter</strong> button. Then, for the <strong class="bold">Key</strong> value, enter <strong class="bold">data</strong>, and for <strong class="bold">Value</strong>, enter <strong class="bold">Running Sloth Festival</strong>.</p>
			<p>The plugin should now be ready to initialize by sending information to n8n and looking at the response that it sends back. To initialize the plugin, first, go back to your n8n workflow and click the <strong class="bold">Execute Workflow</strong> button to start the Webhook listening for input. You should then see a screen like this:</p>
			<div><div><img src="img/Figure_8.15_B17493.jpg" alt="Figure 8.15 – Initializing a response from n8n&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.15 – Initializing a response from n8n</p>
			<p>Next, return to the Bubble plugin and click the <strong class="bold">Initialize call</strong> button. A pop-up window should appear with<a id="_idIndexMarker470"/> the response sent by n8n. Click the <strong class="bold">Show raw data</strong> text to see the exact response sent by n8n. This should match the information shown in the n8n <strong class="bold">Set</strong> node, as illustrated in the following screenshot:</p>
			<div><div><img src="img/Figure_8.16_B17493.jpg" alt="Figure 8.16 – Completed Bubble API Connector plugin&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.16 – Completed Bubble API Connector plugin</p>
			<p>Now, whenever you are working<a id="_idIndexMarker471"/> on a workflow in Bubble, you can use the <strong class="bold">n8n Workflow - Send n8n Data</strong> action in the <strong class="bold">Plugins</strong> section, as illustrated in the following screenshot:</p>
			<div><div><img src="img/Figure_8.17_B17493.jpg" alt="Figure 8.17 – New n8n action in the Bubble workflow editor&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 8.17 – New n8n action in the Bubble workflow editor</p>
			<p>Now that you have configured both n8n and Bubble to work in harmony, you can extend Bubble however<a id="_idIndexMarker472"/> you wish with all the power of n8n, its nodes, and any of the services that n8n can access. This opens up your Bubble application to do almost anything that you can dream of.</p>
			<h1 id="_idParaDest-161"><a id="_idTextAnchor178"/>Summary</h1>
			<p>In this chapter, we learned about the Bubble API. We worked with the Data API to manipulate information in Bubble and the Workflow API to execute workflows. We also learned how to do all of this using n8n, primarily with the <strong class="bold">HTTP Request</strong> node.</p>
			<p>We also learned how to use Bubble to activate Webhooks in n8n and pass information between the two systems.</p>
			<p>In the next chapter, using Bubble, we are going to be learning how to build the frontend of an application that will use n8n on the backend to process information.</p>
		</div>
	</body></html>