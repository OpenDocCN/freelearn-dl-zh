["```py\nfrom langchain.schema import (\n    AIMessage,\n    HumanMessage,\n    SystemMessage\n)\nfrom langchain.chains import LLMChain, ConversationChain\nfrom langchain.chat_models import ChatOpenAI\nfrom langchain.chat_models import ChatOpenAI\nchat = ChatOpenAI()\nmessages = [\n    SystemMessage(content=\"You are a helpful assistant that help the user to plan an optimized itinerary.\"),\n    HumanMessage(content=\"I'm going to Rome for 2 days, what can I visit?\")] \n```", "```py\noutput = chat(messages)\nprint(output.content) \n```", "```py\nIn Rome, there are many famous attractions to visit. Here's an optimized itinerary for your two-day trip:\nDay 1:\n 1\\. Start your day by visiting the Colosseum, one of the world's most iconic ancient landmarks.\n 2\\. Next, explore the nearby Roman Forum, an ancient Roman marketplace.\n 3\\. Afterward, head to the Pantheon, a well-preserved Roman temple with a stunning dome.\n4\\. Take a stroll through the historic district of Trastevere, known for its charming streets and authentic Roman atmosphere.\n5\\. In the evening, visit the Trevi Fountain and toss a coin to ensure your return to Rome.\nDay 2:\n1\\. Begin your day at Vatican City, the smallest independent state in the world. Visit St. Peter's Basilica and admire Michelangelo's masterpiece, the Sistine Chapel.\n2\\. Explore the Vatican Museums, home to an extensive collection of art and historical artifacts.\n3\\. Enjoy a leisurely walk along the Tiber River and cross over to the picturesque neighborhood of Castel Sant'Angelo.\n4\\. Visit the Spanish Steps, a popular meeting point with a beautiful view of the city.\n5\\. End your day by exploring the charming neighborhood of Piazza Navona, known for its baroque architecture and lively atmosphere.\nRemember to check the opening hours and availability of tickets for the attractions in advance. Enjoy your trip to Rome! \n```", "```py\nfrom langchain.memory import ConversationBufferMemory\nfrom langchain.chains import ConversationChain\nmemory = ConversationBufferMemory()\nconversation = ConversationChain(\n    llm=chat, verbose=True, memory=memory\n) \n```", "```py\nconversation.run(\"Hi there!\") \n```", "```py\n> Entering new ConversationChain chain...\nPrompt after formatting:\nThe following is a friendly conversation between a human and an AI. The AI is talkative and provides lots of specific details from its context. If the AI does not know the answer to a question, it truthfully says it does not know.\nCurrent conversation:\nHuman: Hi there!\nAI:\n> Finished chain.\n'Hello! How can I assist you today?' \n```", "```py\nconversation.run(\"what is the most iconic place in Rome?\") \n```", "```py\n> Entering new ConversationChain chain...\nPrompt after formatting:\nThe following is a friendly conversation between a human and an AI. The AI is talkative and provides lots of specific details from its context. If the AI does not know the answer to a question, it truthfully says it does not know.\nCurrent conversation:\nHuman: Hi there!\nAI: Hello! How can I assist you today?\nHuman: what is the most iconic place in Rome?\nAI:\n> Finished chain.\n'The most iconic place in Rome is probably the Colosseum. It is a magnificent amphitheater that was built in the first century AD and is one of the most recognizable symbols of ancient Rome. The Colosseum was used for gladiatorial contests, public spectacles, and other events. Today, it is a major tourist attraction and a UNESCO World Heritage site.' \n```", "```py\nconversation.run(\"What kind of other events?\") \n```", "```py\n> Entering new ConversationChain chain...\nPrompt after formatting:\nThe following is a friendly conversation between a human and an AI. The AI is talkative and provides lots of specific details from its context. If the AI does not know the answer to a question, it truthfully says it does not know.\nCurrent conversation:\nHuman: Hi there!\nAI: Hello! How can I assist you today?\nHuman: what is the most iconic place in Rome?\nAI: The most iconic place in Rome is probably the Colosseum. It is a magnificent amphitheater that was built in the first century AD and is one of the most recognizable symbols of ancient Rome. The Colosseum was used for gladiatorial contests, public spectacles, and other events. Today, it is a major tourist attraction and a UNESCO World Heritage site.\nHuman: What kind of other events?\nAI:\n> Finished chain.\n'Other events that took place at the Colosseum include mock sea battles, animal hunts, and reenactments of famous battles. The Colosseum was also used for executions and religious ceremonies. It was a versatile venue that could accommodate a variety of events and entertainments.' \n```", "```py\n{'history': 'Human: Hi there!\\nAI: Hello! How can I assist you today?\\nHuman: what is the most iconic place in Rome?.... \n```", "```py\nwhile True:\n    query = input('you: ')\n    if query == 'q':\n        break\n    output = conversation({\"input\": query})\n    print('User: ', query)\n    print('AI system: ', output['response']) \n```", "```py\nUser:  hello\nAI system:  Hello! How can I assist you today?\nUser:  I'm planning a 1-day trip in Venice. What should I visit?\nAI system:  That sounds like a wonderful plan! In Venice, there are several must-visit attractions that you can explore in a day. Here's a suggested itinerary for your 1-day trip in Venice:\n1\\. St. Mark's Square (Piazza San Marco): [...] Enjoy your trip to Venice!\nUser:  thanks! I'm planning to be around also the next day, and I love hiking. Do you have any suggestion nearby?\nAI system:  Certainly! If you enjoy hiking and want to explore the natural beauty around Venice, there are a few options you can consider for the next day:\n1\\. The Dolomites: [...]\nUser:  which one is closer to Milan?\nAI system:  If you're looking for a hiking destination closer to Milan, the best option would be the Lombardy region [...] \n```", "```py\nfrom langchain.llms import OpenAI\nfrom langchain.chat_models import ChatOpenAI\nfrom langchain.embeddings.openai import OpenAIEmbeddings\nfrom langchain.text_splitter import RecursiveCharacterTextSplitter\nfrom langchain.vectorstores import FAISS\nfrom langchain.document_loaders import PyPDFLoader\nfrom langchain.chains import ConversationalRetrievalChain\nfrom langchain.memory import ConversationBufferMemory\ntext_splitter = RecursiveCharacterTextSplitter(\n            chunk_size=1500,\n            chunk_overlap=200\n        )\nraw_documents = PyPDFLoader('italy_travel.pdf').load()\ndocuments = text_splitter.split_documents(raw_documents)\ndb = FAISS.from_documents(documents, OpenAIEmbeddings())\nmemory = ConversationBufferMemory(\n            memory_key='chat_history',\n            return_messages=True\n        )\nllm = ChatOpenAI() \n```", "```py\nqa_chain = ConversationalRetrievalChain.from_llm(llm, retriever=db.as_retriever(), memory=memory, verbose=True)\nqa_chain.run({'question':'Give me some review about the Pantheon'}) \n```", "```py\n> Entering new StuffDocumentsChain chain...\n> Entering new LLMChain chain...\nPrompt after formatting:\nSystem: Use the following pieces of context to answer the users question.\nIf you don't know the answer, just say that you don't know, don't try to make up an answer.\n----------------\ncafes in the square. The most famous are the Quadri and\nFlorian.\nPiazza San Marco,\nVenice\n4\nHistorical Monuments\nPantheon\nMiskita:\n\"Angelic and non-human design,\" was how\nMichelangelo described the Pantheon 14 centuries after its\nconstruction. The highlights are the gigantic dome, the upper\neye, the sheer size of the place, and the harmony of the\nwhole building. We visited with a Roman guide which is\n...\n> Finished chain.\n'Miskita:\\n\"Angelic and non-human design,\" was how Michelangelo described the Pantheon 14 centuries after its construction. The highlights \n```", "```py\nfrom langchain.agents.agent_toolkits import create_retriever_tool\ntool = create_retriever_tool(\n    db.as_retriever(),\n    \"italy_travel\",\n    \"Searches and returns documents regarding Italy.\"\n)\ntools = [tool]\nmemory = ConversationBufferMemory(\n            memory_key='chat_history',\n            return_messages=True\n        )\nfrom langchain.agents.agent_toolkits import create_conversational_retrieval_agent\nfrom langchain.chat_models import ChatOpenAI\nllm = ChatOpenAI(temperature = 0)\nagent_executor = create_conversational_retrieval_agent(llm, tools, memory_key='chat_history', verbose=True) \n```", "```py\nagent_executor({\"input\": \"Tell me something about Pantheon\"}) \n```", "```py\n> Entering new AgentExecutor chain...\nInvoking: `italy_travel` with `Pantheon`\n[Document(page_content='cafes in the square. The most famous are the Quadri and\\nFlorian. […]\n> Finished chain. \n```", "```py\noutput = agent_executor({\"input\": \"what can I visit in India in 3 days?\"}) \n```", "```py\n> Entering new AgentExecutor chain...\nIn India, there are numerous incredible places to visit, each with its own unique attractions and cultural experiences. While three days is a relatively short time to explore such a vast and diverse country, here are a few suggestions for places you can visit:\n1\\. Delhi: Start your trip in the capital city of India, Delhi. […]\n> Finished chain. \n```", "```py\nfrom langchain import SerpAPIWrapper\nimport os\nfrom dotenv import load_dotenv\nload_dotenv()\nos.environ[\"SERPAPI_API_KEY\"]\nsearch = SerpAPIWrapper()\ntools = [\n    Tool.from_function(\n        func=search.run,\n        name=\"Search\",\n        description=\"useful for when you need to answer questions about current events\"\n    ),\n    create_retriever_tool(\n        db.as_retriever(),\n        \"italy_travel\",\n        \"Searches and returns documents regarding Italy.\"\n    )\n    ]\nagent_executor = create_conversational_retrieval_agent(llm, tools, memory_key='chat_history', verbose=True) \n```", "```py\n    > Entering new AgentExecutor chain...\n    India is a vast and diverse country with numerous attractions to explore. While it may be challenging to cover all the highlights in just three days, here are some popular destinations that you can consider visiting:\n    1\\. Delhi: Start your trip in the capital city of India, Delhi. […]\n    > Finished chain. \n    ```", "```py\n    > Entering new AgentExecutor chain...\n    Invoking: `Search` with `{'query': 'current weather in Delhi'}`\n    Current Weather · 95°F Mostly sunny · RealFeel® 105°. Very Hot. RealFeel Guide. Very Hot. 101° to 107°. Caution advised. Danger of dehydration, heat stroke, heat ...The current weather in Delhi is 95°F (35°C) with mostly sunny conditions. The RealFeel® temperature is 105°F (41°C), indicating that it feels very hot. Caution is advised as there is a danger of dehydration, heat stroke, and heat-related issues. It is important to stay hydrated and take necessary precautions if you are in Delhi or planning to visit.\n    > Finished chain. \n    ```", "```py\n    > Entering new AgentExecutor chain...\n    Invoking: `italy_travel` with `{'query': 'main attractions in Italy'}`\n    [Document(page_content='ITALY\\nMINUBE TRAVEL GUIDE\\nThe best must-see places for your travels, […]\n    Here are some suggestions for main attractions in Italy:\n    1\\. Parco Sempione, Milan: This is one of the most important parks in Milan. It offers a green space in the city where you can relax, workout, or take a leisurely walk. […]\n    > Finished chain. \n    ```", "```py\n    import streamlit as st\n    st.set_page_config(page_title=\"GlobeBotter\", page_icon=\"![](img/Globe.png)\")\n    st.header('![](img/Globe.png) Welcome to Globebotter, your travel assistant with Internet access. What are you planning for your next trip?') \n    ```", "```py\n    search = SerpAPIWrapper()\n    text_splitter = RecursiveCharacterTextSplitter(\n                chunk_size=1500,\n                chunk_overlap=200\n            )\n    raw_documents = PyPDFLoader('italy_travel.pdf').load()\n    documents = text_splitter.split_documents(raw_documents)\n    db = FAISS.from_documents(documents, OpenAIEmbeddings())\n    memory = ConversationBufferMemory(\n        return_messages=True,\n        memory_key=\"chat_history\",\n        output_key=\"output\"\n    )\n    llm = ChatOpenAI()\n    tools = [\n        Tool.from_function(\n            func=search.run,\n            name=\"Search\",\n            description=\"useful for when you need to answer questions about current events\"\n        ),\n        create_retriever_tool(\n            db.as_retriever(),\n            \"italy_travel\",\n            \"Searches and returns documents regarding Italy.\"\n        )\n        ]\n    agent = create_conversational_retrieval_agent(llm, tools, memory_key='chat_history', verbose=True) \n    ```", "```py\n    user_query = st.text_input(\n        \"**Where are you planning your next vacation?**\",\n        placeholder=\"Ask me anything!\"\n    ) \n    ```", "```py\n    if \"messages\" not in st.session_state:\n        st.session_state[\"messages\"] = [{\"role\": \"assistant\", \"content\": \"How can I help you?\"}]\n    if \"memory\" not in st.session_state:\n        st.session_state['memory'] = memory \n    ```", "```py\n    for msg in st.session_state[\"messages\"]:\n        st.chat_message(msg[\"role\"]).write(msg[\"content\"]) \n    ```", "```py\n    if user_query:\n        st.session_state.messages.append({\"role\": \"user\", \"content\": user_query})\n        st.chat_message(\"user\").write(user_query)\n        with st.chat_message(\"assistant\"):\n            st_cb = StreamlitCallbackHandler(st.container())\n            response = agent(user_query, callbacks=[st_cb])\n            st.session_state.messages.append({\"role\": \"assistant\", \"content\": response})\n            st.write(response) \n    ```", "```py\n    if st.sidebar.button(\"Reset chat history\"):\n        st.session_state.messages = [] \n    ```", "```py\nfrom langchain.callbacks.base import BaseCallbackHandler\nfrom langchain.schema import ChatMessage\nfrom langchain_openai import ChatOpenAI\nimport streamlit as st\nclass StreamHandler(BaseCallbackHandler):\n    def __init__(self, container, initial_text=\"\"):\n        self.container = container\n        self.text = initial_text\n    def on_llm_new_token(self, token: str, **kwargs) -> None:\n        self.text += token\n        self.container.markdown(self.text) \n```", "```py\n with st.chat_message(\"assistant\"):\n        stream_handler = StreamHandler(st.empty())\n        llm = ChatOpenAI(streaming=True, callbacks=[stream_handler])\n        response = llm.invoke(st.session_state.messages)\n        st.session_state.messages.append(ChatMessage(role=\"assistant\", content=response.content)) \n```"]