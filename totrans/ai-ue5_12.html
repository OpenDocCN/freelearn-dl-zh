<html><head></head><body>
  <div id="_idContainer229">
   <h1 class="chapter-number" id="_idParaDest-231">
    <a id="_idTextAnchor233">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     12
    </span>
   </h1>
   <h1 id="_idParaDest-232">
    <a id="_idTextAnchor234">
    </a>
    <span class="koboSpan" id="kobo.2.1">
     Using Hierarchical State Machines with State Trees
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.3.1">
     Unreal
    </span>
    <a id="_idIndexMarker588">
    </a>
    <span class="koboSpan" id="kobo.4.1">
     Engine provides a powerful framework for creating complex AI behaviors through
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.5.1">
      hierarchical state machines
     </span>
    </strong>
    <span class="koboSpan" id="kobo.6.1">
     called
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.7.1">
      state trees
     </span>
    </strong>
    <span class="koboSpan" id="kobo.8.1">
     .
    </span>
    <span class="koboSpan" id="kobo.8.2">
     By defining various
    </span>
    <a id="_idIndexMarker589">
    </a>
    <span class="koboSpan" id="kobo.9.1">
     states and transitions, developers can design sophisticated AI logic that adapts to dynamic environments.
    </span>
    <span class="koboSpan" id="kobo.9.2">
     State trees offer a structured approach to managing AI behavior, allowing for efficient decision-making and seamless integration with other systems in Unreal Engine.
    </span>
    <span class="koboSpan" id="kobo.9.3">
     What’s more, with state trees, you can build clever AI agents that respond to environmental stimuli and interact with the game world in a natural and realistic manner.
    </span>
    <span class="koboSpan" id="kobo.9.4">
     The purpose of the chapter is to introduce you to the state tree framework in Unreal Engine and to its
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.10.1">
      basic concepts.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.11.1">
     In this chapter, we will have a quick introduction to the state tree system available in Unreal Engine and see how to implement state trees inside
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.12.1">
      a project.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.13.1">
     In this chapter, we will be covering the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.14.1">
      following topics:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.15.1">
      Introducing
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.16.1">
       state trees
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.17.1">
      Creating and managing
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.18.1">
       state trees
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.19.1">
      Using advanced state
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.20.1">
       tree features
      </span>
     </span>
    </li>
   </ul>
   <h1 id="_idParaDest-233">
    <a id="_idTextAnchor235">
    </a>
    <span class="koboSpan" id="kobo.21.1">
     Technical requirements
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.22.1">
     To follow the topics presented in this chapter, you should have completed the previous ones and understood
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.23.1">
      their content.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.24.1">
     You’ll be using the starter content available in this book’s companion repository located at
    </span>
    <a href="https://github.com/PacktPublishing/Artificial-Intelligence-in-Unreal-Engine-5">
     <span class="koboSpan" id="kobo.25.1">
      https://github.com/PacktPublishing/Artificial-Intelligence-in-Unreal-Engine-5
     </span>
    </a>
    <span class="koboSpan" id="kobo.26.1">
     .
    </span>
    <span class="koboSpan" id="kobo.26.2">
     Through this link, locate the section for this chapter and download the following
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.27.1">
      .zip
     </span>
    </strong>
    <span class="koboSpan" id="kobo.28.1">
     file:
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.29.1">
      Unreal Agility Arena –
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.30.1">
       Starter Content
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.31.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.32.1">
     Although not mandatory, you can use the code created so far or download the files that correspond to the end of the last chapter by clicking the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.33.1">
      Unreal Agility Arena –
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.34.1">
       Chapter 11
      </span>
     </strong>
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.35.1">
      -
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.36.1">
       End
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.37.1">
      link.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-234">
    <a id="_idTextAnchor236">
    </a>
    <span class="koboSpan" id="kobo.38.1">
     Introducing state trees
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.39.1">
     It appeared inevitable that, sooner or later, someone would uncover Dr.
    </span>
    <span class="koboSpan" id="kobo.39.2">
     Markus’
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.40.1">
      secret experiments:
     </span>
    </span>
   </p>
   <p>
    <em class="italic">
     <span class="koboSpan" id="kobo.41.1">
      Hidden in their secret laboratory, Dr.
     </span>
     <span class="koboSpan" id="kobo.41.2">
      Markus and Professor Viktoria kept on with their groundbreaking experiments.
     </span>
     <span class="koboSpan" id="kobo.41.3">
      However, news of their remarkable inventions began to spread like wildfire; paparazzi and curious individuals started flocking to the area, eager to uncover the secrets hidden within the
     </span>
    </em>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.42.1">
       laboratory’s walls.
      </span>
     </em>
    </span>
   </p>
   <p>
    <em class="italic">
     <span class="koboSpan" id="kobo.43.1">
      Dr.
     </span>
     <span class="koboSpan" id="kobo.43.2">
      Markus and Professor Viktoria realized they needed to take drastic measures to protect their precious research.
     </span>
     <span class="koboSpan" id="kobo.43.3">
      With their expertise, the ingenious duo started enhancing their beloved AI dummy puppets with advanced algorithms and behavioral patterns.
     </span>
     <span class="koboSpan" id="kobo.43.4">
      They programmed the puppets to detect and respond to unauthorized intrusions, trying to ensure the safety of their laboratory
     </span>
    </em>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.44.1">
       and research.
      </span>
     </em>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.45.1">
     State trees
    </span>
    <a id="_idIndexMarker590">
    </a>
    <span class="koboSpan" id="kobo.46.1">
     are the Unreal Engine version of hierarchical state machines that merge selectors from behavior trees with state machines, enabling users to build efficient and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.47.1">
      well-organized logic.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.48.1">
     Note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.49.1">
     A hierarchical state machine
    </span>
    <a id="_idIndexMarker591">
    </a>
    <span class="koboSpan" id="kobo.50.1">
     is a design pattern used in software development to model complex systems with multiple states and transitions.
    </span>
    <span class="koboSpan" id="kobo.50.2">
     It extends the concept of traditional finite-state machines by introducing the idea of hierarchically nested states.
    </span>
    <span class="koboSpan" id="kobo.50.3">
     In a hierarchical state machine, states can be organized into a hierarchical structure, where higher-level states encapsulate and control lower-level states; this nesting allows for a more modular and organized representation of the system behavior.
    </span>
    <span class="koboSpan" id="kobo.50.4">
     Each state can have its own set of substates, which can further have their own substates, forming a hierarchical tree-like structure.
    </span>
    <span class="koboSpan" id="kobo.50.5">
     The main advantage of this pattern is that it provides a way to reuse behavior across multiple states.
    </span>
    <span class="koboSpan" id="kobo.50.6">
     Instead of duplicating similar logic in different states, common behavior can be defined at higher-level states and inherited by their substates.
    </span>
    <span class="koboSpan" id="kobo.50.7">
     This promotes code reusability, reduces redundancy, and simplifies the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.51.1">
      overall design.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.52.1">
     A state tree
    </span>
    <a id="_idIndexMarker592">
    </a>
    <span class="koboSpan" id="kobo.53.1">
     is structured hierarchically, with the state selection process generally starting at the root.
    </span>
    <span class="koboSpan" id="kobo.53.2">
     However, state selection can be initiated from any node within
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.54.1">
      the tree.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.55.1">
     When selecting
    </span>
    <a id="_idIndexMarker593">
    </a>
    <span class="koboSpan" id="kobo.56.1">
     a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.57.1">
      state
     </span>
    </strong>
    <span class="koboSpan" id="kobo.58.1">
     , the system evaluates a set of
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.59.1">
      enter conditions
     </span>
    </strong>
    <span class="koboSpan" id="kobo.60.1">
     for the state itself; if
    </span>
    <a id="_idIndexMarker594">
    </a>
    <span class="koboSpan" id="kobo.61.1">
     conditions are met, the selection progresses to the child states.
    </span>
    <span class="koboSpan" id="kobo.61.2">
     If no child states exist, it means a leaf has been reached and the current state
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.62.1">
      is activated.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.63.1">
     Activating a state
    </span>
    <a id="_idIndexMarker595">
    </a>
    <span class="koboSpan" id="kobo.64.1">
     triggers all states from
    </span>
    <a id="_idIndexMarker596">
    </a>
    <span class="koboSpan" id="kobo.65.1">
     the root to the leaf state, with each of these states comprising
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.66.1">
      tasks
     </span>
    </strong>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.67.1">
      and
     </span>
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.68.1">
       transitions
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.69.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.70.1">
     Upon selecting a state, the chosen state and all its parent states become active, executing tasks for all active states starting from the root down to the leaf state.
    </span>
    <span class="koboSpan" id="kobo.70.2">
     All tasks in a state are executed concurrently, and the first task reaching completion will trigger a transition that may result in the selection of a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.71.1">
      new state.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.72.1">
     Transitions can
    </span>
    <a id="_idIndexMarker597">
    </a>
    <span class="koboSpan" id="kobo.73.1">
     point to any state in the tree, and they are triggered by a set of
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.74.1">
      trigger conditions
     </span>
    </strong>
    <span class="koboSpan" id="kobo.75.1">
     that must be satisfied for the transition to proceed.
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.76.1">
       Figure 12
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.77.1">
      .1
     </span>
    </em>
    <span class="koboSpan" id="kobo.78.1">
     shows a typical example of a state tree (example taken from the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.79.1">
      City Sample
     </span>
    </strong>
    <span class="koboSpan" id="kobo.80.1">
     project freely available in the Epic
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.81.1">
      Games Marketplace):
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer196">
     <span class="koboSpan" id="kobo.82.1">
      <img alt="Figure 12.1 – State tree example" src="image/Figure_12.1_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.83.1">
     Figure 12.1 – State tree example
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.84.1">
     To sum it up, the main elements of a state tree are
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.85.1">
      as follows:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.86.1">
       Root
      </span>
     </strong>
     <span class="koboSpan" id="kobo.87.1">
      state: the
     </span>
     <a id="_idIndexMarker598">
     </a>
     <span class="koboSpan" id="kobo.88.1">
      first state selected when the state tree starts executing
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.89.1">
       its logic
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.90.1">
       Selector
      </span>
     </strong>
     <span class="koboSpan" id="kobo.91.1">
      state: state
     </span>
     <a id="_idIndexMarker599">
     </a>
     <span class="koboSpan" id="kobo.92.1">
      with
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.93.1">
       child states
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.94.1">
       State enter condition
      </span>
     </strong>
     <span class="koboSpan" id="kobo.95.1">
      : lists
     </span>
     <a id="_idIndexMarker600">
     </a>
     <span class="koboSpan" id="kobo.96.1">
      the conditions that decide if a state can
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.97.1">
       be selected
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.98.1">
       Task
      </span>
     </strong>
     <span class="koboSpan" id="kobo.99.1">
      : lists a set of actions
     </span>
     <a id="_idIndexMarker601">
     </a>
     <span class="koboSpan" id="kobo.100.1">
      that will be executed when a state
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.101.1">
       is activated
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.102.1">
       Transition
      </span>
     </strong>
     <span class="koboSpan" id="kobo.103.1">
      : the
     </span>
     <a id="_idIndexMarker602">
     </a>
     <span class="koboSpan" id="kobo.104.1">
      conditions that will trigger the state
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.105.1">
       selection process
      </span>
     </span>
    </li>
   </ul>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.106.1">
     Note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.107.1">
     In case you are wondering, state trees and behavior trees are both decision-making architectures used in AI, but they serve different purposes.
    </span>
    <span class="koboSpan" id="kobo.107.2">
     State trees are structured around discrete states and transitions, focusing on the current state of an entity and how it changes in response to events.
    </span>
    <span class="koboSpan" id="kobo.107.3">
     This makes them suitable for scenarios where clear, distinct states are necessary.
    </span>
    <span class="koboSpan" id="kobo.107.4">
     In contrast, behavior trees are designed for more complex and fluid decision-making, allowing for modular and hierarchical task execution.
    </span>
    <span class="koboSpan" id="kobo.107.5">
     They enable smoother transitions between tasks and can handle more intricate behaviors by combining simple actions into
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.108.1">
      complex sequences.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.109.1">
     Now that you have a basic understanding of the main state tree terminology, we will show how to extend your own
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.110.1">
      state trees.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-235">
    <a id="_idTextAnchor237">
    </a>
    <span class="koboSpan" id="kobo.111.1">
     Extending state trees
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.112.1">
     A state tree can be created to be
    </span>
    <a id="_idIndexMarker603">
    </a>
    <span class="koboSpan" id="kobo.113.1">
     executed on an AI controller or directly from an actor.
    </span>
    <span class="koboSpan" id="kobo.113.2">
     There are two different components available to handle a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.114.1">
      state tree:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.115.1">
       StateTreeComponent
      </span>
     </strong>
     <span class="koboSpan" id="kobo.116.1">
      : This can be attached to any actor and be executed by the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.117.1">
       actor itself
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.118.1">
       StateTreeAIComponent
      </span>
     </strong>
     <span class="koboSpan" id="kobo.119.1">
      : This can be attached to any AI controller and be executed by the AI
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.120.1">
       controller itself
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.121.1">
     Additionally, as you may have already guessed, the state tree system has been created with extensibility in mind, which means you can create your own tasks, evaluators, and conditions.
    </span>
    <span class="koboSpan" id="kobo.121.2">
     Although you can create your own C++ structures, state trees have been implemented with Blueprint creation in mind.
    </span>
    <span class="koboSpan" id="kobo.121.3">
     In particular, the main classes available are
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.122.1">
      as follows:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.123.1">
       StateTreeTaskBlueprintBase
      </span>
     </strong>
     <span class="koboSpan" id="kobo.124.1">
      : Used for implementing your
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.125.1">
       own tasks
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.126.1">
       StateTreeEvaluatorBlueprintBase
      </span>
     </strong>
     <span class="koboSpan" id="kobo.127.1">
      : Used for implementing your
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.128.1">
       own evaluators
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.129.1">
       StateTreeConditionBlueprintBase
      </span>
     </strong>
     <span class="koboSpan" id="kobo.130.1">
      : Used for implementing your
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.131.1">
       own conditions
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.132.1">
     When extending state trees, it’s advisable to implement your own node logic using Blueprints rather than C++.
    </span>
    <span class="koboSpan" id="kobo.132.2">
     This approach can enhance flexibility and ease
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.133.1">
      of use.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-236">
    <a id="_idTextAnchor238">
    </a>
    <span class="koboSpan" id="kobo.134.1">
     Understanding the state tree flow
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.135.1">
     State selection
    </span>
    <a id="_idIndexMarker604">
    </a>
    <span class="koboSpan" id="kobo.136.1">
     in a state tree starts from the tree root and continues down the tree by evaluating each enter conditions.
    </span>
    <span class="koboSpan" id="kobo.136.2">
     The evaluation process
    </span>
    <a id="_idIndexMarker605">
    </a>
    <span class="koboSpan" id="kobo.137.1">
     follows
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.138.1">
      these steps:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.139.1">
      If enter conditions are not satisfied, selection goes to the next
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.140.1">
       sibling state
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.141.1">
      If enter conditions are satisfied and the state is a leaf, it is selected as the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.142.1">
       new state
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.143.1">
      If enter conditions are satisfied but the state is not a leaf, the process is executed for the first
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.144.1">
       child state
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.145.1">
     It should be noted that state selection is run dynamically, triggered by transitions.
    </span>
    <span class="koboSpan" id="kobo.145.2">
     During the first tick, there is an implicit transition to the root state, which then determines the initial state to be executed.
    </span>
    <span class="koboSpan" id="kobo.145.3">
     Subsequently, once this state is chosen, the transitions specify the conditions that trigger the selection logic, determining when and where it will
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.146.1">
      be executed.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.147.1">
     Once a state is selected, all its tasks are executed and will keep on executing until a transition triggers a new state
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.148.1">
      selection process.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-237">
    <a id="_idTextAnchor239">
    </a>
    <span class="koboSpan" id="kobo.149.1">
     Data binding
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.150.1">
     In game
    </span>
    <a id="_idIndexMarker606">
    </a>
    <span class="koboSpan" id="kobo.151.1">
     programming,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.152.1">
      data binding
     </span>
    </strong>
    <span class="koboSpan" id="kobo.153.1">
     refers
    </span>
    <a id="_idIndexMarker607">
    </a>
    <span class="koboSpan" id="kobo.154.1">
     to the process of connecting data between different parts of the game – such as the user interface and the game logic – and it involves creating a link that allows data to be synchronized and updated across various elements of the game.
    </span>
    <span class="koboSpan" id="kobo.154.2">
     This helps in keeping the game elements consistent and up to date with the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.155.1">
      latest information.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.156.1">
     State trees use data binding for transferring data within the tree and to establish conditions or configure tasks for execution.
    </span>
    <span class="koboSpan" id="kobo.156.2">
     Data binding allows access to data passed into the state tree or between nodes in a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.157.1">
      specified manner.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.158.1">
     State tree nodes have the following elements available to implement
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.159.1">
      data binding:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.160.1">
       Parameters
      </span>
     </strong>
     <span class="koboSpan" id="kobo.161.1">
      : These
     </span>
     <a id="_idIndexMarker608">
     </a>
     <span class="koboSpan" id="kobo.162.1">
      can be referenced during the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.163.1">
       tree’s execution
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.164.1">
       Context data
      </span>
     </strong>
     <span class="koboSpan" id="kobo.165.1">
      : This
     </span>
     <a id="_idIndexMarker609">
     </a>
     <span class="koboSpan" id="kobo.166.1">
      represents predefined data available to the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.167.1">
       state tree
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.168.1">
       Evaluators
      </span>
     </strong>
     <span class="koboSpan" id="kobo.169.1">
      : These
     </span>
     <a id="_idIndexMarker610">
     </a>
     <span class="koboSpan" id="kobo.170.1">
      are separate classes that can be executed at runtime and that expose data that could not be made available with parameters and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.171.1">
       context data
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.172.1">
       Global tasks
      </span>
     </strong>
     <span class="koboSpan" id="kobo.173.1">
      : These
     </span>
     <a id="_idIndexMarker611">
     </a>
     <span class="koboSpan" id="kobo.174.1">
      are executed before the root state and can be used when you need permanent data during
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.175.1">
       state selection
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.176.1">
     It is also worth mentioning that nodes in a state tree share data among themselves and can bind data in three ways that have been
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.177.1">
      previously mentioned:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.178.1">
      State
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.179.1">
       enter conditions
      </span>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.180.1">
       Transition conditions
      </span>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.181.1">
       Tasks
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.182.1">
     In this section, we introduced state trees and their key features.
    </span>
    <span class="koboSpan" id="kobo.182.2">
     In the following section, we will delve into practical exercises by crafting our own state trees in order to use them effectively within a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.183.1">
      gym setting.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-238">
    <a id="_idTextAnchor240">
    </a>
    <span class="koboSpan" id="kobo.184.1">
     Creating and managing state trees
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.185.1">
     From this section onward, we will be creating a new gym based on a couple of AI agents using state trees instead of behavior trees.
    </span>
    <span class="koboSpan" id="kobo.185.2">
     This will help us to understand the basic principles behind this new
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.186.1">
      development pattern.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.187.1">
     To help us
    </span>
    <a id="_idIndexMarker612">
    </a>
    <span class="koboSpan" id="kobo.188.1">
     understand
    </span>
    <a id="_idIndexMarker613">
    </a>
    <span class="koboSpan" id="kobo.189.1">
     these principles, we’ll be doing
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.190.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.191.1">
      Create/place an actor in the level who will periodically emit a noise by using a dedicated
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.192.1">
       state tree
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.193.1">
      Create/place a dummy character who will be managed by another state tree and will do
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.194.1">
       the following:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.195.1">
        Stay idle in its
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.196.1">
         starting location
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.197.1">
        Reach the noise location whenever a noise
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.198.1">
         is perceived
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.199.1">
        Get
       </span>
       <a id="_idIndexMarker614">
       </a>
       <span class="koboSpan" id="kobo.200.1">
        back to its starting
       </span>
       <a id="_idIndexMarker615">
       </a>
       <span class="koboSpan" id="kobo.201.1">
        location after a brief time investigating
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.202.1">
         the location
        </span>
       </span>
      </li>
     </ul>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.203.1">
     Although pretty simple, this logic can be used as a starting point for a guard AI agent that will investigate a level looking for intruders and responding to any suspicious
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.204.1">
      noise around.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.205.1">
     As the state trees feature is not enabled by default, the first thing to do will be to get to the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.206.1">
      Plugins
     </span>
    </strong>
    <span class="koboSpan" id="kobo.207.1">
     window and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.208.1">
      enable it.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-239">
    <a id="_idTextAnchor241">
    </a>
    <span class="koboSpan" id="kobo.209.1">
     Enabling state trees plugins
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.210.1">
     To start working with
    </span>
    <a id="_idIndexMarker616">
    </a>
    <span class="koboSpan" id="kobo.211.1">
     state trees, you will need to enable a couple of dedicated plugins.
    </span>
    <span class="koboSpan" id="kobo.211.2">
     In order to do so, follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.212.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.213.1">
      Open the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.214.1">
       Plugin
      </span>
     </strong>
     <span class="koboSpan" id="kobo.215.1">
      window by selecting
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.216.1">
       Edit
      </span>
     </strong>
     <span class="koboSpan" id="kobo.217.1">
      |
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.218.1">
       Plugins
      </span>
     </strong>
     <span class="koboSpan" id="kobo.219.1">
      from the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.220.1">
       main menu.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.221.1">
      Search for the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.222.1">
       GameplayStateTree
      </span>
     </strong>
     <span class="koboSpan" id="kobo.223.1">
      and
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.224.1">
       StateTree
      </span>
     </strong>
     <span class="koboSpan" id="kobo.225.1">
      plugins and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.226.1">
       enable them.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.227.1">
      Restart the Unreal Engine Editor to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.228.1">
       activate them.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer197">
     <span class="koboSpan" id="kobo.229.1">
      <img alt="Figure 12.2 – Plugin window" src="image/Figure_12.2_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.230.1">
     Figure 12.2 – Plugin window
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.231.1">
     If you plan to use state
    </span>
    <a id="_idIndexMarker617">
    </a>
    <span class="koboSpan" id="kobo.232.1">
     trees with C++ (and we do), you will need to add a module to the Unreal Engine
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.233.1">
      build file.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.234.1">
     In our case, we will need to include the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.235.1">
      GameplayStateTreeModule
     </span>
    </strong>
    <span class="koboSpan" id="kobo.236.1">
     dependency in the build, so that the module will be available to your C++ implementation.
    </span>
    <span class="koboSpan" id="kobo.236.2">
     In order to do so, open your IDE and locate the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.237.1">
      UnrealAgilityArena.build.cs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.238.1">
     file in your project; it should be located in the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.239.1">
       UnrealAgilityArena/Source
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.240.1">
      folder.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.241.1">
     Note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.242.1">
     The Unreal Engine
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.243.1">
      .build.cs
     </span>
    </strong>
    <span class="koboSpan" id="kobo.244.1">
     file is responsible for defining how the project is built, including options for defining
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.245.1">
      module dependencies.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.246.1">
     Look for this line
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.247.1">
      of code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.248.1">
PublicDependencyModuleNames.AddRange(new string[] { "Core", "CoreUObject", "Engine", "InputCore" });</span></pre>
   <p>
    <span class="koboSpan" id="kobo.249.1">
     Update it to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.250.1">
      the following:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.251.1">
PublicDependencyModuleNames.AddRange(new string[] { "Core", "CoreUObject", "Engine", "InputCore", "GameplayStateTreeModule" });</span></pre>
   <p>
    <span class="koboSpan" id="kobo.252.1">
     So, once you declare this module, you will have all that’s needed to work with state trees
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.253.1">
      in C++.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.254.1">
     Note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.255.1">
     At the time of writing this book, there seem to be some issues in declaring a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.256.1">
      StateTreeAIComponent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.257.1">
     class in C++, while the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.258.1">
      StateTreeComponent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.259.1">
     class is working just fine.
    </span>
    <span class="koboSpan" id="kobo.259.2">
     Basically, the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.260.1">
      StateTreeAIComponent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.261.1">
     class seems to be unavailable in the module, and using this class won’t compile your project.
    </span>
    <span class="koboSpan" id="kobo.261.2">
     To overcome this issue, we will be adding the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.262.1">
      StateTreeAIComponent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.263.1">
     class from Blueprint
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.264.1">
      when needed.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.265.1">
     Once the plugins have been activated, we can start implementing our first AI agent using a state tree: the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.266.1">
      noise emitter.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-240">
    <a id="_idTextAnchor242">
    </a>
    <span class="koboSpan" id="kobo.267.1">
     Implementing a noise emitter actor
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.268.1">
     We will be now creating an
    </span>
    <a id="_idIndexMarker618">
    </a>
    <span class="koboSpan" id="kobo.269.1">
     actor whose sole aim will be to periodically emit a noise by means of
    </span>
    <a id="_idIndexMarker619">
    </a>
    <span class="koboSpan" id="kobo.270.1">
     the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.271.1">
      Perception System
     </span>
    </strong>
    <span class="koboSpan" id="kobo.272.1">
     .
    </span>
    <span class="koboSpan" id="kobo.272.2">
     This task is straightforward and can be implemented in any manner you find suitable.
    </span>
    <span class="koboSpan" id="kobo.272.3">
     However, for this demonstration, we will use state trees to grasp the fundamental principles of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.273.1">
      this system.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.274.1">
     Creating the noise emitter class
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.275.1">
     We will be starting by
    </span>
    <a id="_idIndexMarker620">
    </a>
    <span class="koboSpan" id="kobo.276.1">
     creating the base class for the noise emitter; we will need to declare all the visual elements and, most importantly, the needed Perception System component and the state tree component.
    </span>
    <span class="koboSpan" id="kobo.276.2">
     Moreover, we will include a function to generate the noise, without concerning ourselves with the logic that will manage it; this responsibility will be delegated to the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.277.1">
      state tree.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.278.1">
     Let’s start by creating a new C++ class extending
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.279.1">
      Actor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.280.1">
     and call it
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.281.1">
      BaseNoiseEmitter
     </span>
    </strong>
    <span class="koboSpan" id="kobo.282.1">
     .
    </span>
    <span class="koboSpan" id="kobo.282.2">
     Once the class has been created, open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.283.1">
      BaseNoiseEmitter.h
     </span>
    </strong>
    <span class="koboSpan" id="kobo.284.1">
     file and add the following forward declarations after the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.285.1">
      #
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.286.1">
       include
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.287.1">
      declarations:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.288.1">
class UAIPerceptionStimuliSourceComponent;
class UStateTreeComponent;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.289.1">
     After that, make the class an acceptable base class for Blueprints by changing the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.290.1">
      UCLASS()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.291.1">
     macro into
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.292.1">
      the following:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.293.1">
UCLASS(Blueprintable)</span></pre>
   <p>
    <span class="koboSpan" id="kobo.294.1">
     Look for the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.295.1">
      Tick()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.296.1">
     declaration and remove it as we won’t be
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.297.1">
      using it.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.298.1">
     Next, add the needed
    </span>
    <a id="_idIndexMarker621">
    </a>
    <span class="koboSpan" id="kobo.299.1">
     components just after the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.300.1">
       GENERATED_BODY()
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.301.1">
      macro:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.302.1">
UPROPERTY(VisibleAnywhere, BlueprintReadOnly, Category="Dummy Target", meta=(AllowPrivateAccess="true"))
UStaticMeshComponent* BaseMeshComponent;
UPROPERTY(VisibleAnywhere, BlueprintReadOnly, Category="Dummy Target", meta=(AllowPrivateAccess="true"))
UStaticMeshComponent* DummyMeshComponent;
UPROPERTY(VisibleAnywhere, BlueprintReadOnly, Category="Dummy Target", meta=(AllowPrivateAccess="true"))
UAIPerceptionStimuliSourceComponent* PerceptionStimuliSourceComponent;
UPROPERTY(VisibleAnywhere, BlueprintReadOnly, Category="Dummy Target", meta=(AllowPrivateAccess="true"))
UStateTreeComponent* StateTreeComponent;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.303.1">
     As you can see from the preceding code, we will be using a few static meshes, as well as the needed state tree and Perception
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.304.1">
      System components.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.305.1">
     Now, just after the constructor declaration, add the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.306.1">
      following declarations:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.307.1">
UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Noise Generation")
float MaxNoiseRange = 3000.f;
UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Noise Generation")
float NoiseRangeRandomDeviation = 100.f;
UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Noise Generation")
FName NoiseTag = "EmitterNoise";
UFUNCTION(BlueprintCallable)
void EmitNoise();</span></pre>
   <p>
    <span class="koboSpan" id="kobo.308.1">
     As you can see, we are exposing some properties to customize our emitter instances in the level, and we are declaring an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.309.1">
      EmitNoise()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.310.1">
     function that we will be using to activate the noise emission when needed.
    </span>
    <span class="koboSpan" id="kobo.310.2">
     Finally, the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.311.1">
      NoiseTag
     </span>
    </strong>
    <span class="koboSpan" id="kobo.312.1">
     property will be used to tag the noise and be
    </span>
    <a id="_idIndexMarker622">
    </a>
    <span class="koboSpan" id="kobo.313.1">
     recognized by listening
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.314.1">
      AI agents.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.315.1">
     It’s now time to open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.316.1">
      BaseNoiseEmitter.cpp
     </span>
    </strong>
    <span class="koboSpan" id="kobo.317.1">
     file and implement the methods.
    </span>
    <span class="koboSpan" id="kobo.317.2">
     As a first step, remove the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.318.1">
      Tick()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.319.1">
     function and, in the constructor, modify this line
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.320.1">
      of code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.321.1">
PrimaryActorTick.bCanEverTick = true;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.322.1">
     Modify it
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.323.1">
      into this:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.324.1">
PrimaryActorTick.bCanEverTick = false;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.325.1">
     After that, add the needed
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.326.1">
      #include
     </span>
    </strong>
    <span class="koboSpan" id="kobo.327.1">
     declarations, so add this block of code at the top of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.328.1">
      the file:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.329.1">
#include "Components/StateTreeComponent.h"
#include "Perception/AIPerceptionStimuliSourceComponent.h"
#include "Perception/AISense_Hearing.h"</span></pre>
   <p>
    <span class="koboSpan" id="kobo.330.1">
     Now, let’s initialize the
    </span>
    <a id="_idIndexMarker623">
    </a>
    <span class="koboSpan" id="kobo.331.1">
     static mesh components inside the constructor by adding the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.332.1">
      following code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.333.1">
BaseMeshComponent = CreateDefaultSubobject&lt;UStaticMeshComponent&gt;(TEXT("BaseMesh"));
RootComponent = BaseMeshComponent;
static ConstructorHelpers::FObjectFinder&lt;UStaticMesh&gt;   BaseStaticMeshAsset(
    TEXT("/Game/KayKit/SpaceBase/landingpad_large.landingpad_large"));
if (BaseStaticMeshAsset.Succeeded())
{
    BaseMeshComponent-&gt;SetStaticMesh(BaseStaticMeshAsset.Object);
}
DummyMeshComponent = CreateDefaultSubobject&lt;UStaticMeshComponent&gt;(TEXT
  ("DummyMesh"));
DummyMeshComponent-&gt;SetupAttachment(RootComponent);
DummyMeshComponent-&gt;SetRelativeRotation(FRotator
  (0.f, -90.f, 0.f));
DummyMeshComponent-&gt;SetRelativeLocation(FVector
  (0.f, 0.f,  80.f));
static ConstructorHelpers::FObjectFinder&lt;UStaticMesh&gt;   DummyStaticMeshAsset(TEXT("/Game/KayKit/PrototypeBits/Models/Dummy_    Base.Dummy_Base"));
if (DummyStaticMeshAsset.Succeeded())
{
    DummyMeshComponent-&gt;SetStaticMesh(DummyStaticMeshAsset.Object);
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.334.1">
     You should be
    </span>
    <a id="_idIndexMarker624">
    </a>
    <span class="koboSpan" id="kobo.335.1">
     already familiar with all of this, so we can go on and declare the stimuli source for the Perception System and the state tree by adding this piece
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.336.1">
      of code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.337.1">
PerceptionStimuliSourceComponent = CreateDefaultSubobject   &lt;UAIPerceptionStimuliSourceComponent&gt;(TEXT("PerceptionStimuli     Source"));
PerceptionStimuliSourceComponent-&gt;RegisterForSense   (UAISense_Hearing::StaticClass());
StateTreeComponent = CreateDefaultSubobject&lt;UStateTreeComponent&gt;(TEXT
  ("StateTree"));</span></pre>
   <p>
    <span class="koboSpan" id="kobo.338.1">
     As you can see, we are just creating the needed components; additionally, we are registering the hearing sense as a stimuli source for the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.339.1">
      Perception System.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.340.1">
     Now, in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.341.1">
      BeginPlay()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.342.1">
     function, add the following lines
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.343.1">
      of code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.344.1">
PerceptionStimuliSourceComponent-&gt;RegisterWithPerceptionSystem();
StateTreeComponent-&gt;StartLogic();</span></pre>
   <p>
    <span class="koboSpan" id="kobo.345.1">
     Here, we are registering the Perception System, and we are starting the logic for the state tree.
    </span>
    <span class="koboSpan" id="kobo.345.2">
     This means that as soon as the game starts, the state tree will
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.346.1">
      begin executing.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.347.1">
     The last thing to do is implement the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.348.1">
      EmitNoise()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.349.1">
     function, so add this piece
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.350.1">
      of code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.351.1">
void ABaseNoiseEmitter::EmitNoise()
{
    const auto NoiseRange = MaxNoiseRange +
      FMath::RandRange(-1.f * NoiseRangeRandomDeviation,
      NoiseRangeRandomDeviation);
    UAISense_Hearing::ReportNoiseEvent(GetWorld(),
      GetActorLocation(), 1.f, this, NoiseRange, NoiseTag);
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.352.1">
     In
    </span>
    <a href="B31016_10.xhtml#_idTextAnchor198">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.353.1">
        Chapter 10
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.354.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.355.1">
      Improving Agents with the Perception System
     </span>
    </em>
    <span class="koboSpan" id="kobo.356.1">
     , you already learned how to handle the sight sense.
    </span>
    <span class="koboSpan" id="kobo.356.2">
     With the sense of hearing, things are slightly different; while being visible is a continuous occurrence, being heard only occurs when you make noise.
    </span>
    <span class="koboSpan" id="kobo.356.3">
     This is why we randomize a noise range – based on the previously declared properties – and
    </span>
    <a id="_idIndexMarker625">
    </a>
    <span class="koboSpan" id="kobo.357.1">
     we use the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.358.1">
      ReportNoiseEvent()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.359.1">
     function to emit the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.360.1">
      actual noise.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.361.1">
     This class is ready, and we can now focus on the actual state tree creation, starting from a custom task: something that will tell the actor to emit
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.362.1">
      the noise.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.363.1">
     Creating the emit noise task
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.364.1">
     The state
    </span>
    <a id="_idIndexMarker626">
    </a>
    <span class="koboSpan" id="kobo.365.1">
     tree task we will be creating needs to just tell the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.366.1">
      BaseNoiseEmitter
     </span>
    </strong>
    <span class="koboSpan" id="kobo.367.1">
     instance to execute the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.368.1">
      EmitNoise()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.369.1">
     function.
    </span>
    <span class="koboSpan" id="kobo.369.2">
     This task will be created as a Blueprint class so, inside
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.370.1">
      Content Browser
     </span>
    </strong>
    <span class="koboSpan" id="kobo.371.1">
     of the Unreal Engine Editor, navigate to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.372.1">
      AI
     </span>
    </strong>
    <span class="koboSpan" id="kobo.373.1">
     folder and do
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.374.1">
      the following:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.375.1">
      Create a new Blueprint class extending from
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.376.1">
       StateTreeTaskBlueprintBase
      </span>
     </strong>
     <span class="koboSpan" id="kobo.377.1">
      and name it
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.378.1">
       STT_EmitNoise
      </span>
     </strong>
     <span class="koboSpan" id="kobo.379.1">
      .
     </span>
     <span class="koboSpan" id="kobo.379.2">
      Double-click on it to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.380.1">
       open it.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.381.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.382.1">
       My Blueprints
      </span>
     </strong>
     <span class="koboSpan" id="kobo.383.1">
      panel, hover over the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.384.1">
       FUNCTIONS
      </span>
     </strong>
     <span class="koboSpan" id="kobo.385.1">
      section and click the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.386.1">
       Override
      </span>
     </strong>
     <span class="koboSpan" id="kobo.387.1">
      dropdown menu that
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.388.1">
       shows up.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.389.1">
      Select the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.390.1">
       Enter State
      </span>
     </strong>
     <span class="koboSpan" id="kobo.391.1">
      option, as depicted in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.392.1">
        Figure 12
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.393.1">
        .3
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.394.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer198">
     <span class="koboSpan" id="kobo.395.1">
      <img alt="Figure 12.3 – Enter State function creation" src="image/Figure_12.3_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.396.1">
     Figure 12.3 – Enter State function creation
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.397.1">
     An
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.398.1">
      Event Enter State
     </span>
    </strong>
    <span class="koboSpan" id="kobo.399.1">
     node will be added to the Event Graph; this event will be executed when a new state in the state tree is entered and if the task is part of the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.400.1">
      active states.
     </span>
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.401.1">
     For this state, we need a reference to the owning actor; as previously mentioned, state trees use data binding for communicating.
    </span>
    <span class="koboSpan" id="kobo.401.2">
     Therefore, we will take advantage of this feature to create the reference.
    </span>
    <span class="koboSpan" id="kobo.401.3">
     To do this, follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.402.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li value="4">
     <span class="koboSpan" id="kobo.403.1">
      Create a new variable that is an
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.404.1">
       Object Reference
      </span>
     </strong>
     <span class="koboSpan" id="kobo.405.1">
      of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.406.1">
       BaseNoiseEmitter
      </span>
     </strong>
     <span class="koboSpan" id="kobo.407.1">
      type and name
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.408.1">
       it
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.409.1">
        Actor
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.410.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.411.1">
      Select the variable
     </span>
     <a id="_idIndexMarker627">
     </a>
     <span class="koboSpan" id="kobo.412.1">
      and, in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.413.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.414.1">
      panel, locate the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.415.1">
       Category
      </span>
     </strong>
     <span class="koboSpan" id="kobo.416.1">
      attribute and, in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.417.1">
       Input
      </span>
     </strong>
     <span class="koboSpan" id="kobo.418.1">
      field, type
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.419.1">
       Context
      </span>
     </strong>
     <span class="koboSpan" id="kobo.420.1">
      , as shown in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.421.1">
        Figure 12
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.422.1">
        .4
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.423.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer199">
     <span class="koboSpan" id="kobo.424.1">
      <img alt="Figure 12.4 – Context category" src="image/Figure_12.4_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.425.1">
     Figure 12.4 – Context category
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.426.1">
     While variable creation is self-explanatory, setting the category name to a value of
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.427.1">
      Context
     </span>
    </strong>
    <span class="koboSpan" id="kobo.428.1">
     needs some explanation; whenever you add a property to the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.429.1">
      Context
     </span>
    </strong>
    <span class="koboSpan" id="kobo.430.1">
     category, the property itself will be exposed through data binding to the state tree the task will be executed in.
    </span>
    <span class="koboSpan" id="kobo.430.2">
     This comes quite handy when you need to get information from the executing state tree and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.431.1">
      vice versa.
     </span>
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.432.1">
     With this new reference available, do the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.433.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li value="6">
     <span class="koboSpan" id="kobo.434.1">
      From the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.435.1">
       Variables
      </span>
     </strong>
     <span class="koboSpan" id="kobo.436.1">
      section, drag the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.437.1">
       Actor
      </span>
     </strong>
     <span class="koboSpan" id="kobo.438.1">
      variable into the Event Graph and add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.439.1">
       Get
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.440.1">
        Actor
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.441.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.442.1">
      From the outgoing pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.443.1">
       Actor
      </span>
     </strong>
     <span class="koboSpan" id="kobo.444.1">
      node, connect an
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.445.1">
       Emit
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.446.1">
        Noise
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.447.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.448.1">
      Connect the outgoing execution pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.449.1">
       Event Enter State
      </span>
     </strong>
     <span class="koboSpan" id="kobo.450.1">
      node with the incoming execution pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.451.1">
       Emit
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.452.1">
        Noise
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.453.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.454.1">
      From the outgoing execution pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.455.1">
       Emit Noise
      </span>
     </strong>
     <span class="koboSpan" id="kobo.456.1">
      node, connect a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.457.1">
       Finish
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.458.1">
        Task
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.459.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.460.1">
      Check the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.461.1">
       Succeeded
      </span>
     </strong>
     <span class="koboSpan" id="kobo.462.1">
      checkbox of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.463.1">
       Finish Task
      </span>
     </strong>
     <span class="koboSpan" id="kobo.464.1">
      node.
     </span>
     <span class="koboSpan" id="kobo.464.2">
      The final graph should look
     </span>
     <a id="_idIndexMarker628">
     </a>
     <span class="koboSpan" id="kobo.465.1">
      like the one depicted in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.466.1">
        Figure 12
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.467.1">
        .5
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.468.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer200">
     <span class="koboSpan" id="kobo.469.1">
      <img alt="Figure 12.5 – Emit Noise graph" src="image/Figure_12.5_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.470.1">
     Figure 12.5 – Emit Noise graph
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.471.1">
     The only thing worth mentioning here is the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.472.1">
      Finish Task
     </span>
    </strong>
    <span class="koboSpan" id="kobo.473.1">
     node that will return a success value after emitting the noise.
    </span>
    <span class="koboSpan" id="kobo.473.2">
     Now that this task is complete, we can finally start working on the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.474.1">
      state tree.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.475.1">
     Creating the noise emitter state tree
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.476.1">
     As previously stated, we will
    </span>
    <a id="_idIndexMarker629">
    </a>
    <span class="koboSpan" id="kobo.477.1">
     be executing the state tree from an actor; this means we will need something that can be used with the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.478.1">
      StateTreeComponent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.479.1">
     class.
    </span>
    <span class="koboSpan" id="kobo.479.2">
     In order to do so, we will need to create an asset that follows the rules dictated by a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.480.1">
      StateTreeComponentSchema
     </span>
    </strong>
    <span class="koboSpan" id="kobo.481.1">
     class that guarantees access to the actor executing the state tree.
    </span>
    <span class="koboSpan" id="kobo.481.2">
     To create such an asset, do the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.482.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.483.1">
      In
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.484.1">
       Content Browser
      </span>
     </strong>
     <span class="koboSpan" id="kobo.485.1">
      , open the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.486.1">
       AI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.487.1">
      folder, right-click on it, and select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.488.1">
       Artificial Intelligence
      </span>
     </strong>
     <span class="koboSpan" id="kobo.489.1">
      |
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.490.1">
        State Tree
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.491.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.492.1">
      From the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.493.1">
       Pick Schema for State Tree
      </span>
     </strong>
     <span class="koboSpan" id="kobo.494.1">
      pop-up window,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.495.1">
       select
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.496.1">
        StateTreeComponentSchema
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.497.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer201">
     <span class="koboSpan" id="kobo.498.1">
      <img alt="Figure 12.6 – State tree creation" src="image/Figure_12.6_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.499.1">
     Figure 12.6 – State tree creation
    </span>
   </p>
   <ol>
    <li value="3">
     <span class="koboSpan" id="kobo.500.1">
      Name the
     </span>
     <a id="_idIndexMarker630">
     </a>
     <span class="koboSpan" id="kobo.501.1">
      newly created asset
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.502.1">
       ST_NoiseEmitter
      </span>
     </strong>
     <span class="koboSpan" id="kobo.503.1">
      and double-click on it to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.504.1">
       open it.
      </span>
     </span>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.505.1">
       Once the asset is opened, locate the
      </span>
      <strong class="bold">
       <span class="koboSpan" id="kobo.506.1">
        StateTree
       </span>
      </strong>
      <span class="koboSpan" id="kobo.507.1">
       tab to the left of the Editor and notice that there is a
      </span>
      <strong class="bold">
       <span class="koboSpan" id="kobo.508.1">
        Context Actor Class
       </span>
      </strong>
      <span class="koboSpan" id="kobo.509.1">
       property, as shown in
      </span>
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.510.1">
         Figure 12
        </span>
       </em>
      </span>
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.511.1">
         .7
        </span>
       </em>
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.512.1">
        :
       </span>
      </span>
     </p>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer202">
     <span class="koboSpan" id="kobo.513.1">
      <img alt="Figure 12.7 – State Tree context actor" src="image/Figure_12.7_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.514.1">
     Figure 12.7 – State Tree context actor
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.515.1">
     This is the reference to the owning actor; at the moment, it is set to a generic actor but we need to be more specific, so click on the dropdown menu and select an
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.516.1">
      Object Reference
     </span>
    </strong>
    <span class="koboSpan" id="kobo.517.1">
     of
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.518.1">
      BaseNoiseEmitter
     </span>
    </strong>
    <span class="koboSpan" id="kobo.519.1">
     .
    </span>
    <span class="koboSpan" id="kobo.519.2">
     From now on, each node of the tree will be granted access to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.520.1">
      this reference.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.521.1">
     Now, let’s start implementing the state
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.522.1">
      tree logic:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.523.1">
      Click the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.524.1">
       Add State
      </span>
     </strong>
     <span class="koboSpan" id="kobo.525.1">
      button three times to create
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.526.1">
       three states.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.527.1">
      Select each of them and, in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.528.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.529.1">
      panel, name them
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.530.1">
       Random Delay
      </span>
     </strong>
     <span class="koboSpan" id="kobo.531.1">
      ,
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.532.1">
       Debug Message
      </span>
     </strong>
     <span class="koboSpan" id="kobo.533.1">
      , and
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.534.1">
       Emit Noise
      </span>
     </strong>
     <span class="koboSpan" id="kobo.535.1">
      , respectively.
     </span>
     <span class="koboSpan" id="kobo.535.2">
      Your state tree should be similar to the one depicted in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.536.1">
        Figure 12
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.537.1">
        .8
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.538.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer203">
     <span class="koboSpan" id="kobo.539.1">
      <img alt="Figure 12.8 – Initial states" src="image/Figure_12.8_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.540.1">
     Figure 12.8 – Initial states
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.541.1">
     As you can see, we
    </span>
    <a id="_idIndexMarker631">
    </a>
    <span class="koboSpan" id="kobo.542.1">
     have created the basis structure for the state tree with three main states that will wait for a random time, display a debug message, and finally emit
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.543.1">
      the noise.
     </span>
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.544.1">
     We now need to implement each of the states with their own tasks and transitions; let’s start from the first one.
    </span>
    <span class="koboSpan" id="kobo.544.2">
     Select the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.545.1">
      Random Delay
     </span>
    </strong>
    <span class="koboSpan" id="kobo.546.1">
     task and do
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.547.1">
      the following:
     </span>
    </span>
   </p>
   <ol>
    <li value="3">
     <span class="koboSpan" id="kobo.548.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.549.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.550.1">
      panel, locate the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.551.1">
       Tasks
      </span>
     </strong>
     <span class="koboSpan" id="kobo.552.1">
      section and click the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.553.1">
       +
      </span>
     </strong>
     <span class="koboSpan" id="kobo.554.1">
      button to add a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.555.1">
       new task.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.556.1">
      From the newly created task, click the dropdown menu and select
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.557.1">
        Delay Task
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.558.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.559.1">
      Expand the task by clicking the tiny arrow icon next to the task name.
     </span>
     <span class="koboSpan" id="kobo.559.2">
      Set the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.560.1">
       Duration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.561.1">
      attribute to
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.562.1">
       10.0
      </span>
     </strong>
     <span class="koboSpan" id="kobo.563.1">
      and the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.564.1">
       Random Deviation
      </span>
     </strong>
     <span class="koboSpan" id="kobo.565.1">
      attribute
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.566.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.567.1">
        3.0
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.568.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.569.1">
      Locate the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.570.1">
       Transitions
      </span>
     </strong>
     <span class="koboSpan" id="kobo.571.1">
      section and click the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.572.1">
       +
      </span>
     </strong>
     <span class="koboSpan" id="kobo.573.1">
      button to create a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.574.1">
       new transition.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.575.1">
      You should see an item labeled
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.576.1">
       On State Transition Completed Go to State Root
      </span>
     </strong>
     <span class="koboSpan" id="kobo.577.1">
      .
     </span>
     <span class="koboSpan" id="kobo.577.2">
      Click on the tiny arrow icon to expand it, and from the dropdown menu of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.578.1">
       Transition To
      </span>
     </strong>
     <span class="koboSpan" id="kobo.579.1">
      attribute, select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.580.1">
       Next State
      </span>
     </strong>
     <span class="koboSpan" id="kobo.581.1">
      .
     </span>
     <span class="koboSpan" id="kobo.581.2">
      This state should look like the one depicted in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.582.1">
        Figure 12
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.583.1">
        .9
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.584.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer204">
     <span class="koboSpan" id="kobo.585.1">
      <img alt="Figure 12.9 – Random delay state" src="image/Figure_12.9_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.586.1">
     Figure 12.9 – Random delay state
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.587.1">
     We can now
    </span>
    <a id="_idIndexMarker632">
    </a>
    <span class="koboSpan" id="kobo.588.1">
     start working on the second state – that is,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.589.1">
      Debug Message
     </span>
    </strong>
    <span class="koboSpan" id="kobo.590.1">
     – that is going to display an in-game message.
    </span>
    <span class="koboSpan" id="kobo.590.2">
     This is obviously not mandatory for making our state tree work, but it serves the purpose of learning how things work.
    </span>
    <span class="koboSpan" id="kobo.590.3">
     Select this state and do
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.591.1">
      the following:
     </span>
    </span>
   </p>
   <ol>
    <li value="8">
     <span class="koboSpan" id="kobo.592.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.593.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.594.1">
      panel, locate the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.595.1">
       Tasks
      </span>
     </strong>
     <span class="koboSpan" id="kobo.596.1">
      section and click the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.597.1">
       +
      </span>
     </strong>
     <span class="koboSpan" id="kobo.598.1">
      button to add a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.599.1">
       new task.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.600.1">
      From the newly created task, click the dropdown menu and select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.601.1">
       Debug
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.602.1">
        Text Task
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.603.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.604.1">
      Expand the task by clicking the tiny arrow icon next to the task name.
     </span>
     <span class="koboSpan" id="kobo.604.2">
      Set the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.605.1">
       Text
      </span>
     </strong>
     <span class="koboSpan" id="kobo.606.1">
      property value to
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.607.1">
       Emitting Noise!
      </span>
     </strong>
     <span class="koboSpan" id="kobo.608.1">
      and the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.609.1">
       Text Color
      </span>
     </strong>
     <span class="koboSpan" id="kobo.610.1">
      property to a color of your choice – in my case, I opted for a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.611.1">
       bright yellow.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.612.1">
      Create another task; click the dropdown menu and select
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.613.1">
        Delay Task
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.614.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.615.1">
      Expand the task by clicking the tiny arrow icon next to the task name and set the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.616.1">
       Duration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.617.1">
      attribute
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.618.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.619.1">
        0.5
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.620.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.621.1">
      Locate the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.622.1">
       Transitions
      </span>
     </strong>
     <span class="koboSpan" id="kobo.623.1">
      section and click the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.624.1">
       +
      </span>
     </strong>
     <span class="koboSpan" id="kobo.625.1">
      button to create a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.626.1">
       new transition.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.627.1">
      You should see an item labeled
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.628.1">
       On State Transition Completed Go to State Root
      </span>
     </strong>
     <span class="koboSpan" id="kobo.629.1">
      ; click on the tiny arrow icon to expand it and, from the dropdown menu of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.630.1">
       Transition To
      </span>
     </strong>
     <span class="koboSpan" id="kobo.631.1">
      attribute, select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.632.1">
       Next State
      </span>
     </strong>
     <span class="koboSpan" id="kobo.633.1">
      .
     </span>
     <span class="koboSpan" id="kobo.633.2">
      This state should look like the one
     </span>
     <a id="_idIndexMarker633">
     </a>
     <span class="koboSpan" id="kobo.634.1">
      depicted in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.635.1">
        Figure 12
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.636.1">
        .10
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.637.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer205">
     <span class="koboSpan" id="kobo.638.1">
      <img alt="Figure 12.10 – Debug Message state" src="image/Figure_12.10_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.639.1">
     Figure 12.10 – Debug Message state
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.640.1">
     Now select the last state – that is,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.641.1">
      Emit Noise
     </span>
    </strong>
    <span class="koboSpan" id="kobo.642.1">
     – and do
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.643.1">
      the following:
     </span>
    </span>
   </p>
   <ol>
    <li value="15">
     <span class="koboSpan" id="kobo.644.1">
      Add a new task, of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.645.1">
       STT Emit
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.646.1">
        Noise
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.647.1">
       type.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.648.1">
      Expand the task by clicking the tiny arrow icon; you should notice a property named
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.649.1">
       Actor
      </span>
     </strong>
     <span class="koboSpan" id="kobo.650.1">
      and labeled
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.651.1">
       CONTEXT
      </span>
     </strong>
     <span class="koboSpan" id="kobo.652.1">
      .
     </span>
     <span class="koboSpan" id="kobo.652.2">
      On its far right, you should see a dropdown menu arrow.
     </span>
     <span class="koboSpan" id="kobo.652.3">
      Click on it to open it and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.653.1">
       select
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.654.1">
        Actor
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.655.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <p class="IMG---Figure">
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer206">
     <span class="koboSpan" id="kobo.656.1">
      <img alt="Figure 12.11 – Binding" src="image/Figure_12.11_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.657.1">
     Figure 12.11 – Binding
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.658.1">
     This last action created the binding between the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.659.1">
      Actor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.660.1">
     property of the state tree and the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.661.1">
      Actor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.662.1">
     property we added when we created the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.663.1">
      STT_EmitNoise
     </span>
    </strong>
    <span class="koboSpan" id="kobo.664.1">
     task.
    </span>
    <span class="koboSpan" id="kobo.664.2">
     This last property has been exposed because in the task Blueprint; we set its category
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.665.1">
      to
     </span>
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.666.1">
       Context
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.667.1">
      .
     </span>
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.668.1">
     This last
    </span>
    <a id="_idIndexMarker634">
    </a>
    <span class="koboSpan" id="kobo.669.1">
     state will look like the one shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.670.1">
       Figure 12
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.671.1">
       .12
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.672.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer207">
     <span class="koboSpan" id="kobo.673.1">
      <img alt="Figure 12.12 – Emit noise state" src="image/Figure_12.12_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.674.1">
     Figure 12.12 – Emit noise state
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.675.1">
     Please note that we didn’t add a transition for this task.
    </span>
    <span class="koboSpan" id="kobo.675.2">
     The default behavior is to point to the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.676.1">
      Root
     </span>
    </strong>
    <span class="koboSpan" id="kobo.677.1">
     node, and we want to create an infinite loop, so we simply leave the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.678.1">
      default behavior.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.679.1">
     Note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.680.1">
     If you are unfamiliar with data binding, things might appear a bit weird initially, but do not worry.
    </span>
    <span class="koboSpan" id="kobo.680.2">
     As you become accustomed to it, things will become quite simple and easy
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.681.1">
      to understand.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.682.1">
     The state tree is finished and should look like
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.683.1">
       Figure 12
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.684.1">
       .13
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.685.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer208">
     <span class="koboSpan" id="kobo.686.1">
      <img alt="Figure 12.13 – Finished state tree" src="image/Figure_12.13_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.687.1">
     Figure 12.13 – Finished state tree
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.688.1">
     As you can see, it is quite easy to get what’s happening in each state and how the state tree flow will progress.
    </span>
    <span class="koboSpan" id="kobo.688.2">
     It’s time to bring everything together and get the noise emitter up
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.689.1">
      and running!
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.690.1">
     Creating the noise emitter Blueprint
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.691.1">
     Creating the
    </span>
    <a id="_idIndexMarker635">
    </a>
    <span class="koboSpan" id="kobo.692.1">
     Blueprint out of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.693.1">
      BaseNoiseEmitter
     </span>
    </strong>
    <span class="koboSpan" id="kobo.694.1">
     class is quite straightforward, so let’s do the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.695.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.696.1">
      Create a new Blueprint class extending from
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.697.1">
       BaseNoiseEmitter
      </span>
     </strong>
     <span class="koboSpan" id="kobo.698.1">
      and name
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.699.1">
       it
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.700.1">
        BP_NoiseEmitter
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.701.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.702.1">
      Open it and locate the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.703.1">
       State Tree
      </span>
     </strong>
     <span class="koboSpan" id="kobo.704.1">
      attribute in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.705.1">
       AI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.706.1">
      section.
     </span>
     <span class="koboSpan" id="kobo.706.2">
      From the dropdown menu, set its value
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.707.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.708.1">
        ST_NoiseEmitter
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.709.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer209">
     <span class="koboSpan" id="kobo.710.1">
      <img alt="Figure 12.14 – Finished BP_NoiseEmitter" src="image/Figure_12.14_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.711.1">
     Figure 12.14 – Finished BP_NoiseEmitter
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.712.1">
     This is all you need to do to implement your noise emitter.
    </span>
    <span class="koboSpan" id="kobo.712.2">
     It is important to note that what we have created is not technically an AI agent.
    </span>
    <span class="koboSpan" id="kobo.712.3">
     This is the beauty of state trees; once you grasp the concept, you will be able to apply your logic to many different types of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.713.1">
      use cases.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.714.1">
     Now that the noise emitter is ready, it is time to test it out in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.715.1">
      a level.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.716.1">
     Testing the noise emitter
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.717.1">
     To test the noise emitter, you will
    </span>
    <a id="_idIndexMarker636">
    </a>
    <span class="koboSpan" id="kobo.718.1">
     just need to create a new gym and add some instances of
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.719.1">
      BP_NoiseEmitter
     </span>
    </strong>
    <span class="koboSpan" id="kobo.720.1">
     .
    </span>
    <span class="koboSpan" id="kobo.720.2">
     To do that, start by doing
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.721.1">
      the following:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.722.1">
      Create a new level, starting from the Level Instances and Packed Level Actors I provided in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.723.1">
       project template.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.724.1">
      Add one or more instances of
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.725.1">
       BP_NoiseEmitter
      </span>
     </strong>
     <span class="koboSpan" id="kobo.726.1">
      to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.727.1">
       the level.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.728.1">
      Play
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.729.1">
       the level.
      </span>
     </span>
    </li>
   </ol>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.730.1">
     Note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.731.1">
     Please note that the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.732.1">
      Debug Text Task
     </span>
    </strong>
    <span class="koboSpan" id="kobo.733.1">
     message won’t be displayed if we hit the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.734.1">
      Simulate
     </span>
    </strong>
    <span class="koboSpan" id="kobo.735.1">
     button.
    </span>
    <span class="koboSpan" id="kobo.735.2">
     To show in-game messages, you will need to use the regular
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.736.1">
       Play
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.737.1">
      button.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.738.1">
     As the level is played, you will see each
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.739.1">
      BP_NoiseEmitter
     </span>
    </strong>
    <span class="koboSpan" id="kobo.740.1">
     instance showing debug messages at random times, as shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.741.1">
       Figure 12
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.742.1">
       .15
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.743.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer210">
     <span class="koboSpan" id="kobo.744.1">
      <img alt="Figure 12.15 – Testing the gym" src="image/Figure_12.15_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.745.1">
     Figure 12.15 – Testing the gym
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.746.1">
     In this section, we saw how to implement a state tree inside an actor.
    </span>
    <span class="koboSpan" id="kobo.746.2">
     Starting from creating a custom task that calls a method in the owning actor, we then created our first state tree that looped indefinitely, emitting noise signals for the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.747.1">
      Perception System.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.748.1">
     In the following section, we will create a guard puppet that listens for noise events and responds accordingly.
    </span>
    <span class="koboSpan" id="kobo.748.2">
     We will do this using
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.749.1">
      state trees.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-241">
    <a id="_idTextAnchor243">
    </a>
    <span class="koboSpan" id="kobo.750.1">
     Using advanced state tree features
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.751.1">
     In this section, we will once again extend the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.752.1">
      BaseDummyCharacter
     </span>
    </strong>
    <span class="koboSpan" id="kobo.753.1">
     class to create an AI agent that listens for noise signals and moves to the location where the noise was generated.
    </span>
    <span class="koboSpan" id="kobo.753.2">
     Once the location has been checked, the AI agent will return to its original position.
    </span>
    <span class="koboSpan" id="kobo.753.3">
     We will start by creating an AI controller that will have hearing capabilities through the Perception System and will handle its AI logic through state trees.
    </span>
    <span class="koboSpan" id="kobo.753.4">
     We are essentially developing a guard to protect a level from intruders.
    </span>
    <span class="koboSpan" id="kobo.753.5">
     As usual, let’s start by creating our own base
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.754.1">
      C++ class.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-242">
    <a id="_idTextAnchor244">
    </a>
    <span class="koboSpan" id="kobo.755.1">
     Creating the C++ AI controller
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.756.1">
     The AI controller class will
    </span>
    <a id="_idIndexMarker637">
    </a>
    <span class="koboSpan" id="kobo.757.1">
     need to implement a hearing sense and execute state tree logic.
    </span>
    <span class="koboSpan" id="kobo.757.2">
     As mentioned earlier, at the time of writing this book, there seems to be a bug in Unreal Engine that prevents us from declaring a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.758.1">
      StateTreeAIComponent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.759.1">
     class in C++ so, for the time being, we will be implementing just the hearing sense and adding the state tree component from Blueprints.
    </span>
    <span class="koboSpan" id="kobo.759.2">
     Let’s create a new C++ class called
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.760.1">
      BaseGuardAIController
     </span>
    </strong>
    <span class="koboSpan" id="kobo.761.1">
     .
    </span>
    <span class="koboSpan" id="kobo.761.2">
     Then, open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.762.1">
      BaseGuardAIController.h
     </span>
    </strong>
    <span class="koboSpan" id="kobo.763.1">
     file and add the following forward declaration after the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.764.1">
      #
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.765.1">
       include
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.766.1">
      declarations:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.767.1">
struct FAIStimulus;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.768.1">
     Then, add a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.769.1">
      public
     </span>
    </strong>
    <span class="koboSpan" id="kobo.770.1">
     section with the following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.771.1">
      function declarations:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.772.1">
public:
    ABaseGuardAIController();
    UFUNCTION(BlueprintCallable,
      BlueprintImplementableEvent)
    void OnTargetPerceptionUpdate(AActor* Actor,
      FAIStimulus Stimulus);</span></pre>
   <p>
    <span class="koboSpan" id="kobo.773.1">
     We are already familiar with these function declarations but note that the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.774.1">
      OnTargetPerceptionUpdate()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.775.1">
     function has a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.776.1">
      BlueprintImplementableEvent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.777.1">
     specifier added; this will let us implement this function from an extending Blueprint instead of directly doing it from this class.
    </span>
    <span class="koboSpan" id="kobo.777.2">
     This means we are leaving the responsibility of implementing this function to the Blueprint.
    </span>
    <span class="koboSpan" id="kobo.777.3">
     Now, let’s open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.778.1">
      BaseGuardAIController.cpp
     </span>
    </strong>
    <span class="koboSpan" id="kobo.779.1">
     file to implement the functions.
    </span>
    <span class="koboSpan" id="kobo.779.2">
     The
    </span>
    <a id="_idIndexMarker638">
    </a>
    <span class="koboSpan" id="kobo.780.1">
     needed
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.781.1">
      #include
     </span>
    </strong>
    <span class="koboSpan" id="kobo.782.1">
     declarations you should be adding are
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.783.1">
      the following:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.784.1">
#include "Perception/AIPerceptionComponent.h"
#include "Perception/AISenseConfig_Hearing.h"</span></pre>
   <p>
    <span class="koboSpan" id="kobo.785.1">
     Then, add the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.786.1">
      constructor implementation:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.787.1">
ABaseGuardAIController::ABaseGuardAIController()
{
const auto SenseConfig_Hearing =
  CreateDefaultSubobject&lt;UAISenseConfig_Hearing&gt;
    ("SenseConfig_Hearing");
    SenseConfig_Hearing-&gt;
      DetectionByAffiliation.bDetectEnemies = true;
    SenseConfig_Hearing-&gt;
      DetectionByAffiliation.bDetectNeutrals = true;
    SenseConfig_Hearing-&gt;
      DetectionByAffiliation.bDetectFriendlies = true;
    SenseConfig_Hearing-&gt;HearingRange = 2500.f;
    SenseConfig_Hearing-&gt;SetStartsEnabled(true);
    PerceptionComponent =       CreateDefaultSubobject&lt;UAIPerceptionComponent&gt;(TEXT
      ("Perception"));
    PerceptionComponent-&gt;
      ConfigureSense(*SenseConfig_Hearing);
    PerceptionComponent-&gt;
      SetDominantSense(SenseConfig_Hearing-&gt;
        GetSenseImplementation());
    PerceptionComponent-&gt;
      OnTargetPerceptionUpdated.AddDynamic(this,
        &amp;ABaseGuardAIController::OnTargetPerceptionUpdate);
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.788.1">
     We already know
    </span>
    <a id="_idIndexMarker639">
    </a>
    <span class="koboSpan" id="kobo.789.1">
     how to configure an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.790.1">
      AIPerceptionComponent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.791.1">
     from
    </span>
    <a href="B31016_10.xhtml#_idTextAnchor198">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.792.1">
        Chapter 10
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.793.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.794.1">
      Improving Agents with the Perception System
     </span>
    </em>
    <span class="koboSpan" id="kobo.795.1">
     , so I will not bother you with extra details.
    </span>
    <span class="koboSpan" id="kobo.795.2">
     Just pay attention to the final line of code, where we are registering the delegate that will manage the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.796.1">
      hearing stimuli.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.797.1">
     You can now compile your project to make this class available to the Blueprint system as, in the next few steps, we will create the AI
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.798.1">
      controller Blueprint.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-243">
    <a id="_idTextAnchor245">
    </a>
    <span class="koboSpan" id="kobo.799.1">
     Implementing the AI controller Blueprint
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.800.1">
     Now that the base
    </span>
    <a id="_idIndexMarker640">
    </a>
    <span class="koboSpan" id="kobo.801.1">
     AI controller is ready, we can start implementing a Blueprint version that will also manage the state tree.
    </span>
    <span class="koboSpan" id="kobo.801.2">
     To get started, in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.802.1">
      Blueprints
     </span>
    </strong>
    <span class="koboSpan" id="kobo.803.1">
     folder, create a new Blueprint class extending from
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.804.1">
      BaseGuardAIController
     </span>
    </strong>
    <span class="koboSpan" id="kobo.805.1">
     , call it
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.806.1">
      AIGuardController
     </span>
    </strong>
    <span class="koboSpan" id="kobo.807.1">
     , and open it.
    </span>
    <span class="koboSpan" id="kobo.807.2">
     Then, do the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.808.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.809.1">
      Create a new variable of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.810.1">
       Name
      </span>
     </strong>
     <span class="koboSpan" id="kobo.811.1">
      type and call it
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.812.1">
       NoiseTag
      </span>
     </strong>
     <span class="koboSpan" id="kobo.813.1">
      .
     </span>
     <span class="koboSpan" id="kobo.813.2">
      Make it
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.814.1">
       Instance Editable
      </span>
     </strong>
     <span class="koboSpan" id="kobo.815.1">
      .
     </span>
     <span class="koboSpan" id="kobo.815.2">
      After compiling this Blueprint, set the default value for this variable
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.816.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.817.1">
        EmitterNoise
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.818.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.819.1">
      Create another variable of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.820.1">
       Vector
      </span>
     </strong>
     <span class="koboSpan" id="kobo.821.1">
      type and name it
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.822.1">
       NoiseLocation
      </span>
     </strong>
     <span class="koboSpan" id="kobo.823.1">
      ; make it
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.824.1">
        Instance Editable
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.825.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.826.1">
      Create a third variable of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.827.1">
       Vector
      </span>
     </strong>
     <span class="koboSpan" id="kobo.828.1">
      type and name it
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.829.1">
       StartLocation
      </span>
     </strong>
     <span class="koboSpan" id="kobo.830.1">
      ; make it
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.831.1">
        Instance Editable
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.832.1">
       .
      </span>
     </span>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.833.1">
       Now, let’s handle the state tree by following the steps
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.834.1">
        that ensue.
       </span>
      </span>
     </p>
    </li>
    <li>
     <span class="koboSpan" id="kobo.835.1">
      Add a new component of the
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.836.1">
        StateTreeAI
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.837.1">
       type.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.838.1">
      Drag the component into the Event Graph to add a reference to the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.839.1">
       component itself.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.840.1">
      From the outgoing pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.841.1">
       State Tree AI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.842.1">
      node, connect a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.843.1">
       Start
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.844.1">
        Logic
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.845.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.846.1">
      Connect the outgoing execution pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.847.1">
       Event Begin Play
      </span>
     </strong>
     <span class="koboSpan" id="kobo.848.1">
      node to the incoming execution pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.849.1">
       Start Logic
      </span>
     </strong>
     <span class="koboSpan" id="kobo.850.1">
      node.
     </span>
     <span class="koboSpan" id="kobo.850.2">
      The Event Graph should look like
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.851.1">
        Figure 12
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.852.1">
        .16
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.853.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer211">
     <span class="koboSpan" id="kobo.854.1">
      <img alt="Figure 12.16 – Event Begin Play" src="image/Figure_12.16_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.855.1">
     Figure 12.16 – Event Begin Play
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.856.1">
     This portion
    </span>
    <a id="_idIndexMarker641">
    </a>
    <span class="koboSpan" id="kobo.857.1">
     of the graph will start the execution of the state tree.
    </span>
    <span class="koboSpan" id="kobo.857.2">
     Now, let’s store the AI character’s starting location.
    </span>
    <span class="koboSpan" id="kobo.857.3">
     To do this, follow the steps
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.858.1">
      that ensue.
     </span>
    </span>
   </p>
   <ol>
    <li value="8">
     <span class="koboSpan" id="kobo.859.1">
      From the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.860.1">
       Variables
      </span>
     </strong>
     <span class="koboSpan" id="kobo.861.1">
      section, drag the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.862.1">
       StartLocation
      </span>
     </strong>
     <span class="koboSpan" id="kobo.863.1">
      variable into the Event Graph and make it a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.864.1">
       setter node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.865.1">
      Connect the outgoing execution pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.866.1">
       Start Logic
      </span>
     </strong>
     <span class="koboSpan" id="kobo.867.1">
      node to the incoming execution pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.868.1">
       Set Start
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.869.1">
        Location
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.870.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.871.1">
      Add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.872.1">
       Get Actor Location
      </span>
     </strong>
     <span class="koboSpan" id="kobo.873.1">
      node and add its
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.874.1">
       Return Value
      </span>
     </strong>
     <span class="koboSpan" id="kobo.875.1">
      pin to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.876.1">
       Start Location
      </span>
     </strong>
     <span class="koboSpan" id="kobo.877.1">
      pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.878.1">
       Set Start
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.879.1">
        Location
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.880.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.881.1">
      Add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.882.1">
       Get Controller Pawn
      </span>
     </strong>
     <span class="koboSpan" id="kobo.883.1">
      node and connect its
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.884.1">
       Return Value
      </span>
     </strong>
     <span class="koboSpan" id="kobo.885.1">
      pin to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.886.1">
       Target
      </span>
     </strong>
     <span class="koboSpan" id="kobo.887.1">
      pin of
     </span>
     <a id="_idIndexMarker642">
     </a>
     <span class="koboSpan" id="kobo.888.1">
      the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.889.1">
       Get Actor Location
      </span>
     </strong>
     <span class="koboSpan" id="kobo.890.1">
      node.
     </span>
     <span class="koboSpan" id="kobo.890.2">
      This portion of the graph is depicted in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.891.1">
        Figure 12
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.892.1">
        .17
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.893.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer212">
     <span class="koboSpan" id="kobo.894.1">
      <img alt="Figure 12.17 – Store starting location" src="image/Figure_12.17_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.895.1">
     Figure 12.17 – Store starting location
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.896.1">
     The
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.897.1">
      Event BeginPlay
     </span>
    </strong>
    <span class="koboSpan" id="kobo.898.1">
     code logic has been completed, so we can start implementing the previously declared
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.899.1">
      OnTargetPerceptionUpdated()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.900.1">
     function.
    </span>
    <span class="koboSpan" id="kobo.900.2">
     To do this, follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.901.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li value="12">
     <span class="koboSpan" id="kobo.902.1">
      Right-click in the Event Graph and add an
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.903.1">
       Event On Target Perception
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.904.1">
        Update
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.905.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.906.1">
      Click and drag from the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.907.1">
       Stimulus
      </span>
     </strong>
     <span class="koboSpan" id="kobo.908.1">
      outgoing pin and add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.909.1">
       Break
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.910.1">
        AIStimulus
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.911.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.912.1">
      From the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.913.1">
       Variables
      </span>
     </strong>
     <span class="koboSpan" id="kobo.914.1">
      panel, drag a getter node for the
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.915.1">
        NoiseTag
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.916.1">
       variable.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.917.1">
      From the outgoing pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.918.1">
       Noise Tag
      </span>
     </strong>
     <span class="koboSpan" id="kobo.919.1">
      node, add an
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.920.1">
       Equal (==)
      </span>
     </strong>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.921.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.922.1">
      Connect the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.923.1">
       Tag
      </span>
     </strong>
     <span class="koboSpan" id="kobo.924.1">
      outgoing pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.925.1">
       Break AIStimulus
      </span>
     </strong>
     <span class="koboSpan" id="kobo.926.1">
      node to the second incoming pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.927.1">
       Equal (==)
      </span>
     </strong>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.928.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.929.1">
      Connect the outgoing execution pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.930.1">
       Event On Target Perception Update
      </span>
     </strong>
     <span class="koboSpan" id="kobo.931.1">
      node to a
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.932.1">
        Branch
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.933.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.934.1">
      Connect the
     </span>
     <a id="_idIndexMarker643">
     </a>
     <span class="koboSpan" id="kobo.935.1">
      outgoing pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.936.1">
       Equal (==)
      </span>
     </strong>
     <span class="koboSpan" id="kobo.937.1">
      node to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.938.1">
       Condition
      </span>
     </strong>
     <span class="koboSpan" id="kobo.939.1">
      pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.940.1">
       Break
      </span>
     </strong>
     <span class="koboSpan" id="kobo.941.1">
      node.
     </span>
     <span class="koboSpan" id="kobo.941.2">
      This portion of the graph is depicted in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.942.1">
        Figure 12
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.943.1">
        .18
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.944.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer213">
     <span class="koboSpan" id="kobo.945.1">
      <img alt="Figure 12.18 – Check stimulus tag" src="image/Figure_12.18_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.946.1">
     Figure 12.18 – Check stimulus tag
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.947.1">
     We now need to store the location of the noise, so let’s do the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.948.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li value="19">
     <span class="koboSpan" id="kobo.949.1">
      From the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.950.1">
       Variables
      </span>
     </strong>
     <span class="koboSpan" id="kobo.951.1">
      section, drag the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.952.1">
       NoiseLocation
      </span>
     </strong>
     <span class="koboSpan" id="kobo.953.1">
      reference to create a
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.954.1">
        Set
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.955.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.956.1">
      Connect the node’s incoming execution pin to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.957.1">
       True
      </span>
     </strong>
     <span class="koboSpan" id="kobo.958.1">
      execution pin of the
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.959.1">
        Branch
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.960.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.961.1">
      Connect the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.962.1">
       Noise Location
      </span>
     </strong>
     <span class="koboSpan" id="kobo.963.1">
      pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.964.1">
       Set Noise Location
      </span>
     </strong>
     <span class="koboSpan" id="kobo.965.1">
      node to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.966.1">
       Stimulus Location
      </span>
     </strong>
     <span class="koboSpan" id="kobo.967.1">
      pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.968.1">
       Break AI Stimulus
      </span>
     </strong>
     <span class="koboSpan" id="kobo.969.1">
      node.
     </span>
     <span class="koboSpan" id="kobo.969.2">
      This portion of the graph is shown in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.970.1">
        Figure 12
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.971.1">
        .19
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.972.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer214">
     <span class="koboSpan" id="kobo.973.1">
      <img alt="Figure 12.19 – Store noise location" src="image/Figure_12.19_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.974.1">
     Figure 12.19 – Store noise location
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.975.1">
     The last thing
    </span>
    <a id="_idIndexMarker644">
    </a>
    <span class="koboSpan" id="kobo.976.1">
     we need to do is to notify the state tree that a noise has been heard and that the AI agent needs to respond
    </span>
    <a id="_idIndexMarker645">
    </a>
    <span class="koboSpan" id="kobo.977.1">
     consequently.
    </span>
    <span class="koboSpan" id="kobo.977.2">
     To do so, we will be using
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.978.1">
       Gameplay Tags
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.979.1">
      .
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.980.1">
     Note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.981.1">
     In Unreal Engine, the Gameplay Tag system is used to mark and categorize gameplay elements.
    </span>
    <span class="koboSpan" id="kobo.981.2">
     Gameplay Tags are lightweight identifiers that can be easily attached to game entities (such as actors or components) to help organize and classify them in a flexible and efficient way.
    </span>
    <span class="koboSpan" id="kobo.981.3">
     Learning how to work with Gameplay Tags is out of the scope of this book; we will be just learning the bare minimum to properly communicate with a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.982.1">
      state tree.
     </span>
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.983.1">
     Let’s get on with our Event Graph implementation by doing the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.984.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li value="22">
     <span class="koboSpan" id="kobo.985.1">
      Add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.986.1">
       Make StateTreeEvent
      </span>
     </strong>
     <span class="koboSpan" id="kobo.987.1">
      node to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.988.1">
       the graph.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.989.1">
      Add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.990.1">
       Send State Tree Event
      </span>
     </strong>
     <span class="koboSpan" id="kobo.991.1">
      node to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.992.1">
       the graph.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.993.1">
      Drag a reference of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.994.1">
       StateTreeAI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.995.1">
      component into
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.996.1">
       the graph.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.997.1">
      Connect the outgoing execution pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.998.1">
       Set Noise Location
      </span>
     </strong>
     <span class="koboSpan" id="kobo.999.1">
      node to the incoming execution pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1000.1">
       Send State Tree
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1001.1">
        Event
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1002.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1003.1">
      Connect the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1004.1">
       State Tree AI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1005.1">
      node to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1006.1">
       Target
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1007.1">
      pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1008.1">
       Send State Tree
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1009.1">
        Event
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1010.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1011.1">
      Connect the outgoing pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1012.1">
       Make State Tree Event
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1013.1">
      node to the incoming
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1014.1">
       Event
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1015.1">
      pin of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1016.1">
       Send State Tree
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1017.1">
        Event
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1018.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1019.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1020.1">
       Origin
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1021.1">
      input
     </span>
     <a id="_idIndexMarker646">
     </a>
     <span class="koboSpan" id="kobo.1022.1">
      field of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1023.1">
       Make StateTreeEvent
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1024.1">
      node, type
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1025.1">
       AI Controller
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1026.1">
      .
     </span>
     <span class="koboSpan" id="kobo.1026.2">
      This portion of the graph should look like
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1027.1">
        Figure 12
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1028.1">
        .20
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1029.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer215">
     <span class="koboSpan" id="kobo.1030.1">
      <img alt="Figure 12.20 – Send State Tree Event" src="image/Figure_12.20_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1031.1">
     Figure 12.20 – Send State Tree Event
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.1032.1">
     This portion of the code is responsible for communicating with the state tree by sending an event; the event will need to be tagged in order to be recognized by the state tree itself.
    </span>
    <span class="koboSpan" id="kobo.1032.2">
     To do so, we need to create a Gameplay Tag.
    </span>
    <span class="koboSpan" id="kobo.1032.3">
     You can do this by following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1033.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li value="29">
     <span class="koboSpan" id="kobo.1034.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1035.1">
       Make StateTreeEvent
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1036.1">
      node, click on the dropdown menu next to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1037.1">
       Tag
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1038.1">
      incoming pin.
     </span>
     <span class="koboSpan" id="kobo.1038.2">
      At the moment, it should be labeled
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1039.1">
       as
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1040.1">
        None
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1041.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1042.1">
      You will get a list of available tags; click on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1043.1">
       Manage Gameplay Tags…
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1044.1">
      option to open the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1045.1">
       Gameplay Tag
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1046.1">
        Manager
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1047.1">
       window.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer216">
     <span class="koboSpan" id="kobo.1048.1">
      <img alt="Figure 12.21 – Manage Gameplay Tags… option" src="image/Figure_12.21_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1049.1">
     Figure 12.21 – Manage Gameplay Tags… option
    </span>
   </p>
   <ol>
    <li value="31">
     <span class="koboSpan" id="kobo.1050.1">
      Once the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1051.1">
       Gameplay Tag Manager
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1052.1">
      window is open, click on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1053.1">
       +
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1054.1">
      button.
     </span>
     <span class="koboSpan" id="kobo.1054.2">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1055.1">
       Name
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1056.1">
      input field, enter
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1057.1">
       UnrealAgilityArena.StateTree.HeardNoise
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1058.1">
      and, in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1059.1">
       Source
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1060.1">
      field,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1061.1">
       select
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1062.1">
        DefaultGameplayTags.ini
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1063.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1064.1">
      Click the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1065.1">
       Add New Tag
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1066.1">
      button
     </span>
     <a id="_idIndexMarker647">
     </a>
     <span class="koboSpan" id="kobo.1067.1">
      to confirm the creation of the new
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1068.1">
       Gameplay Tag.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer217">
     <span class="koboSpan" id="kobo.1069.1">
      <img alt="Figure 12.22 – Create Gameplay Tag" src="image/Figure_12.22_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1070.1">
     Figure 12.22 – Create Gameplay Tag
    </span>
   </p>
   <ol>
    <li value="33">
     <span class="koboSpan" id="kobo.1071.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1072.1">
       Make StateTreeEvent
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1073.1">
      node, click on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1074.1">
       Tag
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1075.1">
      dropdown menu and select the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1076.1">
       HeardNoise
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1077.1">
      checkbox to select that
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1078.1">
       gameplay tag.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer218">
     <span class="koboSpan" id="kobo.1079.1">
      <img alt="Figure 12.23 – Select Gameplay Tag" src="image/Figure_12.23_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1080.1">
     Figure 12.23 – Select Gameplay Tag
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1081.1">
     We’re almost done with the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1082.1">
      AIGuardController
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1083.1">
     Blueprint; the only thing left is to include the state tree reference, but we have to create
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1084.1">
      it first!
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-244">
    <a id="_idTextAnchor246">
    </a>
    <span class="koboSpan" id="kobo.1085.1">
     Implementing the state tree
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1086.1">
     Now, we are going to implement the
    </span>
    <a id="_idIndexMarker648">
    </a>
    <span class="koboSpan" id="kobo.1087.1">
     state tree.
    </span>
    <span class="koboSpan" id="kobo.1087.2">
     This time, we will be executing it from the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1088.1">
      AIGuardController
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1089.1">
     Blueprint.
    </span>
    <span class="koboSpan" id="kobo.1089.2">
     That’s why we will need a subclass of the regular state tree – that is the state tree AI – that will have a reference to the owning
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1090.1">
      AI controller.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1091.1">
     The main states will be
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1092.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1093.1">
       Idle
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1094.1">
      : The AI agent will stay at its
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1095.1">
       starting location
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1096.1">
       Alerted
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1097.1">
      : The AI agent has been notified of a noise and it will go inspecting
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1098.1">
       the location
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1099.1">
       Return to Starting Location
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1100.1">
      : The AI agent will get back to its
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1101.1">
       starting location
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.1102.1">
     So, let’s start by opening the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1103.1">
      AI
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1104.1">
     folder and doing the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1105.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1106.1">
      Right-click and select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1107.1">
       Artificial Intelligence
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1108.1">
      |
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1109.1">
        State Tree
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1110.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1111.1">
      From the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1112.1">
       Pick Schema for State Tree
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1113.1">
      pop-up window, select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1114.1">
       StateTreeAIComponentSchema
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1115.1">
      and name the newly created asset
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1116.1">
       STAI_Guard
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1117.1">
      .
     </span>
     <span class="koboSpan" id="kobo.1117.2">
      Double-click on it to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1118.1">
       open it.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1119.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1120.1">
       StateTree
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1121.1">
      left panel, set the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1122.1">
       AIController Class
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1123.1">
      attribute to
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1124.1">
       AIGuardController
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1125.1">
      and the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1126.1">
       Context Actor Class
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1127.1">
      attribute
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1128.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1129.1">
        BP_Guard
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1130.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.1131.1">
     As we have already mentioned, the aforementioned steps will bind the state tree to the owning AI controller and actor; this way you will be granted access to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1132.1">
      their properties.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1133.1">
     We are now going to implement the base states.
    </span>
    <span class="koboSpan" id="kobo.1133.2">
     To do so, carry out the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1134.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1135.1">
      Create three states and call them,
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1136.1">
       Idle
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1137.1">
      ,
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1138.1">
       Warned
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1139.1">
      ,
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1140.1">
        Resume
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1141.1">
       , respectively.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1142.1">
      Select both the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1143.1">
       Warned
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1144.1">
      and
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1145.1">
       Resume
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1146.1">
      states and, in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1147.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1148.1">
      panel, set the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1149.1">
       Type
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1150.1">
      attribute
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1151.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1152.1">
        Group
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1153.1">
       .
      </span>
     </span>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.1154.1">
       We marked the
      </span>
      <strong class="bold">
       <span class="koboSpan" id="kobo.1155.1">
        Warned
       </span>
      </strong>
      <span class="koboSpan" id="kobo.1156.1">
       and
      </span>
      <strong class="bold">
       <span class="koboSpan" id="kobo.1157.1">
        Resume
       </span>
      </strong>
      <span class="koboSpan" id="kobo.1158.1">
       states as groups because they won’t contain tasks but will delegate them to child states.
      </span>
      <span class="koboSpan" id="kobo.1158.2">
       They basically function as
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.1159.1">
        state
       </span>
      </span>
      <span class="No-Break">
       <a id="_idIndexMarker649">
       </a>
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.1160.1">
        containers.
       </span>
      </span>
     </p>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.1161.1">
     As an extra option, the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1162.1">
      State Tree
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1163.1">
     panel has a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1164.1">
      Theme
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1165.1">
     section that will let you define state colors that can then be applied to each state – and its own children – in the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1166.1">
      Details
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1167.1">
     panel.
    </span>
    <span class="koboSpan" id="kobo.1167.2">
     In my case, I have opted for the colors depicted in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1168.1">
       Figure 12
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1169.1">
       .24
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1170.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer219">
     <span class="koboSpan" id="kobo.1171.1">
      <img alt="Figure 12.24 – Base states" src="image/Figure_12.24_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1172.1">
     Figure 12.24 – Base states
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1173.1">
     Let’s now implement each
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1174.1">
      state separately.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.1175.1">
     Implementing the Idle state
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.1176.1">
     The
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1177.1">
      Idle
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1178.1">
     state is
    </span>
    <a id="_idIndexMarker650">
    </a>
    <span class="koboSpan" id="kobo.1179.1">
     going to be quite simple; we will make the AI agent wait in some sort of infinite loop until we get a noise notification.
    </span>
    <span class="koboSpan" id="kobo.1179.2">
     To implement this state, select it and do the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1180.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1181.1">
      Add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1182.1">
       Delay Task
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1183.1">
      with the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1184.1">
       Duration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1185.1">
      attribute set
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1186.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1187.1">
        10.0
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1188.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1189.1">
      Add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1190.1">
       Transition
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1191.1">
      with the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1192.1">
       following settings:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1193.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1194.1">
         Trigger
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1195.1">
        attribute set to
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1196.1">
         On
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1197.1">
          State Completed
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1198.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1199.1">
         Transition To
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1200.1">
        attribute set
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1201.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1202.1">
          Idle
         </span>
        </strong>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1203.1">
      Add another
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1204.1">
       Transition
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1205.1">
      with the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1206.1">
       following settings:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1207.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1208.1">
         Trigger
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1209.1">
        attribute set to
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1210.1">
          On Event
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1211.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1212.1">
         Event Tag
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1213.1">
        attribute set
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1214.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1215.1">
          UnrealAgilityArena.StateTree.HeardNoise
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1216.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1217.1">
         Transition To
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1218.1">
        attribute set
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1219.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1220.1">
          Alert
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1221.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1222.1">
         Priority
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1223.1">
        attribute set
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1224.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1225.1">
          High
         </span>
        </strong>
       </span>
      </li>
     </ul>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer220">
     <span class="koboSpan" id="kobo.1226.1">
      <img alt="Figure 12.25 – Idle state" src="image/Figure_12.25_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1227.1">
     Figure 12.25 – Idle state
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1228.1">
     As you can see, we
    </span>
    <a id="_idIndexMarker651">
    </a>
    <span class="koboSpan" id="kobo.1229.1">
     will keep on looping inside this state until we get an event from the AI controller notifying us that a noise has been heard.
    </span>
    <span class="koboSpan" id="kobo.1229.2">
     In this case, we will transition to the
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.1230.1">
       Alert
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1231.1">
      state.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.1232.1">
     Implementing the Alert state
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.1233.1">
     Once in the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1234.1">
      Alert
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1235.1">
     state, the AI
    </span>
    <a id="_idIndexMarker652">
    </a>
    <span class="koboSpan" id="kobo.1236.1">
     agent will try to move to the noise location.
    </span>
    <span class="koboSpan" id="kobo.1236.2">
     Once it reaches that point, will wait for some time before changing state; we will need two child states
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1237.1">
      for this.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1238.1">
     So, to create the first child state, do the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1239.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1240.1">
      Create a new state and call it
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1241.1">
       Move to
      </span>
     </strong>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1242.1">
        Noise Location
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1243.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1244.1">
      Add a task of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1245.1">
       Action
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1246.1">
      |
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1247.1">
       Move To
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1248.1">
      type and do the following steps
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1249.1">
       with it:
      </span>
     </span>
     <ol>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.1250.1">
        Bind the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1251.1">
         AIController
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1252.1">
        attribute – labeled
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1253.1">
         CONTEXT
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1254.1">
        – to the owner AI controller by clicking the dropdown arrow and
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1255.1">
         selecting
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1256.1">
          AIController
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1257.1">
         .
        </span>
       </span>
      </li>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.1258.1">
        Locate the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1259.1">
         Destination
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1260.1">
        attribute, click the dropdown arrow, and select
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1261.1">
         AIController
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1262.1">
        |
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1263.1">
         Noise Location
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1264.1">
        to bind this attribute to the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1265.1">
         NoiseLocation
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1266.1">
        property of the AI
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1267.1">
         controller owner.
        </span>
       </span>
      </li>
     </ol>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1268.1">
      Add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1269.1">
       Transition
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1270.1">
      with the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1271.1">
       following settings:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1272.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1273.1">
         Trigger
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1274.1">
        attribute set to
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1275.1">
         On
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1276.1">
          State Succeeded
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1277.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1278.1">
         Transition To
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1279.1">
        attribute set to
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1280.1">
          Next State
         </span>
        </strong>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1281.1">
      Add another
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1282.1">
       Transition
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1283.1">
      with the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1284.1">
       following settings:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1285.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1286.1">
         Trigger
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1287.1">
        attribute set to
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1288.1">
         On
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1289.1">
          State Failed
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1290.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1291.1">
         Transition To
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1292.1">
        attribute
       </span>
       <a id="_idIndexMarker653">
       </a>
       <span class="koboSpan" id="kobo.1293.1">
        set
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1294.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1295.1">
          Resume
         </span>
        </strong>
       </span>
      </li>
     </ul>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer221">
     <span class="koboSpan" id="kobo.1296.1">
      <img alt="Figure 12.26 – Move to Noise Location state" src="image/Figure_12.26_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1297.1">
     Figure 12.26 – Move to Noise Location state
    </span>
   </p>
   <ol>
    <li value="5">
     <span class="koboSpan" id="kobo.1298.1">
      This portion of the state tree will move the AI agent to the location set inside the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1299.1">
       NoiseLocation
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1300.1">
      attribute of the owning AI controller.
     </span>
     <span class="koboSpan" id="kobo.1300.2">
      Once successful, the next state will be executed.
     </span>
     <span class="koboSpan" id="kobo.1300.3">
      If the location cannot be reached, it will get back to its
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1301.1">
       original position.
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.1302.1">
     Let’s now create the second child state for the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1303.1">
      Alert
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1304.1">
     state by doing the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1305.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1306.1">
      Create a new state and call it
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1307.1">
       Inspect
      </span>
     </strong>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1308.1">
        Noise Location
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1309.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1310.1">
      Add a task of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1311.1">
       Delay Task
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1312.1">
      type and do the following
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1313.1">
       with it:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1314.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1315.1">
         Duration
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1316.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1317.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.1318.1">
          3.0
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1319.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1320.1">
         Random Deviation
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1321.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1322.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.1323.1">
          1.0
         </span>
        </strong>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1324.1">
      Add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1325.1">
       Transition
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1326.1">
      with the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1327.1">
       following settings:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1328.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1329.1">
         Trigger
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1330.1">
        attribute set to
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1331.1">
         On
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1332.1">
          State Completed
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1333.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1334.1">
         Transition To
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1335.1">
        attribute
       </span>
       <a id="_idIndexMarker654">
       </a>
       <span class="koboSpan" id="kobo.1336.1">
        set
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1337.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1338.1">
          Resume
         </span>
        </strong>
       </span>
      </li>
     </ul>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer222">
     <span class="koboSpan" id="kobo.1339.1">
      <img alt="Figure 12.27 – Inspect Noise Location state" src="image/Figure_12.27_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1340.1">
     Figure 12.27 – Inspect Noise Location state
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1341.1">
     This portion of the state tree will just make the AI agent wait for a bit, before it goes back to its original location.
    </span>
    <span class="koboSpan" id="kobo.1341.2">
     If the AI agent doesn’t find anything suspicious, it gets back to its
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1342.1">
      guard location.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.1343.1">
     Implementing the Resume state
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.1344.1">
     The
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1345.1">
      Resume
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1346.1">
     state will
    </span>
    <a id="_idIndexMarker655">
    </a>
    <span class="koboSpan" id="kobo.1347.1">
     need to bring the AI agent back to its original position; additionally, at any time, this state should be interrupted if a new noise has been notified.
    </span>
    <span class="koboSpan" id="kobo.1347.2">
     So, to create the first child state, do the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1348.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1349.1">
      Create a new state and call it
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1350.1">
       Move to
      </span>
     </strong>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1351.1">
        Starting Location
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1352.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1353.1">
      Add a task of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1354.1">
       Action
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1355.1">
      |
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1356.1">
       Move To
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1357.1">
      type and do the following steps
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1358.1">
       with it:
      </span>
     </span>
     <ol>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.1359.1">
        Bind the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1360.1">
         AI Controller
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1361.1">
        attribute – labeled
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1362.1">
         CONTEXT
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1363.1">
        – to the owner AI controller by clicking the dropdown arrow and selecting
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1364.1">
          AI Controller
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1365.1">
         .
        </span>
       </span>
      </li>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.1366.1">
        Locate the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1367.1">
         Destination
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1368.1">
        attribute, click the dropdown arrow, and select
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1369.1">
         AIController
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1370.1">
        |
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1371.1">
         Start Location
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1372.1">
        to bind this attribute to the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1373.1">
         StartLocation
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1374.1">
        property of the AI
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1375.1">
         controller owner.
        </span>
       </span>
      </li>
     </ol>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1376.1">
      Add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1377.1">
       Transition
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1378.1">
      with the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1379.1">
       following settings:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1380.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1381.1">
         Trigger
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1382.1">
        attribute set to
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1383.1">
         On
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1384.1">
          State Completed
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1385.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1386.1">
         Transition To
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1387.1">
        attribute set to
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1388.1">
          Next State
         </span>
        </strong>
       </span>
      </li>
     </ul>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer223">
     <span class="koboSpan" id="kobo.1389.1">
      <img alt="Figure 12.28 – Move to Start Location state" src="image/Figure_12.28_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1390.1">
     Figure 12.28 – Move to Start Location state
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1391.1">
     This state is pretty similar to the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1392.1">
      Move to Noise Location
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1393.1">
     one; the only difference is the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1394.1">
      Destination
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1395.1">
     attribute that, in this case, is the original location of the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1396.1">
      AI agent.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1397.1">
     Let’s now create the
    </span>
    <a id="_idIndexMarker656">
    </a>
    <span class="koboSpan" id="kobo.1398.1">
     second child state for the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1399.1">
      Resume
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1400.1">
     state by doing the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1401.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1402.1">
      Create a new state and call
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1403.1">
       it
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1404.1">
        Wait
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1405.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1406.1">
      Add a task of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1407.1">
       Delay Task
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1408.1">
      type and do the following
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1409.1">
       with it:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1410.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1411.1">
         Duration
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1412.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1413.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.1414.1">
          2.0
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1415.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1416.1">
         Random Deviation
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1417.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1418.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.1419.1">
          1.0
         </span>
        </strong>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1420.1">
      Add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1421.1">
       Transition
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1422.1">
      with the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1423.1">
       following settings:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1424.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1425.1">
         Trigger
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1426.1">
        attribute set to
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1427.1">
         On
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1428.1">
          State Completed
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1429.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1430.1">
         Transition To
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1431.1">
        attribute set
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1432.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1433.1">
          Idle
         </span>
        </strong>
       </span>
      </li>
     </ul>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer224">
     <span class="koboSpan" id="kobo.1434.1">
      <img alt="Figure 12.29 – Wait state" src="image/Figure_12.29_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1435.1">
     Figure 12.29 – Wait state
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.1436.1">
     As a last step, we will need to interrupt the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1437.1">
      Resume
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1438.1">
     state if a new noise has been heard, so select the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1439.1">
      Resume
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1440.1">
     state and do the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1441.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li value="4">
     <span class="koboSpan" id="kobo.1442.1">
      Add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1443.1">
       Transition
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1444.1">
      with the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1445.1">
       following settings:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1446.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1447.1">
         Trigger
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1448.1">
        attribute set to
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1449.1">
          On Event
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1450.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1451.1">
         Event Tag
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1452.1">
        attribute set
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1453.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1454.1">
          UnrealAgilityArena.StateTree.HeardNoise
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1455.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1456.1">
         Transition
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1457.1">
        To attribute set
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1458.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1459.1">
          Alert
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1460.1">
        The
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1461.1">
         Priority
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1462.1">
        attribute
       </span>
       <a id="_idIndexMarker657">
       </a>
       <span class="koboSpan" id="kobo.1463.1">
        set
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1464.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1465.1">
          High
         </span>
        </strong>
       </span>
      </li>
     </ul>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer225">
     <span class="koboSpan" id="kobo.1466.1">
      <img alt="Figure 12.30 – Resume state" src="image/Figure_12.30_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1467.1">
     Figure 12.30 – Resume state
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1468.1">
     The state tree is pretty complete, and it should look like the one shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1469.1">
       Figure 12
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1470.1">
       .31
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1471.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer226">
     <span class="koboSpan" id="kobo.1472.1">
      <img alt="Figure 12.31 – Finished state tree" src="image/Figure_12.31_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1473.1">
     Figure 12.31 – Finished state tree
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1474.1">
     Now that the state tree is ready, we will need to add it to the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1475.1">
      AI controller.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-245">
    <a id="_idTextAnchor247">
    </a>
    <span class="koboSpan" id="kobo.1476.1">
     Assigning the state tree to the AI controller
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1477.1">
     Assigning the
    </span>
    <a id="_idIndexMarker658">
    </a>
    <span class="koboSpan" id="kobo.1478.1">
     newly created state tree to the AI controller is pretty straightforward.
    </span>
    <span class="koboSpan" id="kobo.1478.2">
     Just open the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1479.1">
      AIGuardController
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1480.1">
     Blueprint and, in the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1481.1">
      Details
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1482.1">
     panel, locate the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1483.1">
      AI
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1484.1">
     section.
    </span>
    <span class="koboSpan" id="kobo.1484.2">
     Set the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1485.1">
      State Tree
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1486.1">
     property
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1487.1">
      to
     </span>
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.1488.1">
       STAI_Guard
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1489.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1490.1">
     Once this is done, we can create the AI
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1491.1">
      agent Blueprint.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-246">
    <a id="_idTextAnchor248">
    </a>
    <span class="koboSpan" id="kobo.1492.1">
     Creating the guard Blueprint
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1493.1">
     We will now create our
    </span>
    <a id="_idIndexMarker659">
    </a>
    <span class="koboSpan" id="kobo.1494.1">
     guard Blueprint and assign the AI logic to it.
    </span>
    <span class="koboSpan" id="kobo.1494.2">
     To do this, open
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1495.1">
      Content Drawer
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1496.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1496.2">
     In the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1497.1">
      Blueprints
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1498.1">
     folder, create a new Blueprint extending from
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1499.1">
      Base Dummy Character
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1500.1">
     and call
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1501.1">
      it
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1502.1">
       BP_Guard
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1503.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1504.1">
     Open the newly created Blueprint and, in the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1505.1">
      Details
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1506.1">
     panel, set the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1507.1">
      AI Controller Class
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1508.1">
     attribute
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1509.1">
      to
     </span>
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.1510.1">
       AIGuardController
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1511.1">
      .
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer227">
     <span class="koboSpan" id="kobo.1512.1">
      <img alt="Figure 12.32 – Guard Blueprint" src="image/Figure_12.32_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1513.1">
     Figure 12.32 – Guard Blueprint
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1514.1">
     The guard AI agent is now ready; we just need to test it out in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1515.1">
      a gym.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-247">
    <a id="_idTextAnchor249">
    </a>
    <span class="koboSpan" id="kobo.1516.1">
     Testing in a gym
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1517.1">
     With the Blueprint class
    </span>
    <a id="_idIndexMarker660">
    </a>
    <span class="koboSpan" id="kobo.1518.1">
     ready, it’s time to test it out.
    </span>
    <span class="koboSpan" id="kobo.1518.2">
     All you need to do is to add it to the previously created gym and play the level.
    </span>
    <span class="koboSpan" id="kobo.1518.3">
     Whenever a noise is emitted by a noise emitter actor, you should see the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1519.1">
      BP_Guard
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1520.1">
     instance try to reach the noise location and, after a while, get back to its original position.
    </span>
    <span class="koboSpan" id="kobo.1520.2">
     Obviously, all of this will work if the AI agent is in range of the provoked noise location.
    </span>
    <span class="koboSpan" id="kobo.1520.3">
     You can obviously leverage your understanding of AI debugging tools to gain valuable insights into the hearing capabilities and range of the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1521.1">
      AI agent.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer228">
     <span class="koboSpan" id="kobo.1522.1">
      <img alt="Figure 12.33 – Testing the gym" src="image/Figure_12.33_B31016.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1523.1">
     Figure 12.33 – Testing the gym
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1524.1">
     In this quite lengthy section, you got more advanced information on how to implement your own state trees.
    </span>
    <span class="koboSpan" id="kobo.1524.2">
     Starting from an AI controller with some hearing capabilities, we learned how to control a state tree and bind important data between the state tree and the AI controller.
    </span>
    <span class="koboSpan" id="kobo.1524.3">
     Finally, we added the AI controller and, consequently, the state tree to an AI agent and tested its behaviors in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1525.1">
      a gym.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1526.1">
     The AI agent we have created sets the foundation for a complete AI guard agent.
    </span>
    <span class="koboSpan" id="kobo.1526.2">
     Currently, it simply checks for any suspicious noises and investigates their source.
    </span>
    <span class="koboSpan" id="kobo.1526.3">
     I highly recommend adding your own logic to introduce more actions, such as sounding an alarm when an enemy is detected or trying to attack the source of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1527.1">
      the noise.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-248">
    <a id="_idTextAnchor250">
    </a>
    <span class="koboSpan" id="kobo.1528.1">
     Summary
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.1529.1">
     State trees in Unreal Engine are crucial in the AI framework as they help manage and organize the decision-making processes of AI agents efficiently.
    </span>
    <span class="koboSpan" id="kobo.1529.2">
     They offer a neat alternative to behavior trees depending on your design and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1530.1">
      development patterns.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1531.1">
     In this chapter, we learned the basics of state trees, a hierarchical state machine framework implemented in Unreal Engine.
    </span>
    <span class="koboSpan" id="kobo.1531.2">
     Starting from its main concepts, such as how states are handled, we were introduced to the main elements involved – including tasks, transitions, and conditions.
    </span>
    <span class="koboSpan" id="kobo.1531.3">
     After that, we created our own actors, taking advantage of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1532.1">
      state trees.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1533.1">
     In the next chapter, we will be working on a totally different topic: how to manage huge numbers of objects within your level, treating them as a collective group for processing or
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1534.1">
      simulation purposes.
     </span>
    </span>
   </p>
  </div>
 </body></html>