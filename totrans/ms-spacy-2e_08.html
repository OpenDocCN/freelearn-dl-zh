<html><head></head><body>
  <div id="_idContainer097">
   <h1 class="chapter-number" id="_idParaDest-110">
    <a id="_idTextAnchor109">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     8
    </span>
   </h1>
   <h1 id="_idParaDest-111">
    <a id="_idTextAnchor110">
    </a>
    <span class="koboSpan" id="kobo.2.1">
     Training an NER Component with Your Own Data
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.3.1">
     In this chapter, you will learn how to use your own data to train spaCy’s pre-trained models.
    </span>
    <span class="koboSpan" id="kobo.3.2">
     We will do that by training
    </span>
    <a id="_idIndexMarker393">
    </a>
    <span class="koboSpan" id="kobo.4.1">
     a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.5.1">
      named entity recognition
     </span>
    </strong>
    <span class="koboSpan" id="kobo.6.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.7.1">
      NER
     </span>
    </strong>
    <span class="koboSpan" id="kobo.8.1">
     ) pipeline, but you can apply the same knowledge to preprocess and train spaCy pipelines for any NLP task.
    </span>
    <span class="koboSpan" id="kobo.8.2">
     In this chapter, we will focus more on how to collect and label your own data, since we saw how to train models with spaCy’s
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.9.1">
      config.cfg
     </span>
    </strong>
    <span class="koboSpan" id="kobo.10.1">
     file in
    </span>
    <a href="B22441_06.xhtml#_idTextAnchor087">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.11.1">
        Chapter 6
       </span>
      </em>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.12.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.13.1">
     The learning journey of this chapter includes how to make the best use of
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.14.1">
      Prodigy
     </span>
    </strong>
    <span class="koboSpan" id="kobo.15.1">
     , the annotation tool from Explosion, and the team behind spaCy.
    </span>
    <span class="koboSpan" id="kobo.15.2">
     We will also see how to annotate NER data using Jupyter Notebook.
    </span>
    <span class="koboSpan" id="kobo.15.3">
     After that, we will update the spaCy pipeline’s NER component with this
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.16.1">
      labeled data.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.17.1">
     This chapter takes you through a complete machine learning practice, including collecting data, annotating data, and training a model for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.18.1">
      information extraction.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.19.1">
     By the end of this chapter, you’ll be ready to train spaCy models on your own data.
    </span>
    <span class="koboSpan" id="kobo.19.2">
     You’ll have the full skill set of collecting data, preprocessing data into the format that spaCy can recognize, and finally, training spaCy models with this data.
    </span>
    <span class="koboSpan" id="kobo.19.3">
     We’re going to cover the following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.20.1">
      main topics:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.21.1">
      Getting started with
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.22.1">
       data preparation
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.23.1">
      Annotating and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.24.1">
       preparing data
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.25.1">
      Training a NER
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.26.1">
       pipeline component
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.27.1">
      Combining multiple NER components in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.28.1">
       same pipeline
      </span>
     </span>
    </li>
   </ul>
   <h1 id="_idParaDest-112">
    <a id="_idTextAnchor111">
    </a>
    <span class="koboSpan" id="kobo.29.1">
     Technical requirements
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.30.1">
     The code of this Chapter can be found at
    </span>
    <a href="https://github.com/PacktPublishing/Mastering-spaCy-Second-Edition">
     <span class="koboSpan" id="kobo.31.1">
      https://github.com/PacktPublishing/Mastering-spaCy-Second-Edition
     </span>
    </a>
    <span class="koboSpan" id="kobo.32.1">
     .
    </span>
    <span class="koboSpan" id="kobo.32.2">
     We will use the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.33.1">
      nertk
     </span>
    </strong>
    <span class="koboSpan" id="kobo.34.1">
     library to annotate the NER data using a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.35.1">
      Jupyter notebook.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-113">
    <a id="_idTextAnchor112">
    </a>
    <span class="koboSpan" id="kobo.36.1">
     Getting started with data preparation
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.37.1">
     spaCy
    </span>
    <a id="_idIndexMarker394">
    </a>
    <span class="koboSpan" id="kobo.38.1">
     out-of-the-box models are very successful for general NLP purposes but sometimes we have to work on very specific domains that require
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.39.1">
      custom training.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.40.1">
     Training models requires time and effort.
    </span>
    <span class="koboSpan" id="kobo.40.2">
     Before even starting the training process, you should decide whether the training is necessary.
    </span>
    <span class="koboSpan" id="kobo.40.3">
     To determine whether you really need custom training, a good starting point is to ask yourself the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.41.1">
      following questions:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.42.1">
      Do spaCy models perform well enough on
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.43.1">
       your data?
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.44.1">
      Does your domain include many labels that are absent in
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.45.1">
       spaCy models?
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.46.1">
      Is there a pre-trained model/application in Hugging Face Hub or elsewhere already?
     </span>
     <span class="koboSpan" id="kobo.46.2">
      (We wouldn’t want to reinvent
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.47.1">
       the wheel.)
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.48.1">
     Let’s discuss these two first questions in detail in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.49.1">
      following sections.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-114">
    <a id="_idTextAnchor113">
    </a>
    <span class="koboSpan" id="kobo.50.1">
     Do spaCy models perform well enough on your data?
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.51.1">
     In general, if the model performs well enough (generally, something above 0.75 accuracy), then you can customize the model output by means of another spaCy component.
    </span>
    <span class="koboSpan" id="kobo.51.2">
     For example, let’s say we work on the navigation domain and we have utterances such as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.52.1">
      the following:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.53.1">
navigate to my home
navigate to Oxford Street</span></pre>
   <p>
    <span class="koboSpan" id="kobo.54.1">
     Let’s see what entities spaCy’s NER model outputs for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.55.1">
      these sentences:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.56.1">
import spacy
nlp = spacy.load("en_core_web_md")
doc1 = nlp("navigate to my home")
doc1.ents
 ()
doc2 = nlp("navigate to Oxford Street")
doc2.ents
 (Oxford Street,)
 doc2.ents[0].label_
'FAC'
spacy.explain("FAC")
'Buildings, airports, highways, bridges, etc.'</span></pre>
   <p>
    <span class="koboSpan" id="kobo.57.1">
     Here,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.58.1">
      home
     </span>
    </strong>
    <span class="koboSpan" id="kobo.59.1">
     isn’t recognized as an entity at all, but we want it to be recognized as a location entity.
    </span>
    <span class="koboSpan" id="kobo.59.2">
     Also, spaCy’s NER model labels
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.60.1">
      Oxford Street
     </span>
    </strong>
    <span class="koboSpan" id="kobo.61.1">
     as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.62.1">
      FAC
     </span>
    </strong>
    <span class="koboSpan" id="kobo.63.1">
     , meaning a building/highway/airport/bridge type entity, which is not what
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.64.1">
      we want.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.65.1">
     We want this entity to be recognized as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.66.1">
      GPE
     </span>
    </strong>
    <span class="koboSpan" id="kobo.67.1">
     , a location.
    </span>
    <span class="koboSpan" id="kobo.67.2">
     Here, we can train NER further to recognize street names as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.68.1">
      GPE
     </span>
    </strong>
    <span class="koboSpan" id="kobo.69.1">
     , as well as recognize some location words (such as work, home, and my mama’s house)
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.70.1">
      as
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.71.1">
       GPE
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.72.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.73.1">
     Another example is the newspaper domain.
    </span>
    <span class="koboSpan" id="kobo.73.2">
     In this domain,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.74.1">
      person
     </span>
    </strong>
    <span class="koboSpan" id="kobo.75.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.76.1">
      place
     </span>
    </strong>
    <span class="koboSpan" id="kobo.77.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.78.1">
      date
     </span>
    </strong>
    <span class="koboSpan" id="kobo.79.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.80.1">
      time
     </span>
    </strong>
    <span class="koboSpan" id="kobo.81.1">
     , and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.82.1">
      organization
     </span>
    </strong>
    <span class="koboSpan" id="kobo.83.1">
     are all target entities that should be extracted, but you need one more entity type –
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.84.1">
      vehicle
     </span>
    </strong>
    <span class="koboSpan" id="kobo.85.1">
     (car, bus, airplane, and so on).
    </span>
    <span class="koboSpan" id="kobo.85.2">
     Hence, instead of training from scratch, you can add a new entity type by using spaCy’s
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.86.1">
      SpanRuler
     </span>
    </strong>
    <span class="koboSpan" id="kobo.87.1">
     (explained in
    </span>
    <a href="B22441_04.xhtml#_idTextAnchor056">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.88.1">
        Chapter 4
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.89.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.89.2">
     Always examine your data first and calculate the spaCy models’ success rate.
    </span>
    <span class="koboSpan" id="kobo.89.3">
     If the success rate is satisfying, then use other spaCy
    </span>
    <a id="_idIndexMarker395">
    </a>
    <span class="koboSpan" id="kobo.90.1">
     components
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.91.1">
      to customize.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-115">
    <a id="_idTextAnchor114">
    </a>
    <span class="koboSpan" id="kobo.92.1">
     Does your domain include many labels that are absent in spaCy models?
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.93.1">
     For instance, in the preceding newspaper example, only one entity label,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.94.1">
      vehicle
     </span>
    </strong>
    <span class="koboSpan" id="kobo.95.1">
     , is missing from the spaCy’s NER model’s labels but other entity types are recognized.
    </span>
    <span class="koboSpan" id="kobo.95.2">
     Since we can recognize the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.96.1">
      vehicle
     </span>
    </strong>
    <span class="koboSpan" id="kobo.97.1">
     entity with
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.98.1">
      SpanRuler
     </span>
    </strong>
    <span class="koboSpan" id="kobo.99.1">
     , in this case, you don’t need
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.100.1">
      custom training.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.101.1">
     Consider the medical domain again.
    </span>
    <span class="koboSpan" id="kobo.101.2">
     The entities are diseases, symptoms, drugs, dosages, chemical compound names, and so on.
    </span>
    <span class="koboSpan" id="kobo.101.3">
     This is a specialized and long list of entities.
    </span>
    <span class="koboSpan" id="kobo.101.4">
     For the medical domain, you require custom
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.102.1">
      model training.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.103.1">
     If we need custom model training, we usually follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.104.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.105.1">
      Collect
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.106.1">
       our data.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.107.1">
      Annotate
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.108.1">
       our data.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.109.1">
      Decide to update an existing model or train a model
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.110.1">
       from scratch.
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.111.1">
     In the data collection step, we decide how much data to collect: 1,000 sentences, 5,000 sentences, or more.
    </span>
    <span class="koboSpan" id="kobo.111.2">
     The amount of data depends on the complexity of our task and domain.
    </span>
    <span class="koboSpan" id="kobo.111.3">
     Usually, we start with an acceptable amount of data, train the model for the first time, and see how it performs; then, we can add more data and retrain
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.112.1">
      the model.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.113.1">
     After collecting your dataset, you need to annotate your data in such a way that the spaCy training code recognizes it.
    </span>
    <span class="koboSpan" id="kobo.113.2">
     In the next section, we will see the training data format and how to annotate data with Explosion’s
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.114.1">
      Prodigy tool.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.115.1">
     The third step is to decide on training a blank model from scratch or making updates to an existing model.
    </span>
    <span class="koboSpan" id="kobo.115.2">
     Here, the rule of thumb is as follows: if your entities/labels are present in the existing model but you don’t see a very good performance, then update the model with your own data, such as in the preceding
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.116.1">
      vehicle
     </span>
    </strong>
    <span class="koboSpan" id="kobo.117.1">
     example.
    </span>
    <span class="koboSpan" id="kobo.117.2">
     If your entities are not present in the current spaCy model at all, then most probably you need
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.118.1">
      custom
     </span>
    </span>
    <span class="No-Break">
     <a id="_idIndexMarker396">
     </a>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.119.1">
      training.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.120.1">
     We’ll start our journey of building a model with the first step: preparing our training data.
    </span>
    <span class="koboSpan" id="kobo.120.2">
     Let’s move on to the next section and see how to prepare and annotate our
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.121.1">
      training data.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-116">
    <a id="_idTextAnchor115">
    </a>
    <span class="koboSpan" id="kobo.122.1">
     Annotating and preparing data
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.123.1">
     The first step of training a model is always preparing training data.
    </span>
    <span class="koboSpan" id="kobo.123.2">
     You usually collect data from customer logs and then turn them into a dataset by dumping the data as a CSV file or a JSON file.
    </span>
    <span class="koboSpan" id="kobo.123.3">
     spaCy model training code works with
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.124.1">
      DocBin
     </span>
    </strong>
    <span class="koboSpan" id="kobo.125.1">
     objects, so we will be annotating the data and converting it to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.126.1">
      DocBin
     </span>
    </strong>
    <span class="koboSpan" id="kobo.127.1">
     objects in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.128.1">
      this chapter.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.129.1">
     After collecting our data, we annotate our data.
    </span>
    <span class="koboSpan" id="kobo.129.2">
     Annotation means labeling the intent, entities, POS tags, and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.130.1">
      so on.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.131.1">
     This is an example of annotated data, taken from spaCy’s
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.132.1">
      Detecting Fashion Brands in Online Comments
     </span>
    </em>
    <span class="koboSpan" id="kobo.133.1">
     tutorial (available
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.134.1">
      at
     </span>
    </span>
    <a href="https://github.com/explosion/projects/tree/v3/tutorials/ner_fashion_brands">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.135.1">
       https://github.com/explosion/projects/tree/v3/tutorials/ner_fashion_brands
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.136.1">
      ):
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.137.1">
{
  "text": "Bonobos has some long sizes.",
  "tokens": [
    { "text": "Bonobos", "start": 0, "end": 7, "id": 0 },
    { "text": "has", "start": 8, "end": 11, "id": 1 },
    { "text": "some", "start": 12, "end": 16, "id": 2 },
    { "text": "long", "start": 17, "end": 21, "id": 3 },
    { "text": "sizes", "start": 22, "end": 27, "id": 4 },
    { "text": ".", "start": 27, "end": 28, "id": 5 }
  ],
  "spans": [
    {
      "start": 0,
      "end": 7,
      "token_start": 0,
      "token_end": 0,
      "label": "FASHION_BRAND"
    }
  ]
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.138.1">
     We annotated the
    </span>
    <a id="_idIndexMarker397">
    </a>
    <span class="koboSpan" id="kobo.139.1">
     data with the goal of pointing the statistical algorithm to what we want the model to learn.
    </span>
    <span class="koboSpan" id="kobo.139.2">
     In this example, we want the model to learn about the entities; hence, we feed examples with
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.140.1">
      entities annotated.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.141.1">
     In this section, we’ll also see spaCy’s
    </span>
    <a id="_idIndexMarker398">
    </a>
    <span class="koboSpan" id="kobo.142.1">
     annotation tool,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.143.1">
      Prodigy
     </span>
    </strong>
    <span class="koboSpan" id="kobo.144.1">
     , along with
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.145.1">
      nertk
     </span>
    </strong>
    <span class="koboSpan" id="kobo.146.1">
     , a
    </span>
    <a id="_idIndexMarker399">
    </a>
    <span class="koboSpan" id="kobo.147.1">
     simple open source Python library to annotate NER data using Jupyter Notebook.
    </span>
    <span class="koboSpan" id="kobo.147.2">
     Prodigy is tailored for small teams working on fast-paced projects.
    </span>
    <span class="koboSpan" id="kobo.147.3">
     Although it’s not free or open source, buying Prodigy helps fund open source initiatives, including the development of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.148.1">
      spaCy itself.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.149.1">
     Annotating data with Prodigy
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.150.1">
     Prodigy is a
    </span>
    <a id="_idIndexMarker400">
    </a>
    <span class="koboSpan" id="kobo.151.1">
     modern tool powered by active learning.
    </span>
    <span class="koboSpan" id="kobo.151.2">
     We will be using the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.152.1">
      Prodigy live demo
     </span>
    </em>
    <span class="koboSpan" id="kobo.153.1">
     (
    </span>
    <a href="https://demo.prodi.gy/">
     <span class="koboSpan" id="kobo.154.1">
      https://demo.prodi.gy/
     </span>
    </a>
    <span class="koboSpan" id="kobo.155.1">
     ) to
    </span>
    <a id="_idIndexMarker401">
    </a>
    <span class="koboSpan" id="kobo.156.1">
     exhibit how an annotation
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.157.1">
      tool works.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.158.1">
     Let’s
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.159.1">
      get started:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.160.1">
      We
     </span>
     <a id="_idIndexMarker402">
     </a>
     <span class="koboSpan" id="kobo.161.1">
      navigate to the
     </span>
     <a id="_idIndexMarker403">
     </a>
     <span class="koboSpan" id="kobo.162.1">
      Prodigy Live Demo and view an example text by Prodigy to be annotated, as shown in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.163.1">
       following screenshot:
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer087">
     <span class="koboSpan" id="kobo.164.1">
      <img alt="Figure 8.1 – Prodigy interface (screenshot taken from their Prodigy Demo page)" src="image/B22441_08_01.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.165.1">
     Figure 8.1 – Prodigy interface (screenshot taken from their Prodigy Demo page)
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.166.1">
     This screenshot,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.167.1">
      Figure 8
     </span>
    </span>
    <span class="koboSpan" id="kobo.168.1">
     .1, shows an example text that we want to annotate.
    </span>
    <span class="koboSpan" id="kobo.168.2">
     The buttons at the bottom of the screenshot showcase the means to either accept this training example, reject it, or ignore it.
    </span>
    <span class="koboSpan" id="kobo.168.3">
     If the text is relevant and the annotation is good, then we accept it and it joins
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.169.1">
      our dataset.
     </span>
    </span>
   </p>
   <ol>
    <li value="2">
     <span class="koboSpan" id="kobo.170.1">
      Next, we’ll label the entities.
     </span>
     <span class="koboSpan" id="kobo.170.2">
      To do that, first, we select an entity type from the upper bar.
     </span>
     <span class="koboSpan" id="kobo.170.3">
      This corpus includes two types of entities,
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.171.1">
       PERSON
      </span>
     </strong>
     <span class="koboSpan" id="kobo.172.1">
      and
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.173.1">
       ORG
      </span>
     </strong>
     <span class="koboSpan" id="kobo.174.1">
      .
     </span>
     <span class="koboSpan" id="kobo.174.2">
      Then, we’ll just select the words we want to label as an entity with the cursor, as shown in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.175.1">
       following screenshot:
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer088">
     <span class="koboSpan" id="kobo.176.1">
      <img alt="Figure 8.2 – Annotating PERSON entities on the Prodigy Demo page" src="image/B22441_08_02.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.177.1">
     Figure 8.2 – Annotating PERSON entities on the Prodigy Demo page
    </span>
   </p>
   <ol>
    <li value="3">
     <span class="koboSpan" id="kobo.178.1">
      After we’re
     </span>
     <a id="_idIndexMarker404">
     </a>
     <span class="koboSpan" id="kobo.179.1">
      finished with annotating the text, we click
     </span>
     <a id="_idIndexMarker405">
     </a>
     <span class="koboSpan" id="kobo.180.1">
      the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.181.1">
       Accept
      </span>
     </strong>
     <span class="koboSpan" id="kobo.182.1">
      button.
     </span>
     <span class="koboSpan" id="kobo.182.2">
      Once the session is finished, you can dump the annotated data as a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.183.1">
       JSON file.
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.184.1">
     Prodigy features do not only include NER but also text classification, computer vision, prompt engineering, large language models,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.185.1">
      and more.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.186.1">
     Annotating data with nertk
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.187.1">
     Another
    </span>
    <a id="_idIndexMarker406">
    </a>
    <span class="koboSpan" id="kobo.188.1">
     annotation tool is
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.189.1">
      nertk
     </span>
    </strong>
    <span class="koboSpan" id="kobo.190.1">
     , which is an open source Python
    </span>
    <a id="_idIndexMarker407">
    </a>
    <span class="koboSpan" id="kobo.191.1">
     library for
    </span>
    <a id="_idIndexMarker408">
    </a>
    <span class="koboSpan" id="kobo.192.1">
     NER text annotation (
    </span>
    <a href="https://github.com/johnsmithm/nertk">
     <span class="koboSpan" id="kobo.193.1">
      https://github.com/johnsmithm/nertk
     </span>
    </a>
    <span class="koboSpan" id="kobo.194.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.194.2">
     The tool works inline on Jupyter Notebook allowing you to interact with your data and annotate it quickly and easily.
    </span>
    <span class="koboSpan" id="kobo.194.3">
     The project is currently in alpha development, so it’s useful only for simple and quick NER
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.195.1">
      annotation sessions.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.196.1">
     To work with
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.197.1">
      nertk
     </span>
    </strong>
    <span class="koboSpan" id="kobo.198.1">
     , you need to install it using
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.199.1">
      pip install nertk
     </span>
    </strong>
    <span class="koboSpan" id="kobo.200.1">
     , run a Jupyter Notebook server, and open the URL for the server in a web browser.
    </span>
    <span class="koboSpan" id="kobo.200.2">
     To process the data for
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.201.1">
      nertk
     </span>
    </strong>
    <span class="koboSpan" id="kobo.202.1">
     , you need to tokenize the text and pass the data you want to annotate.
    </span>
    <span class="koboSpan" id="kobo.202.2">
     Let’s do that step
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.203.1">
      by step:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.204.1">
      First, we need to tokenize the data because
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.205.1">
       nertk
      </span>
     </strong>
     <span class="koboSpan" id="kobo.206.1">
      works with lists of words.
     </span>
     <span class="koboSpan" id="kobo.206.2">
      Our dataset for this chapter is in Portuguese so we import the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.207.1">
       en
      </span>
     </strong>
     <span class="koboSpan" id="kobo.208.1">
      model and select only the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.209.1">
       tokenizer
      </span>
     </strong>
     <span class="koboSpan" id="kobo.210.1">
      component since is the only thing
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.211.1">
       we need:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.212.1">
import spacy
nlp = spacy.load("en_core_web_sm", enable="tokenizer")</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.213.1">
      We will use the dataset of spacy’s
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.214.1">
       Detecting fashion brands in online comments
      </span>
     </em>
     <span class="koboSpan" id="kobo.215.1">
      tutorial.
     </span>
     <span class="koboSpan" id="kobo.215.2">
      The raw text was sourced from the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.216.1">
       r/MaleFashionAdvice
      </span>
     </strong>
     <span class="koboSpan" id="kobo.217.1">
      and
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.218.1">
       r/FemaleFashionAdvice
      </span>
     </strong>
     <span class="koboSpan" id="kobo.219.1">
      subreddits.
     </span>
     <span class="koboSpan" id="kobo.219.2">
      The data is in the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.220.1">
       jsonl
      </span>
     </strong>
     <span class="koboSpan" id="kobo.221.1">
      format, so we’ll use the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.222.1">
       srsly
      </span>
     </strong>
     <span class="koboSpan" id="kobo.223.1">
      library to read it.
     </span>
     <span class="koboSpan" id="kobo.223.2">
      Let’s print the first item to see what the data
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.224.1">
       looks like:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.225.1">
import srsly
from pprint import pprint
training_path = "data/fashion_brands_training.jsonl"
for row in srsly.read_jsonl(training_path):
    pprint(row)
    break</span></pre>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.226.1">
       Since the data is already annotated with Prodigy, it has the
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.227.1">
        ['text', 'meta', '_input_hash', '_task_hash', 'tokens', 'spans', '_session_id', '_view_id', 'answer']
       </span>
      </strong>
      <span class="koboSpan" id="kobo.228.1">
       keys.
      </span>
      <span class="koboSpan" id="kobo.228.2">
       To learn how we would go if we didn’t have the entities, let’s use just the
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.229.1">
        text
       </span>
      </strong>
      <span class="koboSpan" id="kobo.230.1">
       key, which contains the text of
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.231.1">
        Reddit’s comment.
       </span>
      </span>
     </p>
    </li>
    <li>
     <span class="koboSpan" id="kobo.232.1">
      The next step is to tokenize the data.
     </span>
     <span class="koboSpan" id="kobo.232.2">
      We need to create a list where each item is also a list, but a list of the words of the comment.
     </span>
     <span class="koboSpan" id="kobo.232.3">
      To do that, we’ll loop through the data, tokenize it with the model we loaded previously, and add this to the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.233.1">
       main list:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.234.1">
nertk_input_text = []
for row in srsly.read_jsonl(training_path):
    comment = nlp(row["text"])
    comment_words = [token.text for token in comment]
    nertk_input_text.append(comment_words)</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.235.1">
      Now, we
     </span>
     <a id="_idIndexMarker409">
     </a>
     <span class="koboSpan" id="kobo.236.1">
      are ready to start the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.237.1">
       nertk
      </span>
     </strong>
     <span class="koboSpan" id="kobo.238.1">
      tool.
     </span>
     <span class="koboSpan" id="kobo.238.2">
      We need to
     </span>
     <a id="_idIndexMarker410">
     </a>
     <span class="koboSpan" id="kobo.239.1">
      pass to the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.240.1">
       Entator
      </span>
     </strong>
     <span class="koboSpan" id="kobo.241.1">
      class the list with the entity label names and the list with the words of each comment.
     </span>
     <span class="koboSpan" id="kobo.241.2">
      Then, we can call the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.242.1">
       run()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.243.1">
      method to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.244.1">
       start annotating:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.245.1">
from nertk import Entator
annotator = Entator(labels=['None', 'FASHION_BRAND'],
inputs=nertk_input_text)
annotator.run()</span></pre>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.246.1">
       We will annotate all the
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.247.1">
        FASHION_BRAND
       </span>
      </strong>
      <span class="koboSpan" id="kobo.248.1">
       entities.
      </span>
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.249.1">
         Figure 8
        </span>
       </em>
      </span>
      <em class="italic">
       <span class="koboSpan" id="kobo.250.1">
        .3
       </span>
      </em>
      <span class="koboSpan" id="kobo.251.1">
       shows the
      </span>
      <span class="No-Break">
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.252.1">
         nertk
        </span>
       </strong>
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.253.1">
        interface:
       </span>
      </span>
     </p>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer089">
     <span class="koboSpan" id="kobo.254.1">
      <img alt="Figure 8.3 – The nertk interface" src="image/B22441_08_03.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.255.1">
     Figure 8.3 – The nertk interface
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.256.1">
     To select the
    </span>
    <a id="_idIndexMarker411">
    </a>
    <span class="koboSpan" id="kobo.257.1">
     tokens that are part of
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.258.1">
      FASHION_BRAND
     </span>
    </strong>
    <span class="koboSpan" id="kobo.259.1">
     entities, you
    </span>
    <a id="_idIndexMarker412">
    </a>
    <span class="koboSpan" id="kobo.260.1">
     simply click on them.
    </span>
    <span class="koboSpan" id="kobo.260.2">
     When you are ready with the example, you can click on the next button to annotate another one.
    </span>
    <span class="koboSpan" id="kobo.260.3">
     The results of the annotated tokens are stored in the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.261.1">
       annotator.targets
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.262.1">
      attribute.
     </span>
    </span>
   </p>
   <h4>
    <span class="koboSpan" id="kobo.263.1">
     Converting the annotated data to DocBin objects
    </span>
   </h4>
   <p>
    <span class="koboSpan" id="kobo.264.1">
     To use
    </span>
    <a id="_idIndexMarker413">
    </a>
    <span class="koboSpan" id="kobo.265.1">
     this annotated data to train the models, we need to convert it to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.266.1">
      DocBin
     </span>
    </strong>
    <span class="koboSpan" id="kobo.267.1">
     format.
    </span>
    <span class="koboSpan" id="kobo.267.2">
     To do that, we will create a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.268.1">
      Doc
     </span>
    </strong>
    <span class="koboSpan" id="kobo.269.1">
     object for each comment and add the entities we’ve annotated.
    </span>
    <span class="koboSpan" id="kobo.269.2">
     Let’s create the code to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.270.1">
      do that:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.271.1">
      The first thing to do is to create the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.272.1">
       DocBin
      </span>
     </strong>
     <span class="koboSpan" id="kobo.273.1">
      object and loop through each comment getting the indexes of the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.274.1">
       annotated entities:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.275.1">
from spacy.tokens import DocBin, Span
from utils import create_consecutive_token_sequences
db = DocBin()
for idx, (row, nerkt_tokens, nertk_entities) in enumerate(
    zip(srsly.read_jsonl(training_path), nertk_input_text,
        annotator.targets)):
    if idx == 5:
        break
    doc = nlp(row["text"])
    indexes_entity_tokens = [index for index, x in enumerate(
        nertk_entities) if x == "FASHION_BRAND"]</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.276.1">
      With
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.277.1">
       nertk
      </span>
     </strong>
     <span class="koboSpan" id="kobo.278.1">
      , we annotated each token, but an entity can encompass more than one token.
     </span>
     <span class="koboSpan" id="kobo.278.2">
      To handle that, we use a helper function that gets the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.279.1">
       indexes_entity_tokens
      </span>
     </strong>
     <span class="koboSpan" id="kobo.280.1">
      list and creates tuples with the indexes of the start and end token of each entity (this code is still inside the main
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.281.1">
        for
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.282.1">
       loop):
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.283.1">
span_indexes = create_consecutive_token_sequences(indexes_entity_tokens)</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.284.1">
      Now, it’s
     </span>
     <a id="_idIndexMarker414">
     </a>
     <span class="koboSpan" id="kobo.285.1">
      time to create the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.286.1">
       Span
      </span>
     </strong>
     <span class="koboSpan" id="kobo.287.1">
      objects for each entity.
     </span>
     <span class="koboSpan" id="kobo.287.2">
      We create an
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.288.1">
       ents
      </span>
     </strong>
     <span class="koboSpan" id="kobo.289.1">
      list to store these spans, set this list as the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.290.1">
       doc.ents
      </span>
     </strong>
     <span class="koboSpan" id="kobo.291.1">
      parameter, and add this
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.292.1">
       Doc
      </span>
     </strong>
     <span class="koboSpan" id="kobo.293.1">
      to the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.294.1">
       DocBin
      </span>
     </strong>
     <span class="koboSpan" id="kobo.295.1">
      object (this code is also still inside the main
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.296.1">
        for
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.297.1">
       loop):
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.298.1">
  ents = []
  label = "FASHION_BRAND"
  for start,end in span_indexes:
      span = Span(doc, start, end+1, label)
      ents.append(span)
  doc.ents = ents
  db.add(doc)</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.299.1">
      Finally, we save the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.300.1">
       DocBin
      </span>
     </strong>
     <span class="koboSpan" id="kobo.301.1">
      file
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.302.1">
       to disk:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.303.1">
db.to_disk("data/nertk_training.spacy")</span></pre>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.304.1">
       Here is the full code to convert the
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.305.1">
        nertk
       </span>
      </strong>
      <span class="koboSpan" id="kobo.306.1">
       annotated entities
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.307.1">
        to
       </span>
      </span>
      <span class="No-Break">
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.308.1">
         DocBin
        </span>
       </strong>
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.309.1">
        :
       </span>
      </span>
     </p>
     <pre class="source-code"><span class="koboSpan" id="kobo.310.1">from spacy.tokens import DocBin, Span
from utils import create_consecutive_token_sequences
db = DocBin()
for idx, (row, nerkt_tokens, nertk_entities) in enumerate(
    zip(srsly.read_jsonl(training_path), nertk_input_text,
        annotator.targets)):
    if idx == 5:
        break
    doc = nlp(row["text"])
    indexes_entity_tokens = [index for index, x in enumerate(
        nertk_entities) if x == "FASHION_BRAND"]
    
    span_indexes = create_consecutive_token_sequences(
        indexes_entity_tokens)
    
    ents = []
    label = "FASHION_BRAND"
    for start, end in span_indexes:
        span = Span(doc, start, end + 1, label)
        ents.append(span)
    
    doc.ents = ents
    db.add(doc)
db.to_disk("data/nertk_training.spacy")</span></pre>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.311.1">
     This is the process of
    </span>
    <a id="_idIndexMarker415">
    </a>
    <span class="koboSpan" id="kobo.312.1">
     creating the training data to fine-tune the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.313.1">
      ner
     </span>
    </strong>
    <span class="koboSpan" id="kobo.314.1">
     spaCy component.
    </span>
    <span class="koboSpan" id="kobo.314.2">
     To create training data for any other trainable component, the process is the same.
    </span>
    <span class="koboSpan" id="kobo.314.3">
     You create the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.315.1">
      Doc
     </span>
    </strong>
    <span class="koboSpan" id="kobo.316.1">
     object, setting the annotations with the appropriate format, and then save these Docs as a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.317.1">
      DocBin
     </span>
    </strong>
    <span class="koboSpan" id="kobo.318.1">
     object.
    </span>
    <span class="koboSpan" id="kobo.318.2">
     You can check all the data formats
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.319.1">
      here:
     </span>
    </span>
    <a href="https://spacy.io/api/data-formats#dict-input">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.320.1">
       https://spacy.io/api/data-formats#dict-input
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.321.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.322.1">
     With the training data set, the next step is to train the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.323.1">
      ner
     </span>
    </strong>
    <span class="koboSpan" id="kobo.324.1">
     component.
    </span>
    <span class="koboSpan" id="kobo.324.2">
     Let’s do that in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.325.1">
      next section.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-117">
    <a id="_idTextAnchor116">
    </a>
    <span class="koboSpan" id="kobo.326.1">
     Training an NER pipeline component
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.327.1">
     Our
    </span>
    <a id="_idIndexMarker416">
    </a>
    <span class="koboSpan" id="kobo.328.1">
     goal is to create a pipeline to identify the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.329.1">
      FASHION_BRAND
     </span>
    </strong>
    <span class="koboSpan" id="kobo.330.1">
     entities.
    </span>
    <span class="koboSpan" id="kobo.330.2">
     We will do that by training the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.331.1">
      EntityRecognizer
     </span>
    </strong>
    <span class="koboSpan" id="kobo.332.1">
     pipeline component.
    </span>
    <span class="koboSpan" id="kobo.332.2">
     It uses a transition-based algorithm that assumes the most decisive information about the entities that are close to the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.333.1">
      initial tokens.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.334.1">
     The first thing we need to do to train the component is to create the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.335.1">
      config
     </span>
    </strong>
    <span class="koboSpan" id="kobo.336.1">
     file.
    </span>
    <span class="koboSpan" id="kobo.336.2">
     We’ll use the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.337.1">
      spacy init config
     </span>
    </strong>
    <span class="koboSpan" id="kobo.338.1">
     CLI command to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.339.1">
      do that:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.340.1">
python3 –m spacy init config cpu_config.cfg --lang "en" --pipeline "ner" --optimize "efficiency"</span></pre>
   <p>
    <span class="koboSpan" id="kobo.341.1">
     This creates the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.342.1">
      cpu_config.cfg
     </span>
    </strong>
    <span class="koboSpan" id="kobo.343.1">
     file with all default configurations and sets the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.344.1">
      ner
     </span>
    </strong>
    <span class="koboSpan" id="kobo.345.1">
     component for training optimized for
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.346.1">
      efficiency
     </span>
    </strong>
    <span class="koboSpan" id="kobo.347.1">
     (faster inference, smaller model, and lower memory consumption).
    </span>
    <span class="koboSpan" id="kobo.347.2">
     We will use the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.348.1">
      preprocess.py
     </span>
    </strong>
    <span class="koboSpan" id="kobo.349.1">
     script from the spaCy tutorial to convert the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.350.1">
      jsonl
     </span>
    </strong>
    <span class="koboSpan" id="kobo.351.1">
     data into
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.352.1">
       DocBin
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.353.1">
      objects:
     </span>
    </span>
   </p>
   <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.354.1">python3 ./scripts/preprocess.py ./data/fashion_brands_training.jsonl ./data/fashion_brands_training.spacy</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.355.1">python3 ./scripts/preprocess.py ./data/fashion_brands_eval.jsonl ./data/fashion_brands_eval.spacy</span></strong></pre>
   <p>
    <span class="koboSpan" id="kobo.356.1">
     Now, we are ready to train the model using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.357.1">
      spacy train
     </span>
    </strong>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.358.1">
      CLI command:
     </span>
    </span>
   </p>
   <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.359.1">python3 -m spacy train cpu_config.cfg --output training_cpu/ --paths.train ./data/fashion_brands_training.spacy --paths.dev ./data/fashion_brands_eval.spacy</span></strong></pre>
   <p>
    <span class="koboSpan" id="kobo.360.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.361.1">
      output
     </span>
    </strong>
    <span class="koboSpan" id="kobo.362.1">
     parameter specifies the directory to store the trained pipeline.
    </span>
    <span class="koboSpan" id="kobo.362.2">
     In
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.363.1">
       Figure 8
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.364.1">
      .4
     </span>
    </em>
    <span class="koboSpan" id="kobo.365.1">
     , we can see the
    </span>
    <a id="_idIndexMarker417">
    </a>
    <span class="koboSpan" id="kobo.366.1">
     messages produced
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.367.1">
      during training.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer090">
     <span class="koboSpan" id="kobo.368.1">
      <img alt="Figure 8.4 – Messages produced during the training of the ner component" src="image/B22441_08_04.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.369.1">
     Figure 8.4 – Messages produced during the training of the ner component
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.370.1">
     We can see that, during training, there is a training loss for a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.371.1">
      tok2vec
     </span>
    </strong>
    <span class="koboSpan" id="kobo.372.1">
     component and a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.373.1">
      ner
     </span>
    </strong>
    <span class="koboSpan" id="kobo.374.1">
     component.
    </span>
    <span class="koboSpan" id="kobo.374.2">
     That’s
    </span>
    <a id="_idIndexMarker418">
    </a>
    <span class="koboSpan" id="kobo.375.1">
     because the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.376.1">
      ner
     </span>
    </strong>
    <span class="koboSpan" id="kobo.377.1">
     component by default uses the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.378.1">
      spacy.TransitionBasedParser.v2
     </span>
    </strong>
    <span class="koboSpan" id="kobo.379.1">
     model architecture.
    </span>
    <span class="koboSpan" id="kobo.379.2">
     As the spaCy documentation says (
    </span>
    <a href="https://spacy.io/api/architectures#TransitionBasedParser">
     <span class="koboSpan" id="kobo.380.1">
      https://spacy.io/api/architectures#TransitionBasedParser
     </span>
    </a>
    <span class="koboSpan" id="kobo.381.1">
     ), the model consists of either two or three subnetworks.
    </span>
    <span class="koboSpan" id="kobo.381.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.382.1">
      tok2vec
     </span>
    </strong>
    <span class="koboSpan" id="kobo.383.1">
     component transforms each token into a vector, running once per batch.
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.384.1">
      Lower
     </span>
    </strong>
    <span class="koboSpan" id="kobo.385.1">
     generates a vector for each
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.386.1">
      (token, feature)
     </span>
    </strong>
    <span class="koboSpan" id="kobo.387.1">
     pair per batch, combining features and applying non-linearity to form the state representation.
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.388.1">
      Upper
     </span>
    </strong>
    <span class="koboSpan" id="kobo.389.1">
     is an optional feed-forward network that derives scores from the state representation.
    </span>
    <span class="koboSpan" id="kobo.389.2">
     If omitted, the lower model’s output is used directly as action scores.
    </span>
    <span class="koboSpan" id="kobo.389.3">
     In summary, the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.390.1">
      tok2vec
     </span>
    </strong>
    <span class="koboSpan" id="kobo.391.1">
     component is responsible for mapping the tokens into
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.392.1">
      vector representations.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-118">
    <a id="_idTextAnchor117">
    </a>
    <span class="koboSpan" id="kobo.393.1">
     Evaluating the accuracy of the NER component
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.394.1">
     We can use
    </span>
    <a id="_idIndexMarker419">
    </a>
    <span class="koboSpan" id="kobo.395.1">
     the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.396.1">
      spacy evaluate
     </span>
    </strong>
    <span class="koboSpan" id="kobo.397.1">
     CLI command to evaluate the accuracy of the pipeline.
    </span>
    <span class="koboSpan" id="kobo.397.2">
     The command expects a loadable spaCy pipeline and evaluation data in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.398.1">
      DocBin
     </span>
    </strong>
    <span class="koboSpan" id="kobo.399.1">
     format.
    </span>
    <span class="koboSpan" id="kobo.399.2">
     We don’t have a test dataset so we will use the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.400.1">
      fashion_brands_eval.spacy
     </span>
    </strong>
    <span class="koboSpan" id="kobo.401.1">
     dataset just to see how the command works.
    </span>
    <span class="koboSpan" id="kobo.401.2">
     The results are then
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.402.1">
      overestimated
     </span>
    </strong>
    <span class="koboSpan" id="kobo.403.1">
     because the dataset was also used to decide when to stop the model training.
    </span>
    <span class="koboSpan" id="kobo.403.2">
     This is
    </span>
    <a id="_idIndexMarker420">
    </a>
    <span class="koboSpan" id="kobo.404.1">
     called
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.405.1">
      data leakage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.406.1">
     .
    </span>
    <span class="koboSpan" id="kobo.406.2">
     However, here, we are
    </span>
    <a id="_idIndexMarker421">
    </a>
    <span class="koboSpan" id="kobo.407.1">
     training the model for learning purposes so we’re fine.
    </span>
    <span class="koboSpan" id="kobo.407.2">
     Let’s run the command and check
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.408.1">
      the results:
     </span>
    </span>
   </p>
   <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.409.1">python3 -m spacy evaluate training_cpu/model-best ./data/fashion_brands_eval.spacy --output training_cpu/metrics.json</span></strong></pre>
   <p>
    <span class="koboSpan" id="kobo.410.1">
     The command displays the output and saves the metrics to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.411.1">
      training_cpu/metrics.json
     </span>
    </strong>
    <span class="koboSpan" id="kobo.412.1">
     file.
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.413.1">
       Figure 8
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.414.1">
      .5
     </span>
    </em>
    <span class="koboSpan" id="kobo.415.1">
     shows
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.416.1">
      the results:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer091">
     <span class="koboSpan" id="kobo.417.1">
      <img alt="Figure 8.5 – Accuracy of the ner model" src="image/B22441_08_05.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.418.1">
     Figure 8.5 – Accuracy of the ner model
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.419.1">
     The precision score is
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.420.1">
      76.88
     </span>
    </strong>
    <span class="koboSpan" id="kobo.421.1">
     and the recall is
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.422.1">
      55.88
     </span>
    </strong>
    <span class="koboSpan" id="kobo.423.1">
     .
    </span>
    <span class="koboSpan" id="kobo.423.2">
     This is a model trained on the CPU; what if we train it with GPU and use transformers?
    </span>
    <span class="koboSpan" id="kobo.423.3">
     spaCy makes it simple to try this; we just need to create a new
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.424.1">
      config.cfg
     </span>
    </strong>
    <span class="koboSpan" id="kobo.425.1">
     file and run the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.426.1">
      spacy train
     </span>
    </strong>
    <span class="koboSpan" id="kobo.427.1">
     command again.
    </span>
    <span class="koboSpan" id="kobo.427.2">
     Let’s do that in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.428.1">
      next section.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-119">
    <a id="_idTextAnchor118">
    </a>
    <span class="koboSpan" id="kobo.429.1">
     Training an NER component optimized for accuracy
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.430.1">
     Training a component
    </span>
    <a id="_idIndexMarker422">
    </a>
    <span class="koboSpan" id="kobo.431.1">
     optimized for accuracy and that runs on a GPU requires that you install the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.432.1">
      spacy-transformers
     </span>
    </strong>
    <span class="koboSpan" id="kobo.433.1">
     library.
    </span>
    <span class="koboSpan" id="kobo.433.2">
     After that, we can create the new config file
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.434.1">
      like this:
     </span>
    </span>
   </p>
   <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.435.1">python3 -m spacy init config gpu_config.cfg -l "en" -p "ner" --optimize "accuracy" --gpu</span></strong></pre>
   <p>
    <span class="koboSpan" id="kobo.436.1">
     Then, we can train the model again, now pointing to this
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.437.1">
       gpu_config.cfg
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.438.1">
      file:
     </span>
    </span>
   </p>
   <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.439.1">python3 -m spacy train gpu_config.cfg --output training_gpu/ --paths.train ./data/fashion_brands_training.spacy --paths.dev ./data/fashion_brands_eval.spacy --gpu-id 0</span></strong></pre>
   <p>
    <span class="koboSpan" id="kobo.440.1">
     My machine has a GPU so I’m setting it using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.441.1">
      –gpu-id 1
     </span>
    </strong>
    <span class="koboSpan" id="kobo.442.1">
     parameter.
    </span>
    <span class="koboSpan" id="kobo.442.2">
     When we train for accuracy, usually, the model behaves better but we also end up with a potentially larger and slower model.
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.443.1">
       Figure 8
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.444.1">
      .6
     </span>
    </em>
    <span class="koboSpan" id="kobo.445.1">
     shows the messages produced
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.446.1">
      during training:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer092">
     <span class="koboSpan" id="kobo.447.1">
      <img alt="Figure 8.6 – Messages produced during the training of the ner component for accuracy" src="image/B22441_08_06.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.448.1">
     Figure 8.6 – Messages produced during the training of the ner component for accuracy
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.449.1">
     This architecture uses a transformer Model component instead of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.450.1">
      tok2vec
     </span>
    </strong>
    <span class="koboSpan" id="kobo.451.1">
     component.
    </span>
    <span class="koboSpan" id="kobo.451.2">
     We can see that the scores of this pipeline at each evaluation point are higher, always above
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.452.1">
      0.78
     </span>
    </strong>
    <span class="koboSpan" id="kobo.453.1">
     .
    </span>
    <span class="koboSpan" id="kobo.453.2">
     Let’s run the evaluation again to compare
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.454.1">
      the models:
     </span>
    </span>
   </p>
   <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.455.1">python3 -m spacy evaluate training_gpu/model-best ./data/fashion_brands_eval.spacy --output training_gpu/metrics.json --gpu-id 0</span></strong></pre>
   <p>
    <span class="koboSpan" id="kobo.456.1">
     The command
    </span>
    <a id="_idIndexMarker423">
    </a>
    <span class="koboSpan" id="kobo.457.1">
     displays the output and saves the metrics to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.458.1">
      training_gpu/metrics.json
     </span>
    </strong>
    <span class="koboSpan" id="kobo.459.1">
     file.
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.460.1">
       Figure 8
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.461.1">
      .7
     </span>
    </em>
    <span class="koboSpan" id="kobo.462.1">
     shows
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.463.1">
      the results:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer093">
     <span class="koboSpan" id="kobo.464.1">
      <img alt="Figure 8.7 – Accuracy of the ner model trained for accuracy" src="image/B22441_08_07.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.465.1">
     Figure 8.7 – Accuracy of the ner model trained for accuracy
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.466.1">
     The precision score is
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.467.1">
      88.79
     </span>
    </strong>
    <span class="koboSpan" id="kobo.468.1">
     and the recall is
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.469.1">
      79.83
     </span>
    </strong>
    <span class="koboSpan" id="kobo.470.1">
     .
    </span>
    <span class="koboSpan" id="kobo.470.2">
     This is a significant increase if we compare it with the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.471.1">
      76.88
     </span>
    </strong>
    <span class="koboSpan" id="kobo.472.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.473.1">
      55.88
     </span>
    </strong>
    <span class="koboSpan" id="kobo.474.1">
     results of the model trained for efficiency.
    </span>
    <span class="koboSpan" id="kobo.474.2">
     We can load the models for usage by passing the directories created during training to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.475.1">
      nlp.load()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.476.1">
     method.
    </span>
    <span class="koboSpan" id="kobo.476.2">
     Let’s get the entities of the sentence
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.477.1">
      Givenchy is looking at buying U.K.
     </span>
     <span class="koboSpan" id="kobo.477.2">
      startup for $
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.478.1">
       1 billion
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.479.1">
      :
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.480.1">
      First, we load the libraries and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.481.1">
       the pipeline:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.482.1">
import spacy
from spacy import displacy
nlp = spacy.load('training_gpu/model-best')</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.483.1">
      Now, we can apply the pipeline to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.484.1">
       the text:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.485.1">
sentence = "Givenchy is looking at buying U.K. </span><span class="koboSpan" id="kobo.485.2">startup for $1 billion"
doc = nlp(sentence)
displacy.render(doc, style="ent", jupyter=True)</span></pre>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.486.1">
       The result is displayed in
      </span>
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.487.1">
         Figure 8
        </span>
       </em>
      </span>
      <em class="italic">
       <span class="koboSpan" id="kobo.488.1">
        .8
       </span>
      </em>
      <span class="koboSpan" id="kobo.489.1">
       ; the pipeline was able to find the
      </span>
      <span class="No-Break">
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.490.1">
         Givenchy
        </span>
       </strong>
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.491.1">
        entity:
       </span>
      </span>
     </p>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer094">
     <span class="koboSpan" id="kobo.492.1">
      <img alt="Figure 8.8 – The entities extracted using the ner pipeline trained for accuracy" src="image/B22441_08_08.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.493.1">
     Figure 8.8 – The entities extracted using the ner pipeline trained for accuracy
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.494.1">
     The component can only identify
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.495.1">
      FASHION_BRAND
     </span>
    </strong>
    <span class="koboSpan" id="kobo.496.1">
     entities, which was the only entity we’ve trained it for.
    </span>
    <span class="koboSpan" id="kobo.496.2">
     But the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.497.1">
      en_core_web_sm
     </span>
    </strong>
    <span class="koboSpan" id="kobo.498.1">
     model made available by spaCy can identify more
    </span>
    <a id="_idIndexMarker424">
    </a>
    <span class="koboSpan" id="kobo.499.1">
     entities.
    </span>
    <span class="koboSpan" id="kobo.499.2">
     Let’s check
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.500.1">
      it out:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.501.1">
      Load the libraries and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.502.1">
       the model:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.503.1">
import spacy
from spacy import displacy
nlp = spacy.load('en_core_web_sm')</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.504.1">
      Apply the pipeline to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.505.1">
       the text:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.506.1">
sentence = "Givenchy is looking at buying U.K. </span><span class="koboSpan" id="kobo.506.2">startup for $1 billion"
doc = nlp(sentence)
displacy.render(doc, style="ent", jupyter=True)</span></pre>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.507.1">
       The result is displayed in
      </span>
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.508.1">
         Figure 8
        </span>
       </em>
      </span>
      <em class="italic">
       <span class="koboSpan" id="kobo.509.1">
        .9
       </span>
      </em>
      <span class="koboSpan" id="kobo.510.1">
       ; the pipeline was able to find the
      </span>
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.511.1">
        GPE
       </span>
      </strong>
      <span class="koboSpan" id="kobo.512.1">
       and
      </span>
      <span class="No-Break">
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.513.1">
         MONEY
        </span>
       </strong>
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.514.1">
        entities:
       </span>
      </span>
     </p>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer095">
     <span class="koboSpan" id="kobo.515.1">
      <img alt="Figure 8.9 – The entities extracted using the en_core_web_sm pipeline" src="image/B22441_08_09.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.516.1">
     Figure 8.9 – The entities extracted using the en_core_web_sm pipeline
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.517.1">
     What if we
    </span>
    <a id="_idIndexMarker425">
    </a>
    <span class="koboSpan" id="kobo.518.1">
     want to extract both the entities we’ve trained for and the entities the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.519.1">
      en_core_web_sm
     </span>
    </strong>
    <span class="koboSpan" id="kobo.520.1">
     NER component is trained for?
    </span>
    <span class="koboSpan" id="kobo.520.2">
     We can do that by combining multiple NER components in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.521.1">
      same pipeline.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-120">
    <a id="_idTextAnchor119">
    </a>
    <span class="koboSpan" id="kobo.522.1">
     Combining multiple NER components in the same pipeline
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.523.1">
     When
    </span>
    <a id="_idIndexMarker426">
    </a>
    <span class="koboSpan" id="kobo.524.1">
     spaCy loads a pipeline, it iterates over the pipeline names and looks up each component name in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.525.1">
      [components]
     </span>
    </strong>
    <span class="koboSpan" id="kobo.526.1">
     block.
    </span>
    <span class="koboSpan" id="kobo.526.2">
     The components can be built either using
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.527.1">
      factory
     </span>
    </strong>
    <span class="koboSpan" id="kobo.528.1">
     or
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.529.1">
      source
     </span>
    </strong>
    <span class="koboSpan" id="kobo.530.1">
     .
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.531.1">
      Factories
     </span>
    </strong>
    <span class="koboSpan" id="kobo.532.1">
     are named functions that take settings and return a pipeline component function, and the source is used to reference the name of the path of a trained pipeline to copy
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.533.1">
      components from.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.534.1">
     To use both the NER component we’ve trained and the NER component of
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.535.1">
      en_core_web_sm
     </span>
    </strong>
    <span class="koboSpan" id="kobo.536.1">
     , we will create a new
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.537.1">
      config.cfg
     </span>
    </strong>
    <span class="koboSpan" id="kobo.538.1">
     file and source the NER components in the pipeline.
    </span>
    <span class="koboSpan" id="kobo.538.2">
     With this
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.539.1">
      config.cfg
     </span>
    </strong>
    <span class="koboSpan" id="kobo.540.1">
     file set, we will then use the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.541.1">
      spacy assemble
     </span>
    </strong>
    <span class="koboSpan" id="kobo.542.1">
     command to assemble the config without additional training.
    </span>
    <span class="koboSpan" id="kobo.542.2">
     To be able to reference the trained NER component using
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.543.1">
      spacy assemble
     </span>
    </strong>
    <span class="koboSpan" id="kobo.544.1">
     , we will create a package for the pipeline and install it with
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.545.1">
       pip install
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.546.1">
      .
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-121">
    <a id="_idTextAnchor120">
    </a>
    <span class="koboSpan" id="kobo.547.1">
     Creating a package for the trained pipeline
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.548.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.549.1">
      spacy package
     </span>
    </strong>
    <span class="koboSpan" id="kobo.550.1">
     CLI
    </span>
    <a id="_idIndexMarker427">
    </a>
    <span class="koboSpan" id="kobo.551.1">
     command generates an installable Python package from an existing pipeline directory.
    </span>
    <span class="koboSpan" id="kobo.551.2">
     spaCy creates a build artifact that you can install with
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.552.1">
      pip install
     </span>
    </strong>
    <span class="koboSpan" id="kobo.553.1">
     .
    </span>
    <span class="koboSpan" id="kobo.553.2">
     This is useful if you want to deploy your pipeline in a production environment or share it
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.554.1">
      with others.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.555.1">
     We will provide the path to the directory containing pipeline data, the path to the directory in which to create the package folder, and the package name.
    </span>
    <span class="koboSpan" id="kobo.555.2">
     This is the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.556.1">
      full command:
     </span>
    </span>
   </p>
   <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.557.1">python3 -m spacy package training_gpu/model-best ./ --name "ner_fashion_brands"</span></strong></pre>
   <p>
    <span class="koboSpan" id="kobo.558.1">
     The command
    </span>
    <a id="_idIndexMarker428">
    </a>
    <span class="koboSpan" id="kobo.559.1">
     creates a folder named
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.560.1">
      en_ner_fashion_brands-0.0.0
     </span>
    </strong>
    <span class="koboSpan" id="kobo.561.1">
     .
    </span>
    <span class="koboSpan" id="kobo.561.2">
     We can now install this package and load it
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.562.1">
      in Python:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.563.1">
      Install
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.564.1">
       the package:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.565.1">python3 -m pip install en_ner_fashion_brands-0.0.0/</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.566.1">
      Import the package, load the pipeline, and apply it to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.567.1">
       the text:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.568.1">
import en_ner_fashion_brands
from spacy import displacy
nlp = en_ner_fashion_brands.load()
sentence = "Givenchy is looking at buying U.K. </span><span class="koboSpan" id="kobo.568.2">startup for $1 billion"
doc = nlp(sentence)
displacy.render(doc, style="ent", jupyter=True)</span></pre>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.569.1">
     It works just like loading the pipeline from its directory.
    </span>
    <span class="koboSpan" id="kobo.569.2">
     Now, we can point to the NER component of this pipeline in a new
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.570.1">
      config
     </span>
    </strong>
    <span class="koboSpan" id="kobo.571.1">
     file to create a pipeline that uses this NER component and the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.572.1">
      en_core_web_sm
     </span>
    </strong>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.573.1">
      NER component.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-122">
    <a id="_idTextAnchor121">
    </a>
    <span class="koboSpan" id="kobo.574.1">
     Creating a pipeline with different NER components
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.575.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.576.1">
      spacy assemble
     </span>
    </strong>
    <span class="koboSpan" id="kobo.577.1">
     CLI
    </span>
    <a id="_idIndexMarker429">
    </a>
    <span class="koboSpan" id="kobo.578.1">
     command assembles a pipeline from a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.579.1">
      config
     </span>
    </strong>
    <span class="koboSpan" id="kobo.580.1">
     file without additional training.
    </span>
    <span class="koboSpan" id="kobo.580.2">
     Simple as that.
    </span>
    <span class="koboSpan" id="kobo.580.3">
     This
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.581.1">
      config
     </span>
    </strong>
    <span class="koboSpan" id="kobo.582.1">
     file is simpler since it’s used only to build the pipeline and not to train it.
    </span>
    <span class="koboSpan" id="kobo.582.2">
     Let’s create the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.583.1">
       combined_ner.cfg
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.584.1">
      file:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.585.1">
      First, we define the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.586.1">
       nlp
      </span>
     </strong>
     <span class="koboSpan" id="kobo.587.1">
      object.
     </span>
     <span class="koboSpan" id="kobo.587.2">
      We will specify the pipeline language ISO code and the pipeline components’ names in order.
     </span>
     <span class="koboSpan" id="kobo.587.3">
      We will specify how to load them in the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.588.1">
       [components]
      </span>
     </strong>
     <span class="koboSpan" id="kobo.589.1">
      section, so we can name them as
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.590.1">
       we want:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.591.1">
[nlp]
lang = "en"
pipeline = ["ner_fashion_brands","ner"]</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.592.1">
      Since we want to copy the components from existing pipelines, we will set the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.593.1">
       source
      </span>
     </strong>
     <span class="koboSpan" id="kobo.594.1">
      argument of each component.
     </span>
     <span class="koboSpan" id="kobo.594.2">
      The argument values can be a loadable spaCy pipeline package or a path.
     </span>
     <span class="koboSpan" id="kobo.594.3">
      After defining, we set the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.595.1">
       component
      </span>
     </strong>
     <span class="koboSpan" id="kobo.596.1">
      argument, which is the name of the component in the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.597.1">
       source
      </span>
     </strong>
     <span class="koboSpan" id="kobo.598.1">
      pipeline.
     </span>
     <span class="koboSpan" id="kobo.598.2">
      Let’s first define how to
     </span>
     <a id="_idIndexMarker430">
     </a>
     <span class="koboSpan" id="kobo.599.1">
      load the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.600.1">
       ner
      </span>
     </strong>
     <span class="koboSpan" id="kobo.601.1">
      component of the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.602.1">
        en_core_web_sm
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.603.1">
       pipeline:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.604.1">
[components]
[components.ner]
source = "en_core_web_sm"
component = "ner"</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.605.1">
      Now, to load the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.606.1">
       ner
      </span>
     </strong>
     <span class="koboSpan" id="kobo.607.1">
      component we’ve trained to identify the fashion brands, we also need to include a copy of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.608.1">
       tok2vec
      </span>
     </strong>
     <span class="koboSpan" id="kobo.609.1">
      listener of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.610.1">
       source
      </span>
     </strong>
     <span class="koboSpan" id="kobo.611.1">
      pipeline using the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.612.1">
       replace_listeners
      </span>
     </strong>
     <span class="koboSpan" id="kobo.613.1">
      argument,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.614.1">
       like this:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.615.1">
[components.ner_fashion_brands]
source = "en_ner_fashion_brands"
component = "ner"
replace_listeners = ["model.tok2vec"]</span></pre>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.616.1">
     Now, we have a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.617.1">
      config
     </span>
    </strong>
    <span class="koboSpan" id="kobo.618.1">
     file to assemble our final pipeline.
    </span>
    <span class="koboSpan" id="kobo.618.2">
     We’ll do
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.619.1">
      that next.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.620.1">
     Assembling the pipeline from a config file
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.621.1">
     To assemble the
    </span>
    <a id="_idIndexMarker431">
    </a>
    <span class="koboSpan" id="kobo.622.1">
     pipeline, we will provide the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.623.1">
      combined_ner.cfg
     </span>
    </strong>
    <span class="koboSpan" id="kobo.624.1">
     file we have created and the output directory to store the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.625.1">
      final pipeline:
     </span>
    </span>
   </p>
   <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.626.1">python3 -m spacy assemble combined_ner.cfg pipelines/fashion_ner_with_base_entities</span></strong></pre>
   <p>
    <span class="koboSpan" id="kobo.627.1">
     If everything worked correctly, we could now load this pipeline and it will identify all the entities of both
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.628.1">
      ner
     </span>
    </strong>
    <span class="koboSpan" id="kobo.629.1">
     components.
    </span>
    <span class="koboSpan" id="kobo.629.2">
     Let’s see whether that is
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.630.1">
      the case:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.631.1">
      Let’s first load the pipeline
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.632.1">
       we’ve assembled:
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.633.1">
import spacy
from spacy import displacy
nlp = spacy.load("pipelines/fashion_ner_with_base_entities")</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.634.1">
      Now, let’s process the text and show the entities
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.635.1">
       with
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.636.1">
        displacy
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.637.1">
       :
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.638.1">
sentence = "Givenchy is looking at buying U.K. </span><span class="koboSpan" id="kobo.638.2">startup for $1 billion"
doc = nlp(sentence)
displacy.render(doc, style="ent", jupyter=True)</span></pre>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.639.1">
       We can see the results in
      </span>
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.640.1">
         Figure 8
        </span>
       </em>
      </span>
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.641.1">
         .10
        </span>
       </em>
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.642.1">
        :
       </span>
      </span>
     </p>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer096">
     <span class="koboSpan" id="kobo.643.1">
      <img alt="Figure 8.10 – Entities identified with the assembled pipeline #TODO: take new screenshot" src="image/B22441_08_10.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.644.1">
     Figure 8.10 – Entities identified with the assembled pipeline #TODO: take new screenshot
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.645.1">
     Neat, right?
    </span>
    <span class="koboSpan" id="kobo.645.2">
     We could combine as many
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.646.1">
      ner
     </span>
    </strong>
    <span class="koboSpan" id="kobo.647.1">
     components as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.648.1">
      we need.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-123">
    <a id="_idTextAnchor122">
    </a>
    <span class="koboSpan" id="kobo.649.1">
     Summary
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.650.1">
     In this chapter, we explored how to train spaCy NER components with our own domain and data.
    </span>
    <span class="koboSpan" id="kobo.650.2">
     First, we learned the key points of deciding whether we really need custom model training.
    </span>
    <span class="koboSpan" id="kobo.650.3">
     Then, we went through an essential part of model training – data collection
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.651.1">
      and labeling.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.652.1">
     We learned about two annotation tools – Prodigy and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.653.1">
      nertk
     </span>
    </strong>
    <span class="koboSpan" id="kobo.654.1">
     – and learned how to convert the data for training and how to train the component using spaCy’s CLI.
    </span>
    <span class="koboSpan" id="kobo.654.2">
     Then, we used spaCy CLI commands to train the component and create a Python package for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.655.1">
      the pipeline.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.656.1">
     Finally, we learned how to combine different NER components into a single pipeline.
    </span>
    <span class="koboSpan" id="kobo.656.2">
     In the next chapter, we will learn how to manage and share end-to-end workflows for different use cases and domains using spaCy
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.657.1">
      and Weasel.
     </span>
    </span>
   </p>
  </div>
 </body></html>