<html><head></head><body>
  <div><h1 class="chapterNumber"><a id="_idTextAnchor261"/>9</h1>
    <h1 class="chapterTitle" id="_idParaDest-252"><a id="_idTextAnchor262"/>Upgrading the GenAISys with Data Security and Moderation for Customer Service</h1>
    <p class="normal">In this chapter, we will open up our GenAISys by integrating it with real-world online services—specifically, by connecting it to an online weather API. This will enable the fictional online travel agency that we’ve been supporting throughout the book to access real-time weather data. Weather reports for a specific location serve as an entry point for various tasks essential to the agency’s operations, such as marketing initiatives, recommendations for tourist activities, and coordinating product deliveries.</p>
    <p class="normal">Connecting our GenAISys to external online resources transitions our system from a controlled internal environment to the unpredictable realm of real-time data interactions. This transition, however, introduces critical security concerns. Opening a system without adequate protections can inadvertently expose sensitive data or cause security breaches, posing genuine risks both to users and the organization itself. As such, robust security measures are a prerequisite before fully integrating external services. Therefore, this chapter presents a threefold challenge: implementing the weather service using the OpenWeather API, building a moderation system leveraging OpenAI’s moderation capabilities, and developing a RAG-based data security function with Pinecone, which will detect and prevent sensitive-topic breaches. We will rely heavily on the flexible and powerful handler selection mechanism of our existing GenAISys architecture to seamlessly integrate these new functionalities. Our objective remains clear—minimal code enhancements with maximum functional impact.</p>
    <p class="normal">The chapter begins by detailing how these additional components—moderation, data security, and real-time weather—fit into the overall architecture of the GenAISys. Then, we’ll dive under the surface to build the moderation function using OpenAI’s moderation endpoint. We will then construct a RAG-powered data security module, using Pinecone, to proactively detect and filter out sensitive or inappropriate inputs. By integrating these two security layers directly into the GenAISys’s handler selection mechanism, we ensure comprehensive protection against unwanted interactions.</p>
    <p class="normal">With security firmly in place, we will then implement the OpenWeather API. This integration allows us to retrieve live, real-time weather information to power a range of engaging, user-centric tasks. Finally, we will demonstrate the capabilities of the enhanced GenAISys through practical, multimodal, multi-user scenarios—such as generating weather-based activity recommendations, crafting customized promotional images for travel merchandise, and dynamically creating personalized weather-aware messages for travelers. By the end of this chapter, you’ll be fully equipped to adapt the core architecture and concepts we’ve explored in the GenAISys to real-world<a id="_idIndexMarker602"/> applications, confidently delivering a comprehensive, secure, and highly functional <strong class="keyWord">proof of concept</strong>.</p>
    <p class="normal">This chapter covers the following topics:</p>
    <ul>
      <li class="bulletList">Enhancing the GenAISys</li>
      <li class="bulletList">Adding a security function to the handler selection mechanism</li>
      <li class="bulletList">Building the weather forecast component</li>
      <li class="bulletList">Running use cases in the GenAISys</li>
    </ul>
    <p class="normal">Let’s start by clearly mapping out how the new moderation, data security, and weather functions integrate into our GenAISys.</p>
    <h1 class="heading-1" id="_idParaDest-253"><a id="_idTextAnchor263"/>Enhancing the GenAISys</h1>
    <p class="normal">Integrating moderation, data security, and real-time weather functionalities into our GenAISys will affect all three <a id="_idIndexMarker603"/>architectural layers, as illustrated in <em class="italic">Figure 9.1</em>. We will rely on the framework built around our handler selection mechanism to make this three-level, three-function implementation seamless.</p>
    <figure class="mediaobject"><img alt="Figure 9.1: Moderation, data security, and weather report integration" src="img/B32304_09_1.png"/></figure>
    <p class="packt_figref">Figure 9.1: Moderation, data security, and weather report integration</p>
    <p class="normal">The implementation will impact all three layers as follows:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Layer 1 (IPython interface)</strong>: We’ll introduce a new <strong class="screenText">Weather</strong> option within the <strong class="screenText">Reasoning</strong> drop-down menu of the IPython interface. Why place it here? Because in real-world project settings, the weather report function could easily be expanded into a more complex, multi-step <strong class="keyWord">chain-of-thought</strong> (<strong class="keyWord">CoT</strong>) pipeline, enabling the generation of sophisticated, context-aware outputs <a id="_idIndexMarker604"/>based on weather conditions.</li>
      <li class="bulletList"><strong class="keyWord">Layer 2 (AI agent)</strong>: The central orchestrator of our GenAISys, the handler selection mechanism, will now manage an additional component—the real-time weather forecasting capability. More critically, we’ll enhance the handler with an integrated moderation and data security mechanism that will function as an immediate <em class="italic">kill switch</em>, instantly terminating the process and returning a security warning to the user when inappropriate <a id="_idIndexMarker605"/>or sensitive content is detected.</li>
      <li class="bulletList"><strong class="keyWord">Layer 3 (functions and agents)</strong>: Three new key functions—moderation, data security, and weather forecast retrieval—will be implemented at this level. The moderation and data security checks will reside outside the handler registry since their roles are not optional. As depicted in <em class="italic">Figure 9.2</em>, these two functions will form a mandatory global security barrier directly controlled by the handler selection mechanism, protecting users and company data before initiating any further tasks.</li>
    </ul>
    <figure class="mediaobject"><img alt="Figure 9.2: Security and moderation checks are directly managed within the handler selection mechanism" src="img/B32304_09_2.png"/></figure>
    <p class="packt_figref">Figure 9.2: Security and moderation checks are directly managed within the handler selection mechanism</p>
    <p class="normal">This security system will proactively intercept and evaluate each user input, blocking further processing and immediately alerting the user via the IPython interface if inappropriate or sensitive content is detected.</p>
    <p class="normal">While building and showcasing your GenAISys as a flexible proof of concept, remember to demonstrate its scalability clearly. Highlight its potential for integration with additional AI functions, further security features, or alternative generative models. However, exercise caution: avoid prematurely adding functionalities without concrete project requirements, as this can lead to unnecessary complexity or overdeveloping your project. The goal is to clearly show the project’s potential without investing resources in unrequested developments.</p>
    <p class="normal">With this strategic clarity in mind, we will begin by constructing the security function.</p>
    <h1 class="heading-1" id="_idParaDest-254"><a id="_idTextAnchor264"/>Adding a security function to the handler selection mechanism</h1>
    <p class="normal">In this<a id="_idIndexMarker606"/> section, we will <a id="_idIndexMarker607"/>build the <strong class="keyWord">security function</strong>, the <strong class="keyWord">moderation function</strong>, and <a id="_idIndexMarker608"/>the <strong class="keyWord">data security function</strong>, as illustrated<a id="_idIndexMarker609"/> in <em class="italic">Figure 9.3</em>:</p>
    <figure class="mediaobject"><img alt="Figure 9.3: The handler selection mechanism directly calls the security function" src="img/B32304_09_3.png"/></figure>
    <p class="packt_figref">Figure 9.3: The handler selection mechanism directly calls the security function</p>
    <p class="normal">We’ll implement these functions as follows:</p>
    <ul>
      <li class="bulletList">The security function will call the moderation function</li>
      <li class="bulletList">The security function will also call the data security function</li>
      <li class="bulletList">The moderation function will contain subfunctions</li>
      <li class="bulletList">The data security function will ensure compliance with security standards</li>
    </ul>
    <p class="normal">Let’s first build the security function along with its calls.</p>
    <h2 class="heading-2" id="_idParaDest-255"><a id="_idTextAnchor265"/>Implementing the security function</h2>
    <p class="normal">The security function is directly <a id="_idIndexMarker610"/>integrated with the handler selection mechanism, as illustrated in <em class="italic">Figure 9.4</em>. It receives the user message directly, prior to any handler selection in the handler registry. If the user message violates the GenAISys content policy, the security function returns a <code class="inlineCode">False</code> flag (indicating a content violation) to the IPython interface.</p>
    <figure class="mediaobject"><img alt="Figure 9.4: The security function is directly connected to the handler selection mechanism" src="img/B32304_09_4.png"/></figure>
    <p class="packt_figref">Figure 9.4: The security function is directly connected to the handler selection mechanism</p>
    <p class="normal">Open <code class="inlineCode">GenAISys_Customer_Service.ipynb</code> and go to the <em class="italic">Security</em> section within the Chapter09 directory on GitHub (<a href="https://github.com/Denis2054/Building-Business-Ready-Generative-AI-Systems/tree/main">https://github.com/Denis2054/Building-Business-Ready-Generative-AI-Systems/tree/main</a>). We first create the function that sets the <code class="inlineCode">securitym</code> flag to <code class="inlineCode">True</code>, signifying the content does not violate content policies. Also in this function, <code class="inlineCode">securityd=True</code> shows that no sensitive topic has been detected and that the message is <a id="_idIndexMarker611"/>data security-compliant:</p>
    <pre class="programlisting code"><code class="hljs-code">def security(user_message):
  securitym=True # default value
  securityd=True # default value
</code></pre>
    <div><p class="normal"><img alt="" src="img/3-PPMUMLAP0325.png"/><strong class="keyWord">Quick tip</strong>: Enhance your coding experience with the <strong class="keyWord">AI Code Explainer</strong> and <strong class="keyWord">Quick Copy</strong> features. Open this book in the next-gen Packt Reader. Click the <strong class="keyWord">Copy</strong> button</p>
      <p class="normal">(<strong class="keyWord">1</strong>) to quickly copy code into your coding environment, or click the <strong class="keyWord">Explain</strong> button</p>
      <p class="normal">(<strong class="keyWord">2</strong>) to get the AI assistant to explain a block of code to you.</p>
      <p class="normal"><img alt="A white background with a black text  AI-generated content may be incorrect." src="img/image_%282%29.png"/></p>
      <p class="normal"><img alt="" src="img/4.png"/><strong class="keyWord">The next-gen Packt Reader </strong>is included for free with the purchase of this book. Scan the QR code OR visit <a href="http://packtpub.com/unlock">packtpub.com/unlock</a>, then use the search bar to find this book by name. Double-check the edition shown to make sure you get the right one.</p>
      <p class="normal"><img alt="A qr code on a white background  AI-generated content may be incorrect." src="img/Unlock_Code1.png"/></p>
    </div>
    <p class="normal">The function begins by calling the moderation and content acceptability functions:</p>
    <pre class="programlisting code"><code class="hljs-code">  response=moderation(user_message)
  # Moderation
  security = is_acceptable(user_message,response)
  #print(security)  # Outputs: True if acceptable, False otherwise
</code></pre>
    <ul>
      <li class="bulletList"><code class="inlineCode">moderation(user_message)</code> invokes the OpenAI moderation API</li>
      <li class="bulletList"><code class="inlineCode">is_acceptable(user_message, response)</code> processes the moderation response</li>
      <li class="bulletList">The debugging line (<code class="inlineCode">print(securitym)</code>) can be uncommented during testing or troubleshooting</li>
    </ul>
    <p class="normal">Next, the security function calls the data security function, which checks for sensitive topics within the user message:</p>
    <pre class="programlisting code"><code class="hljs-code"> # Data security
  securityd = data_security(user_message)
  #print securityd
</code></pre>
    <p class="normal">The <code class="inlineCode">securityd</code> variable will store either <code class="inlineCode">True</code> or <code class="inlineCode">False</code>, depending on whether the message meets the data security criteria.</p>
    <p class="normal">The final part of the function evaluates both flags (<code class="inlineCode">securitym</code> and <code class="inlineCode">securityd</code>) and returns the security status accordingly:</p>
    <pre class="programlisting code"><code class="hljs-code">  if securitym==False or securityd==False:
    return False
  else:
    return True
</code></pre>
    <div><p class="normal"> If you prefer not to activate the moderation or data security checks, you can comment out the relevant lines in the security function—specifically, the code between the assignments of <code class="inlineCode">securitym=True</code> and <code class="inlineCode">securityd=True</code>, and the <code class="inlineCode">if securitym==False</code> or <code class="inlineCode">securityd==False</code> conditional statement. This way, the function defaults to always returning <code class="inlineCode">True</code>.</p>
    </div>
    <p class="normal">Let’s now examine how the handler selection mechanism interacts with the IPython interface.</p>
    <h2 class="heading-2" id="_idParaDest-256"><a id="_idTextAnchor266"/>Handler selection mechanism interactions</h2>
    <p class="normal">The handler selection mechanism <a id="_idIndexMarker612"/>and IPython interface interact closely, as shown in <em class="italic">Figure 9.5</em>. When the IPython interface sends a user message to the handler selection mechanism, it determines whether the message complies with security policies.</p>
    <figure class="mediaobject"><img alt="Figure 9.5: Handler selection mechanism and IPython interactions" src="img/B32304_09_5.png"/></figure>
    <p class="packt_figref">Figure 9.5: Handler selection mechanism and IPython interactions</p>
    <p class="normal">The primary structure of the handler selection mechanism function remains unchanged from previous chapters:</p>
    <pre class="programlisting code"><code class="hljs-code">def chat_with_gpt(
    messages, user_message, files_status, active_instruct, models
):
    global memory_enabled  # Ensure memory is used if set globally
</code></pre>
    <p class="normal">However, at the start of this function, we now call the security function. It returns a security status (<code class="inlineCode">True</code> for compliant or <code class="inlineCode">False</code> for non-compliant):</p>
    <pre class="programlisting code"><code class="hljs-code">    try:
        if not security(user_message):
            return "Your message could not be processed as it may violate our security guidelines."d
</code></pre>
    <p class="normal">If the message is flagged as non-compliant, a clear message will be immediately returned to the user interface. We will test <a id="_idIndexMarker613"/>security function examples thoroughly in the <em class="italic">Running security checks</em> section later. Before that, let’s move forward by implementing the moderation function.</p>
    <h2 class="heading-2" id="_idParaDest-257"><a id="_idTextAnchor267"/>Implementing the moderation function</h2>
    <p class="normal">We will use OpenAI Omni, which has a<a id="_idIndexMarker614"/> comprehensive<a id="_idIndexMarker615"/> range of categorization options, as the moderation model: <a href="https://platform.openai.com/docs/guides/moderation">https://platform.openai.com/docs/guides/moderation</a>.</p>
    <p class="normal">Open the <code class="inlineCode">GenAISys_Customer_Service.ipynb</code> notebook and navigate to the <em class="italic">Moderation</em> subsection within the <em class="italic">Security</em> section. The moderation function will be directly invoked by the handler selection mechanism, as illustrated in <em class="italic">Figure 9.6</em>. It classifies user messages and provides details about any inappropriate content flagged during processing.</p>
    <figure class="mediaobject"><img alt="Figure 9.6: Calling the moderation function" src="img/B32304_09_6.png"/></figure>
    <p class="packt_figref">Figure 9.6: Calling the moderation function</p>
    <p class="normal">We will implement the moderation function with OpenAI Omni as follows:</p>
    <pre class="programlisting code"><code class="hljs-code">from openai import OpenAI
client = OpenAI()
def moderation(user_message):
  response = client.moderations.create(
      model="omni-moderation-latest",
      input=user_message,
  )
  return response
</code></pre>
    <p class="normal">This function processes the <a id="_idIndexMarker616"/>user message and returns a moderation response. Once received by the security function, the response is sent to another function, <code class="inlineCode">is_acceptable</code>, to evaluate whether the message is acceptable or not:</p>
    <pre class="programlisting code"><code class="hljs-code">def is_acceptable(user_message, response):
    # Extract the 'flagged' status from the first result
    flagged = response.results[0].flagged
</code></pre>
    <p class="normal">The response contains <code class="inlineCode">response.results[0].flagged</code>, which provides a <code class="inlineCode">True</code> value if the content is flagged or a <code class="inlineCode">False</code> status if the response is acceptable. If the content is flagged, the details of the response will be saved in a timestamped JSON file:</p>
    <pre class="programlisting code"><code class="hljs-code">    if flagged:
        # Generate filename based on current date and time
        timestamp = datetime.datetime.now().strftime("%Y%m%d%H%M%S")
        sanitized_message = ''.join(
            e for e in user_message if e.isalnum() 
            or e in (' ', '_')
        ).strip()
        filename = \
            f"{sanitized_message[:50].replace(' ', '_')}_{timestamp}.json"
       
        # Ensure the 'logs' directory exists
        os.makedirs('logs', exist_ok=True)
        # Convert the response to a dictionary
        response_dict = response.model_dump()
       
        # Write the response to a JSON file in the 'logs' directory
        with open(os.path.join('logs', filename), 'w') as file:
            json.dump(response_dict, file, indent=4)
   
</code></pre>
    <p class="normal">Finally, the function<a id="_idIndexMarker617"/> returns the flagged status as <code class="inlineCode">not_flagged</code>:</p>
    <pre class="programlisting code"><code class="hljs-code">    # Return True if content is acceptable, False otherwise
    return <strong class="hljs-slc">not_flagged</strong>
</code></pre>
    <p class="normal">If the message is flagged, details are saved in a timestamped JSON file located within the <code class="inlineCode">/logs</code> subdirectory. The resulting JSON file contains a unique ID, the model used, and the status of a wide range of categories:</p>
    <pre class="programlisting code"><code class="hljs-code">{
    "id": "modr-bb021ae067c296c1985fca7ccfd9ccf9",
    "model": "omni-moderation-latest",
    "results": [
        {
            "categories": {
                "harassment": true,
                "harassment_threatening": false,
                "hate": false,
                "hate_threatening": false,
                "illicit": false,
                "illicit_violent": false,
                "self_harm": false,
                "self_harm_instructions": false,
                "self_harm_intent": false,
                "sexual": false,
                "sexual_minors": false,
                "violence": false,
                "violence_graphic": false,
                "harassment/threatening": false,
                "hate/threatening": false,
                "illicit/violent": false,
                "self-harm/intent": false,
                "self-harm/instructions": false,
                "self-harm": false,
                "sexual/minors": false,
                "violence/graphic": false
            },
            "category_applied_input_types": {
                "harassment": [
                    "text"
                ],
                "harassment_threatening": [
                    "text"
                ],…
</code></pre>
    <p class="normal">In this case, the <code class="inlineCode">harassment</code> category has been flagged, for example. The file also contains a score for each category, as <a id="_idIndexMarker618"/>shown in this excerpt from the file:</p>
    <pre class="programlisting code"><code class="hljs-code">               
            "category_scores": {
                <strong class="hljs-string-slc">"harassment"</strong><strong class="hljs-slc">: </strong><strong class="hljs-number-slc">0.8075929522141405</strong>,
                …
            },
            "flagged": true
           …
</code></pre>
    <p class="normal">To perform a quick quality control check or evaluate specific user messages manually, uncomment and use the following lines in your notebook:</p>
    <pre class="programlisting code"><code class="hljs-code"># Uncomment to use as security user message evaluation
user_message="Your ideas are always foolish and contribute nothing to our discussions."
security(user_message)
</code></pre>
    <p class="normal">The file containing the information can be processed further with other functions as required for your project. We could add<a id="_idIndexMarker619"/> the user to the file. We can also view the details of the dialogue to find which user entered the flagged message in the <em class="italic">Load and display the conversation history</em> section of the notebook. We will go through these features in the <em class="italic">Running security checks</em> section later.</p>
    <p class="normal">Let’s now build the data security function.</p>
    <h2 class="heading-2" id="_idParaDest-258"><a id="_idTextAnchor268"/>Building the data security function</h2>
    <p class="normal">We will now build a data security function designed to detect whether a user message contains sensitive topics. This function <a id="_idIndexMarker620"/>covers a wide spectrum of security-related concerns, from safeguarding confidential information to preventing inappropriate or sensitive discussions through the GenAISys interface. The data security function <a id="_idIndexMarker621"/>comprises two components, as shown in <em class="italic">Figure 9.7</em>: the first component populates a Pinecone index with sensitive topics, and the second component queries this index to detect sensitive topics within user messages.</p>
    <figure class="mediaobject"><img alt="Figure 9.7: The two components of the data security function" src="img/B32304_09_7.png"/></figure>
    <p class="packt_figref">Figure 9.7: The two components of the data security function</p>
    <h3 class="heading-3" id="_idParaDest-259"><a id="_idTextAnchor269"/>Populating the Pinecone index</h3>
    <p class="normal">We will first populate the Pinecone index with sensitive topics. Open <code class="inlineCode">Pinecone_Security.ipynb</code>. This notebook mirrors the structure of the earlier notebook from <a href="Chapter_3.xhtml#_idTextAnchor085"><em class="italic">Chapter 3</em></a><em class="italic"> </em>(<code class="inlineCode">Chapter03/Pinecone_instruction_scenarios.ipynb</code>). We will simply adapt it here to accommodate sensitive topics. Feel free to revisit <code class="inlineCode">Pinecone_instruction_scenarios.ipynb</code> for a detailed refresher if needed.</p>
    <p class="normal">We’ll briefly cover the code <a id="_idIndexMarker622"/>sections specifically adapted for this domain. The first step involves downloading our <code class="inlineCode">sensitive_topics</code> dataset:</p>
    <pre class="programlisting code"><code class="hljs-code">download("Chapter09","sensitive_topics.csv")
</code></pre>
    <p class="normal">The file, <code class="inlineCode">sensitive_topics.csv</code>, contains 100 sensitive topics structured as follows:</p>
    <ul>
      <li class="bulletList"><code class="inlineCode">id</code>: A unique identifier ranging from <code class="inlineCode">1000</code> to <code class="inlineCode">1099</code></li>
      <li class="bulletList"><code class="inlineCode">values</code>: Text descriptions of sensitive topics</li>
    </ul>
    <p class="normal">For example, the first topic is as follows:</p>
    <pre class="programlisting code"><code class="hljs-code">Discussing the mismanagement of client funds that has resulted in significant financial discrepancies which have raised concerns among regulatory bodies and could lead to potential legal actions being taken against the travel agency if corrective measures are not implemented promptly and with strict accountability this issue demands immediate thorough review.
</code></pre>
    <p class="normal">If a user message contains content similar to this topic, for example, it will be flagged. Vector-based similarity searches provide more nuanced detection than traditional methods.</p>
    <p class="normal">The next step is to chunk the data from the <code class="inlineCode">sensitive_topics.csv</code> file:</p>
    <pre class="programlisting code"><code class="hljs-code">import time
start_time = time.time()  # Start timing
# File path
file_path = 'sensitive_topics.csv'
# Read the file, skip the header, and clean the lines
chunks = []
…
</code></pre>
    <p class="normal">We then create a namespace within Pinecone to hold this sensitive data. We will call this namespace <code class="inlineCode">security</code>:</p>
    <pre class="programlisting code"><code class="hljs-code">from pinecone import ServerlessSpec
index_name = 'genai-v1'
namespace="security"
cloud = os.environ.get('PINECONE_CLOUD') or 'aws'
region = os.environ.get('PINECONE_REGION') or 'us-east-1'
spec = ServerlessSpec(cloud=cloud, region=region)
</code></pre>
    <p class="normal">The upserting function remains unchanged, retaining the same column names as in the <code class="inlineCode">.csv</code> file:</p>
    <pre class="programlisting code"><code class="hljs-code">def upsert_to_pinecone(batch, batch_size, namespace="security"):
    …
</code></pre>
    <p class="normal">With the data now <a id="_idIndexMarker623"/>populated in Pinecone, we’ll proceed to implement the query component.</p>
    <h3 class="heading-3" id="_idParaDest-260"><a id="_idTextAnchor270"/>Querying the Pinecone index</h3>
    <p class="normal">Open <code class="inlineCode">GenAISys_Customer_Service.ipynb</code> and navigate to the <em class="italic">Data security</em> subsection in the <em class="italic">Security</em> section. The goal here is to determine whether a user message matches any sensitive topics stored in the Pinecone<a id="_idIndexMarker624"/> security index. If a match is found, the message will be flagged.</p>
    <p class="normal">Initially, we set default security indicators:</p>
    <pre class="programlisting code"><code class="hljs-code"># Define data security function
import datetime
def data_security(user_message):
    sec = True # Initialize to True (safe by default)
    target_id = 0
    score = None     # Initialize score
    security_level = 0.30 # Set your desired security threshold here (as a float, e.g., 0.0 to 1.0)
</code></pre>
    <p class="normal">The default value, <code class="inlineCode">sec</code>, is set to <code class="inlineCode">True</code>, meaning that the user message is secure until found otherwise. Additionally, <code class="inlineCode">target_id</code> is set to <code class="inlineCode">0</code> to show that no record in the Pinecone index has been found yet. Additionally, we have a security level threshold, <code class="inlineCode">security_level</code>, that can be set to the value deemed necessary in production. You can modify it here in the code or create a security interface once your strategy has been decided with your team. In this case, <code class="inlineCode">security_level</code> is set to <code class="inlineCode">0.30</code> to avoid filtering low-level security items in this educational example.</p>
    <p class="normal">We then define our namespace for querying:</p>
    <pre class="programlisting code"><code class="hljs-code">    namespace = <strong class="hljs-string-slc">"security"</strong>
    print(namespace)
</code></pre>
    <p class="normal">We then query the Pinecone index to detect sensitive topics:</p>
    <pre class="programlisting code"><code class="hljs-code">    query_text = user_message
    query_results = get_query_results(query_text, namespace)
</code></pre>
    <p class="normal">We now extract the score, which we will use as our security level threshold:</p>
    <pre class="programlisting code"><code class="hljs-code"># Extract score directly from query_results BEFORE calling display_results
    if (
        query_results
        and "matches" in query_results
        and query_results["matches"]
    ):
        score = query_results['matches'][0]['score']
        print(f"Extracted Score: {score}") # Optional: print to verify
</code></pre>
    <p class="normal">Now, we can display<a id="_idIndexMarker625"/> the results:</p>
    <pre class="programlisting code"><code class="hljs-code">    print("Processed query results:")
    qtext, target_id = display_results(query_results)
    print(qtext)
</code></pre>
    <p class="normal">If a similar sensitive topic is found (indicated by a score that exceeds the threshold), we have a security logic process:</p>
    <pre class="programlisting code"><code class="hljs-code"># --- LOGIC FOR SECURITY CHECK ---
    # Determine 'sec' based on score first, if a score is available.
    if score is not None:
        if score &gt; security_level:
            sec = False # Breach detected: Score is above threshold
            print(f"Security flag triggered: Score ({score}) exceeds threshold ({security_level}).")
        else:
            sec = True # No breach: Score is below or equal to threshold
            print(f"Score ({score}) is below or equal to threshold ({security_level}). Not a score-based breach.")
    else:
        # If no score is available (e.g., no match found), then use target_id as a fallback.
        if target_id is not None and int(target_id) &gt; 0:
            sec = False # Breach detected: Target ID is positive (fallback)
            print(f"Security flag triggered: Target ID ({target_id}) is greater than 0 (fallback check).")
        else:
            sec = True # No breach detected by target_id fallback
    # --- END SECURITY CHECK  LOGIC -
</code></pre>
    <p class="normal">The query results are tracked and the details are recorded:</p>
    <pre class="programlisting code"><code class="hljs-code"> # Create a filename with the prefix "security_breach" and current datetime (format: YYYYMMDD_HHMMSS)
    if not sec: # Only log if a security breach is detected
        now = datetime.datetime.now().strftime("%Y%m%d_%H%M%S")
        filename = f"security_breach_{now}.txt"
        # Include score and threshold in the log for context
        log_content = f"Security Breach Detected!\nUser Message: {user_message}\nMatched Text: {qtext}\nTarget ID: {target_id}\nScore: {score}\nThreshold: {security_level}"
        with open(filename, "w") as file:
            file.write(log_content)
        print(f"Security breach logged to {filename}")
    else:
        print("No security breach detected.")
</code></pre>
    <p class="normal">The result, <code class="inlineCode">True</code> (non-sensitive) or <code class="inlineCode">False</code> (sensitive), is returned to the security function:</p>
    <pre class="programlisting code"><code class="hljs-code">return sec
</code></pre>
    <p class="normal">To manually evaluate messages, you <a id="_idIndexMarker626"/>can uncomment the following code snippet:</p>
    <pre class="programlisting code"><code class="hljs-code">#Uncomment for security message evaluations
'''
user_message="Some client funds were mismanaged"
response=data_security(user_message)
print(response)
'''
</code></pre>
    <p class="normal">Let’s now run security checks for moderation and sensitive data classification.</p>
    <h2 class="heading-2" id="_idParaDest-261"><a id="_idTextAnchor271"/>Running security checks</h2>
    <p class="normal">We’ll perform two security evaluations: one for moderation (harassment) and another for sensitive data. Let’s<a id="_idIndexMarker627"/> first begin with a moderation user message.</p>
    <p class="normal">Consider a user message that contains harassment content, as shown here:</p>
    <figure class="mediaobject"><img alt="Figure 9.8: A harassing message" src="img/B32304_09_8.png"/></figure>
    <p class="packt_figref">Figure 9.8: A harassing message</p>
    <p class="normal">The moderation function detects the inappropriate content:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">User01</strong>: Your ideas are always foolish and contribute nothing to our discussions
<strong class="hljs-con-slc">Agent</strong>: Your message could not be processed as it may violate our security guidelines.
</code></pre>
    <p class="normal">A JSON file containing the flagged message is created in the <code class="inlineCode">/logs</code> directory:</p>
    <pre class="programlisting con"><code class="hljs-con">/content/logs/Your_ideas_are_always_foolish_and_contribute_nothi_20250306213022.json
</code></pre>
    <p class="normal">The file contains the moderation categories and has flagged the user message as <code class="inlineCode">harassment</code>:</p>
    <pre class="programlisting code"><code class="hljs-code">{
    "id": "modr-5ef1eeaaa3256a7c45feaa17396f11fd",
    "model": "omni-moderation-latest",
    "results": [
        {
            "categories": {
                "harassment": true,
</code></pre>
    <p class="normal">The probability is also logged:</p>
    <pre class="programlisting code"><code class="hljs-code">…
            "category_scores": {
                "harassment": 0.8054343118110135,
</code></pre>
    <p class="normal">We now have a data security function. When we run a security check for a sensitive topic, such as referring to mismanaged client funds, the output confirms the detection of a sensitive topic:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">User01:</strong> Some client funds were mismanaged and used in a case of intellectual property violations.
<strong class="hljs-con-slc">Agent:</strong> Your message could not be processed as it may violate our security guidelines.
</code></pre>
    <p class="normal">A file containing the flagged message is created :</p>
    <pre class="programlisting con"><code class="hljs-con">/content/security_breach_20250306_213240.txt
</code></pre>
    <p class="normal">This file contains a<a id="_idIndexMarker628"/> record of the flagged message in the Pinecone index:</p>
    <pre class="programlisting code"><code class="hljs-code">1063, Discussing disputes over intellectual property in travel brochure designs which have led to accusations of copyright infringement potential lawsuits and significant reputational damage to the travel agency thereby necessitating an immediate review of all creative materials and strict adherence to intellectual property laws with immediate legal consultation and review now.
</code></pre>
    <p class="normal">Both moderation and sensitive data checks have created detailed records. These logs can be further expanded with user profiles or additional data as your project needs evolve. Additionally, the GenAISys stores full dialogue histories (<code class="inlineCode">conversation_history.json</code>) and summarizations for future reference and auditing. The conversation history is activated when we enter <code class="inlineCode">exit</code>:</p>
    <pre class="programlisting con"><code class="hljs-con">Conversation ended. Saving history...
Conversation history saved to conversation_history.json.
History saved. Proceed to the next cell.
</code></pre>
    <p class="normal">The <em class="italic">Load and display the conversation history</em> outputs contain the log of the conversation with the usernames and security flags:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">User01</strong>:..
Your ideas are always foolish and contribute nothing to our discussions…
assistant…
Your message could not be processed as it may violate our security guidelines.
…
Some client funds were mismanaged and used in a case of intellectual property violations.
assistant…
Your message could not be processed as it may violate our security guidelines….
</code></pre>
    <p class="normal">The raw log of the conversation is saved in <code class="inlineCode">/content/conversation_history.json</code> for further use. The <em class="italic">Load and summarize the conversation history</em> section contains a summary of the dialogue, which includes the username, user messages, and assistant’s responses:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">List of Actions:</strong>
1. User01's First Message:
- Action: User01 criticized the quality of ideas in discussions.
- Assistant's Response: The message was blocked due to potential security guideline violations.
2. User01's Second Message:
- Action: User01 reported an issue regarding the mismanagement of client funds.
- Assistant's Response: The message was again blocked for potential security guideline violations.
</code></pre>
    <p class="normal">With these core functionalities in place, our system’s moderation and security measures can be easily adapted or <a id="_idIndexMarker629"/>expanded to meet your project-specific requirements. We’re now ready to move forward by integrating an external weather forecast component.</p>
    <h1 class="heading-1" id="_idParaDest-262"><a id="_idTextAnchor272"/>Building a weather forecast component</h1>
    <p class="normal">In this section, we’ll cautiously open up the GenAISys by integrating a weather forecast library and building a dedicated <a id="_idIndexMarker630"/>weather forecast function using an external API. This integration allows our GenAISys to interact directly with real-time weather information, providing a pathway to more controlled interactions with external web services. After successfully implementing this functionality, the GenAISys could be authorized to interact with other websites as needed.</p>
    <p class="normal">We’ll implement real-time weather forecasts for specific locations (cities in this case) to support marketing, production planning, deliveries, and customer service, as illustrated in the upcoming <em class="italic">Running the GenAISys</em> section.</p>
    <p class="normal">Open the <code class="inlineCode">GenAISys_Customer_Service.ipynb</code> notebook. The notebook uses the OpenWeather API, available at <a href="https://home.openweathermap.org/">https://home.openweathermap.org/</a>. OpenWeather provides a wide range <a id="_idIndexMarker631"/>of weather forecasting services, but we will focus specifically on real-time forecasts suitable for our use case.</p>
    <p class="normal">To use the OpenWeather API, sign up for an account, obtain your API key, and carefully review their pricing plans at <a href="https://openweathermap.org/price">https://openweathermap.org/price</a>. At the time of writing, the API calls required for our examples are available under their free tier, subject to request limits. Please confirm the cost and limits before proceeding.</p>
    <p class="normal">We will seamlessly integrate our weather forecast function into the GenAISys framework using the handler selection mechanism, as depicted in<em class="italic"> Figure 9.9</em>:</p>
    <figure class="mediaobject"><img alt="Figure 9.9: Integrating a weather forecast API in the GenAISys framework" src="img/B32304_09_9.png"/></figure>
    <p class="packt_figref">Figure 9.9: Integrating a weather forecast API in the GenAISys framework</p>
    <p class="normal">Once we set the OpenWeather environment up, we will integrate the weather forecast function seamlessly with the handler<a id="_idIndexMarker632"/> selection mechanism framework:</p>
    <ol>
      <li class="numberedList" value="1"><strong class="keyWord">IPython interface</strong>: Add a <strong class="screenText">Weather forecast</strong> option to the interface.</li>
      <li class="numberedList"><strong class="keyWord">Handler selection mechanism</strong>: No change.</li>
      <li class="numberedList"><strong class="keyWord">Handler registry</strong>: Include a dedicated weather forecast handler.</li>
      <li class="numberedList"><strong class="keyWord">AI functions</strong>: Develop a specific weather forecast function.</li>
    </ol>
    <p class="normal">Let’s first set up the OpenWeather environment.</p>
    <h2 class="heading-2" id="_idParaDest-263"><a id="_idTextAnchor273"/>Setting up the OpenWeather environment</h2>
    <p class="normal">In <code class="inlineCode">GenAISys_Customer_Service.ipynb</code>, go to the <em class="italic">Weather</em> subsection under the <em class="italic">Setting up the environment</em> section.</p>
    <p class="normal">First, download the script for retrieving your <a id="_idIndexMarker633"/>OpenWeather API key from Google Secrets:</p>
    <pre class="programlisting code"><code class="hljs-code">download("commons","weather_setup.py")
</code></pre>
    <p class="normal">The notebook then runs the API key initialization function:</p>
    <pre class="programlisting code"><code class="hljs-code">google_secrets=True
if google_secrets==True:
  import weather_setup
  weather_setup.initialize_weather_api()
</code></pre>
    <p class="normal">Then, initialize the API key using this function:</p>
    <pre class="programlisting code"><code class="hljs-code">import requests
import os  # Make sure to import os to access environment variables
# Fetch the API key from environment variables
api_key = os.environ.get('Weather_Key')
if not api_key:
    raise ValueError("API Key is not set. Please check your initialization.")
</code></pre>
    <p class="normal">You can also set the API key with another method, depending on the environment you are running the notebook in. We begin by double-checking that <code class="inlineCode">api_key</code> is set:</p>
    <pre class="programlisting code"><code class="hljs-code">def weather_location(city_name):
    # Fetch the API key from environment variables
    api_key = os.environ.get('Weather_Key')
</code></pre>
    <p class="normal">This double-check is not obligatory; it just ensures that the code is robust if the session is interrupted by micro web interruptions, for example. Feel free to remove the redundant check if your environment is stable.</p>
    <p class="normal">The OpenWeather call is <a id="_idIndexMarker634"/>remarkably simple. It requires only your API key and the city name:</p>
    <pre class="programlisting code"><code class="hljs-code"># OpenWeatherMap API URL for city name
url = f"https://api.openweathermap.org/data/2.5/weather?q={city_name}&amp;units=metric&amp;appid={api_key}"
</code></pre>
    <div><p class="normal">Note that <code class="inlineCode">metric</code> is a specific keyword defined by the OpenWeatherMap API, meaning degrees <strong class="keyWord">Celsius</strong> (<strong class="keyWord">C</strong>), and also provides the wind speed in <strong class="keyWord">meters per second</strong> (<strong class="keyWord">m/s</strong>). If you want US customary units, change metric to imperial, <code class="inlineCode">&amp;units=imperial</code>, and you will obtain degrees <strong class="keyWord">Fahrenheit</strong> (<strong class="keyWord">°F</strong>) and <a id="_idIndexMarker635"/>windspeed in <strong class="keyWord">miles per hour</strong> (<strong class="keyWord">mph</strong>).</p>
    </div>
    <p class="normal">We now just have to make the request and retrieve the response:</p>
    <pre class="programlisting code"><code class="hljs-code">   # Fetch real-time weather data
    response = requests.get(url)
    weather_data = response.json()
</code></pre>
    <p class="normal">We will now extract and return the real-time weather information we need for our use case. We will use the current temperature, a brief weather description, and the wind speed:</p>
    <pre class="programlisting code"><code class="hljs-code"># Extract relevant data
    current_temp = weather_data['main']['temp']
    current_weather_desc = weather_data['weather'][0]['description']
    wind_speed = weather_data['wind']['speed']
    return current_temp, current_weather_desc, wind_speed
</code></pre>
    <div><p class="normal"> Note that we only provided the name of the city, not the country. The OpenWeatherMap API has a smart system for handling requests for cities with the same name in different locations. When it searches for “Paris,” it defaults to the most prominent and well-known location, which is Paris, France.</p>
    </div>
    <p class="normal">When the API receives a request with just a city name (<code class="inlineCode">q={city_name}</code>), it uses an internal algorithm to determine the most likely intended location. This algorithm prioritizes several factors:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Population</strong>: Larger, more populous cities are often ranked higher</li>
      <li class="bulletList"><strong class="keyWord">Significance</strong>: Capital cities and major cultural or economic hubs are given preference</li>
      <li class="bulletList"><strong class="keyWord">Internal Ranking</strong>: OpenWeatherMap maintains its own database and ranking system for locations</li>
    </ul>
    <p class="normal">Because Paris, France, is a major global capital with a significantly larger population and international recognition than Paris, Texas, the API defaults to the French capital.</p>
    <p class="normal">Since we are building an <a id="_idIndexMarker636"/>educational example using major tourist locations, such as Paris, the algorithm easily defaults to Paris, France. If needed in production, you could modify the function to include the country and country code, as in the following example:</p>
    <pre class="programlisting code"><code class="hljs-code">def weather_location(city_name, state_code="", country_code=""):
…
query = city_name if state_code: query += f",{state_code}" 
    if country_code: query += f",{country_code}"
</code></pre>
    <p class="normal">The information that we are returning is sufficient for a generative AI model to interpret the real-time weather forecast and make decisions based on it. With that, we are now ready to add a weather forecast option to the IPython interface.</p>
    <h2 class="heading-2" id="_idParaDest-264"><a id="_idTextAnchor274"/>Adding a weather widget to the interface</h2>
    <p class="normal">We will now add a <strong class="screenText">Weather</strong> option to the instruction drop-down list as shown in <em class="italic">Figure 9.10</em>. Why add a weather forecast option to <a id="_idIndexMarker637"/>a reasoning list? The motivation comes from the fact that we are building a GenAISys proof of concept. We could imagine several CoT scenarios based on the use cases we will run in our GenAISys. However, if we write these pipelines before having workshops with the end users, they might find the system too rigid.</p>
    <figure class="mediaobject"><img alt="Figure 9.10: Add a weather forecast option to the IPython interface" src="img/B32304_09_10.png"/></figure>
    <p class="packt_figref">Figure 9.10: Add a weather forecast option to the IPython interface</p>
    <p class="normal">The best approach is to have some CoT and pipeline scenarios to demonstrate the capabilities of the GenAISys, but leave room for flexibility until the users suggest that we automate some of the CoT scenarios they<a id="_idIndexMarker638"/> performed while running the GenAISys.</p>
    <p class="normal">We will thus add the option to the IPython interface, in <code class="inlineCode">instruct_selector</code>, leaving the way it is used open to discussion:</p>
    <pre class="programlisting code"><code class="hljs-code"># Dropdown for reasoning type
instruct_selector = Dropdown(
    options=["None", "Analysis", "Generation","Mobility","Weather"],
    value="None",
    description='Reasoning:',
    layout=Layout(width='50%')
)
</code></pre>
    <p class="normal">When running forecasts, users select <strong class="screenText">Weather</strong> and simply enter a city name. Although adding a city selector or location autocomplete could improve the user experience, a simple text input is more practical for this<a id="_idIndexMarker639"/> real-time use case, especially since tourists typically know their exact destination names.</p>
    <p class="normal">That is all we need at <strong class="keyWord">Layer 1</strong> in the IPython interface. The handler selection mechanism remains unchanged, so we move directly on to the handler registry.</p>
    <h2 class="heading-2" id="_idParaDest-265"><a id="_idTextAnchor275"/>Adding a handle to the handler registry</h2>
    <p class="normal">The weather handler in our registry<a id="_idIndexMarker640"/> only requires a one-word location in the user message and the <code class="inlineCode">"Weather"</code> instruction in this implementation of OpenWeather:</p>
    <pre class="programlisting code"><code class="hljs-code"># Weather handler: determined by the instruct flag
    (
        lambda msg, instruct, mem, models, user_message, 
            **kwargs: instruct == "Weather",
        lambda msg, instruct, mem, models, user_message, 
            **kwargs: handle_weather(
                user_message, models=models)
    ),
</code></pre>
    <p class="normal">Why not use keywords? Using <code class="inlineCode">"weather"</code> as a keyword instead of an instruction could be confused with a follow-up question<a id="_idIndexMarker641"/> in the following context, as follows:</p>
    <ul>
      <li class="bulletList">User 1 could ask: <code class="inlineCode">What is the weather in Paris?</code> The assistant would answer: <code class="inlineCode">20°C, clear skies, 5m/s wind speed</code>.</li>
      <li class="bulletList">User 2 could ask: <code class="inlineCode">What can I visit in this weather?</code> In this case, <code class="inlineCode">weather</code> could trigger an API weather call that would fail because no location is provided.</li>
    </ul>
    <p class="normal">At the time of writing this chapter, even ChatGPT Plus has options before submitting a request, as follows:</p>
    <ul>
      <li class="bulletList">The choice between multiple models such as GPT-4o for general purpose tasks, DALL-E for images, o1-mini for reasoning, o3-mini for high reasoning, GPT-4.5, and more</li>
      <li class="bulletList">A button to activate web search and another one for <strong class="screenText">Deep Research</strong></li>
      <li class="bulletList">Manual file uploads</li>
    </ul>
    <p class="normal">These multiple interactive choices make the interface flexible. However, as we work on user interfaces, we will see a progressive automation of many of these options, along with new generative AI models that encompass the functionality of several former models. It’s an ongoing accelerated generative AI evolution!</p>
    <p class="normal">We will now add the weather function to the AI functions library.</p>
    <h2 class="heading-2" id="_idParaDest-266"><a id="_idTextAnchor276"/>Adding the weather forecast function to AI functions</h2>
    <p class="normal">The real-time weather forecast function first checks whether <code class="inlineCode">api_key</code> is still active during the session. This additional check ensures that the <a id="_idIndexMarker642"/>API call remains stable with no disconnection if there is a micro-interruption of the session in the<a id="_idIndexMarker643"/> VM we are using:</p>
    <pre class="programlisting code"><code class="hljs-code">def handle_weather(user_message, **kwargs):
 # Fetch the API key from environment variables
  api_key = os.environ.get('Weather_Key')
  if not api_key:
      raise ValueError("API Key is not set. Please check your initialization.")
</code></pre>
    <p class="normal">The city name is the user message; the weather forecast will be requested; and the temperature, description, and wind speed will be returned:</p>
    <pre class="programlisting code"><code class="hljs-code">    city_name = user_message
    current_temp, current_weather_desc, wind_speed = \
        weather_location(city_name)
    return f"Current Temperature in {city_name}: {current_temp}°C\nWeather: {current_weather_desc}\nWind Speed: {wind_speed} m/s"
</code></pre>
    <p class="normal">We could add a keyword search to a longer user message.</p>
    <p class="normal">At this stage, the constraint is that the user message must only contain the city’s name. However, the functionality can be expanded in various ways based on user feedback gathered during project workshops, such as the following:</p>
    <ul>
      <li class="bulletList">Scan a user message for the location if the weather option is activated.</li>
    </ul>
    <p class="normal">Limitation: Only the name of the city is necessary.</p>
    <ul>
      <li class="bulletList">Have a drop-down list of all the possible city locations.</li>
    </ul>
    <p class="normal">Limitation: The list could contain hundreds of cities.</p>
    <ul>
      <li class="bulletList">Have a country selection list, then choose a region (or administrative name for a region), then choose the city.</li>
    </ul>
    <p class="normal">Limitation: A customer might not know the name of the region or state. Also, this takes longer than just entering the city.</p>
    <ul>
      <li class="bulletList">Automatically detect where the customer is.</li>
    </ul>
    <p class="normal">Limitation: The query might be for another city and not the one the customer is in.</p>
    <ul>
      <li class="bulletList">Just enter the city and nothing else, as we are doing now.</li>
    </ul>
    <p class="normal">Limitation: We might<a id="_idIndexMarker644"/> need to enhance the function with a city keyword search just in case the user enters more words than just the name of the city. Also, the customer might misspell the name of the location.</p>
    <p class="normal">As you can see, there are several ways to implement the real-time weather forecast request at the user level. The best approach is to initially showcase the basic capabilities of the system clearly and then adapt and extend the interface based on the feedback you receive from workshops with a customer <a id="_idIndexMarker645"/>panel.</p>
    <p class="normal">Now that we’ve built and integrated the weather forecast functionality into the handler selection mechanism framework, we’re ready to demonstrate real-world use cases within the GenAISys.</p>
    <h1 class="heading-1" id="_idParaDest-267"><a id="_idTextAnchor277"/>Running the GenAISys</h1>
    <p class="normal">In this section, we will run multi-user, cross-domain, multimodal interactions using the GenAISys for real-time tourism-related services. Typically, when tourists visit a city, they check weather forecasts in one app and <a id="_idIndexMarker646"/>decide on their activities in another. Here, we’re merging these domains into one seamless experience. Users will request real-time weather forecasts, and the GenAISys will suggest suitable activities—indoor, outdoor, or both—based on the current weather conditions. This integrated, cross-domain approach can be extended beyond tourism into areas such as construction planning, delivery scheduling, and nearly any scenario where multiple applications are traditionally needed to support user decisions.</p>
    <p class="normal">The main objective of this section is to demonstrate the cross-domain capabilities of the GenAISys in a flexible manner, illustrating how the system can adapt to various domain-specific scenarios. Specifically, we will focus on the following:</p>
    <ul>
      <li class="bulletList">Activating and deactivating the weather forecast functionality</li>
      <li class="bulletList">Activating and deactivating the file display option</li>
    </ul>
    <p class="normal">We aim to present a clear and practical proof of concept, highlighting potential workflows before automation decisions are finalized in user workshops. By not prematurely automating too many scenarios, the GenAISys maintains flexibility, allowing actual users first to experiment freely and determine which features should be automated. Remember, the more automation you introduce, the less flexibility you retain in user interactions—though, with careful planning, it is possible to balance both automation and interactivity.</p>
    <p class="normal">As emphasized earlier, an effective strategy begins with supporting interactive, manual workflows, then progressively automating some or all tasks as users gain familiarity and provide feedback. <em class="italic">Time is not the objective; user maturity is</em>. Interactive scenarios can transition into fully automated pipelines or CoT processes at the users’ pace. By letting user feedback shape development, adoption rates naturally improve.</p>
    <div><p class="normal"> Generative AI systems rely on probabilistic responses, meaning outputs can vary slightly with each run. This stochastic behavior ensures responses remain dynamic rather than rigid or repetitive.</p>
    </div>
    <p class="normal">At the beginning of the notebook (<code class="inlineCode">GenAISys_Customer_Service.ipynb</code>), you have the option to activate or deactivate the DeepSeek model:</p>
    <pre class="programlisting code"><code class="hljs-code"># DeepSeek activation deepseek=True to activate. 20 Go (estimate) GPU memory and 30-40 Go Disk Space
deepseek=False
</code></pre>
    <p class="normal">For this chapter, <code class="inlineCode">deepseek</code> is<a id="_idIndexMarker647"/> set to <code class="inlineCode">False</code>, and we will rely on OpenAI for running our use cases.</p>
    <p class="normal">With all necessary functions ready for weather-based decision-making, let’s now explore interactive use cases in the GenAISys.</p>
    <h2 class="heading-2" id="_idParaDest-268"><a id="_idTextAnchor278"/>A multi-user, cross-domain, and multimodal dialogue</h2>
    <p class="normal">We’ll run an interactive scenario with the GenAISys, simulating a tourist seeking real-time, weather-based recommendations in a specific city—whether the weather is cloudy with possible rain or clear. The<a id="_idIndexMarker648"/> GenAISys must thus adapt its suggestions to real-time weather forecasts in that specific location.</p>
    <p class="normal">The dialogue will be multi-user between the following users:</p>
    <ul>
      <li class="bulletList"><code class="inlineCode">User01</code>: A tourist who expects weather-dependent suggestions on what to do</li>
      <li class="bulletList"><code class="inlineCode">User02</code>: A customer service agent who provides support</li>
      <li class="bulletList"><code class="inlineCode">User03</code>: A decision-maker who coordinates marketing, product design, production, deliveries, and customer service</li>
    </ul>
    <p class="normal">Each interaction in this dialogue is clearly labeled, indicating the user initiating the request. If a new session starts, it will be prefixed by <code class="inlineCode">New Session</code>.</p>
    <p class="normal">The interface actions will be as follows:</p>
    <ul>
      <li class="bulletList">Writing and submitting a prompt</li>
      <li class="bulletList">Activating or deactivating the weather forecast function</li>
      <li class="bulletList">Activating or deactivating file displays</li>
    </ul>
    <p class="normal">There are many enhancements, improvements, additional functions, CoT processes, and pipelines we could add to expand our GenAISys. However, this should be done in collaboration with a customer/user panel.</p>
    <p class="normal">Let’s start the dialogue in Paris.</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">User01</strong>: Paris
</code></pre>
    <p class="normal">The customer activated the <strong class="screenText">Weather</strong> function and entered <strong class="screenText">Paris</strong>, knowing that in this proof of concept, those are the instructions to follow, as shown here:</p>
    <figure class="mediaobject"><img alt="Figure 9.11: Asking for a real-time weather forecast" src="img/B32304_09_11.png"/></figure>
    <p class="packt_figref">Figure 9.11: Asking for a real-time weather forecast</p>
    <p class="normal">The GenAISys agent provides the requested information:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">Agent:</strong> Current Temperature in Paris: 10.68°C
Weather: clear sky
Wind Speed: 3.09 m/s
</code></pre>
    <p class="normal">Note that the weather response will <a id="_idIndexMarker649"/>continually change, and thus, the whole dialogue that follows will take a different turn. Different locations, different weather conditions, and different points of interest for the customer will take this dialogue in unique directions. The customer now asks for recommendations:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">User01</strong>: What should I first visit with this weather
</code></pre>
    <p class="normal">With the <strong class="screenText">Reasoning</strong> option set to <strong class="screenText">None</strong>, the GenAI provides personalized suggestions:</p>
    <figure class="mediaobject"><img alt="Figure 9.12: Asking what activities to do in this weather" src="img/B32304_09_12.png"/></figure>
    <p class="packt_figref">Figure 9.12: Asking what activities to do in this weather</p>
    <p class="normal">The GenAI suggests some engaging activities based on the weather:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">Agent:</strong> With clear skies and cool temperatures in Paris, it's a great opportunity to explore outdoor attractions. Here are a few suggestions:
1. <strong class="hljs-con-slc">Eiffel Tower</strong>: Start your day with a visit to the iconic Eiffel Tower. You can enjoy the view from the ground or take an elevator ride to the top for a panoramic view of the city.
2. <strong class="hljs-con-slc">Champs-Élysées and Arc de Triomphe</strong>: Take a stroll down the famous Champs-Élysées and visit the Arc de Triomphe. The clear weather will make for great photos and a pleasant walk.
…
4. <strong class="hljs-con-slc">Seine River Cruise</strong>: Consider taking a Seine River cruise to see many of Paris's landmarks from the water. The clear sky will provide beautiful views of the city.
5. <strong class="hljs-con-slc">Luxembourg Gardens</strong>: Enjoy a leisurely walk in the Luxembourg Gardens. It's a perfect spot to relax and take in the beauty of the well-maintained gardens.
Make sure to dress warmly, as the temperature is quite cool. Enjoy your visit!
</code></pre>
    <p class="normal">The user finds the response useful but <a id="_idIndexMarker650"/>would also like to visit a museum:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">User01</strong>:But what if I want to only visit one outdoor site and then go to a museum?
</code></pre>
    <p class="normal">Without changing the interface configuration, the agent provides a tailored itinerary:</p>
    <pre class="programlisting con"><code class="hljs-con">1. <strong class="hljs-con-slc">Outdoor Site: Eiffel Tower</strong>: Start your day with a visit to the Eiffel Tower. It's an iconic symbol of Paris and offers stunning views of the city. You can choose to admire it from the ground or take a trip to the top.
2. <strong class="hljs-con-slc">Museum: Musée d'Orsay</strong>: After visiting the Eiffel Tower, head to the Musée d'Orsay. It's located along the Seine River and is housed in a beautiful Beaux-Arts railway station. The museum features an extensive collection of Impressionist and Post-Impressionist masterpieces by artists like Monet, Van Gogh, and Degas.
This combination allows you to enjoy both the outdoor beauty of Paris and its rich cultural heritage. Make sure to check the museum's opening hours and any ticket requirements in advance. Enjoy your day!
</code></pre>
    <p class="normal">Now, the customer service agent steps in to augment the personalized experience of the customer:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">User02</strong>: Create an engaging image of the Eiffel tower and the Musée d'Orsay museum in Paris for a tourist
</code></pre>
    <p class="normal">This kind of multi-user interface could easily be built into a website with features such as text and image generation, customer <a id="_idIndexMarker651"/>profiles, and conversation history—your imagination is the only limit.</p>
    <p class="normal">In this case, ensure <strong class="screenText">Files</strong> is checked to display the image, as shown here:</p>
    <figure class="mediaobject"><img alt="Figure 9.13: Creating a custom image for the visit" src="img/B32304_09_13.png"/></figure>
    <p class="packt_figref">Figure 9.13: Creating a custom image for the visit</p>
    <p class="normal">The GenAISys generates a captivating image representing the recommended custom visit, as displayed here:</p>
    <figure class="mediaobject"><img alt="Figure 9.14: A custom image for a customized visit" src="img/B32304_09_14.png"/></figure>
    <p class="packt_figref">Figure 9.14: A custom image for a customized visit</p>
    <p class="normal">Our GenAISys could be expanded to send the image to the tourist’s smartphone, or even better, the GenAISys could be developed as a smartphone app connecting with the GenAISys server.</p>
    <p class="normal">The image is great and the <a id="_idIndexMarker652"/>weather fine. Pleased, <code class="inlineCode">User02</code> requests a promotional offer:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">User02</strong>: Create an offer with a 10% discount for a Paris Seine River Cruise
</code></pre>
    <p class="normal"><strong class="screenText">Files</strong> is unchecked so the GenAI can craft a text-based promotional message, as shown here:</p>
    <figure class="mediaobject"><img alt="Figure 9.15: A custom image for a customized visit" src="img/B32304_09_15.png"/></figure>
    <p class="packt_figref">Figure 9.15: A custom image for a customized visit</p>
    <p class="normal">The model generates an engaging message:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">Agent:</strong><strong class="hljs-con-slc">Exclusive Offer: 10% Discount on Paris Seine River Cruise!</strong> 
Experience the magic of Paris from the water with our exclusive Seine River Cruise. Glide past iconic landmarks like the Eiffel Tower, Notre-Dame Cathedral, and the Louvre, all while enjoying the stunning views of the City of Light.
<strong class="hljs-con-slc">Offer Details:</strong>
- <strong class="hljs-con-slc">Discount:</strong> 10% off your Seine River Cruise ticket
- <strong class="hljs-con-slc">Promo Code:</strong> SEINE10
- <strong class="hljs-con-slc">Validity:</strong> Book by [insert date] for travel until [insert date]
<strong class="hljs-con-slc">Highlights:</strong>
- Breathtaking views of Paris's most famous attractions
- Relaxing and scenic cruise experience
- Perfect for couples, families, and solo travelers
</code></pre>
    <p class="normal">The river cruise offer is great, but now <code class="inlineCode">User03</code> steps in with a cutting-edge idea to enhance customer engagement:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">User03</strong>: Create an image of a cool travel bag with all the outdoor locations a tourist can visit in Paris on a sunny day. Add the Eiffel Tower and the Musée du Louvre to make it complete.
</code></pre>
    <p class="normal"><strong class="screenText">Files</strong> is checked again<a id="_idIndexMarker653"/> so the agent can produce the requested image, as shown:</p>
    <figure class="mediaobject"><img alt="Figure 9.16: Checking files to display an image" src="img/B32304_09_16.png"/></figure>
    <p class="packt_figref">Figure 9.16: Checking files to display an image</p>
    <p class="normal">The result is the eye-catching design displayed here:</p>
    <figure class="mediaobject"><img alt="Figure 9.17: A customized travel bag image" src="img/B32304_09_17.png"/></figure>
    <p class="packt_figref">Figure 9.17: A customized travel bag image</p>
    <p class="normal">The manager forwards this custom design immediately to a local printing partner that maintains travel bag stock and specialized printing equipment. The travel bag will be printed and delivered to the customer’s hotel within half an hour—a service as convenient and timely as ordering a pizza! This represents the future of real-time customer service.</p>
    <p class="normal">For a final touch, the manager asks for an engaging email to be sent to the customer:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">User03</strong>: Write an engaging email for the tourist that will receive this custom-printed travel bag at the hotel desk within 30 minutes!
</code></pre>
    <p class="normal">The message could be a notification in an app, a text message, and/or part of the online conversation on a <a id="_idIndexMarker654"/>cutting-edge, multi-user, cross-domain, multimodal website!</p>
    <p class="normal">In this case, <strong class="screenText">Files</strong> is unchecked to make room for the GenAI to generate the text, as shown here:</p>
    <figure class="mediaobject"><img alt="Figure 9.18: Unchecking files to send a message" src="img/B32304_09_18.png"/></figure>
    <p class="packt_figref">Figure 9.18: Unchecking files to send a message</p>
    <div><p class="normal"> If the manager wished, <strong class="screenText">Files</strong> could have remained checked, and the image could have been processed to be attached to the message.</p>
    </div>
    <p class="normal">The message is engaging and highlights the exceptional level of customer service offered by the travel agency:</p>
    <pre class="programlisting con"><code class="hljs-con">Dear [Tourist's Name],
Bonjour and welcome to the enchanting city of Paris!
We are thrilled to inform you that your custom-printed travel bag, designed exclusively for your Parisian adventure, is ready and waiting for you at the hotel desk. This isn't just any travel bag; it's your personal guide to the most iconic outdoor locations in the City of Light, all beautifully illustrated to inspire your journey.
….
We hope this bag not only serves as a practical companion but also as a cherished keepsake of your time in Paris. Whether you're strolling along the Seine or enjoying a café au lait at a local bistro, let this bag be your guide to unforgettable memories.
Please visit the hotel desk within the next 30 minutes to collect your bag and start your Parisian adventure in style.
…
P.S. Don't forget to share your adventures with us on social media using #ParisWith[HotelName]! We can't wait to see where your travels take you.
</code></pre>
    <p class="normal">The “P.S.” message is important in a real-time delivery context, as it encourages customers to share their positive experiences on social media. This kind of user-generated content helps brands extend their reach and strengthen their market differentiation as competition intensifies across nearly every industry.</p>
    <p class="normal">Now let’s move to another location, using a different approach. Restart the session by entering <code class="inlineCode">Exit</code> and rerunning the notebook’s cell. The customer service agent will now explore options for customers visiting Tokyo:</p>
    <pre class="programlisting con"><code class="hljs-con">New Session. <strong class="hljs-con-slc">User02</strong>: Tokyo
</code></pre>
    <p class="normal">In this session, <code class="inlineCode">User02</code>, the <a id="_idIndexMarker655"/>customer service agent, and <code class="inlineCode">User03</code>, the manager, are trying to figure out what to suggest to their customers who have arrived in Tokyo. They want to customize the experience to make sure they keep ahead of the competition. They first want to know the weather for that day, so they select <strong class="screenText">Weather</strong> (as in <em class="italic">Figure 9.19</em>) and enter <code class="inlineCode">Tokyo</code>.</p>
    <figure class="mediaobject"><img alt="Figure 9.19: Files is unchecked, and Weather is selected" src="img/B32304_09_19.png"/></figure>
    <p class="packt_figref">Figure 9.19: Files is unchecked, and Weather is selected</p>
    <p class="normal">The GenAISys returns the weather in real time:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">Agent:</strong> Current Temperature in Tokyo: 9.51°C
Weather: moderate rain
Wind Speed: 10.8 m/s
</code></pre>
    <p class="normal">Now, <code class="inlineCode">User02</code> would like to know what to suggest for this weather:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">User02</strong>: What places would you suggest a tourist visit in this weather?
</code></pre>
    <p class="normal">The <strong class="screenText">Weather</strong> function is deactivated (see <em class="italic">Figure 9.11</em>). The GenAI must analyze the weather and then suggest activities.</p>
    <figure class="mediaobject"><img alt="Figure 9.20: Files is unchecked, and Reasoning is set to None" src="img/B32304_09_20.png"/></figure>
    <p class="packt_figref">Figure 9.20: Files is unchecked, and Reasoning is set to None</p>
    <p class="normal">The agent takes the weather into account and makes interesting suggestions:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">Agent:</strong> In moderate rain and cooler temperatures, it's a good idea to suggest indoor activities or places where tourists can enjoy themselves without being too affected by the weather. Here are some suggestions for a tourist visiting Tokyo in such conditions:
1. <strong class="hljs-con-slc">Museums and Art Galleries</strong>:
- <strong class="hljs-con-slc">Tokyo National Museum</strong>: Located in Ueno Park…
- <strong class="hljs-con-slc">Mori Art Museum</strong>: Situated in Roppongi Hills…
2. <strong class="hljs-con-slc">Shopping and Entertainment Complexes</strong>:
- <strong class="hljs-con-slc">Odaiba</strong>: This man-made island has shopping malls…
- <strong class="hljs-con-slc">Shibuya Scramble Square</strong>: Offers shopping, dining, …
3. <strong class="hljs-con-slc">Aquariums and Zoos</strong>:
- <strong class="hljs-con-slc">Sumida Aquarium</strong>: Located in…
- <strong class="hljs-con-slc">Ueno Zoo</strong>: While some parts…
…
</code></pre>
    <p class="normal">We can see that the GenAISys is adapting to different scenarios in an acceptable way.</p>
    <p class="normal">Now, <code class="inlineCode">User02</code> is getting <a id="_idIndexMarker656"/>some ideas from the response. Since the weather is rainy, why not suggest a bus tour?</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">User02</strong>: Ok. Write an engaging email to offer a bus tour for some of these locations to visit in one day. Don't make it too dense. Make the bus tour nice and cool.
</code></pre>
    <p class="normal">The configuration (<strong class="screenText">Files</strong> unchecked, <strong class="screenText">Reasoning</strong> set to <strong class="screenText">None</strong>) does not change. The GenAISys makes an engaging offer for a bus tour:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">Agent:</strong> Subject: Discover Tokyo's Hidden Gems with Our Exclusive Bus Tour!
Hi [Name],
Are you ready to explore Tokyo like never before? Join us for a one-of-a-kind bus tour that takes you to some of the city's most fascinating indoor attractions, perfect for a day of adventure, rain or shine!
<strong class="hljs-con-slc">Tour Highlights:</strong>
…
Our comfortable, climate-controlled bus ensures a relaxing journey between stops, with a friendly guide sharing insider tips and stories about each location. Plus, enjoy complimentary snacks and refreshments on board!
<strong class="hljs-con-slc">Tour Details:</strong>
- <strong class="hljs-con-slc">Date</strong>: [Insert Date]
- <strong class="hljs-con-slc">Time</strong>: [Insert Time]
- <strong class="hljs-con-slc">Pick-up Location</strong>: [Insert Location]
</code></pre>
    <p class="normal"><code class="inlineCode">User03</code> steps in and asks the GenAISys to write an engaging message for food and beverages:</p>
    <pre class="programlisting con"><code class="hljs-con">User03: Write an engaging email for the food and beverages for tourists taking a bus tour of Tokyo with some stops. Do not mention the stops at all or the locations. Just focus on the super discount prices for food and beverages. Make sure to have food with and without meat. No alcohol on the bus is allowed. Also, think of some gluten-free food.
</code></pre>
    <p class="normal">The configuration (<strong class="screenText">Files</strong> unchecked, <strong class="screenText">Reasoning</strong> set to <strong class="screenText">None</strong>) does not change. The GenAISys makes an engaging offer for food and beverages during the bus tour. The idea is to show the customers that the travel <a id="_idIndexMarker657"/>agency is taking care of them in great detail.</p>
    <p class="normal">The GenAISys understands the situation and provides an engaging message:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">Agent:</strong> Subject: Delicious Deals Await on Your Tokyo Bus Tour!
Dear Traveler,
Get ready to embark on a delightful culinary journey as you explore Tokyo with us! We're thrilled to offer you an array of mouth-watering food and beverage options at unbeatable prices, ensuring your taste buds are as entertained as your eyes.
<strong class="hljs-con-slc">Savor the Flavors:</strong>
- <strong class="hljs-con-slc">Meaty Marvels:</strong> …
- <strong class="hljs-con-slc">Veggie Delights:</strong> …
- <strong class="hljs-con-slc">Gluten-Free Goodies:</strong>…
<strong class="hljs-con-slc">Thirst-Quenching Beverages: </strong>Stay refreshed with our selection of non-alcoholic beverages…
<strong class="hljs-con-slc">Exclusive Offer:…</strong>
<strong class="hljs-con-slc">…</strong>
P.S. Remember, no alcohol is allowed on the bus so that you can enjoy a safe and family-friendly environment throughout your adventure!
</code></pre>
    <p class="normal">We can see that the GenAISys is flexible and leverages the generative AI models efficiently.</p>
    <p class="normal">Let’s end our travelling journey experience in New York. Exit the session and rerun the IPython cell.</p>
    <p class="normal"><code class="inlineCode">User02</code> wants to anticipate activities in New York:</p>
    <pre class="programlisting con"><code class="hljs-con">New session. <strong class="hljs-con-slc">User02</strong>: New York
</code></pre>
    <p class="normal">In this session, <code class="inlineCode">User02</code> (customer service agent) and <code class="inlineCode">User03</code> (manager) are brainstorming personalized recommendations for tourists <a id="_idIndexMarker658"/>arriving in Tokyo. They want to tailor the experience to stay ahead of competitors. First, they check the current weather by selecting the <strong class="screenText">Weather</strong> option (<em class="italic">Figure 9.21</em>) and entering <code class="inlineCode">Tokyo</code>:</p>
    <figure class="mediaobject"><img alt="Figure 9.21: Files is unchecked and Weather is selected" src="img/B32304_09_21.png"/></figure>
    <p class="packt_figref">Figure 9.21: Files is unchecked and Weather is selected</p>
    <p class="normal">The agent provides the weather in real time:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">Agent:</strong> Current Temperature in New York: 10.06°C
Weather: mist
Wind Speed: 4.12 m/s
</code></pre>
    <p class="normal"><code class="inlineCode">User02</code> thinks that misty weather is not the best day to take customers on a tour of Central Park. What can the GenAISys come up with?</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">User02</strong>: I'm a tourist customer service agent. Considering the weather, I was thinking of suggesting an exciting activity to my tourist group. Find one activity for the morning that could be exciting.
</code></pre>
    <p class="normal"><code class="inlineCode">User02</code> runs the GenAISys with <strong class="screenText">Files</strong> unchecked and no <strong class="screenText">Reasoning</strong> instruction (<em class="italic">Figure 9.22</em>). The situation is not that easy because we want the customers to visit new places and possibly surprise them a bit:</p>
    <figure class="mediaobject"><img alt="Figure 9.22: Files is unchecked and Weather is not selected" src="img/B32304_09_22.png"/></figure>
    <p class="packt_figref">Figure 9.22: Files is unchecked and Weather is not selected</p>
    <p class="normal">The GenAISys finds an interesting program that can add a cultural touch to the trip:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">Agent:</strong> Considering the misty weather in New York, a great morning activity for your tourist group could be visiting the American Museum of Natural History. It's an exciting indoor experience where they can explore fascinating exhibits, including dinosaur fossils, the Hall of Ocean Life, and the Rose Center for Earth and Space. This activity will keep them engaged and comfortable regardless of the weather outside.
</code></pre>
    <p class="normal">At the end of the trip to New York, <code class="inlineCode">User03</code>, the manager, steps in to offer the customers a souvenir T-shirt:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">User03</strong>: The hotel was great for a tourist group in New York because the view reminded some of them of when they first came to  New York with their parents. I'm sure they would have like to receive a custom T-shirt as a souvenir to remind them of that experience. Make sure that the image you produce shows a T-shirt.
</code></pre>
    <p class="normal"><code class="inlineCode">User03</code> decides to<a id="_idIndexMarker659"/> activate a full-scale GenAISys CoT generation to analyze customer feedback and produce a nice T-shirt. <strong class="screenText">Files</strong> is checked and <strong class="screenText">Generation</strong> is activated, as shown:</p>
    <figure class="mediaobject"><img alt="Figure 9.23: Files is checked and Generation is selected" src="img/B32304_09_23.png"/></figure>
    <p class="packt_figref">Figure 9.23: Files is checked and Generation is selected</p>
    <p class="normal">Our GenAISys begins the generation process step by step:</p>
    <pre class="programlisting con"><code class="hljs-con">"The hotel was great for a tourist group in New York because the view reminded some of them of when they first came to New York with their parents.I'm sure they would have like to receive a custom T-shirt as a souvenir to remind them of that experience.Make sure that the image you produce shows a T-shirt."
</code></pre>
    <p class="normal">It first performs a memory and sentiment analysis of the feedback the tour guide detected:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">Agent: Process: Performing memory and sentiment analysis.</strong>
<strong class="hljs-con-slc">Memory analysis result</strong>: Segment 1: "The hotel was great for a tourist group in New York because the view reminded some of them of when they first came to New York with their parents."
- Memory Tags: [Episodic Memory, Time Memory Past, Reality Memory]
- Dimension: Emotional
- Sentiment Score: 0.8
- Explanation: This segment references a real past event (their first visit to New York with their parents) that triggers personal, nostalgic recollections, placing it in episodic and time (past) memory while affirming its reality and positive emotional tone.
</code></pre>
    <p class="normal">It then extracts the scores <a id="_idIndexMarker660"/>from the content it analyzed:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">Process: Extracting scores from response.</strong>
Memory analysis result: Episodic Memory sentiment 0.8
Time Memory Past sentiment 0.8
Reality Memory sentiment 0.8
Episodic Memory sentiment 0.75
Time Memory Past sentiment 0.75
Memoryless sentiment 0.5
</code></pre>
    <p class="normal">It then performs a statistical analysis to provide an overall rating:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">Process: Statistical analysis</strong>
Extracted sentiment scores: [0.8, 0.8, 0.8, 0.75, 0.75, 0.5]
Extracted sentiment scores: 0.73
Scaled rating (0–5): 3.65
Process: Creating content
</code></pre>
    <p class="normal">The score is not 4 or 5 because they would like a souvenir, a T-shirt, and they don’t have it yet! So, the GenAISys now creates a prompt for image generation:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">Prompt created for image generation:</strong> "Design a custom T-shirt featuring the iconic New York skyline or a memorable landmark like Times Square or Central Park, capturing the essence of a nostalgic and cherished tourist experience."
</code></pre>
    <p class="normal">The GenAISys now creates an image for the prompt (<em class="italic">Figure 9.24</em>):</p>
    <pre class="programlisting con"><code class="hljs-con">Process: Creating an image
Image created
</code></pre>
    <figure class="mediaobject"><img alt="Figure 9.24: A custom T-shirt" src="img/B32304_09_24.png"/></figure>
    <p class="packt_figref">Figure 9.24: A custom T-shirt</p>
    <p class="normal">The GenAISys now<a id="_idIndexMarker661"/> creates a message for the customer:</p>
    <pre class="programlisting con"><code class="hljs-con"><strong class="hljs-con-slc">Process: Creating a message.</strong>
Customer message: Dear Customer,
We invite you to design a custom T-shirt that beautifully showcases the iconic New York skyline or a memorable landmark such as Times Square or Central Park. This design aims to capture the essence of a nostalgic and cherished tourist experience.
Best regards,
</code></pre>
    <p class="normal">For the New York trip, the manager will now instruct the local printer to print the custom image onto a batch of T-shirts already stocked at the printer’s site. The shirts will be produced and delivered to the tourist’s hotel within the hour.</p>
    <p class="normal">The travel agency is extremely satisfied with the GenAISys proof of concept and is now preparing to organize workshops with all team members to take the system to the next level.</p>
    <p class="normal">Let’s now summarize our journey—and get ready to explore what’s next!</p>
    <h1 class="heading-1" id="_idParaDest-269"><a id="_idTextAnchor279"/>Summary</h1>
    <p class="normal">The acceleration of modern markets has led to the extinction of waiting times.<em class="italic"> Real-time responsiveness is now the default</em>. The use case explored in this chapter demonstrates that a business-ready GenAISys proof of concept must be able to provide immediate, real-world services. We implemented a real-time travel agency scenario—one that can easily be adapted to other domains once you enter project mode.</p>
    <p class="normal">To make our proof of concept suitable for live demonstration to a team, customer, or investor, we first integrated a moderation component into GenAISys. We implemented OpenAI’s Omni model to detect and flag multiple categories of content policy violations. This moderation function is embedded at the handler selection mechanism level, ensuring that inappropriate user messages are flagged and rejected before any further processing. To further reassure stakeholders, we added a data security layer. Using vector similarity search, we built a function that detects whether a user message aligns with sensitive topics. We created a dedicated Pinecone namespace to store these topics and queried it against every incoming user message. If a match was found, the system flagged the content, displayed a warning, and rejected the request.</p>
    <p class="normal">All flagged moderation and security violations were logged in separate files, and the full conversation history can be traced to individual users. With these essential safeguards in place, we proceeded to implement a real-time weather forecasting feature using OpenWeather—tightly integrated into GenAISys for weather-aware decision-making. Finally, we walked through a complete GenAISys dialogue, showcasing the system’s ability to support real-time, multi-user, cross-domain, multimodal interactions—a powerful illustration of what generative AI can achieve in production settings.</p>
    <p class="normal">The next step? Presenting your GenAISys proof of concept to secure the resources needed to expand and scale the system. But such a presentation must be carefully crafted—and that’s exactly what we’ll focus on in the next chapter.</p>
    <h1 class="heading-1" id="_idParaDest-270"><a id="_idTextAnchor280"/>Questions</h1>
    <ol>
      <li class="numberedList" value="1">Sensitive topics can be detected with vector similarity searches. (True or False)</li>
      <li class="numberedList">A flagged user message containing a sensitive topic in the GenAISys does not stop the dialogue. (True or False)</li>
      <li class="numberedList">The OpenAI moderation tool only has one category for foul language. (True or False)</li>
      <li class="numberedList">A flagged user message containing content that violates the content policy of the GenAISys does not stop the dialogue. (True or False)</li>
      <li class="numberedList">Weather forecasting in real time to automatically suggest activities can give a company a competitive advantage. (True or False)</li>
      <li class="numberedList">A multi-user, cross-domain, multimodal GenAISys is the future of apps. (True or False)</li>
      <li class="numberedList">Multi-user, cross-domain, multimodal apps don’t exist yet. (True or False)</li>
      <li class="numberedList">Adding GenAISys to apps will significantly boost productivity and engage users. (True or False)</li>
      <li class="numberedList">A GenAISys should be developed with a customer panel. (True or False)</li>
    </ol>
    <h1 class="heading-1" id="_idParaDest-271"><a id="_idTextAnchor281"/>References</h1>
    <ul>
      <li class="bulletList">OpenAI moderation: <a href="https://platform.openai.com/docs/guides/moderation">https://platform.openai.com/docs/guides/moderation</a></li>
      <li class="bulletList">The OpenAI Moderation object: <a href="https://platform.openai.com/docs/api-reference/moderations/object">https://platform.openai.com/docs/api-reference/moderations/object</a></li>
      <li class="bulletList">OpenWeather: <a href="https://openweathermap.org/">https://openweathermap.org/</a><a href="https://home.openweathermap.org "/></li>
    </ul>
    <h1 class="heading-1" id="_idParaDest-272"><a id="_idTextAnchor282"/>Further reading</h1>
    <ul>
      <li class="bulletList">OpenWeather’s solar radiance research: <a href="https://home.openweathermap.org/solar_irradiance_history_bulks/new">https://home.openweathermap.org/solar_irradiance_history_bulks/new</a></li>
    </ul>
    <div><table class="table-container" id="table001-5">
        <tbody>
          <tr>
            <td class="table-cell">
              <h4 class="heading-4">Unlock this book’s exclusive benefits now</h4>
              <p class="normal">Scan this QR code or go to <a href="http://packtpub.com/unlock">packtpub.com/unlock</a>, then search for this book by name.</p>
            </td>
            <td class="table-cell" rowspan="2">
              <figure class="mediaobject"><img alt="A qr code on a white background  AI-generated content may be incorrect." src="img/Unlock.png"/></figure>
            </td>
          </tr>
          <tr>
            <td class="table-cell">
              <p class="normal"><em class="italic">Note: Keep your purchase invoice ready before you start.</em></p>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</body></html>