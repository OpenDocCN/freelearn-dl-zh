<html><head></head><body><html:html>&#13;
 <html:head>&#13;
  <html:title>&#13;
   Indexing our PITS study materials – hands-on&#13;
  </html:title>&#13;
 </html:head>&#13;
 <html:body>&#13;
  <html:div class="epub-source">&#13;
   <html:h1 id="_idParaDest-129">&#13;
    Indexing our PITS study materials – hands-on&#13;
   </html:h1>&#13;
   <html:div id="_idContainer052">&#13;
    from llama_index.core import (&#13;
    VectorStoreIndex, TreeIndex, load_index_from_storage)&#13;
from llama_index.core import StorageContext&#13;
from global_settings import INDEX_STORAGE&#13;
from document_uploader import ingest_documents&#13;
    def build_indexes(nodes):&#13;
    try:&#13;
        storage_context = StorageContext.from_defaults(&#13;
            persist_dir=INDEX_STORAGE&#13;
        )&#13;
        vector_index = load_index_from_storage(&#13;
            storage_context, index_id="vector"&#13;
        )&#13;
        tree_index = load_index_from_storage(&#13;
            storage_context, index_id="tree"&#13;
        )&#13;
        print("All indices loaded from storage.")&#13;
        except Exception as e:&#13;
        print(f"Error occurred while loading indices: {e}")&#13;
        storage_context = StorageContext.from_defaults()&#13;
        vector_index = VectorStoreIndex(&#13;
            nodes, storage_context=storage_context&#13;
        )&#13;
        vector_index.set_index_id("vector")&#13;
        tree_index = TreeIndex(&#13;
            nodes, storage_context=storage_context&#13;
        )&#13;
        tree_index.set_index_id("tree")&#13;
        storage_context.persist(&#13;
            persist_dir=INDEX_STORAGE&#13;
        )&#13;
        print("New indexes created and persisted.")&#13;
    return vector_index, tree_index&#13;
    <html:p>&#13;
     With a solid understanding&#13;
     <html:a id="_idIndexMarker511">&#13;
     </html:a>&#13;
     of how indexing works in LlamaIndex, we’re now ready to implement the indexing logic in our&#13;
     <html:span class="No-Break">&#13;
      tutoring application.&#13;
     </html:span>&#13;
    </html:p>&#13;
    <html:p>&#13;
     Let’s create the&#13;
     <html:code class="literal">&#13;
      index_builder.py&#13;
     </html:code>&#13;
     module. This module takes care of Index creation. In the current implementation, it creates two Indexes: a&#13;
     <html:code class="literal">&#13;
      VectorStoreIndex&#13;
     </html:code>&#13;
     and a&#13;
     <html:code class="literal">&#13;
      TreeIndex&#13;
     </html:code>&#13;
     . As you can see, this is a very basic implementation and there is definitely&#13;
     <html:a id="_idIndexMarker512">&#13;
     </html:a>&#13;
     room for improvement. Let’s handle the&#13;
     <html:span class="No-Break">&#13;
      imports first:&#13;
     </html:span>&#13;
    </html:p>&#13;
    <html:p>&#13;
     Next, we’ll implement our Index&#13;
     <html:span class="No-Break">&#13;
      building function:&#13;
     </html:span>&#13;
    </html:p>&#13;
    <html:p>&#13;
     We first check to see whether the Indexes have already been persisted to disk. If affirmative, then we leverage persistence to avoid the additional cost of&#13;
     <html:span class="No-Break">&#13;
      rebuilding them.&#13;
     </html:span>&#13;
    </html:p>&#13;
    <html:p class="callout-heading">&#13;
     Note on: Notice the usage of index_id&#13;
    </html:p>&#13;
    <html:p class="callout">&#13;
     Because we have persisted&#13;
     <html:a id="_idIndexMarker513">&#13;
     </html:a>&#13;
     more than one Index in the same storage folder –&#13;
     <html:code class="literal">&#13;
      INDEX_STORAGE&#13;
     </html:code>&#13;
     – when using&#13;
     <html:code class="literal">&#13;
      load_index_from_storage&#13;
     </html:code>&#13;
     , we need to specify their individual IDs so that LlamaIndex can identify the&#13;
     <html:span class="No-Break">&#13;
      correct Index.&#13;
     </html:span>&#13;
    </html:p>&#13;
    <html:p>&#13;
     If we cannot find them in the&#13;
     <html:code class="literal">&#13;
      INDEX_STORAGE&#13;
     </html:code>&#13;
     folder, we proceed to build them from the nodes. We also set an ID for each Index using&#13;
     <html:code class="literal">&#13;
      set_index_id&#13;
     </html:code>&#13;
     so that we can load them correctly&#13;
     <html:a id="_idIndexMarker514">&#13;
     </html:a>&#13;
     in&#13;
     <html:span class="No-Break">&#13;
      future sessions:&#13;
     </html:span>&#13;
    </html:p>&#13;
    <html:p>&#13;
     The&#13;
     <html:code class="literal">&#13;
      build_indexes&#13;
     </html:code>&#13;
     function returns the two Index objects that we’ll use later in&#13;
     <html:span class="No-Break">&#13;
      our application.&#13;
     </html:span>&#13;
    </html:p>&#13;
    <html:p>&#13;
     That’s it for now. We’ll take&#13;
     <html:a id="_idIndexMarker515">&#13;
     </html:a>&#13;
     the next steps during&#13;
     <html:a>&#13;
      <html:span class="No-Break">&#13;
       <html:em class="italic">&#13;
        Chapter 6&#13;
       </html:em>&#13;
      </html:span>&#13;
     </html:a>&#13;
     ,&#13;
     <html:em class="italic">&#13;
      Querying Our Data, Part 1 –&#13;
     </html:em>&#13;
     <html:span class="No-Break">&#13;
      <html:em class="italic">&#13;
       Context Retrieval&#13;
      </html:em>&#13;
     </html:span>&#13;
     <html:span class="No-Break">&#13;
      .&#13;
     </html:span>&#13;
    </html:p>&#13;
    <html:a id="_idTextAnchor129">&#13;
    </html:a>&#13;
   </html:div>&#13;
  </html:div>&#13;
 </html:body>&#13;
</html:html>
<html:html>&#13;
 <html:head>&#13;
  <html:title>&#13;
   Summary&#13;
  </html:title>&#13;
 </html:head>&#13;
 <html:body>&#13;
  <html:div class="epub-source">&#13;
   <html:h1 id="_idParaDest-130">&#13;
    Summary&#13;
   </html:h1>&#13;
   <html:div id="_idContainer052">&#13;
    <html:p>&#13;
     In this chapter, we explored various indexing strategies and architectures within LlamaIndex. Indexes provide essential capabilities for building performant&#13;
     <html:span class="No-Break">&#13;
      RAG systems.&#13;
     </html:span>&#13;
    </html:p>&#13;
    <html:p>&#13;
     Throughout the chapter, we looked at the&#13;
     <html:code class="literal">&#13;
      VectorStoreIndex&#13;
     </html:code>&#13;
     , which is the most commonly used Index type. We also gained an understanding of embeddings, vector stores, similarity search, and storage contexts. These are key concepts related to&#13;
     <html:span class="No-Break">&#13;
      the&#13;
     </html:span>&#13;
     <html:span class="No-Break">&#13;
      <html:code class="literal">&#13;
       VectorStoreIndex&#13;
      </html:code>&#13;
     </html:span>&#13;
     <html:span class="No-Break">&#13;
      .&#13;
     </html:span>&#13;
    </html:p>&#13;
    <html:p>&#13;
     We also covered other Index types such as&#13;
     <html:code class="literal">&#13;
      SummaryIndex&#13;
     </html:code>&#13;
     for simple linear scans,&#13;
     <html:code class="literal">&#13;
      KeywordTableIndex&#13;
     </html:code>&#13;
     for keyword search,&#13;
     <html:code class="literal">&#13;
      TreeIndex&#13;
     </html:code>&#13;
     for hierarchical data, and&#13;
     <html:code class="literal">&#13;
      KnowledgeGraphIndex&#13;
     </html:code>&#13;
     for relationship-based queries.&#13;
     <html:code class="literal">&#13;
      ComposableGraph&#13;
     </html:code>&#13;
     was introduced as a tool for building multi-level Indexes, and cost estimation techniques were discussed together with&#13;
     <html:span class="No-Break">&#13;
      best practices.&#13;
     </html:span>&#13;
    </html:p>&#13;
    <html:p>&#13;
     Overall, this chapter provided an overview of indexing capabilities in LlamaIndex, laying the foundation for building sophisticated and efficient&#13;
     <html:span class="No-Break">&#13;
      RAG applications.&#13;
     </html:span>&#13;
    </html:p>&#13;
    <html:p>&#13;
     See you in&#13;
     <html:a>&#13;
      <html:span class="No-Break">&#13;
       <html:em class="italic">&#13;
        Chapter 6&#13;
       </html:em>&#13;
      </html:span>&#13;
     </html:a>&#13;
     , where we’ll discuss methods for querying our data&#13;
     <html:span class="No-Break">&#13;
      in LlamaIndex.&#13;
     </html:span>&#13;
    </html:p>&#13;
   </html:div>&#13;
  </html:div>&#13;
 </html:body>&#13;
</html:html>
<html:html>&#13;
 <html:head>&#13;
  <html:title>&#13;
   Part 3: Retrieving and Working with Indexed Data&#13;
  </html:title>&#13;
 </html:head>&#13;
 <html:body>&#13;
  <html:div class="epub-source">&#13;
   <html:h1 id="_idParaDest-131" lang="en-US">&#13;
    Part 3: Retrieving and Working with Indexed Data&#13;
   </html:h1>&#13;
   <html:div class="Content" id="_idContainer053">&#13;
   </html:div>&#13;
   <html:div id="_idContainer054">&#13;
    <html:p>&#13;
     This part progresses from exploring LlamaIndex’s querying capabilities within a RAG workflow, focusing on retrieval mechanisms, query mechanics, and advanced retrieval strategies, to refining these queries through post-processing techniques and integrating them into comprehensive query engines. It culminates in a practical examination of building chatbots and intelligent agents, covering various engine modes, agent architectures, and the implementation of conversational features, thereby equipping you with the knowledge to create dynamic, conversational&#13;
     <html:span class="No-Break">&#13;
      RAG interfaces.&#13;
     </html:span>&#13;
    </html:p>&#13;
    <html:p>&#13;
     This part has the&#13;
     <html:span class="No-Break">&#13;
      following chapters:&#13;
     </html:span>&#13;
    </html:p>&#13;
    <html:ul>&#13;
     <html:li>&#13;
      <html:a>&#13;
       <html:em class="italic">&#13;
        Chapter 6&#13;
       </html:em>&#13;
      </html:a>&#13;
      ,&#13;
      <html:em class="italic">&#13;
       Querying Our Data, Part 1 – Context Retrieval&#13;
      </html:em>&#13;
     </html:li>&#13;
     <html:li>&#13;
      <html:a>&#13;
       <html:em class="italic">&#13;
        Chapter 7&#13;
       </html:em>&#13;
      </html:a>&#13;
      ,&#13;
      <html:em class="italic">&#13;
       Querying Our Data, Part 2 – Postprocessing and Response Synthesis&#13;
      </html:em>&#13;
     </html:li>&#13;
     <html:li>&#13;
      <html:a>&#13;
       <html:em class="italic">&#13;
        Chapter 8&#13;
       </html:em>&#13;
      </html:a>&#13;
      ,&#13;
      <html:em class="italic">&#13;
       Building Chatbots and Agents with LlamaIndex&#13;
      </html:em>&#13;
     </html:li>&#13;
    </html:ul>&#13;
   </html:div>&#13;
   <html:div>&#13;
    <html:div id="_idContainer055">&#13;
    </html:div>&#13;
   </html:div>&#13;
   <html:div>&#13;
    <html:div id="_idContainer056">&#13;
    </html:div>&#13;
   </html:div>&#13;
   <html:div>&#13;
    <html:div class="Basic-Graphics-Frame" id="_idContainer057">&#13;
    </html:div>&#13;
   </html:div>&#13;
  </html:div>&#13;
 </html:body>&#13;
</html:html></body></html>