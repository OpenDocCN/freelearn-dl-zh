<html><head></head><body>
  <div id="_idContainer169">
   <h1 class="chapter-number" id="_idParaDest-168">
    <a id="_idTextAnchor170">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     9
    </span>
   </h1>
   <h1 id="_idParaDest-169">
    <a id="_idTextAnchor171">
    </a>
    <span class="koboSpan" id="kobo.2.1">
     Extending Behavior Trees
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.3.1">
     Understanding the nuances of behavior trees is crucial for game developers, as they enable them to have a firm grasp on creating responsive and more engaging AI characters.
    </span>
    <span class="koboSpan" id="kobo.3.2">
     This is why, in this chapter, we will embark on a deep dive into the inner workings and best practices of the behavior tree system for Unreal Engine; we will go through a thorough explanation of their functionality, most notably on how to create more complex custom tasks, services, and decorators for our AI agents.
    </span>
    <span class="koboSpan" id="kobo.3.3">
     Additionally, we will go back to the debugging tools and see how to analyze behavior trees
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.4.1">
      at runtime.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.5.1">
     In this chapter, we will be covering the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.6.1">
      following topics:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.7.1">
      Presenting best practices for authoring
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.8.1">
       behavior trees
      </span>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.9.1">
       Understanding decorators
      </span>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.10.1">
       Understanding services
      </span>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.11.1">
       Understanding tasks
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.12.1">
      Debugging
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.13.1">
       behavior trees
      </span>
     </span>
    </li>
   </ul>
   <h1 id="_idParaDest-170">
    <a id="_idTextAnchor172">
    </a>
    <span class="koboSpan" id="kobo.14.1">
     Technical requirements
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.15.1">
     To follow the topics presented in this chapter, you should have completed the previous ones and understood
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.16.1">
      their content.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.17.1">
     Additionally, if you would prefer to begin with code from the companion repository for this book, you can download the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.18.1">
      .zip
     </span>
    </strong>
    <span class="koboSpan" id="kobo.19.1">
     project files provided in this book’s companion project
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.20.1">
      repository:
     </span>
    </span>
    <a href="https://github.com/PacktPublishing/Artificial-Intelligence-in-Unreal-Engine-5">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.21.1">
       https://github.com/PacktPublishing/Artificial-Intelligence-in-Unreal-Engine-5
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.22.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.23.1">
     To download the files from the end of the last chapter, click the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.24.1">
      Unreal Agility Arena –
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.25.1">
       Chapter 08
      </span>
     </strong>
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.26.1">
      -
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.27.1">
       End
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.28.1">
      link.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-171">
    <a id="_idTextAnchor173">
    </a>
    <span class="koboSpan" id="kobo.29.1">
     Presenting best practices for authoring behavior trees
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.30.1">
     It seems
    </span>
    <a id="_idIndexMarker389">
    </a>
    <span class="koboSpan" id="kobo.31.1">
     our little novel has a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.32.1">
      new chapter:
     </span>
    </span>
   </p>
   <p>
    <em class="italic">
     <span class="koboSpan" id="kobo.33.1">
      In their quest to test the capabilities of their AI puppets, Dr.
     </span>
     <span class="koboSpan" id="kobo.33.2">
      Markus and Professor Viktoria decided to equip them with Nerf guns.
     </span>
     <span class="koboSpan" id="kobo.33.3">
      The idea was to create a fun and engaging scenario where the puppets could showcase their newfound
     </span>
    </em>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.34.1">
       shooting skills.
      </span>
     </em>
    </span>
   </p>
   <p>
    <em class="italic">
     <span class="koboSpan" id="kobo.35.1">
      In the secret lab, the atmosphere buzzed with excitement as the puppets, now armed and ready with non-lethal weapons, were going to take on the challenge.
     </span>
     <span class="koboSpan" id="kobo.35.2">
      With their advanced AI programming and sensor systems, the puppets were able to analyze the environment, calculate trajectories, and take aim at the targets with
     </span>
    </em>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.36.1">
       remarkable accuracy.
      </span>
     </em>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.37.1">
     When designing a behavior tree for your AI agents, it is crucial to possess a thorough understanding of the best practices to consider.
    </span>
    <span class="koboSpan" id="kobo.37.2">
     Additionally, staying up to date with the latest advancements and research in the field of AI in the video game industry will provide valuable insights and inform your decision-making process when designing better
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.38.1">
      behavior trees.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-172">
    <a id="_idTextAnchor174">
    </a>
    <span class="koboSpan" id="kobo.39.1">
     Listing best practices
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.40.1">
     In this
    </span>
    <a id="_idIndexMarker390">
    </a>
    <span class="koboSpan" id="kobo.41.1">
     subsection, I will provide you with some valuable advice to optimize and enhance the engagement of your AIs; some of them come from well-known patterns, while some originate from my own personal experience – most of the time, acquired by a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.42.1">
      trial-and-error process.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.43.1">
     Use proper naming conventions
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.44.1">
     It is good
    </span>
    <a id="_idIndexMarker391">
    </a>
    <span class="koboSpan" id="kobo.45.1">
     practice to properly name any newly created tasks, decorators, or services in the behavior tree.
    </span>
    <span class="koboSpan" id="kobo.45.2">
     Use naming conventions that indicate the type of asset, be it a task, decorator, or service.
    </span>
    <span class="koboSpan" id="kobo.45.3">
     As a rule of thumb, you should use the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.46.1">
      following prefixes:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.47.1">
       BTTask_
      </span>
     </strong>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.48.1">
       for tasks
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.49.1">
       BTDecorator_
      </span>
     </strong>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.50.1">
       for decorators
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.51.1">
       BTService_
      </span>
     </strong>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.52.1">
       for services
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.53.1">
     This will not
    </span>
    <a id="_idIndexMarker392">
    </a>
    <span class="koboSpan" id="kobo.54.1">
     only help you in making it clear the type of asset you have created but you will also get a beneficial side effect; in the behavior tree graph, the system will recognize the type of class and will remove the prefix by showing just the node name.
    </span>
    <span class="koboSpan" id="kobo.54.2">
     The use of improper naming conventions would result in erratic behaviors when trying to select the nodes in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.55.1">
      node graph.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.56.1">
     As an example, in
    </span>
    <a href="B31016_08.xhtml#_idTextAnchor148">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.57.1">
        Chapter 8
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.58.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.59.1">
      Setting Up a Behavior Tree
     </span>
    </em>
    <span class="koboSpan" id="kobo.60.1">
     , you may have noticed that we named the battery check service
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.61.1">
      BTService_BatteryCheck
     </span>
    </strong>
    <span class="koboSpan" id="kobo.62.1">
     , but in the behavior tree graph, it is shown just as
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.63.1">
       Battery Check
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.64.1">
      .
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.65.1">
     Give your nodes a meaningful name
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.66.1">
     Behavior tree
    </span>
    <a id="_idIndexMarker393">
    </a>
    <span class="koboSpan" id="kobo.67.1">
     tasks, decorators, and services all have a property named
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.68.1">
      NodeName
     </span>
    </strong>
    <span class="koboSpan" id="kobo.69.1">
     that will be used to display the node name in the graph; use it if you want to give your nodes a different name than the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.70.1">
      class name.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.71.1">
     Avoid directly changing node properties
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.72.1">
     Instead
    </span>
    <a id="_idIndexMarker394">
    </a>
    <span class="koboSpan" id="kobo.73.1">
     of directly changing the properties of nodes within the behavior tree, you should leverage the power of Blackboards and change its keys.
    </span>
    <span class="koboSpan" id="kobo.73.2">
     Alternatively, you may call a function inside the character that makes the necessary modifications to keys.
    </span>
    <span class="koboSpan" id="kobo.73.3">
     This will help maintain a cleaner and more
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.74.1">
      organized structure.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.75.1">
     As an example, our previously created dummy puppet handles the battery logic through the character and some dedicated
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.76.1">
      Blackboard keys.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.77.1">
     Consider performance optimization
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.78.1">
     The
    </span>
    <a id="_idIndexMarker395">
    </a>
    <span class="koboSpan" id="kobo.79.1">
     behavior tree system in Unreal Engine is fundamentally optimized, as it avoids evaluating the entire tree at every frame and instead relies on success and fail notifications to determine the next node to execute.
    </span>
    <span class="koboSpan" id="kobo.79.2">
     However, it is important to exercise caution and not rely too heavily on certain features with the assumption that they will automatically function
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.80.1">
      as intended.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.81.1">
     As an example, in the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.82.1">
      Battery Check
     </span>
    </em>
    <span class="koboSpan" id="kobo.83.1">
     service we previously created, we disabled the tick interval, leveraging the power of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.84.1">
      delegates instead.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.85.1">
     Use modular design
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.86.1">
     Try breaking
    </span>
    <a id="_idIndexMarker396">
    </a>
    <span class="koboSpan" id="kobo.87.1">
     down complex behaviors into smaller, reusable modules such as tasks, services, and decorators.
    </span>
    <span class="koboSpan" id="kobo.87.2">
     This modular approach will make it easier to maintain and update the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.88.1">
      behavior tree.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.89.1">
     As an example of small tasks creating a more complex behavior, try checking the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.90.1">
      Roam Sequence
     </span>
    </strong>
    <span class="koboSpan" id="kobo.91.1">
     from the behavior tree implemented in
    </span>
    <a href="B31016_08.xhtml#_idTextAnchor148">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.92.1">
        Chapter 8
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.93.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.94.1">
      Setting Up a
     </span>
    </em>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.95.1">
       Behavior Tree
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.96.1">
      .
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.97.1">
     Do not assume your character is going to be an AI agent
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.98.1">
     When developing an AI character, you may be tempted to add AI logic directly into the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.99.1">
      Character
     </span>
    </strong>
    <span class="koboSpan" id="kobo.100.1">
     class.
    </span>
    <span class="koboSpan" id="kobo.100.2">
     However, it is generally advisable to avoid this practice.
    </span>
    <span class="koboSpan" id="kobo.100.3">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.101.1">
      AI Controller
     </span>
    </strong>
    <span class="koboSpan" id="kobo.102.1">
     class has been specifically designed to serve a purpose, offering a more structured and modular method for overseeing the AI behavior of characters.
    </span>
    <span class="koboSpan" id="kobo.102.2">
     By leveraging the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.103.1">
      AI Controller
     </span>
    </strong>
    <span class="koboSpan" id="kobo.104.1">
     class, you can effectively separate the AI logic from the character itself, resulting in enhanced maintainability and the ability to update the AI
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.105.1">
      behavior independently.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.106.1">
     As an example, having the capability of switching between an AI controller and a player controller at runtime can provide several advantages such as allowing a player to take control of an
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.107.1">
      AI character.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.108.1">
     As a rule of thumb, it is recommended to create your
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.109.1">
      Pawn
     </span>
    </strong>
    <span class="koboSpan" id="kobo.110.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.111.1">
      Character
     </span>
    </strong>
    <span class="koboSpan" id="kobo.112.1">
     classes in a way that allows them to be controlled by both players and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.113.1">
      AI interchangeably.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.114.1">
     Later in this chapter, we will be creating a brand-new AI agent with this
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.115.1">
      in mind.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.116.1">
     Debug and test often
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.117.1">
     Regularly test
    </span>
    <a id="_idIndexMarker397">
    </a>
    <span class="koboSpan" id="kobo.118.1">
     and debug your behavior tree to ensure it functions as intended.
    </span>
    <span class="koboSpan" id="kobo.118.2">
     Use debugging tools provided by Unreal Engine to identify and
    </span>
    <a id="_idIndexMarker398">
    </a>
    <span class="koboSpan" id="kobo.119.1">
     resolve
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.120.1">
      any issues.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.121.1">
     By the end of this chapter, I will be showing you how to properly use the debugging tools with your
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.122.1">
      behavior trees.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.123.1">
     Now that you have some additional information on how to create an AI agent effectively, it’s time to dive back into our project and begin crafting a brand-new character!
    </span>
    <span class="koboSpan" id="kobo.123.2">
     Let’s
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.124.1">
      get started!
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-173">
    <a id="_idTextAnchor175">
    </a>
    <span class="koboSpan" id="kobo.125.1">
     Implementing a gunner character logic
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.126.1">
     As a starting point, we
    </span>
    <a id="_idIndexMarker399">
    </a>
    <span class="koboSpan" id="kobo.127.1">
     will be creating a new AI character with some extra features; in particular, it will have some nice gunning capabilities to shoot at targets – by means of a non-lethal Nerf gun.
    </span>
    <span class="koboSpan" id="kobo.127.2">
     As mentioned earlier, it’s important to prioritize simplicity and modularity when working on your characters.
    </span>
    <span class="koboSpan" id="kobo.127.3">
     In this particular scenario, it doesn’t make sense to have the shooting logic integrated within the base character.
    </span>
    <span class="koboSpan" id="kobo.127.4">
     Instead, it would be more effective to take advantage of the capabilities provided by Unreal Engine components.
    </span>
    <span class="koboSpan" id="kobo.127.5">
     By doing so, you can keep the shooting functionality separate and modular, allowing for better organization and flexibility in your project.
    </span>
    <span class="koboSpan" id="kobo.127.6">
     As a final result, the AI agent will be capable of shooting at targets, by using
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.128.1">
      AI behaviors.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.129.1">
     Creating the BaseWeaponComponent class
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.130.1">
     To create a
    </span>
    <a id="_idIndexMarker400">
    </a>
    <span class="koboSpan" id="kobo.131.1">
     weapon component for our dummy character, we will start by extending a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.132.1">
      StaticMeshComponent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.133.1">
     class; this will give a good starting point – the mesh – and we will just need to add the socket attaching logic and the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.134.1">
      shooting logic.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.135.1">
     To start
    </span>
    <a id="_idIndexMarker401">
    </a>
    <span class="koboSpan" id="kobo.136.1">
     creating this component, from Unreal Engine, create a new C++ class extending from
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.137.1">
      StaticMeshComponent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.138.1">
     and name
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.139.1">
      it
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.140.1">
       BaseWeaponComponent
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.141.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.142.1">
     Once the class has been created, open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.143.1">
      BaseWeaponComponent.h
     </span>
    </strong>
    <span class="koboSpan" id="kobo.144.1">
     file and change the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.145.1">
      UCLASS()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.146.1">
     macro with this line
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.147.1">
      of code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.148.1">
UCLASS(BlueprintType, Blueprintable, ClassGroup="UnrealAgilityArena",
  meta=(BlueprintSpawnableComponent))</span></pre>
   <p>
    <span class="koboSpan" id="kobo.149.1">
     This will make the component accessible to Blueprints, and you can attach it directly to a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.150.1">
      Blueprint class.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.151.1">
     Now, inside the class, just after the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.152.1">
      GENERATED_BODY()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.153.1">
     macro, add the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.154.1">
      following declarations:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.155.1">
public:
    UBaseWeaponComponent();
    UFUNCTION(BlueprintCallable)
    virtual void Shoot();
    UPROPERTY(EditAnywhere, BlueprintReadWrite, Category="Bullet")
    TSubclassOf&lt;AActor&gt; BulletClass;
    UPROPERTY(EditAnywhere, BlueprintReadWrite, Category="Bullet")
    FVector MuzzleOffset = FVector(150, 30.f, 0.f);
protected:
    virtual void BeginPlay() override;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.156.1">
     Here, we
    </span>
    <a id="_idIndexMarker402">
    </a>
    <span class="koboSpan" id="kobo.157.1">
     are declaring the constructor, a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.158.1">
      Shoot()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.159.1">
     function that will spawn a bullet; then, we declare
    </span>
    <a id="_idIndexMarker403">
    </a>
    <span class="koboSpan" id="kobo.160.1">
     the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.161.1">
      BulletClass
     </span>
    </strong>
    <span class="koboSpan" id="kobo.162.1">
     property for the spawned bullet and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.163.1">
      MuzzleOffset
     </span>
    </strong>
    <span class="koboSpan" id="kobo.164.1">
     to precisely place the bullet spawn point.
    </span>
    <span class="koboSpan" id="kobo.164.2">
     Finally, in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.165.1">
      protected
     </span>
    </strong>
    <span class="koboSpan" id="kobo.166.1">
     section, we will need the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.167.1">
      BeginPlay()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.168.1">
     declaration to add
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.169.1">
      some initialization.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.170.1">
     We are now ready to implement the component, so open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.171.1">
      BaseWeaponComponent.cpp
     </span>
    </strong>
    <span class="koboSpan" id="kobo.172.1">
     file and, at the very top of it, add this line
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.173.1">
      of code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.174.1">
#include "BaseDummyCharacter.h"</span></pre>
   <p>
    <span class="koboSpan" id="kobo.175.1">
     Immediately after that, add the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.176.1">
      class constructor:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.177.1">
UBaseWeaponComponent::UBaseWeaponComponent()
{
    static ConstructorHelpers::FObjectFinder&lt;UStaticMesh&gt;       StaticMeshAsset(
       TEXT("/Game/KayKit/PrototypeBits/Models/Gun_Pistol.Gun_         Pistol"));
    if (StaticMeshAsset.Succeeded())
    {
       UStaticMeshComponent::SetStaticMesh(StaticMeshAsset.Object);
    }
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.178.1">
     This
    </span>
    <a id="_idIndexMarker404">
    </a>
    <span class="koboSpan" id="kobo.179.1">
     function is quite easy
    </span>
    <a id="_idIndexMarker405">
    </a>
    <span class="koboSpan" id="kobo.180.1">
     and straightforward as we are just declaring a default mesh – a Nerf gun pistol – for the component; you will be free to change it later on when extending this class with
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.181.1">
      a Blueprint.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.182.1">
     After that, add the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.183.1">
       BeginPlay()
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.184.1">
      implementation:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.185.1">
void UBaseWeaponComponent::BeginPlay()
{
    Super::BeginPlay();
    const auto Character = Cast&lt;ABaseDummyCharacter&gt;(GetOwner());
    if(Character == nullptr) return;
    AttachToComponent(Character-&gt;GetMesh(),       FAttachmentTransformRules::SnapToTargetIncludingScale,       "hand_right");
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.186.1">
     This function tries to cast the owner of the component to a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.187.1">
      Character
     </span>
    </strong>
    <span class="koboSpan" id="kobo.188.1">
     object, and if the cast is successful, it
    </span>
    <a id="_idIndexMarker406">
    </a>
    <span class="koboSpan" id="kobo.189.1">
     attaches the component to the mesh of the character at the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.190.1">
      hand_right
     </span>
    </strong>
    <span class="koboSpan" id="kobo.191.1">
     socket so that
    </span>
    <a id="_idIndexMarker407">
    </a>
    <span class="koboSpan" id="kobo.192.1">
     the gun will stay in the character’s right hand; I have already provided such a socket for you in the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.193.1">
      Dummy
     </span>
    </strong>
    <span class="koboSpan" id="kobo.194.1">
     skeletal mesh, as shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.195.1">
       Figure 9
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.196.1">
       .1
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.197.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer143">
     <span class="koboSpan" id="kobo.198.1">
      <img alt="Figure 9.1 – Hand socket" src="image/B31016_figure_09.01.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.199.1">
     Figure 9.1 – Hand socket
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.200.1">
     As a final step, it’s time to implement the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.201.1">
      Shoot()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.202.1">
     function logic, so add the following lines
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.203.1">
      of code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.204.1">
void UBaseWeaponComponent::Shoot()
{
    if (BulletClass == nullptr) return;
    auto const World = GetWorld();
    if (World == nullptr) return;
    const FRotator SpawnRotation = GetOwner()-&gt;GetActorRotation();
    const FVector SpawnLocation = GetOwner()-&gt;GetActorLocation() +       SpawnRotation.RotateVector(MuzzleOffset);
    FActorSpawnParameters ActorSpawnParams;
    ActorSpawnParams.SpawnCollisionHandlingOverride =       ESpawnActorCollisionHandlingMethod::AdjustIfPossibleButDont       SpawnIfColliding;
    World-&gt;SpawnActor&lt;AActor&gt;(BulletClass, SpawnLocation, SpawnRotation, ActorSpawnParams);
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.205.1">
     This
    </span>
    <a id="_idIndexMarker408">
    </a>
    <span class="koboSpan" id="kobo.206.1">
     function checks
    </span>
    <a id="_idIndexMarker409">
    </a>
    <span class="koboSpan" id="kobo.207.1">
     whether
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.208.1">
      BulletClass
     </span>
    </strong>
    <span class="koboSpan" id="kobo.209.1">
     is valid, gets the reference to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.210.1">
      World
     </span>
    </strong>
    <span class="koboSpan" id="kobo.211.1">
     – the top-level object that represents a map reference – then calculates the spawn location and rotation based on the owner’s position, and finally, spawns an actor using
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.212.1">
      BulletClass
     </span>
    </strong>
    <span class="koboSpan" id="kobo.213.1">
     at the calculated location
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.214.1">
      and rotation.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.215.1">
     The component is now ready; the next step will be to create a proper bullet to shoot at the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.216.1">
      right time.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.217.1">
     Creating the BaseBullet class
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.218.1">
     Having
    </span>
    <a id="_idIndexMarker410">
    </a>
    <span class="koboSpan" id="kobo.219.1">
     created a weapon component
    </span>
    <a id="_idIndexMarker411">
    </a>
    <span class="koboSpan" id="kobo.220.1">
     that spawns bullets, the next logical step is to create a spawnable bullet.
    </span>
    <span class="koboSpan" id="kobo.220.2">
     This is going to be quite straightforward; we will be creating an object with a mesh that will move forward, doing damage to anything that it will hit.
    </span>
    <span class="koboSpan" id="kobo.220.3">
     Let’s start by creating a new C++ class extending
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.221.1">
      Actor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.222.1">
     and calling it
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.223.1">
      BaseGunBullet
     </span>
    </strong>
    <span class="koboSpan" id="kobo.224.1">
     ; after the class has been created, open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.225.1">
      BaseGunBullet.h
     </span>
    </strong>
    <span class="koboSpan" id="kobo.226.1">
     header file and, just after the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.227.1">
      #include
     </span>
    </strong>
    <span class="koboSpan" id="kobo.228.1">
     section, add the following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.229.1">
      forward declarations:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.230.1">
class USphereComponent;
class UProjectileMovementComponent;
class UStaticMeshComponent;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.231.1">
     After that, change
    </span>
    <a id="_idIndexMarker412">
    </a>
    <span class="koboSpan" id="kobo.232.1">
     the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.233.1">
      UCLASS()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.234.1">
     macro so that this class is an acceptable base for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.235.1">
      creating Blueprints:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.236.1">
UCLASS(Blueprintable)</span></pre>
   <p>
    <span class="koboSpan" id="kobo.237.1">
     Now, just
    </span>
    <a id="_idIndexMarker413">
    </a>
    <span class="koboSpan" id="kobo.238.1">
     after the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.239.1">
      GENERATED_BODY()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.240.1">
     macro, add the needed
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.241.1">
      component declarations:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.242.1">
UPROPERTY(VisibleDefaultsOnly, Category="Projectile")
USphereComponent* CollisionComponent;
UPROPERTY(VisibleAnywhere, BlueprintReadOnly, Category="Projectile",   meta=(AllowPrivateAccess="true"))
UStaticMeshComponent* MeshComponent;
UPROPERTY(VisibleAnywhere, BlueprintReadOnly, Category="Movement",   meta=(AllowPrivateAccess="true"))
UProjectileMovementComponent* ProjectileMovementComponent;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.243.1">
     The next step is to declare the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.244.1">
      public
     </span>
    </strong>
    <span class="koboSpan" id="kobo.245.1">
     functions – that is, the constructor and the getters for the components – so add the following lines
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.246.1">
      of code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.247.1">
public:
   ABaseGunBullet();
    USphereComponent* GetCollision() const { return       CollisionComponent; }
    UProjectileMovementComponent* GetProjectileMovement() const {       return ProjectileMovementComponent; }
    UStaticMeshComponent* GetMesh() const { return MeshComponent; }</span></pre>
   <p>
    <span class="koboSpan" id="kobo.248.1">
     In the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.249.1">
      protected
     </span>
    </strong>
    <span class="koboSpan" id="kobo.250.1">
     section, remove the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.251.1">
      BeginPlay()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.252.1">
     declaration as it won’t be needed.
    </span>
    <span class="koboSpan" id="kobo.252.2">
     Instead, we will need the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.253.1">
      OnHit()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.254.1">
     handler for bullet
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.255.1">
      collision events:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.256.1">
protected:
    virtual void BeginPlay() override;
    UFUNCTION()
    void OnHit(UPrimitiveComponent* HitComp, AActor* OtherActor,       UPrimitiveComponent* OtherComp, FVector NormalImpulse, const         FHitResult&amp; Hit);</span></pre>
   <p>
    <span class="koboSpan" id="kobo.257.1">
     Now
    </span>
    <a id="_idIndexMarker414">
    </a>
    <span class="koboSpan" id="kobo.258.1">
     that the header is complete, it’s time
    </span>
    <a id="_idIndexMarker415">
    </a>
    <span class="koboSpan" id="kobo.259.1">
     to start implementing the class, so open up
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.260.1">
      BaseGunBullet.cpp
     </span>
    </strong>
    <span class="koboSpan" id="kobo.261.1">
     .
    </span>
    <span class="koboSpan" id="kobo.261.2">
     As a first step, add the needed
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.262.1">
      #include
     </span>
    </strong>
    <span class="koboSpan" id="kobo.263.1">
     declarations at the top of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.264.1">
      the file:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.265.1">
#include "GameFramework/ProjectileMovementComponent.h"
#include "Components/SphereComponent.h"
#include "Components/StaticMeshComponent.h"
#include "Engine/DamageEvents.h"</span></pre>
   <p>
    <span class="koboSpan" id="kobo.266.1">
     Next, remove the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.267.1">
      BeginPlay()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.268.1">
     implementation, which, as I previously said, won’t be needed.
    </span>
    <span class="koboSpan" id="kobo.268.2">
     After that, add the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.269.1">
      constructor implementation:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.270.1">
ABaseGunBullet::ABaseGunBullet()
{
    PrimaryActorTick.bCanEverTick = false;
    InitialLifeSpan = 10.0f;
    CollisionComponent =       CreateDefaultSubobject&lt;USphereComponent&gt;(TEXT("Collision"));
    CollisionComponent-&gt;InitSphereRadius(20.0f);
    CollisionComponent-&gt;BodyInstance.      SetCollisionProfileName("BlockAll");
    CollisionComponent-&gt;OnComponentHit.AddDynamic(this,       &amp;ABaseGunBullet::OnHit);
    CollisionComponent-&gt;SetWalkableSlopeOverride       (FWalkableSlopeOverride(WalkableSlope_Unwalkable, 0.f));
    CollisionComponent-&gt;CanCharacterStepUpOn = ECB_No;
    RootComponent = CollisionComponent;
    ProjectileMovementComponent = 
      CreateDefaultSubobject&lt;UProjectileMovementComponent&gt;(TEXT         ("Projectile"));
    ProjectileMovementComponent-&gt;UpdatedComponent =       CollisionComponent;
    ProjectileMovementComponent-&gt;InitialSpeed = 1800.f;
    ProjectileMovementComponent-&gt;MaxSpeed = 1800.f;
    ProjectileMovementComponent-&gt;bRotationFollowsVelocity = true;
    ProjectileMovementComponent-&gt;ProjectileGravityScale = 0.f;
    MeshComponent =       CreateDefaultSubobject&lt;UStaticMeshComponent&gt;(TEXT("Mesh"));
    MeshComponent-&gt;SetupAttachment(RootComponent);
    MeshComponent-&gt;SetRelativeRotation(FRotator(0.f, -90.f, 0.f));
    MeshComponent-&gt;SetRelativeScale3D(FVector(2.f, 2.f, 2.f));
   static ConstructorHelpers::FObjectFinder&lt;UStaticMesh&gt;      StaticMeshAsset(
       TEXT("/Game/KayKit/PrototypeBits/Models/Bullet.Bullet"));
   if (StaticMeshAsset.Succeeded())
    {
       MeshComponent-&gt;SetStaticMesh(StaticMeshAsset.Object);
    }
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.271.1">
     Most of
    </span>
    <a id="_idIndexMarker416">
    </a>
    <span class="koboSpan" id="kobo.272.1">
     the
    </span>
    <a id="_idIndexMarker417">
    </a>
    <span class="koboSpan" id="kobo.273.1">
     aforementioned code has been addressed previously or is self-explanatory, although there are some important things to mention.
    </span>
    <span class="koboSpan" id="kobo.273.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.274.1">
      CollisionComponent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.275.1">
     collision profile name has been set to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.276.1">
      BlockAll
     </span>
    </strong>
    <span class="koboSpan" id="kobo.277.1">
     , in order to get proper collisions; additionally, we have bound the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.278.1">
      OnComponentHit
     </span>
    </strong>
    <span class="koboSpan" id="kobo.279.1">
     delegate to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.280.1">
      OnHit()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.281.1">
     method, in order to react to any
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.282.1">
      bullet collisions.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.283.1">
     We can now add the final method implementation, which will handle the bullet hitting
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.284.1">
      any object:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.285.1">
void ABaseGunBullet::OnHit(UPrimitiveComponent* HitComp, AActor*   OtherActor, UPrimitiveComponent* OtherComp, FVector NormalImpulse,     const FHitResult&amp; Hit)
{
    if (OtherActor != nullptr &amp;&amp; OtherActor != this)
    {
       const auto DamageEvt = FDamageEvent();
       OtherActor-&gt;TakeDamage(1.f, DamageEvt, nullptr, nullptr);
    }
    Destroy();
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.286.1">
     As you can see, we just call the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.287.1">
      TakeDamage()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.288.1">
     method to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.289.1">
      Actor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.290.1">
     object that has been hit and then we destroy the bullet.
    </span>
    <span class="koboSpan" id="kobo.290.2">
     No need to worry about damage parameters in this game!
    </span>
    <span class="koboSpan" id="kobo.290.3">
     They
    </span>
    <a id="_idIndexMarker418">
    </a>
    <span class="koboSpan" id="kobo.291.1">
     aren’t the focus of this book, so you have the freedom to add your own damage logic and stick to it if you’d like.
    </span>
    <span class="koboSpan" id="kobo.291.2">
     Feel free to customize the game to your
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.292.1">
      heart’s content!
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.293.1">
     Now that we’ve finalized the bullet class, it’s time to create a suitable target
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.294.1">
      for it.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-174">
    <a id="_idTextAnchor176">
    </a>
    <span class="koboSpan" id="kobo.295.1">
     Implementing a Target class
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.296.1">
     We now
    </span>
    <a id="_idIndexMarker419">
    </a>
    <span class="koboSpan" id="kobo.297.1">
     need to create a base actor that we will be using to implement a target for our shooting AI agent.
    </span>
    <span class="koboSpan" id="kobo.297.2">
     So, let’s start by creating a new C++ class extending from
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.298.1">
      Actor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.299.1">
     and call it
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.300.1">
      BaseTarget
     </span>
    </strong>
    <span class="koboSpan" id="kobo.301.1">
     .
    </span>
    <span class="koboSpan" id="kobo.301.2">
     Once the class has been created, open up the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.302.1">
      BaseTarget.h
     </span>
    </strong>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.303.1">
      header file.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.304.1">
     As a first step, add this forward declaration just after the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.305.1">
      #
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.306.1">
       include
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.307.1">
      section:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.308.1">
class UStaticMeshComponent;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.309.1">
     Next, remove the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.310.1">
      BeginPlay()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.311.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.312.1">
      Tick()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.313.1">
     functions as they won’t be needed, and add the following declarations just after the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.314.1">
       ABaseTarget()
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.315.1">
      constructor:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.316.1">
protected:
    UPROPERTY(VisibleAnywhere, BlueprintReadOnly,       Category="Projectile", meta=(AllowPrivateAccess="true"))
    UStaticMeshComponent* MeshComponent;
    virtual float TakeDamage(float DamageAmount, FDamageEvent const&amp;       DamageEvent, AController* EventInstigator, AActor* DamageCauser)         override;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.317.1">
     Apart from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.318.1">
      StaticMeshComponent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.319.1">
     property that will be used to show the target mesh, we have added the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.320.1">
      TakeDamage()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.321.1">
     declaration that will be used to handle hits
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.322.1">
      from bullets.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.323.1">
     Now, open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.324.1">
      BaseTarget.cpp
     </span>
    </strong>
    <span class="koboSpan" id="kobo.325.1">
     file and, after removing the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.326.1">
      BeginPlay()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.327.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.328.1">
      Tick()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.329.1">
     function implementations, change the constructor with the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.330.1">
      following code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.331.1">
ABaseTarget::ABaseTarget()
{
    PrimaryActorTick.bCanEverTick = false;
    MeshComponent =       CreateDefaultSubobject&lt;UStaticMeshComponent&gt;(TEXT("Mesh"));
    MeshComponent-&gt;SetupAttachment(RootComponent);
    MeshComponent-&gt;SetRelativeRotation(FRotator(0.f, -90.f, 0.f));
    RootComponent = MeshComponent;
    static ConstructorHelpers::FObjectFinder&lt;UStaticMesh&gt;       StaticMeshAsset(
    TEXT("/Game/KayKit/PrototypeBits/Models/target_stand_B_target_      stand_B.target_stand_B_target_stand_B"));
    if (StaticMeshAsset.Succeeded())
    {
       MeshComponent-&gt;SetStaticMesh(StaticMeshAsset.Object);
    }
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.332.1">
     By now, you
    </span>
    <a id="_idIndexMarker420">
    </a>
    <span class="koboSpan" id="kobo.333.1">
     should already be familiar with the previous code; after disabling the tick functionality for this actor, we proceeded to add and initialize a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.334.1">
      StaticMesh
     </span>
    </strong>
    <span class="koboSpan" id="kobo.335.1">
     component, which will serve the purpose of displaying a target in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.336.1">
      our project.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.337.1">
     Now, add the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.338.1">
      TakeDamage()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.339.1">
     implementation to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.340.1">
      your file:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.341.1">
float ABaseTarget::TakeDamage(float DamageAmount, FDamageEvent const&amp;   DamageEvent, AController* EventInstigator,
    AActor* DamageCauser)
{
    Tags[0] = "Untagged";
    return DamageAmount;
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.342.1">
     As you can see, the
    </span>
    <a id="_idIndexMarker421">
    </a>
    <span class="koboSpan" id="kobo.343.1">
     approach here is quite simple; we are merely using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.344.1">
      Untagged
     </span>
    </strong>
    <span class="koboSpan" id="kobo.345.1">
     keyword, which will invalidate the tag assigned to the parent object.
    </span>
    <span class="koboSpan" id="kobo.345.2">
     This effectively renders it invisible to the behavior tree task we will be constructing later in this chapter.
    </span>
    <span class="koboSpan" id="kobo.345.3">
     We don’t need to worry about damage logic; once a target has been it, it will just
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.346.1">
      be invalidated.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.347.1">
     Now that all the base classes have been created, we are ready to implement the needed Blueprints, including a brand-new
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.348.1">
      gunner character.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-175">
    <a id="_idTextAnchor177">
    </a>
    <span class="koboSpan" id="kobo.349.1">
     Creating the Blueprints
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.350.1">
     We
    </span>
    <a id="_idIndexMarker422">
    </a>
    <span class="koboSpan" id="kobo.351.1">
     will proceed with the creation of the Blueprints that will be instrumental in generating the new AI gunner agent.
    </span>
    <span class="koboSpan" id="kobo.351.2">
     Specifically, we will be working on the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.352.1">
      following components:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.353.1">
      The
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.354.1">
       spawnable bullet
      </span>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.355.1">
       The target
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.356.1">
      The gunner
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.357.1">
       character itself
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.358.1">
     Let’s start by creating the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.359.1">
      bullet Blueprint.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.360.1">
     Implementing the bullet Blueprint
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.361.1">
     The creation of
    </span>
    <a id="_idIndexMarker423">
    </a>
    <span class="koboSpan" id="kobo.362.1">
     the bullet Blueprint is quite straightforward.
    </span>
    <span class="koboSpan" id="kobo.362.2">
     Just follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.363.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.364.1">
      Open the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.365.1">
       Blueprints
      </span>
     </strong>
     <span class="koboSpan" id="kobo.366.1">
      folder in the Unreal Engine
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.367.1">
        Content Drawer
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.368.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.369.1">
      Right-click on it and select
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.370.1">
        Blueprint Class
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.371.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.372.1">
      From the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.373.1">
       All Classes
      </span>
     </strong>
     <span class="koboSpan" id="kobo.374.1">
      section,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.375.1">
       select
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.376.1">
        BaseGunBullet
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.377.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.378.1">
      Name the
     </span>
     <a id="_idIndexMarker424">
     </a>
     <span class="koboSpan" id="kobo.379.1">
      new asset
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.380.1">
       BP_GunBullet
      </span>
     </strong>
     <span class="koboSpan" id="kobo.381.1">
      .
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.382.1">
        Figure 9
       </span>
      </em>
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.383.1">
       .2
      </span>
     </em>
     <span class="koboSpan" id="kobo.384.1">
      shows the final
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.385.1">
       Blueprint class:
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer144">
     <span class="koboSpan" id="kobo.386.1">
      <img alt="Figure 9.2 – Gun bullet Blueprint" src="image/B31016_figure_09.02.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.387.1">
     Figure 9.2 – Gun bullet Blueprint
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.388.1">
     Implementing the target Blueprint
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.389.1">
     The
    </span>
    <a id="_idIndexMarker425">
    </a>
    <span class="koboSpan" id="kobo.390.1">
     creation of the target Blueprint is almost identical to the bullet one; we just need to add a tag to the object.
    </span>
    <span class="koboSpan" id="kobo.390.2">
     Do the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.391.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.392.1">
      Open the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.393.1">
       Blueprints
      </span>
     </strong>
     <span class="koboSpan" id="kobo.394.1">
      folder in the Unreal Engine
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.395.1">
        Content Drawer
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.396.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.397.1">
      Right-click on it and select
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.398.1">
        Blueprint Class
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.399.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.400.1">
      From the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.401.1">
       All Classes
      </span>
     </strong>
     <span class="koboSpan" id="kobo.402.1">
      section,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.403.1">
       select
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.404.1">
        BaseTarget
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.405.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.406.1">
      Name the new
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.407.1">
       asset
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.408.1">
        BP_Target
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.409.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.410.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.411.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.412.1">
      panel, look for the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.413.1">
       Tags
      </span>
     </strong>
     <span class="koboSpan" id="kobo.414.1">
      property in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.415.1">
       Actor
      </span>
     </strong>
     <span class="koboSpan" id="kobo.416.1">
      |
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.417.1">
       Advanced
      </span>
     </strong>
     <span class="koboSpan" id="kobo.418.1">
      category and hit the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.419.1">
       +
      </span>
     </strong>
     <span class="koboSpan" id="kobo.420.1">
      button to create a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.421.1">
       new tag.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.422.1">
      Name the tag
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.423.1">
       ShootingTarget
      </span>
     </strong>
     <span class="koboSpan" id="kobo.424.1">
      , as shown in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.425.1">
        Figure 9
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.426.1">
        .3
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.427.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer145">
     <span class="koboSpan" id="kobo.428.1">
      <img alt="Figure 9.3 – Target tag" src="image/B31016_figure_09.03.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.429.1">
     Figure 9.3 – Target tag
    </span>
   </p>
   <p>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.430.1">
       Figure 9
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.431.1">
      .4
     </span>
    </em>
    <span class="koboSpan" id="kobo.432.1">
     shows
    </span>
    <a id="_idIndexMarker426">
    </a>
    <span class="koboSpan" id="kobo.433.1">
     the final
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.434.1">
      Blueprint class:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer146">
     <span class="koboSpan" id="kobo.435.1">
      <img alt="Figure 9.4 – Target Blueprint" src="image/B31016_figure_09.04.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.436.1">
     Figure 9.4 – Target Blueprint
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.437.1">
     Implementing the gunner character Blueprint
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.438.1">
     It’s now time
    </span>
    <a id="_idIndexMarker427">
    </a>
    <span class="koboSpan" id="kobo.439.1">
     to create the gunner character as a Blueprint.
    </span>
    <span class="koboSpan" id="kobo.439.2">
     You are already familiar with the process, but here are the steps
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.440.1">
      to follow:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.441.1">
      Open the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.442.1">
       Blueprints
      </span>
     </strong>
     <span class="koboSpan" id="kobo.443.1">
      folder in the Unreal Engine
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.444.1">
        Content Drawer
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.445.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.446.1">
      Right-click on it and select
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.447.1">
        Blueprint Class
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.448.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.449.1">
      From the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.450.1">
       All Classes
      </span>
     </strong>
     <span class="koboSpan" id="kobo.451.1">
      section,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.452.1">
       select
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.453.1">
        BaseDummyCharacter
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.454.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.455.1">
      Name the new
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.456.1">
       asset
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.457.1">
        BP_GunnerDummy
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.458.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.459.1">
     We’ll add the AI controller later in this chapter, but we need to change a value in the Blueprint class in order to make our character properly work.
    </span>
    <span class="koboSpan" id="kobo.459.2">
     So, open this Blueprint and, in the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.460.1">
      Details
     </span>
    </strong>
    <span class="koboSpan" id="kobo.461.1">
     panel, locate the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.462.1">
      Use Controller Rotation Yaw
     </span>
    </strong>
    <span class="koboSpan" id="kobo.463.1">
     attribute in the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.464.1">
      Pawn
     </span>
    </strong>
    <span class="koboSpan" id="kobo.465.1">
     category; this will allow rotation of the character correctly when using AI logic later on.
    </span>
    <span class="koboSpan" id="kobo.465.2">
     Tick the value, as depicted in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.466.1">
       Figure 9
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.467.1">
       .5
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.468.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer147">
     <span class="koboSpan" id="kobo.469.1">
      <img alt="Figure 9.5 – Use Controller Rotation Yaw ticked" src="image/B31016_figure_09.05.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.470.1">
     Figure 9.5 – Use Controller Rotation Yaw ticked
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.471.1">
     This value
    </span>
    <a id="_idIndexMarker428">
    </a>
    <span class="koboSpan" id="kobo.472.1">
     will allow us to rotate the character through a task when shooting at
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.473.1">
      a target.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.474.1">
     Now, it’s time to add a proper weapon to the character.
    </span>
    <span class="koboSpan" id="kobo.474.2">
     To do this, follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.475.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.476.1">
      With the Blueprint character class open, locate the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.477.1">
       Components
      </span>
     </strong>
     <span class="koboSpan" id="kobo.478.1">
      panel and click the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.479.1">
       +
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.480.1">
        Add
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.481.1">
       button.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.482.1">
      Select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.483.1">
       UnrealAgilityArena
      </span>
     </strong>
     <span class="koboSpan" id="kobo.484.1">
      |
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.485.1">
       Base Weapon
      </span>
     </strong>
     <span class="koboSpan" id="kobo.486.1">
      to add this component to the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.487.1">
       Blueprint class.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.488.1">
      Select this newly added component and, in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.489.1">
       Bullet
      </span>
     </strong>
     <span class="koboSpan" id="kobo.490.1">
      category of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.491.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.492.1">
      panel, locate the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.493.1">
       Bullet Class
      </span>
     </strong>
     <span class="koboSpan" id="kobo.494.1">
      attribute; from its dropdown,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.495.1">
       select
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.496.1">
        BP_GunBullet
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.497.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.498.1">
     Now that we’ve got our character all primed and ready, it’s time to unleash its shooting prowess at
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.499.1">
      our command!
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.500.1">
     Making the weapon shoot
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.501.1">
     To make the
    </span>
    <a id="_idIndexMarker429">
    </a>
    <span class="koboSpan" id="kobo.502.1">
     shooting phase work properly, we will be
    </span>
    <a id="_idIndexMarker430">
    </a>
    <span class="koboSpan" id="kobo.503.1">
     using
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.504.1">
      Anim Notify
     </span>
    </strong>
    <span class="koboSpan" id="kobo.505.1">
     – an event that can be synchronized with animation sequences – so that we can call the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.506.1">
      Shoot()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.507.1">
     function at a specific point along the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.508.1">
      animation timeline.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.509.1">
     Note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.510.1">
     You might be curious about why we’re implementing this particular system instead of directly calling the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.511.1">
      Shoot()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.512.1">
     function from any part of our code.
    </span>
    <span class="koboSpan" id="kobo.512.2">
     Well, here’s the thing: the shoot animation has a duration, and the moment when the bullet should be spawned occurs somewhere within the animation.
    </span>
    <span class="koboSpan" id="kobo.512.3">
     This is where an Anim Notify comes into play.
    </span>
    <span class="koboSpan" id="kobo.512.4">
     By using
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.513.1">
      Anim Notify
     </span>
    </strong>
    <span class="koboSpan" id="kobo.514.1">
     , we can specify the exact moment within the animation when the bullet should
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.515.1">
      be spawned.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.516.1">
     An
    </span>
    <a id="_idIndexMarker431">
    </a>
    <span class="koboSpan" id="kobo.517.1">
     Anim Notify is
    </span>
    <a id="_idIndexMarker432">
    </a>
    <span class="koboSpan" id="kobo.518.1">
     created by extending the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.519.1">
      AnimNotify
     </span>
    </strong>
    <span class="koboSpan" id="kobo.520.1">
     class, so start by creating a new C++ class that extends
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.521.1">
      AnimNotify
     </span>
    </strong>
    <span class="koboSpan" id="kobo.522.1">
     and call it
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.523.1">
      AnimNotify_Shoot
     </span>
    </strong>
    <span class="koboSpan" id="kobo.524.1">
     .
    </span>
    <span class="koboSpan" id="kobo.524.2">
     Once the files have been created, open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.525.1">
      AnimNotify_Shoot.h
     </span>
    </strong>
    <span class="koboSpan" id="kobo.526.1">
     header file and, as a first step, change the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.527.1">
      UCLASS()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.528.1">
     macro declaration to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.529.1">
      the following:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.530.1">
UCLASS(const, hidecategories=Object, collapsecategories, Config = Game, meta=(DisplayName="Shoot"))</span></pre>
   <p>
    <span class="koboSpan" id="kobo.531.1">
     Without delving too deeply into the specifics, it is sufficient to say that these initialization settings are necessary for the class to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.532.1">
      function correctly.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.533.1">
     After that, add the following
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.534.1">
      public
     </span>
    </strong>
    <span class="koboSpan" id="kobo.535.1">
     declarations to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.536.1">
      the class:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.537.1">
public:
    UAnimNotify_Shoot();
   virtual void Notify(USkeletalMeshComponent* MeshComp,      UAnimSequenceBase* Animation, const FAnimNotifyEventReference&amp;        EventReference) override;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.538.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.539.1">
      UAnimNotify_Shoot()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.540.1">
     declaration is the constructor, which is quite self-explanatory, while the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.541.1">
      Notify()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.542.1">
     declaration will be called when an Anim Notify
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.543.1">
      is triggered.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.544.1">
     Now, open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.545.1">
      AnimNotify_Shoot.cpp
     </span>
    </strong>
    <span class="koboSpan" id="kobo.546.1">
     file and add the needed
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.547.1">
      #include
     </span>
    </strong>
    <span class="koboSpan" id="kobo.548.1">
     declarations at
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.549.1">
      its top:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.550.1">
#include "BaseDummyCharacter.h"
#include "BaseWeaponComponent.h"</span></pre>
   <p>
    <span class="koboSpan" id="kobo.551.1">
     After that, add the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.552.1">
      constructor implementation:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.553.1">
UAnimNotify_Shoot::UAnimNotify_Shoot():Super()
{
#if WITH_EDITORONLY_DATA
    NotifyColor = FColor(222, 142, 142, 255);
#endif
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.554.1">
     While not
    </span>
    <a id="_idIndexMarker433">
    </a>
    <span class="koboSpan" id="kobo.555.1">
     mandatory, this function allows you to customize the color of the notify label within the Unreal Engine Editor.
    </span>
    <span class="koboSpan" id="kobo.555.2">
     It’s quite handy,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.556.1">
      isn’t it?
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.557.1">
     On the other hand, the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.558.1">
      Notify()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.559.1">
     function holds significant importance for gameplay-related reasons, so add the following lines
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.560.1">
      of code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.561.1">
void UAnimNotify_Shoot::Notify(USkeletalMeshComponent* MeshComp, UAnimSequenceBase* Animation,
                               const FAnimNotifyEventReference&amp; EventReference)
{
    if(MeshComp == nullptr) return;
    const auto Character = Cast&lt;ABaseDummyCharacter&gt;      (MeshComp-&gt;GetOwner());
    if(Character == nullptr) return;
    const auto WeaponComponent = Character-&gt;      GetComponentByClass&lt;UBaseWeaponComponent&gt;();
    if(WeaponComponent == nullptr) return;
    WeaponComponent-&gt;Shoot();
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.562.1">
     This function looks for a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.563.1">
      BaseWeaponComponent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.564.1">
     instance, if any, and calls the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.565.1">
       Shoot()
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.566.1">
      function.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.567.1">
     Before adding this Anim Notify to the shoot animation, you will need to compile your project.
    </span>
    <span class="koboSpan" id="kobo.567.2">
     Once the new class is available, look for the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.568.1">
      AM_1H_Shoot
     </span>
    </strong>
    <span class="koboSpan" id="kobo.569.1">
     montage, which can be found in the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.570.1">
       Content/KayKit/PrototypeBits/Character/Animations
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.571.1">
      folder.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.572.1">
     Note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.573.1">
     In Unreal Engine, a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.574.1">
      montage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.575.1">
     refers
    </span>
    <a id="_idIndexMarker434">
    </a>
    <span class="koboSpan" id="kobo.576.1">
     to a specialized asset that allows you to create complex animations for characters or objects.
    </span>
    <span class="koboSpan" id="kobo.576.2">
     Montages are commonly used for defining sequences of related animation.
    </span>
    <span class="koboSpan" id="kobo.576.3">
     As montages are not part of this book’s focus, I have provided the needed ones
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.577.1">
      for you.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.578.1">
     Once you have
    </span>
    <a id="_idIndexMarker435">
    </a>
    <span class="koboSpan" id="kobo.579.1">
     opened the asset by double-clicking on it, you will notice that, in the asset timeline, there is a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.580.1">
      ShootNotify_C
     </span>
    </strong>
    <span class="koboSpan" id="kobo.581.1">
     label; this is an empty placeholder I have provided for you to let you know where the notify should
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.582.1">
      be placed.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer148">
     <span class="koboSpan" id="kobo.583.1">
      <img alt="Figure 9.6 – Animation montage" src="image/B31016_figure_09.06.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.584.1">
     Figure 9.6 – Animation montage
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.585.1">
     Right-click on that label and select
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.586.1">
      Replace
     </span>
    </strong>
    <span class="koboSpan" id="kobo.587.1">
     with
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.588.1">
      Notify
     </span>
    </strong>
    <span class="koboSpan" id="kobo.589.1">
     |
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.590.1">
      Shoot
     </span>
    </strong>
    <span class="koboSpan" id="kobo.591.1">
     to add an
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.592.1">
       AnimNotify_Shoot
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.593.1">
      instance.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer149">
     <span class="koboSpan" id="kobo.594.1">
      <img alt="Figure 9.7 – Shoot notify" src="image/B31016_figure_09.07.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.595.1">
     Figure 9.7 – Shoot notify
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.596.1">
     Now, whenever your AI agent plays this montage, it will get a notification from the montage itself that will call the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.597.1">
      Shoot()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.598.1">
     function.
    </span>
    <span class="koboSpan" id="kobo.598.2">
     Later in this chapter, we will be creating a
    </span>
    <a id="_idIndexMarker436">
    </a>
    <span class="koboSpan" id="kobo.599.1">
     dedicated task for our AI agent behavior tree, in order to play the montage but, if you want to test things out, you can simply use the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.600.1">
      Play Montage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.601.1">
     node in the Event Graph of
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.602.1">
      BP_GunnerDummyCharacter
     </span>
    </strong>
    <span class="koboSpan" id="kobo.603.1">
     , as shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.604.1">
       Figure 9
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.605.1">
       .8
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.606.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer150">
     <span class="koboSpan" id="kobo.607.1">
      <img alt="Figure 9.8 – Montage test" src="image/B31016_figure_09.08.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.608.1">
     Figure 9.8 – Montage test
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.609.1">
     Just ensure to remove this node after completing your testing to prevent your AI agent from exhibiting seemingly
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.610.1">
      erratic behaviors.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.611.1">
     In this section, I have provided insights on enhancing AI agents and behavior trees through best practices and tips from my own experience.
    </span>
    <span class="koboSpan" id="kobo.611.2">
     Following that, we established the foundation for a more advanced AI agent capable of shooting.
    </span>
    <span class="koboSpan" id="kobo.611.3">
     The upcoming section will focus on developing a custom decorator, adding a new layer of complexity to our project.
    </span>
    <span class="koboSpan" id="kobo.611.4">
     Exciting developments lie ahead for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.612.1">
      our endeavor!
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-176">
    <a id="_idTextAnchor178">
    </a>
    <span class="koboSpan" id="kobo.613.1">
     Understanding decorators
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.614.1">
     Decorators
    </span>
    <a id="_idIndexMarker437">
    </a>
    <span class="koboSpan" id="kobo.615.1">
     provide a way to add additional functionality or conditions to the execution of a portion of a behavior tree.
    </span>
    <span class="koboSpan" id="kobo.615.2">
     As you already know from previous chapters, decorators are attached to either a composite or a task node and determine whether a branch in the tree (or even a single node) can be executed.
    </span>
    <span class="koboSpan" id="kobo.615.3">
     By combining decorators with composite nodes, you can create behavior trees with prioritized behavior allowing for powerful logic capable of handling intricate scenarios.
    </span>
    <span class="koboSpan" id="kobo.615.4">
     In
    </span>
    <a href="B31016_08.xhtml#_idTextAnchor148">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.616.1">
        Chapter 8
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.617.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.618.1">
      Setting Up a Behavior Tree
     </span>
    </em>
    <span class="koboSpan" id="kobo.619.1">
     , we used some built-in decorators but, in this section, I will give you more detailed information about creating your own
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.620.1">
      custom decorators.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-177">
    <a id="_idTextAnchor179">
    </a>
    <span class="koboSpan" id="kobo.621.1">
     Explaining the BTAuxiliaryNode class
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.622.1">
     Both
    </span>
    <a id="_idIndexMarker438">
    </a>
    <span class="koboSpan" id="kobo.623.1">
     decorators and services inherit from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.624.1">
      BTAuxiliaryNode
     </span>
    </strong>
    <span class="koboSpan" id="kobo.625.1">
     class, which
    </span>
    <a id="_idIndexMarker439">
    </a>
    <span class="koboSpan" id="kobo.626.1">
     will let you implement the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.627.1">
      following functions:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.628.1">
       OnBecomeRelevant()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.629.1">
      : This will be called when the auxiliary node – the one the decorator or service is attached to –
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.630.1">
       becomes active
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.631.1">
       OnCeaseRelevant()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.632.1">
      : This will be executed when the auxiliary node
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.633.1">
       becomes inactive
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.634.1">
       TickNode()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.635.1">
      : This will be executed at each auxiliary
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.636.1">
       node tick
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.637.1">
     In
    </span>
    <a href="B31016_08.xhtml#_idTextAnchor148">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.638.1">
        Chapter 8
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.639.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.640.1">
      Setting Up a Behavior Tree
     </span>
    </em>
    <span class="koboSpan" id="kobo.641.1">
     , I presented you with some of these functions, so it’s good to know where they
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.642.1">
      come from.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-178">
    <a id="_idTextAnchor180">
    </a>
    <span class="koboSpan" id="kobo.643.1">
     Creating C++ decorators
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.644.1">
     A
    </span>
    <a id="_idIndexMarker440">
    </a>
    <span class="koboSpan" id="kobo.645.1">
     decorator
    </span>
    <a id="_idIndexMarker441">
    </a>
    <span class="koboSpan" id="kobo.646.1">
     extends from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.647.1">
      BTDecorator
     </span>
    </strong>
    <span class="koboSpan" id="kobo.648.1">
     class, and in C++, its main implementable functions are
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.649.1">
      as follows:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.650.1">
       OnNodeActivation()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.651.1">
      : This is called when the underlying node
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.652.1">
       is activated
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.653.1">
       OnNodeDeactivation()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.654.1">
      : This is called when the underlying node
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.655.1">
       is deactivated
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.656.1">
       OnNodeProcessed()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.657.1">
      : This is called when the underlying node is deactivated or fails
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.658.1">
       to activate
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.659.1">
       CalculateRawConditionalValue()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.660.1">
      : This computes the value of the decorator condition without considering the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.661.1">
       inverse condition
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.662.1">
     Additionally, you can use the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.663.1">
      IsInversed()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.664.1">
     function to check whether the decorator will handle the inversed
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.665.1">
      conditional value.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-179">
    <a id="_idTextAnchor181">
    </a>
    <span class="koboSpan" id="kobo.666.1">
     Creating Blueprint decorators
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.667.1">
     Whenever
    </span>
    <a id="_idIndexMarker442">
    </a>
    <span class="koboSpan" id="kobo.668.1">
     creating a decorator with Blueprints
    </span>
    <a id="_idIndexMarker443">
    </a>
    <span class="koboSpan" id="kobo.669.1">
     Visual Scripting, you should extend from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.670.1">
      BTDecorator_BlueprintBase
     </span>
    </strong>
    <span class="koboSpan" id="kobo.671.1">
     class, which includes some additional code logic and events, in order to better manage it.
    </span>
    <span class="koboSpan" id="kobo.671.2">
     You can create a decorator in the usual way – from
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.672.1">
      Content Drawer
     </span>
    </strong>
    <span class="koboSpan" id="kobo.673.1">
     – or you can select the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.674.1">
      New Decorator
     </span>
    </strong>
    <span class="koboSpan" id="kobo.675.1">
     button from the behavior tree graph, as shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.676.1">
       Figure 9
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.677.1">
       .9
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.678.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer151">
     <span class="koboSpan" id="kobo.679.1">
      <img alt="Figure 9.9 – Decorator creation" src="image/B31016_figure_09.09.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.680.1">
     Figure 9.9 – Decorator creation
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.681.1">
     The main
    </span>
    <a id="_idIndexMarker444">
    </a>
    <span class="koboSpan" id="kobo.682.1">
     events you will have at your disposal when working with Blueprint-generated decorators are
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.683.1">
      as follows:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.684.1">
       Receive Execution Start AI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.685.1">
      : This is called when the underlying node
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.686.1">
       is activated
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.687.1">
       Receive Execution Finish AI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.688.1">
      : This is called when the underlying node has finished executing
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.689.1">
       its logic
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.690.1">
       Receive Tick AI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.691.1">
      : This is called on
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.692.1">
       each tick
      </span>
     </span>
    </li>
   </ul>
   <div>
    <div class="IMG---Figure" id="_idContainer152">
     <span class="koboSpan" id="kobo.693.1">
      <img alt="Figure 9.10 – Decorator nodes" src="image/B31016_figure_09.10.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.694.1">
     Figure 9.10 – Decorator nodes
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.695.1">
     By keeping this in mind, you will have the ability to implement your own Blueprint decorators for your
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.696.1">
      AI agents.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.697.1">
     We are now going to implement our own decorator, one that will be checking a tag on
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.698.1">
      an actor.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-180">
    <a id="_idTextAnchor182">
    </a>
    <span class="koboSpan" id="kobo.699.1">
     Implementing the CheckTagOnActor decorator
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.700.1">
     Now is
    </span>
    <a id="_idIndexMarker445">
    </a>
    <span class="koboSpan" id="kobo.701.1">
     the perfect time to create
    </span>
    <a id="_idIndexMarker446">
    </a>
    <span class="koboSpan" id="kobo.702.1">
     our first decorator.
    </span>
    <span class="koboSpan" id="kobo.702.2">
     As you may recall, while implementing the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.703.1">
      BaseTarget
     </span>
    </strong>
    <span class="koboSpan" id="kobo.704.1">
     class, we ensured that whenever a target gets hit, its tag is set to an undefined value.
    </span>
    <span class="koboSpan" id="kobo.704.2">
     By implementing a decorator that checks an actor instance tag, we can determine whether the actor itself is a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.705.1">
      viable target.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.706.1">
     So, let’s start by creating a new C++ class extending
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.707.1">
      BTDecorator
     </span>
    </strong>
    <span class="koboSpan" id="kobo.708.1">
     , and let’s call it
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.709.1">
      BTDecorator_CheckTagOnActor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.710.1">
     .
    </span>
    <span class="koboSpan" id="kobo.710.2">
     Once the class has been created, open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.711.1">
      BTDecorator_CheckTagOnActor.h
     </span>
    </strong>
    <span class="koboSpan" id="kobo.712.1">
     file and add the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.713.1">
      following declarations:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.714.1">
protected:
   UBTDecorator_CheckTagOnActor();
   UPROPERTY(EditAnywhere, Category=TagCheck)
    FBlackboardKeySelector ActorToCheck;
   UPROPERTY(EditAnywhere, Category=TagCheck)
    FName TagName;
   virtual bool CalculateRawConditionValue(UBehaviorTreeComponent&amp; OwnerComp, uint8* NodeMemory) const override;
   virtual void InitializeFromAsset(UBehaviorTree&amp; Asset) override;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.715.1">
     As you can see, we will be using a Blackboard key value – the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.716.1">
      ActorToCheck
     </span>
    </strong>
    <span class="koboSpan" id="kobo.717.1">
     one – to check whether its referred value has a tag equal to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.718.1">
      TagName
     </span>
    </strong>
    <span class="koboSpan" id="kobo.719.1">
     .
    </span>
    <span class="koboSpan" id="kobo.719.2">
     This check will be handled by the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.720.1">
      CalculateRawConditionValue()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.721.1">
     function.
    </span>
    <span class="koboSpan" id="kobo.721.2">
     Additionally, we will need to initialize any asset-related data, and this is usually done in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.722.1">
      InitializeFromAsset()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.723.1">
     function, which is inherited by the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.724.1">
       BTNode
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.725.1">
      superclass.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.726.1">
     Now, open
    </span>
    <a id="_idIndexMarker447">
    </a>
    <span class="koboSpan" id="kobo.727.1">
     the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.728.1">
      BTDecorator_CheckTagOnActor.cpp
     </span>
    </strong>
    <span class="koboSpan" id="kobo.729.1">
     file to start implementing the functions.
    </span>
    <span class="koboSpan" id="kobo.729.2">
     Let’s start by adding the needed
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.730.1">
      #
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.731.1">
       include
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.732.1">
      files:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.733.1">
#include "BehaviorTree/BlackboardComponent.h"
#include "BehaviorTree/Blackboard/BlackboardKeyType_Object.h"</span></pre>
   <p>
    <span class="koboSpan" id="kobo.734.1">
     Next, let’s
    </span>
    <a id="_idIndexMarker448">
    </a>
    <span class="koboSpan" id="kobo.735.1">
     implement
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.736.1">
      the constructor:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.737.1">
UBTDecorator_CheckTagOnActor::UBTDecorator_CheckTagOnActor()
{
    NodeName = "Tag Condition";
    ActorToCheck.AddObjectFilter(this, GET_MEMBER_NAME_      CHECKED(UBTDecorator_CheckTagOnActor, ActorToCheck),         AActor::StaticClass());
    ActorToCheck.SelectedKeyName = FBlackboard::KeySelf;
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.738.1">
     What we are doing here, immediately after naming the node, holds significant importance.
    </span>
    <span class="koboSpan" id="kobo.738.2">
     We are filtering key values to only allow
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.739.1">
      Actor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.740.1">
     classes.
    </span>
    <span class="koboSpan" id="kobo.740.2">
     This step ensures that only valid Blackboard keys related to actors will be accepted, maintaining the integrity and appropriateness of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.741.1">
      the inputs.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.742.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.743.1">
      CalculateRawConditionValue()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.744.1">
     function is going to be
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.745.1">
      pretty straightforward:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.746.1">
bool UBTDecorator_CheckTagOnActor::CalculateRawConditionValue(UBehaviorTreeComponent&amp; OwnerComp,
                                                              uint8* NodeMemory) const
{
    const UBlackboardComponent* BlackboardComp = OwnerComp.      GetBlackboardComponent();
    if (BlackboardComp == nullptr) return false;
   const AActor* Actor = Cast&lt;AActor&gt;(BlackboardComp-     &gt;GetValue&lt;UBlackboardKeyType_Object&gt;(ActorToCheck.       SelectedKeyName));
    return Actor != nullptr &amp;&amp; Actor-&gt;ActorHasTag(TagName);
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.747.1">
     As you
    </span>
    <a id="_idIndexMarker449">
    </a>
    <span class="koboSpan" id="kobo.748.1">
     can see, we retrieve the
    </span>
    <a id="_idIndexMarker450">
    </a>
    <span class="koboSpan" id="kobo.749.1">
     Blackboard component and get the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.750.1">
      ActorToCheck
     </span>
    </strong>
    <span class="koboSpan" id="kobo.751.1">
     key in order to check whether there is a valid
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.752.1">
      Actor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.753.1">
     instance and whether it is tagged as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.754.1">
      a target.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.755.1">
     Now, implement the last
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.756.1">
      required function:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.757.1">
void UBTDecorator_CheckTagOnActor::InitializeFromAsset(UBehaviorTree&amp; Asset)
{
    Super::InitializeFromAsset(Asset);
    if (const UBlackboardData* BBAsset = GetBlackboardAsset();       ensure(BBAsset))
    {
       ActorToCheck.ResolveSelectedKey(*BBAsset);
    }
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.758.1">
     This function retrieves the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.759.1">
      BlackboardData
     </span>
    </strong>
    <span class="koboSpan" id="kobo.760.1">
     asset and resolves the selected key for
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.761.1">
      ActorToCheck
     </span>
    </strong>
    <span class="koboSpan" id="kobo.762.1">
     from
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.763.1">
      that asset.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.764.1">
     In this section, you have been provided with more advanced information about decorators, including specific considerations for implementing them in C++ or Blueprints.
    </span>
    <span class="koboSpan" id="kobo.764.2">
     Additionally, you have successfully created a custom decorator that will be utilized by our upcoming gunner AI agent.
    </span>
    <span class="koboSpan" id="kobo.764.3">
     This custom decorator will play a crucial role in creating the behavior and decision-making capabilities of the AI gunner agent, further improving its performance
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.765.1">
      and effectiveness.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.766.1">
     In the next section, I will be presenting you with some detailed information on how to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.767.1">
      implement services.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-181">
    <a id="_idTextAnchor183">
    </a>
    <span class="koboSpan" id="kobo.768.1">
     Understanding services
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.769.1">
     Since you
    </span>
    <a id="_idIndexMarker451">
    </a>
    <span class="koboSpan" id="kobo.770.1">
     are already acquainted with services from previous chapters, I will now provide you with additional information to further enrich your understanding of this topic.
    </span>
    <span class="koboSpan" id="kobo.770.2">
     Let’s explore these details to enhance your expertise in services within
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.771.1">
      behavior trees.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-182">
    <a id="_idTextAnchor184">
    </a>
    <span class="koboSpan" id="kobo.772.1">
     Creating C++ services
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.773.1">
     A service
    </span>
    <a id="_idIndexMarker452">
    </a>
    <span class="koboSpan" id="kobo.774.1">
     extends from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.775.1">
      BTService
     </span>
    </strong>
    <span class="koboSpan" id="kobo.776.1">
     class, and its main
    </span>
    <a id="_idIndexMarker453">
    </a>
    <span class="koboSpan" id="kobo.777.1">
     implementable function is
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.778.1">
      OnSearchStart()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.779.1">
     , which is executed when the behavior tree search enters the underlying branch.
    </span>
    <span class="koboSpan" id="kobo.779.2">
     You can use this to create some kind of initialization
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.780.1">
      if needed.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.781.1">
     Furthermore, it is important to remember that services extend the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.782.1">
      BTAuxiliaryNode
     </span>
    </strong>
    <span class="koboSpan" id="kobo.783.1">
     class, thereby inheriting all of its functions.
    </span>
    <span class="koboSpan" id="kobo.783.2">
     One particularly crucial function inherited by services is the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.784.1">
      TickNode()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.785.1">
     function, which plays a vital role in the implementation of services, as it governs the execution and periodic updating of the service node within the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.786.1">
      behavior tree.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-183">
    <a id="_idTextAnchor185">
    </a>
    <span class="koboSpan" id="kobo.787.1">
     Creating Blueprint services
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.788.1">
     When
    </span>
    <a id="_idIndexMarker454">
    </a>
    <span class="koboSpan" id="kobo.789.1">
     creating
    </span>
    <a id="_idIndexMarker455">
    </a>
    <span class="koboSpan" id="kobo.790.1">
     a service using Blueprints Visual Scripting, it is advisable to extend from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.791.1">
      BTService_BlueprintBase
     </span>
    </strong>
    <span class="koboSpan" id="kobo.792.1">
     class as it provides additional code logic and events that facilitate better management of the service itself.
    </span>
    <span class="koboSpan" id="kobo.792.2">
     Similar to decorators, there are two ways to create a
    </span>
    <a id="_idIndexMarker456">
    </a>
    <span class="koboSpan" id="kobo.793.1">
     service: the conventional method, which involves using
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.794.1">
      Content Drawer
     </span>
    </strong>
    <span class="koboSpan" id="kobo.795.1">
     , or selecting the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.796.1">
      New Service
     </span>
    </strong>
    <span class="koboSpan" id="kobo.797.1">
     button directly from the behavior tree graph, as shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.798.1">
       Figure 9
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.799.1">
       .11
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.800.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer153">
     <span class="koboSpan" id="kobo.801.1">
      <img alt="Figure 9.11 – Service creation" src="image/B31016_figure_09.11.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.802.1">
     Figure 9.11 – Service creation
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.803.1">
     The main
    </span>
    <a id="_idIndexMarker457">
    </a>
    <span class="koboSpan" id="kobo.804.1">
     events you will have at your disposal when working with Blueprint-generated services are
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.805.1">
      as follows:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.806.1">
       Receive Activation AI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.807.1">
      : This is called when the service
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.808.1">
       becomes active
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.809.1">
       Receive Deactivation AI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.810.1">
      : This is called when the service
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.811.1">
       becomes inactive
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.812.1">
       Receive Search Start AI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.813.1">
      : This is called when the behavior tree search enters the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.814.1">
       underlying branch
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.815.1">
       Receive Tick AI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.816.1">
      : This is called on
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.817.1">
       each tick
      </span>
     </span>
    </li>
   </ul>
   <div>
    <div class="IMG---Figure" id="_idContainer154">
     <span class="koboSpan" id="kobo.818.1">
      <img alt="Figure 9.12 – Service nodes" src="image/B31016_figure_09.12.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.819.1">
     Figure 9.12 – Service nodes
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.820.1">
     With this in mind, you will have the ability to implement your own Blueprint services for your
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.821.1">
      behavior trees.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.822.1">
     With this new knowledge at our disposal, let’s implement a new service that will let us handle the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.823.1">
      ammo state.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-184">
    <a id="_idTextAnchor186">
    </a>
    <span class="koboSpan" id="kobo.824.1">
     Implementing the SetAmmo service
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.825.1">
     We are
    </span>
    <a id="_idIndexMarker458">
    </a>
    <span class="koboSpan" id="kobo.826.1">
     now ready to start implementing our own service; you already have created a couple of them in
    </span>
    <a href="B31016_08.xhtml#_idTextAnchor148">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.827.1">
        Chapter 8
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.828.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.829.1">
      Setting Up a Behavior Tree
     </span>
    </em>
    <span class="koboSpan" id="kobo.830.1">
     , so you should be already familiar with some of the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.831.1">
      presented steps.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.832.1">
     In this case, we
    </span>
    <a id="_idIndexMarker459">
    </a>
    <span class="koboSpan" id="kobo.833.1">
     will need a service that will allow us to tell the Blackboard when a weapon has fired – and so needs reloading – or is ready to shoot.
    </span>
    <span class="koboSpan" id="kobo.833.2">
     As usual, let’s start by creating a new C++ class extending from
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.834.1">
      BT_Service
     </span>
    </strong>
    <span class="koboSpan" id="kobo.835.1">
     and call it
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.836.1">
      BTService_SetAmmo
     </span>
    </strong>
    <span class="koboSpan" id="kobo.837.1">
     .
    </span>
    <span class="koboSpan" id="kobo.837.2">
     Once it has been created, open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.838.1">
      BTService_SetAmmo.h
     </span>
    </strong>
    <span class="koboSpan" id="kobo.839.1">
     file and add the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.840.1">
      following declarations:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.841.1">
public:
    UBTService_SetAmmo();
protected:
    UPROPERTY(BlueprintReadOnly, EditAnywhere, Category="Blackboard")
    FBlackboardKeySelector NeedsReload;
    UPROPERTY(BlueprintReadOnly, EditAnywhere, Category="Blackboard")
    bool bKeyValue = false;
    virtual void OnBecomeRelevant(UBehaviorTreeComponent&amp; OwnerComp,       uint8* NodeMemory) override;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.842.1">
     You should already be familiar with most of the code here; let’s just say that we will be using a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.843.1">
      NeedsReload
     </span>
    </strong>
    <span class="koboSpan" id="kobo.844.1">
     Blackboard key as a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.845.1">
      bool
     </span>
    </strong>
    <span class="koboSpan" id="kobo.846.1">
     value to see whether the weapon ammo is depleted or not.
    </span>
    <span class="koboSpan" id="kobo.846.2">
     Now, open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.847.1">
      BTService_SetAmmo.cpp
     </span>
    </strong>
    <span class="koboSpan" id="kobo.848.1">
     file and add the following
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.849.1">
      #include
     </span>
    </strong>
    <span class="koboSpan" id="kobo.850.1">
     declaration at the top
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.851.1">
      of it:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.852.1">
#include "BehaviorTree/BlackboardComponent.h"</span></pre>
   <p>
    <span class="koboSpan" id="kobo.853.1">
     The constructor is going to be pretty straightforward as we want the service tick to be disabled and we want to execute it just when it
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.854.1">
      becomes relevant:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.855.1">
UBTService_SetAmmo::UBTService_SetAmmo()
{
    NodeName = "SetAmmo";
    bCreateNodeInstance = true;
    bNotifyBecomeRelevant = true;
    bNotifyTick = false;
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.856.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.857.1">
      OnBecomeRelevant()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.858.1">
     function
    </span>
    <a id="_idIndexMarker460">
    </a>
    <span class="koboSpan" id="kobo.859.1">
     will serve us just to set
    </span>
    <a id="_idIndexMarker461">
    </a>
    <span class="koboSpan" id="kobo.860.1">
     the Blackboard
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.861.1">
      key value:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.862.1">
void UBTService_SetAmmo::OnBecomeRelevant(UBehaviorTreeComponent&amp;   OwnerComp, uint8* NodeMemory)
{
    const auto BlackboardComp = OwnerComp.GetBlackboardComponent();
    if (BlackboardComp == nullptr) return;
    BlackboardComp-&gt;SetValueAsBool(NeedsReload.SelectedKeyName,       bKeyValue);
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.863.1">
     In this section, you have been provided with additional information about services, including specific considerations for implementing them in C++ or Blueprints.
    </span>
    <span class="koboSpan" id="kobo.863.2">
     Additionally, you have successfully created another custom service that will be used to handle your AI agent’s
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.864.1">
      gun ammo.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.865.1">
     In the next section, I will be presenting you with detailed information on how to implement tasks as we will be creating a couple more for our soon-to-be
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.866.1">
      gunner agent.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-185">
    <a id="_idTextAnchor187">
    </a>
    <span class="koboSpan" id="kobo.867.1">
     Understanding tasks
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.868.1">
     In this section, I will
    </span>
    <a id="_idIndexMarker462">
    </a>
    <span class="koboSpan" id="kobo.869.1">
     provide you with additional information to enhance your understanding of tasks.
    </span>
    <span class="koboSpan" id="kobo.869.2">
     Let’s explore these details together to further strengthen your grasp of tasks within the context of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.870.1">
      behavior trees.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-186">
    <a id="_idTextAnchor188">
    </a>
    <span class="koboSpan" id="kobo.871.1">
     Creating C++ tasks
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.872.1">
     A task
    </span>
    <a id="_idIndexMarker463">
    </a>
    <span class="koboSpan" id="kobo.873.1">
     extends from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.874.1">
      BTTask
     </span>
    </strong>
    <span class="koboSpan" id="kobo.875.1">
     class, and its main implementable
    </span>
    <a id="_idIndexMarker464">
    </a>
    <span class="koboSpan" id="kobo.876.1">
     functions are
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.877.1">
      as follows:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.878.1">
       ExecuteTask()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.879.1">
      : This will start the task execution and will return the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.880.1">
       task result
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.881.1">
       AbortTask()
      </span>
     </strong>
     <span class="koboSpan" id="kobo.882.1">
      : This will let you handle events where a task should
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.883.1">
       be stopped
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.884.1">
     This is usually all you need to create even a simple yet fully
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.885.1">
      working task.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-187">
    <a id="_idTextAnchor189">
    </a>
    <span class="koboSpan" id="kobo.886.1">
     Creating Blueprint tasks
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.887.1">
     When
    </span>
    <a id="_idIndexMarker465">
    </a>
    <span class="koboSpan" id="kobo.888.1">
     creating a task using Blueprints Visual Scripting, you
    </span>
    <a id="_idIndexMarker466">
    </a>
    <span class="koboSpan" id="kobo.889.1">
     will be extending from the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.890.1">
      BTTask_BlueprintBase
     </span>
    </strong>
    <span class="koboSpan" id="kobo.891.1">
     class as it provides additional code logic to facilitate its implementation.
    </span>
    <span class="koboSpan" id="kobo.891.2">
     As you may have guessed, there are two ways to create a task: the usual creation from
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.892.1">
      Content Drawer
     </span>
    </strong>
    <span class="koboSpan" id="kobo.893.1">
     , and the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.894.1">
      New Task
     </span>
    </strong>
    <span class="koboSpan" id="kobo.895.1">
     selection button directly from the behavior tree graph, as shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.896.1">
       Figure 9
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.897.1">
       .13
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.898.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer155">
     <span class="koboSpan" id="kobo.899.1">
      <img alt="Figure 9.13 – Task creation" src="image/B31016_figure_09.13.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.900.1">
     Figure 9.13 – Task creation
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.901.1">
     The main events you will have available when working with Blueprint-generated tasks are
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.902.1">
      as follows:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.903.1">
       Receive Execute AI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.904.1">
      : This is called when the task
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.905.1">
       is executed
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.906.1">
       Receive Abort AI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.907.1">
      : This is called when the task
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.908.1">
       is aborted
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.909.1">
       Receive Tick AI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.910.1">
      : This is called on
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.911.1">
       each tick
      </span>
     </span>
    </li>
   </ul>
   <div>
    <div class="IMG---Figure" id="_idContainer156">
     <span class="koboSpan" id="kobo.912.1">
      <img alt="Figure 9.14 – Task nodes" src="image/B31016_figure_09.14.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.913.1">
     Figure 9.14 – Task nodes
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.914.1">
     Keeping this in
    </span>
    <a id="_idIndexMarker467">
    </a>
    <span class="koboSpan" id="kobo.915.1">
     mind, you will possess the capability to implement your own Blueprint tasks for your
    </span>
    <a id="_idIndexMarker468">
    </a>
    <span class="koboSpan" id="kobo.916.1">
     behavior trees, and that’s exactly what we are going to do in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.917.1">
      next steps.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-188">
    <a id="_idTextAnchor190">
    </a>
    <span class="koboSpan" id="kobo.918.1">
     Implementing the PlayMontage task
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.919.1">
     As you
    </span>
    <a id="_idIndexMarker469">
    </a>
    <span class="koboSpan" id="kobo.920.1">
     already know, the shooting command for our AI agent is going to be controlled by an Anim Notify from an animation
    </span>
    <a id="_idIndexMarker470">
    </a>
    <span class="koboSpan" id="kobo.921.1">
     montage.
    </span>
    <span class="koboSpan" id="kobo.921.2">
     Unfortunately, there is no out-of-the-box task for executing montages from a behavior tree; a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.922.1">
      PlayAnimation
     </span>
    </strong>
    <span class="koboSpan" id="kobo.923.1">
     task is present, but it will not serve our purposes as it won’t handle montages really well.
    </span>
    <span class="koboSpan" id="kobo.923.2">
     Fortunately, with our existing strong understanding of tasks, implementing the code logic will be relatively straightforward.
    </span>
    <span class="koboSpan" id="kobo.923.3">
     Furthermore, having a task that plays montages will prove highly beneficial when handling other animation sequences, such as reloading bullets or celebrating when all targets have been successfully hit.
    </span>
    <span class="koboSpan" id="kobo.923.4">
     So, start by creating a new C++ class that extends
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.924.1">
      BTTask
     </span>
    </strong>
    <span class="koboSpan" id="kobo.925.1">
     and call it
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.926.1">
      BTTask_PlayMontage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.927.1">
     .
    </span>
    <span class="koboSpan" id="kobo.927.2">
     Inside the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.928.1">
      BTTask_PlayMontage.h
     </span>
    </strong>
    <span class="koboSpan" id="kobo.929.1">
     file, add the following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.930.1">
      self-explanatory declarations:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.931.1">
public:
   UPROPERTY(EditAnywhere, Category="Dummy Task")
   UAnimMontage* AnimMontage;
   virtual EBTNodeResult::Type ExecuteTask(UBehaviorTreeComponent&amp;      OwnerComp, uint8* NodeMemory) override;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.932.1">
     Inside the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.933.1">
      BTTask_PlayMontage.cpp
     </span>
    </strong>
    <span class="koboSpan" id="kobo.934.1">
     file, add the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.935.1">
      following implementation:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.936.1">
EBTNodeResult::Type UBTTask_PlayMontage::ExecuteTask(UBehaviorTreeComponent&amp; OwnerComp, uint8* NodeMemory)
{
    if(AnimMontage == nullptr) return EBTNodeResult::Failed;
    const auto Controller = OwnerComp.GetAIOwner();
    if(Controller == nullptr) return EBTNodeResult::Failed;
   const auto Character = Cast&lt;ACharacter&gt;     (Controller-&gt;GetCharacter());
    if(Character == nullptr) return EBTNodeResult::Failed;
    Character-&gt;PlayAnimMontage(AnimMontage, 1.f, FName("Default"));
    return EBTNodeResult::Succeeded;
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.937.1">
     This function
    </span>
    <a id="_idIndexMarker471">
    </a>
    <span class="koboSpan" id="kobo.938.1">
     simply executes the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.939.1">
      PlayAnimMontage()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.940.1">
     function on the character, returning a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.941.1">
      Succeeded
     </span>
    </strong>
    <span class="koboSpan" id="kobo.942.1">
     result.
    </span>
    <span class="koboSpan" id="kobo.942.2">
     If any of the needed
    </span>
    <a id="_idIndexMarker472">
    </a>
    <span class="koboSpan" id="kobo.943.1">
     references are not found, a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.944.1">
      Failed
     </span>
    </strong>
    <span class="koboSpan" id="kobo.945.1">
     result
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.946.1">
      is returned.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.947.1">
     With this task ready to go, we can implement a second one, the last one we will be needing in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.948.1">
      this chapter.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-189">
    <a id="_idTextAnchor191">
    </a>
    <span class="koboSpan" id="kobo.949.1">
     Implementing the FindAvailableTarget task
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.950.1">
     This task
    </span>
    <a id="_idIndexMarker473">
    </a>
    <span class="koboSpan" id="kobo.951.1">
     will have the sole aim of finding an
    </span>
    <a id="_idIndexMarker474">
    </a>
    <span class="koboSpan" id="kobo.952.1">
     available target by checking all actors with a predefined tag.
    </span>
    <span class="koboSpan" id="kobo.952.2">
     There is nothing fancy here, but we will be needing it, so create a new C++ class inheriting from
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.953.1">
      BBTask
     </span>
    </strong>
    <span class="koboSpan" id="kobo.954.1">
     and call it
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.955.1">
      BTTask_FindAvailableTarget
     </span>
    </strong>
    <span class="koboSpan" id="kobo.956.1">
     .
    </span>
    <span class="koboSpan" id="kobo.956.2">
     In the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.957.1">
      BTTask_FindAvailableTarget.h
     </span>
    </strong>
    <span class="koboSpan" id="kobo.958.1">
     header file, add the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.959.1">
      following declarations:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.960.1">
public:
    UBTTask_FindAvailableTarget();
   UPROPERTY(EditAnywhere, Category="Blackboard")
    FBlackboardKeySelector TargetActor;
    UPROPERTY(EditAnywhere, Category="Dummy Task")
    FName TargetTag;
protected:
    virtual EBTNodeResult::Type ExecuteTask(UBehaviorTreeComponent&amp;       OwnerComp, uint8* NodeMemory) override;</span></pre>
   <p>
    <span class="koboSpan" id="kobo.961.1">
     No need
    </span>
    <a id="_idIndexMarker475">
    </a>
    <span class="koboSpan" id="kobo.962.1">
     to
    </span>
    <a id="_idIndexMarker476">
    </a>
    <span class="koboSpan" id="kobo.963.1">
     add explanations here, so let’s open the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.964.1">
      BTTask_FindAvailableTarget.cpp
     </span>
    </strong>
    <span class="koboSpan" id="kobo.965.1">
     file and add the needed
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.966.1">
      #
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.967.1">
       include
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.968.1">
      declarations:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.969.1">
#include "BehaviorTree/BlackboardComponent.h"
#include "Kismet/GameplayStatics.h"</span></pre>
   <p>
    <span class="koboSpan" id="kobo.970.1">
     The constructor is just going to filter the type entries for the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.971.1">
       TargetValue
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.972.1">
      key:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.973.1">
UBTTask_FindAvailableTarget::UBTTask_FindAvailableTarget()
{
    NodeName = "Find Available Target";
    TargetActor.AddObjectFilter(this, GET_MEMBER_NAME_CHECKED(UBTTask_      FindAvailableTarget, TargetActor), AActor::StaticClass());
    TargetActor.SelectedKeyName = FBlackboard::KeySelf;
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.974.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.975.1">
      ExecuteTask()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.976.1">
     function will search through the level in order to find all
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.977.1">
      Actor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.978.1">
     instances
    </span>
    <a id="_idIndexMarker477">
    </a>
    <span class="koboSpan" id="kobo.979.1">
     correctly tagged and
    </span>
    <a id="_idIndexMarker478">
    </a>
    <span class="koboSpan" id="kobo.980.1">
     return a random element from the list.
    </span>
    <span class="koboSpan" id="kobo.980.2">
     Just add this piece
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.981.1">
      of code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.982.1">
EBTNodeResult::Type UBTTask_FindAvailableTarget::ExecuteTask   (UBehaviorTreeComponent&amp; OwnerComp, uint8* NodeMemory)
{
    const auto BlackboardComp = OwnerComp.GetBlackboardComponent();
    if (BlackboardComp == nullptr) { return EBTNodeResult::Failed; }
    TArray&lt;AActor*&gt; TargetList;
    UGameplayStatics::GetAllActorsWithTag(GetWorld(), TargetTag,       TargetList);
    if(TargetList.Num() == 0) { return EBTNodeResult::Failed; }
    const auto RandomTarget = TargetList[FMath::RandRange(0,       TargetList.Num() - 1)];
    BlackboardComp-&gt;SetValueAsObject(TargetActor.SelectedKeyName,       RandomTarget);
    return EBTNodeResult::Succeeded;
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.983.1">
     As you can see, a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.984.1">
      Succeeded
     </span>
    </strong>
    <span class="koboSpan" id="kobo.985.1">
     result is returned if at least one
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.986.1">
      Actor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.987.1">
     instance has
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.988.1">
      been found.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.989.1">
     In this
    </span>
    <a id="_idIndexMarker479">
    </a>
    <span class="koboSpan" id="kobo.990.1">
     section, we took a brief look at some of the key features of tasks and even added a couple more to our arsenal.
    </span>
    <span class="koboSpan" id="kobo.990.2">
     It seems like we are now well-prepared to embark on our journey with the gunner AI character.
    </span>
    <span class="koboSpan" id="kobo.990.3">
     While we are discussing this topic, it’s a great opportunity to
    </span>
    <a id="_idIndexMarker480">
    </a>
    <span class="koboSpan" id="kobo.991.1">
     explain the proper techniques for debugging a behavior tree.
    </span>
    <span class="koboSpan" id="kobo.991.2">
     So, let’s dive in and get started
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.992.1">
      with it!
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-190">
    <a id="_idTextAnchor192">
    </a>
    <span class="koboSpan" id="kobo.993.1">
     Debugging behavior trees
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.994.1">
     Debugging
    </span>
    <a id="_idIndexMarker481">
    </a>
    <span class="koboSpan" id="kobo.995.1">
     behavior trees with Unreal Engine is essential for ensuring the smooth and efficient functioning of your AI-driven games.
    </span>
    <span class="koboSpan" id="kobo.995.2">
     By carefully examining and analyzing the behavior tree’s execution, you can identify and resolve any issues or glitches that may arise during gameplay.
    </span>
    <span class="koboSpan" id="kobo.995.3">
     You already have some understanding of how to enable the debugging tools in Unreal Engine.
    </span>
    <span class="koboSpan" id="kobo.995.4">
     In this section, we will take a deep dive into the debugging feature specifically designed for behavior trees; before starting with the debugging tools, we’ll need to create a proper – and moderately complex –
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.996.1">
      behavior tree.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-191">
    <a id="_idTextAnchor193">
    </a>
    <span class="koboSpan" id="kobo.997.1">
     Creating the Blackboard
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.998.1">
     The
    </span>
    <a id="_idIndexMarker482">
    </a>
    <span class="koboSpan" id="kobo.999.1">
     Blackboard for the behavior tree is going to be straightforward; we need a couple of keys to keep a reference of the target and a flag to check whether the weapon needs reloading.
    </span>
    <span class="koboSpan" id="kobo.999.2">
     So, let’s start by doing
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1000.1">
      the following:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1001.1">
      Open
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1002.1">
       Content Drawer
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1003.1">
      and create a Blackboard asset in the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1004.1">
        Content/AI
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1005.1">
       folder.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1006.1">
      Name the asset
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1007.1">
       BB_GunnerDummy
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1008.1">
      and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1009.1">
       open it.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1010.1">
      Create a new key of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1011.1">
       bool
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1012.1">
      type and name
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1013.1">
       it
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1014.1">
        NeedsReload
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1015.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1016.1">
      Create a new key of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1017.1">
       Object
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1018.1">
      type and call
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1019.1">
       it
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1020.1">
        TargetActor
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1021.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.1022.1">
     You may
    </span>
    <a id="_idIndexMarker483">
    </a>
    <span class="koboSpan" id="kobo.1023.1">
     remember that while creating the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1024.1">
      BTTask_FindAvailableTarget
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1025.1">
     class, we decided to filter this key so that it will accept only the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1026.1">
      Actor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1027.1">
     type and not a generic
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1028.1">
      Object
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1029.1">
     one; this means you will need to set the base class for this key to an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1030.1">
      Actor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1031.1">
     type.
    </span>
    <span class="koboSpan" id="kobo.1031.2">
     To do this, follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1032.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1033.1">
      Select the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1034.1">
       TargetActor
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1035.1">
      key and, in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1036.1">
       Blackboard Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1037.1">
      panel, open the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1038.1">
       Key Type
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1039.1">
      option to show the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1040.1">
       Base
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1041.1">
        Class
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1042.1">
       attribute.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1043.1">
      From the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1044.1">
       Base Class
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1045.1">
      dropdown, select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1046.1">
       Actor
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1047.1">
      , as shown in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1048.1">
        Figure 9
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1049.1">
        .15
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1050.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer157">
     <span class="koboSpan" id="kobo.1051.1">
      <img alt="Figure 9.15 – Target Actor key" src="image/B31016_figure_09.15.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1052.1">
     Figure 9.15 – Target Actor key
    </span>
   </p>
   <h2 id="_idParaDest-192">
    <a id="_idTextAnchor194">
    </a>
    <span class="koboSpan" id="kobo.1053.1">
     Creating the behavior tree
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1054.1">
     The
    </span>
    <a id="_idIndexMarker484">
    </a>
    <span class="koboSpan" id="kobo.1055.1">
     behavior tree we are going to implement is going to have the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1056.1">
      following logic:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.1057.1">
      If the AI character has a valid target, it will shoot at it and then reload
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1058.1">
       the weapon
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1059.1">
      If no target is set, it will try to find one in the level and set the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1060.1">
       proper key
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1061.1">
      If no target is available in the level, it means all targets have been hit and the AI character will cheer
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1062.1">
       with happiness
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.1063.1">
     Start by doing
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1064.1">
      the following:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1065.1">
      In the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1066.1">
       Content/AI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1067.1">
      folder, create a new
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1068.1">
       Behavior Tree
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1069.1">
      asset and call
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1070.1">
       it
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1071.1">
        BT_GunnerDummy
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1072.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1073.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1074.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1075.1">
      panel, set the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1076.1">
       Blackboard Asset
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1077.1">
      attribute
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1078.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1079.1">
        BB_GunnerDummy
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1080.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1081.1">
      Connect a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1082.1">
       Selector
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1083.1">
      node to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1084.1">
       Root
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1085.1">
      node and call it
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1086.1">
       Root Selector
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1087.1">
      , as shown in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1088.1">
        Figure 9
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1089.1">
        .16
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1090.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer158">
     <span class="koboSpan" id="kobo.1091.1">
      <img alt="Figure 9.16 – The Root Selector node" src="image/B31016_figure_09.16.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1092.1">
     Figure 9.16 – The Root Selector node
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1093.1">
     As you may
    </span>
    <a id="_idIndexMarker485">
    </a>
    <span class="koboSpan" id="kobo.1094.1">
     remember, a selector node will execute the subtrees in sequence until one of them succeeds; this is exactly what we need to do in order to create our gunner
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1095.1">
      AI logic.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.1096.1">
     Adding the shooting logic
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.1097.1">
     The
    </span>
    <a id="_idIndexMarker486">
    </a>
    <span class="koboSpan" id="kobo.1098.1">
     shooting logic is going to be subdivided into two phases – shooting and reloading – so we are going to use another selector node.
    </span>
    <span class="koboSpan" id="kobo.1098.2">
     Let’s do
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1099.1">
      the following:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1100.1">
      From
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1101.1">
       Root Selector
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1102.1">
      , add another selector node and name it
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1103.1">
        Shoot Selector
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1104.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1105.1">
      Right-click on it, add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1106.1">
       CheckTagOnTarget
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1107.1">
      decorator, and name it
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1108.1">
       Is Actor
      </span>
     </strong>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1109.1">
        a Target?
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1110.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1111.1">
      Select this decorator and, in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1112.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1113.1">
      panel, do
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1114.1">
       the following:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1115.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1116.1">
         Actor to Check
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1117.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1118.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1119.1">
          TargetActor
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1120.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1121.1">
         Tag Name
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1122.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1123.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1124.1">
          ShootingTarget
         </span>
        </strong>
       </span>
      </li>
     </ul>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.1125.1">
     Basically, this selector will be executed only if there is a valid target in the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1126.1">
      TargetActor
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1127.1">
     key of the Blackboard; if not,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1128.1">
      Root Selector
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1129.1">
     will try executing the next subtree available.
    </span>
    <span class="koboSpan" id="kobo.1129.2">
     We need now to create the actual shooting logic, so start doing the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1130.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1131.1">
      Add a sequence node to
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1132.1">
       Shoot Selector
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1133.1">
      and name it
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1134.1">
        Shoot Sequence
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1135.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1136.1">
      Right-click on it, add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1137.1">
       Blackboard
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1138.1">
      decorator, and name it
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1139.1">
        Has Ammo?
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1140.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1141.1">
      Select the decorator and, in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1142.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1143.1">
      panel, do
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1144.1">
       the following:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1145.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1146.1">
         Notify Observers
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1147.1">
        attribute to
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1148.1">
         On
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1149.1">
          Value Change
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1150.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1151.1">
         Key Query
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1152.1">
        attribute to
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1153.1">
         Is
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1154.1">
          Not Set
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1155.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1156.1">
         Blackboard Key
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1157.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1158.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1159.1">
          NeedsReload
         </span>
        </strong>
       </span>
      </li>
     </ul>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.1160.1">
       This part
      </span>
      <a id="_idIndexMarker487">
      </a>
      <span class="koboSpan" id="kobo.1161.1">
       of the tree will execute only when the
      </span>
      <strong class="bold">
       <span class="koboSpan" id="kobo.1162.1">
        NeedsReload
       </span>
      </strong>
      <span class="koboSpan" id="kobo.1163.1">
       key is set to
      </span>
      <strong class="bold">
       <span class="koboSpan" id="kobo.1164.1">
        true
       </span>
      </strong>
      <span class="koboSpan" id="kobo.1165.1">
       ; otherwise, it will try to execute the next subtree.
      </span>
      <span class="koboSpan" id="kobo.1165.2">
       This portion of the tree graph should look like the one depicted in
      </span>
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.1166.1">
         Figure 9
        </span>
       </em>
      </span>
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.1167.1">
         .17
        </span>
       </em>
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.1168.1">
        :
       </span>
      </span>
     </p>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer159">
     <span class="koboSpan" id="kobo.1169.1">
      <img alt="Figure 9.17 – Starting shoot sequence" src="image/B31016_figure_09.17.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1170.1">
     Figure 9.17 – Starting shoot sequence
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.1171.1">
     Let’s add some nodes to
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.1172.1">
       Shoot Sequence
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1173.1">
      :
     </span>
    </span>
   </p>
   <ol>
    <li value="4">
     <span class="koboSpan" id="kobo.1174.1">
      Add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1175.1">
       Rotate to Face BBEntry
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1176.1">
      task and name it
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1177.1">
       Rotate
      </span>
     </strong>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1178.1">
        Towards Target
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1179.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1180.1">
      Select this node and, in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1181.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1182.1">
      panel, set the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1183.1">
       Blackboard Key
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1184.1">
      attribute
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1185.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1186.1">
        TargetActor
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1187.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1188.1">
      From
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1189.1">
       Shoot Sequence
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1190.1">
      , add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1191.1">
       Play Montage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1192.1">
      task and name it
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1193.1">
       Shoot Montage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1194.1">
      .
     </span>
     <span class="koboSpan" id="kobo.1194.2">
      Make sure that this task is at the right of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1195.1">
       Rotate Towards Target
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1196.1">
      task.
     </span>
     <span class="koboSpan" id="kobo.1196.2">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1197.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1198.1">
      panel, set the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1199.1">
       Anim Montage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1200.1">
      attribute
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1201.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1202.1">
        AM_1H_Shoot
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1203.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1204.1">
      Right-click on this task node, add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1205.1">
       Set Ammo
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1206.1">
      service, and name it
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1207.1">
        Deplete Ammo
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1208.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1209.1">
      Select this
     </span>
     <a id="_idIndexMarker488">
     </a>
     <span class="koboSpan" id="kobo.1210.1">
      service and do
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1211.1">
       the following:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1212.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1213.1">
         Needs Reload
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1214.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1215.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1216.1">
          NeedsReload
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1217.1">
        Check the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1218.1">
         Key
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1219.1">
          Value
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1220.1">
         attribute
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1221.1">
      From
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1222.1">
       Shoot Sequence
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1223.1">
      , add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1224.1">
       Wait
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1225.1">
      node and make sure that this task is at the right of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1226.1">
       Shoot Montage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1227.1">
      task.
     </span>
     <span class="koboSpan" id="kobo.1227.2">
      Select the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1228.1">
       Wait
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1229.1">
      node and do
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1230.1">
       the following:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1231.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1232.1">
         Wait Time
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1233.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1234.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.1235.1">
          2.0
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1236.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1237.1">
         Random Deviation
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1238.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1239.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.1240.1">
          0.5
         </span>
        </strong>
       </span>
      </li>
     </ul>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.1241.1">
     This portion of the behavior tree can be seen in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1242.1">
       Figure 9
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1243.1">
       .18
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1244.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer160">
     <span class="koboSpan" id="kobo.1245.1">
      <img alt="Figure 9.18 – Finished shoot sequence" src="image/B31016_figure_09.18.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1246.1">
     Figure 9.18 – Finished shoot sequence
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1247.1">
     One of the great things about behavior trees is that when you give descriptive names to your nodes, you can quickly understand what’s happening at a glance.
    </span>
    <span class="koboSpan" id="kobo.1247.2">
     By naming your nodes in a way that accurately reflects their purpose or function, you create a clear and intuitive visual representation of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1248.1">
      your AI.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1249.1">
     We can now start creating the reload sequence for the gun.
    </span>
    <span class="koboSpan" id="kobo.1249.2">
     Let’s start by following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1250.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1251.1">
      From
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1252.1">
       Shoot Selector
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1253.1">
      , add a new sequence node to the right of
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1254.1">
       Shoot Sequence
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1255.1">
      and name it
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1256.1">
        Reload Sequence
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1257.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1258.1">
      From
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1259.1">
       Reload Sequence
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1260.1">
      , add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1261.1">
       Play Montage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1262.1">
      task and name it
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1263.1">
       Reload Montage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1264.1">
      .
     </span>
     <span class="koboSpan" id="kobo.1264.2">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1265.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1266.1">
      panel, set the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1267.1">
       Anim Montage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1268.1">
      attribute
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1269.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1270.1">
        AM_1H_Reload
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1271.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1272.1">
      Right-click
     </span>
     <a id="_idIndexMarker489">
     </a>
     <span class="koboSpan" id="kobo.1273.1">
      on this task node, add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1274.1">
       Set Ammo
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1275.1">
      service, and name it
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1276.1">
        Refill Ammo
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1277.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1278.1">
      Select this service and do
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1279.1">
       the following:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1280.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1281.1">
         Needs Reload
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1282.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1283.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1284.1">
          NeedsReload
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1285.1">
        Leave the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1286.1">
         Key Value
        </span>
       </strong>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1287.1">
         attribute unchecked
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1288.1">
      From
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1289.1">
       Reload Sequence
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1290.1">
      , add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1291.1">
       Wait
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1292.1">
      node and make sure that this task is at the right of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1293.1">
       Reload Montage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1294.1">
      task.
     </span>
     <span class="koboSpan" id="kobo.1294.2">
      Select the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1295.1">
       Wait
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1296.1">
      node and do
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1297.1">
       the following:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1298.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1299.1">
         Wait Time
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1300.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1301.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.1302.1">
          3.0
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1303.1">
         .
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1304.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1305.1">
         Random Deviation
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1306.1">
        attribute to
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.1307.1">
         0.5
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1308.1">
        .
       </span>
       <span class="koboSpan" id="kobo.1308.2">
        This portion of the behavior tree can be seen in
       </span>
       <span class="No-Break">
        <em class="italic">
         <span class="koboSpan" id="kobo.1309.1">
          Figure 9.19
         </span>
        </em>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1310.1">
         :
        </span>
       </span>
      </li>
     </ul>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer161">
     <span class="koboSpan" id="kobo.1311.1">
      <img alt="Figure 9.19 – Reload sequence" src="image/B31016_figure_09.19.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1312.1">
     Figure 9.19 – Reload sequence
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1313.1">
     Whenever we enter this portion of the tree, start the reload animation while setting the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1314.1">
      NeedsReload
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1315.1">
     key to
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1316.1">
      false
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1317.1">
     , and we wait a bit before going on with the execution.
    </span>
    <span class="koboSpan" id="kobo.1317.2">
     With this portion of the behavior tree complete, we can implement the target
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1318.1">
      search portion.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.1319.1">
     Finding an available target
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.1320.1">
     Whenever there is no available target to shoot at,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1321.1">
      Root Selector
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1322.1">
     will execute the next subtree; in this
    </span>
    <a id="_idIndexMarker490">
    </a>
    <span class="koboSpan" id="kobo.1323.1">
     case, we will be looking for a new viable target.
    </span>
    <span class="koboSpan" id="kobo.1323.2">
     To do this, follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1324.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1325.1">
      From
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1326.1">
       Root Selector
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1327.1">
      , add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1328.1">
       FindAvailableTarget
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1329.1">
      task at the right of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1330.1">
       Shoot
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1331.1">
        Selector
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1332.1">
       node.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1333.1">
      Select the task and do
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1334.1">
       the following:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1335.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1336.1">
         Target Actor
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1337.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1338.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1339.1">
          TargetActor
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1340.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1341.1">
         Target Tag
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1342.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1343.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.1344.1">
          ShootingTarget
         </span>
        </strong>
       </span>
      </li>
     </ul>
    </li>
   </ol>
   <p>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1345.1">
       Figure 9
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1346.1">
      .20
     </span>
    </em>
    <span class="koboSpan" id="kobo.1347.1">
     shows this portion of the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1348.1">
      behavior tree:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer162">
     <span class="koboSpan" id="kobo.1349.1">
      <img alt="Figure 9.20 – Find target task" src="image/B31016_figure_09.20.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1350.1">
     Figure 9.20 – Find target task
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1351.1">
     It’s now time to add the third and last part of the behavior
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1352.1">
      tree logic.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.1353.1">
     Finishing the AI logic
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.1354.1">
     The
    </span>
    <a id="_idIndexMarker491">
    </a>
    <span class="koboSpan" id="kobo.1355.1">
     last portion of the code will be to make the AI character cheer when all targets have been hit.
    </span>
    <span class="koboSpan" id="kobo.1355.2">
     To do so, follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1356.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1357.1">
      From
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1358.1">
       Root Selector
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1359.1">
      , add a sequence node at the right of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1360.1">
       Find Available Target
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1361.1">
      task and name it
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1362.1">
        Cheer Sequence
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1363.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1364.1">
      From
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1365.1">
       Cheer Sequence
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1366.1">
      , add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1367.1">
       Play Montage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1368.1">
      task and name it
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1369.1">
       Cheer Montage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1370.1">
      .
     </span>
     <span class="koboSpan" id="kobo.1370.2">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1371.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1372.1">
      panel, set the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1373.1">
       Anim Montage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1374.1">
      attribute
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1375.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1376.1">
        AM_Cheer
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1377.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1378.1">
      From
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1379.1">
       Cheer Sequence
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1380.1">
      , add a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1381.1">
       Wait
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1382.1">
      node and make sure that this task is at the right of the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1383.1">
       Cheer Montage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1384.1">
      task.
     </span>
     <span class="koboSpan" id="kobo.1384.2">
      Select the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1385.1">
       Wait
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1386.1">
      node and do
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1387.1">
       the following:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.1388.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1389.1">
         Wait Time
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1390.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1391.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.1392.1">
          3.0
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.1393.1">
        Set the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.1394.1">
         Random Deviation
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1395.1">
        attribute
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1396.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.1397.1">
          0.5
         </span>
        </strong>
       </span>
      </li>
     </ul>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.1398.1">
     This part of
    </span>
    <a id="_idIndexMarker492">
    </a>
    <span class="koboSpan" id="kobo.1399.1">
     the graph should look like
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1400.1">
       Figure 9
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1401.1">
       .21
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1402.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer163">
     <span class="koboSpan" id="kobo.1403.1">
      <img alt="Figure 9.21 – Cheer sequence" src="image/B31016_figure_09.21.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1404.1">
     Figure 9.21 – Cheer sequence
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1405.1">
     Now that the behavior tree is finally complete, we can move forward by creating a dedicated
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1406.1">
      AI controller.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-193">
    <a id="_idTextAnchor195">
    </a>
    <span class="koboSpan" id="kobo.1407.1">
     Creating the AI controller
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1408.1">
     The AI controller
    </span>
    <a id="_idIndexMarker493">
    </a>
    <span class="koboSpan" id="kobo.1409.1">
     is going to be pretty simple; you’ll just need to do
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1410.1">
      the following:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1411.1">
      Open
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1412.1">
       Content Drawer
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1413.1">
      and, in the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1414.1">
       Content/Blueprints
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1415.1">
      folder, add a new Blueprint class extending
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1416.1">
       BaseDummyAIController
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1417.1">
      and name
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1418.1">
       it
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.1419.1">
        AIGunnerDummyController
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1420.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1421.1">
      Open it and, in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1422.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1423.1">
      panel, locate the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1424.1">
       Behavior Tree
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1425.1">
      property and set its value
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1426.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1427.1">
        BT_GunnerDummy
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1428.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1429.1">
      Open
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1430.1">
       BP_GunnerDummyCharacter
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1431.1">
      and, in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1432.1">
       Details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1433.1">
      panel, set the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1434.1">
       AI Controller Class
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1435.1">
      attribute
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1436.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1437.1">
        AIDummyGunnerController
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1438.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.1439.1">
     Now that we have the controller ready and the character all set up, it’s time to test and debug
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1440.1">
      its behavior.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-194">
    <a id="_idTextAnchor196">
    </a>
    <span class="koboSpan" id="kobo.1441.1">
     Debugging the behavior tree on a gym
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1442.1">
     To start
    </span>
    <a id="_idIndexMarker494">
    </a>
    <span class="koboSpan" id="kobo.1443.1">
     debugging the newly created behavior tree, let’s start by creating a new level.
    </span>
    <span class="koboSpan" id="kobo.1443.2">
     Let’s follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1444.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1445.1">
      Create a level of your choice, starting from the Level Instances and Packed Level Actors I provided in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1446.1">
       project template.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1447.1">
      Add a
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1448.1">
        BP_GunnerDummyCharacter
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1449.1">
       instance.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1450.1">
      Add one or more
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1451.1">
       BP_Target
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1452.1">
      instances so that your AI character will have a line of sight to them.
     </span>
     <span class="koboSpan" id="kobo.1452.2">
      My gym level is shown in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1453.1">
        Figure 9
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1454.1">
        .22
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1455.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer164">
     <span class="koboSpan" id="kobo.1456.1">
      <img alt="Figure 9.22 – Gym level" src="image/B31016_figure_09.22.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1457.1">
     Figure 9.22 – Gym level
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1458.1">
     Once you test the level, the expected behavior is for the character to shoot at each target, reload after each shot, and cheer once all targets have been
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1459.1">
      successfully hit.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.1460.1">
     Adding breakpoints
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.1461.1">
     To test
    </span>
    <a id="_idIndexMarker495">
    </a>
    <span class="koboSpan" id="kobo.1462.1">
     your behavior tree, you can open it up and start the level simulation; you will see the active part of the tree, with nodes highlighted in yellow, as shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1463.1">
       Figure 9
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1464.1">
       .23
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1465.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer165">
     <span class="koboSpan" id="kobo.1466.1">
      <img alt="Figure 9.23 – Testing the tree" src="image/B31016_figure_09.23.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1467.1">
     Figure 9.23 – Testing the tree
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1468.1">
     Sometimes, portions
    </span>
    <a id="_idIndexMarker496">
    </a>
    <span class="koboSpan" id="kobo.1469.1">
     of the graph will be executed really fast and you may not see whether a particular portion of the tree has been executed.
    </span>
    <span class="koboSpan" id="kobo.1469.2">
     To get a better understanding of what’s happening, you may add a breakpoint by right-clicking on a node and selecting
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1470.1">
      Add Breakpoint
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1471.1">
     , as shown in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1472.1">
       Figure 9
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1473.1">
       .24
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1474.1">
      :
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer166">
     <span class="koboSpan" id="kobo.1475.1">
      <img alt="Figure 9.24 – Adding a breakpoint" src="image/B31016_figure_09.24.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1476.1">
     Figure 9.24 – Adding a breakpoint
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.1477.1">
     Note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.1478.1">
     In Unreal Engine’s behavior tree, a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1479.1">
      breakpoint
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1480.1">
     is a
    </span>
    <a id="_idIndexMarker497">
    </a>
    <span class="koboSpan" id="kobo.1481.1">
     debugging feature that allows you to pause the execution of the behavior tree at a specific node.
    </span>
    <span class="koboSpan" id="kobo.1481.2">
     When the execution reaches the breakpoint, the behavior tree execution is temporarily halted, giving you the opportunity to inspect the state of the AI character and analyze the flow of the behavior tree.
    </span>
    <span class="koboSpan" id="kobo.1481.3">
     Execution can be resumed at any time to get on with the behavior
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1482.1">
      tree execution.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1483.1">
     When the
    </span>
    <a id="_idIndexMarker498">
    </a>
    <span class="koboSpan" id="kobo.1484.1">
     behavior tree is executed, it will pause at the breakpoint, providing a clear view of what is happening at that moment.
    </span>
    <span class="koboSpan" id="kobo.1484.2">
     By pausing the execution at specific breakpoints, you can gain valuable insights into the inner workings of the AI behavior and identify any issues or unexpected behaviors that need to be addressed.
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1485.1">
       Figure 9
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1486.1">
      .25
     </span>
    </em>
    <span class="koboSpan" id="kobo.1487.1">
     shows a breakpoint positioned on the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1488.1">
      Find Available Target
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1489.1">
     node, showing that the previous subtree failed while checking the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1490.1">
      Is Actor a
     </span>
    </strong>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.1491.1">
       Target?
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1492.1">
      decorator:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer167">
     <span class="koboSpan" id="kobo.1493.1">
      <img alt="Figure 9.25 – Active breakpoint" src="image/B31016_figure_09.25.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1494.1">
     Figure 9.25 – Active breakpoint
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.1495.1">
     Using the debugging tools
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.1496.1">
     As you
    </span>
    <a id="_idIndexMarker499">
    </a>
    <span class="koboSpan" id="kobo.1497.1">
     may recall from
    </span>
    <a href="B31016_06.xhtml#_idTextAnchor116">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1498.1">
        Chapter 6
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.1499.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1500.1">
      Optimizing the Navigation System
     </span>
    </em>
    <span class="koboSpan" id="kobo.1501.1">
     , Unreal Engine offers a range of debugging tools for the AI system.
    </span>
    <span class="koboSpan" id="kobo.1501.2">
     Behavior trees are no exception, and once you enable these tools, you will have the ability to analyze the situation by pressing the number
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1502.1">
      2
     </span>
    </em>
    <span class="koboSpan" id="kobo.1503.1">
     on your keyboard’s numpad.
    </span>
    <span class="koboSpan" id="kobo.1503.2">
     This feature allows you to gain insights into the behavior of the AI character and evaluate the execution of the behavior tree in real time.
    </span>
    <span class="koboSpan" id="kobo.1503.3">
     In
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1504.1">
       Figure 9
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1505.1">
      .26
     </span>
    </em>
    <span class="koboSpan" id="kobo.1506.1">
     , we can observe a specific situation where the behavior tree is displayed on
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1507.1">
      the screen:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer168">
     <span class="koboSpan" id="kobo.1508.1">
      <img alt="Figure 9.26 – Debugging tools" src="image/B31016_figure_09.26.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1509.1">
     Figure 9.26 – Debugging tools
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1510.1">
     This visual
    </span>
    <a id="_idIndexMarker500">
    </a>
    <span class="koboSpan" id="kobo.1511.1">
     representation provides a clear view of the structure and flow of the behavior tree, allowing us to analyze and understand
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1512.1">
      its organization.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-195">
    <a id="_idTextAnchor197">
    </a>
    <span class="koboSpan" id="kobo.1513.1">
     Summary
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.1514.1">
     In this comprehensive chapter, I have provided you with additional information on creating more effective and efficient behavior trees.
    </span>
    <span class="koboSpan" id="kobo.1514.2">
     We began by discussing some best practices and then delved into the key features of decorators, services, and tasks.
    </span>
    <span class="koboSpan" id="kobo.1514.3">
     Furthermore, we explored the implementation of custom nodes tailored to specific requirements, culminating in the creation of a fully functional AI agent.
    </span>
    <span class="koboSpan" id="kobo.1514.4">
     To validate our work and take advantage of Unreal Engine’s robust debugging tools, we also developed a gym environment for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1515.1">
      thorough testing.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1516.1">
     Get ready for the next chapter because things are about to get even more packed with excitement!
    </span>
    <span class="koboSpan" id="kobo.1516.2">
     In this upcoming chapter, I’ll be unveiling the Unreal Perception System, where your AI agents will sharpen their senses and become more attentive than
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1517.1">
      ever before!
     </span>
    </span>
   </p>
  </div>
 </body></html>