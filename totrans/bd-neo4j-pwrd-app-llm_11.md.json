["```py\n    <!-- Langchain Springboot integration -->\n    <dependency>\n        <groupId>dev.langchain4j</groupId>\n        <artifactId>langchain4j-spring-boot-starter</artifactId>\n        <version>0.36.0</version>\n    </dependency> \n    ```", "```py\n    <!-- Open AI integration -->\n    <dependency>\n        <groupId>dev.langchain4j</groupId>\n        <artifactId>langchain4j-open-ai-spring-boot-starter</artifactId>\n        <version>0.36.0</version>\n    </dependency> \n    ```", "```py\n    <!-- Neo4j Vector Store integration -->\n    <dependency>\n        <groupId>dev.langchain4j</groupId>\n        <artifactId>langchain4j-neo4j</artifactId>\n        <version>0.35.0</version>\n    </dependency> \n    ```", "```py\n    <dependency>\n        <groupId>dev.langchain4j</groupId>\n        <artifactId>langchain4j-embeddings-all-minilm-l6-v2</artifactId>\n        <version>0.35.0</version>\n    </dependency> \n    ```", "```py\n    # Open AI LLM Integration for Generating Summary using Chat Model.\n    langchain4j.open-ai.chat-model.api-key=<`OPEN_AI_KEY`>\n    langchain4j.open-ai.chat-model.model-name=gpt-4o-mini\n    langchain4j.open-ai.chat-model.log-requests=true\n    langchain4j.open-ai.chat-model.log-responses=true \n    ```", "```py\n    # Open AI LLM Integration for Generating Embeddings\n    langchain4j.open-ai.embedding-model.api-key=<`OPEN_AI_KEY`>\n    langchain4j.open-ai.embedding-model.model-name=text-embedding-3-large \n    ```", "```py\n    # Neo4j Integration\n    neo4j.uri=bolt://localhost:7687\n    neo4j.user=neo4j\n    neo4j.password=test1234\n    neo4j.database=hmreco\n    config.batchSize=5 \n    ```", "```py\n@ConfigurationProperties(prefix = \"neo4j\")\npublic class Neo4jConfiguration { \n    private String uri; \n    private String user ; \n    private String password ; \n    private String database ; \n   */** Getter/Setters **/*\n} \n```", "```py\n    @Service\n    @Configuration\n    @EnableConfigurationProperties(Neo4jConfiguration.class)\n    public class Neo4jService {\n        @Autowired\n        private Neo4jConfiguration configuration ;\n        private Driver driver ; \n    ```", "```py\n    public synchronized void setup() {\n            if( driver == null ) {\n                driver = GraphDatabase.driver(\n                        configuration.getUri(),\n                        AuthTokens.basic(\n                                configuration.getUser(),\n                                configuration.getPassword()));\n                driver.verifyConnectivity();\n            }\n        } \n    ```", "```py\n    public List<EncodeRequest> getDataFromDB(String startSeason, String endSeason) {\n        setup();\n        String cypherTemplate = \"\"\"\n            --- Cypher query to get the transactions\n        \"\"\";\n        String cypher = String.format(cypherTemplate, startSeason, endSeason);\n        SessionConfig config = SessionConfig.builder()\n            .withDatabase(configuration.getDatabase())\n            .build();\n        try (Session session = driver.session(config)) {\n            List<EncodeRequest> data = session.executeRead(tx -> {\n                List<EncodeRequest> out = new ArrayList<>();\n                var records = tx.run(cypher);\n                while (records.hasNext()) {\n                    var record = records.next();\n                    String id = record.get(\"elementId\").asString();\n                    String articles = record.get(\"articles\").asString();\n                    out.add(new EncodeRequest(articles, id));\n                }\n                return out;\n            });\n            return data;\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n        return null;\n    } \n    ```", "```py\n    public List<EncodeRequest> getArticlesFromDB() {\n        setup();\n        String cypherTemplate = \"\"\"\n            -- Cypher query to get the articles.\n        \"\"\";\n        SessionConfig config = SessionConfig.builder()\n            .withDatabase(configuration.getDatabase())\n            .build();\n        try (Session session = driver.session(config)) {\n            List<EncodeRequest> data = session.executeRead(tx -> {\n                List<EncodeRequest> out = new ArrayList<>();\n                var records = tx.run(cypherTemplate);\n                while (records.hasNext()) {\n                    var record = records.next();\n                    String id = record.get(\"elementId\").asString();\n                    String article = record.get(\"article\").asString();\n                    out.add(new EncodeRequest(article, id));\n                }\n                return out;\n            });\n            return data;\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n        return null;\n    } \n    ```", "```py\n    public void saveEmbeddings(List<Map<String, Object>> embeddings) {\n        setup();\n        String cypher = \"\"\"\n            UNWIND $data as row\n            WITH row\n            MATCH ()-[r]->()\n            WHERE elementId(r) = row.id\n            SET r.summary = row.summary\n            WITH row, r\n            CALL db.create.setRelationshipVectorProperty(r, 'embedding', row.embedding)\n        \"\"\";\n        SessionConfig config = SessionConfig.builder()\n            .withDatabase(configuration.getDatabase())\n            .build();\n        try (Session session = driver.session(config)) {\n            session.executeWriteWithoutResult(tx -> {\n                tx.run(cypher, Map.of(\"data\", embeddings));\n            });\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    } \n    ```", "```py\n    public void saveArticleEmbeddings(List<Map<String, Object>> embeddings) {\n        setup();\n        String cypher = \"\"\"\n            UNWIND $data as row\n            WITH row\n            MATCH (a:Article)\n            WHERE elementId(a) = row.id\n            CALL db.create.setNodeVectorProperty(a, 'embedding', row.embedding)\n        \"\"\";\n        SessionConfig config = SessionConfig.builder()\n            .withDatabase(configuration.getDatabase())\n            .build();\n        try (Session session = driver.session(config)) {\n            session.executeWriteWithoutResult(tx -> {\n                tx.run(cypher, Map.of(\"data\", embeddings));\n            });\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    } \n    ```", "```py\n    @AiService\n    public interface ChatAssistant {\n        @SystemMessage(\"\"\" \n    ```", "```py\n    ---Role---\n\n                 You are an helpful assistant with expertise in fashion for a clothing company. \n    ```", "```py\n    ---Goal---\n\n                Your goal is to generate a summary of the products purchased by the customers and descriptions of each of the products.\\s\n                Your summary should contain two sections -\\s\n                Section 1 - Overall summary outlining the fashion preferences of the customer based on the purchases. Limit the summary to 3 sentences\n                Section 2 - highlight 3-5 individual purchases.\n\n                You should use the data provided in the section below as the primary context for generating the response.\\s\n                If you don't know the answer or if the input data tables do not contain sufficient information to provide an answer, just say so.\\s\n                Do not make anything up.\n\n                Data Description:\n                - Each Customer has an ID. Customer ID is a numeric value.\n                - Each Customer has purchased more than one clothing articles (products). Products have descriptions.\n                - The order of the purchases is very important. You should take into account the order when generating the summary. \n    ```", "```py\n    Response:\n                ---\n                # Overall Fashion Summary:\n\n                \\\\n\\\\n\n\n                # Individual Purchase Details:\n\n                -- \n    ```", "```py\n    Data:\n                {text}\n        \"\"\")\n        String chat(String text);\n    } \n    ```", "```py\n@Service\npublic class OpenAIChatService\n    private ChatAssistant assistant ;\n    public OpenAIChatService(ChatAssistant assistant) {\n        this.assistant = assistant;\n    }\n    public String getSummaryText(String input) {\n        String out = assistant.chat(input) ;\n        return out ;\n    }\n} \n```", "```py\ngetSummaryText method invokes the chat request. It is as simple as that to integrate the chat services into the application.\n```", "```py\n@Service\npublic class OpenAIEmbeddingModelService {\n    EmbeddingModel embeddingModel ;\n    public OpenAIEmbeddingModelService(EmbeddingModel embeddingModel) {\n        this.embeddingModel = embeddingModel;\n    }\n    Embedding generateEmbedding(String text) {\n        Response<Embedding> response = embeddingModel.embed(text) ;\n        return  response.content() ;\n    }\n} \n```", "```py\n    @Configuration\n    @EnableConfigurationProperties(RunConfiguration.class)\n    @RestController\n    public class LangchainGraphAugmentController { \n    ```", "```py\n    @Autowired\n        private OpenAIEmbeddingModelService embeddingModelService ;\n        @Autowired\n        private Neo4jService neo4jService ;\n        @Autowired\n        private OpenAIChatService chatService ;\n        @Autowired\n        private RunConfiguration configuration ; \n    ```", "```py\n    private HashMap<String, IRequest> currentRequests = new HashMap<>() ; \n    ```", "```py\n    @GetMapping(\"/augment/{startSeason}/{endSeason}\")\n        public String processAugment(\n                @PathVariable (value=\"startSeason\") String startSeason,\n                @PathVariable (value=\"endSeason\") String endSeason\n        ) {\n            String uuid = UUID.randomUUID().toString() ;\n            ProcessRequest request = new ProcessRequest(\n                    chatService,\n                    embeddingModelService,\n                    neo4jService,\n                    configuration,\n                    startSeason,\n                    endSeason\n            ) ;\n            currentRequests.put(uuid, request) ;\n            Thread t = new Thread(request) ;\n            t.start();\n            return uuid ;\n        } \n    ```", "```py\n    @GetMapping(\"/augmentArticles\")\n        public String processAugmentArticles() {\n            String uuid = UUID.randomUUID().toString() ;\n            ProcessArticles request = new ProcessArticles(\n                    embeddingModelService,\n                    neo4jService,\n                    configuration\n            ) ;\n            currentRequests.put(uuid, request) ;\n            Thread t = new Thread(request) ;\n            t.start();\n            return uuid ;\n        } \n    ```", "```py\n    @GetMapping(\"/augment/status/{requestId}\")\n        public String getStatus(\n                @PathVariable (value=\"requestId\") String requestId) {\n            IRequest request = currentRequests.get(requestId) ;\n            if( request != null ) {\n                if( request.isComplete() ) {\n                    currentRequests.remove(requestId) ;\n                }\n                return request.getCurStatus() ;\n            } else {\n                return \"Request Not Found.\" ;\n            }\n        }\n    } \n    ```", "```py\n    public class ProcessRequest implements Runnable, IRequest {\n        private OpenAIChatService chatService ;\n        private OpenAIEmbeddingModelService embeddingModelService ;\n        private Neo4jService neo4jService ;\n        private RunConfiguration configuration ;\n        private String startSeson ;\n        private String endSeason ;\n        private String curStatus = \"0 %\" ;\n        private boolean isComplete = false ;\n        public ProcessRequest(\n                OpenAIChatService chatService,\n                OpenAIEmbeddingModelService embeddingModelService,\n                Neo4jService neo4jService,\n                RunConfiguration configuration,\n                String startSeson,\n                String endSeason) {\n            this.chatService = chatService;\n            this.embeddingModelService = embeddingModelService;\n            this.neo4jService = neo4jService;\n            this.configuration = configuration ;\n            this.startSeson = startSeson ;\n            this.endSeason = endSeason ;\n        }\n        public String getCurStatus() {\n            return curStatus ;\n        }\n        public boolean isComplete() {\n            return isComplete;\n        } \n    ```", "```py\n@Override\n    public void run() {\n        try { \n```", "```py\n    System.out.println(\"Retrieving Data from Graph\");\n                List<EncodeRequest> dbData = neo4jService.getDataFromDB(startSeson, endSeason);\n                System.out.println(\"Retrieved Data from Graph\");\n                int i = 0;\n                int processingSize = dbData.size();\n                List<Map<String, Object>> embeddings = new ArrayList<>();\n                for( EncodeRequest request: dbData ) { \n    ```", "```py\nif (i > 0 && i % configuration.getBatchSize() == 0) {\n                    System.out.println(\"Saving Embeddings to Graph : \" + i);\n                    neo4jService.saveEmbeddings(embeddings);\n                    embeddings.clear();\n                    curStatus = ( ( i * 100.0 ) / processingSize ) + \" %\";\n                }\n                i++;\n                Map<String, Object> embedMap = new HashMap<>(); \n```", "```py\n    String id = request.getId();\n                    System.out.println(\"Retrieving Summary\");\n                    String summary = chatService.getSummaryText(request.getText());\n                    System.out.println(\"Retrieving embedding\"); \n    ```", "```py\n    Embedding embedding = embeddingModelService.generateEmbedding(summary); \n    ```", "```py\n    embedMap.put(\"id\", id);\n                    embedMap.put(\"embedding\", embedding.vector());\n                    embedMap.put(\"summary\", summary);\n                    embeddings.add(embedMap);\n                } \n    ```", "```py\n    if( embeddings.size() > 0 ) {\n                    System.out.println(\"Saving Embeddings to Graph\");\n                    neo4jService.saveEmbeddings(embeddings);\n                    embeddings.clear();\n                }\n                curStatus = \"100 %\";\n            }catch (Exception e) {\n                e.printStackTrace();\n            }\n            isComplete = true;\n        }\n    } \n    ```", "```py\npublic class ProcessArticles implements Runnable, IRequest { \n```", "```py\n@Override\n    public void run() {\n\n            List<EncodeRequest> dbData = neo4jService.getArticlesFromDB();\n\n            for( EncodeRequest request: dbData ) {\n                if (i > 0 && i % batchSize == 0) { \n```", "```py\nList<Embedding> embedList = embeddingModelService.generateEmbeddingBatch(inputData);\n                                                            neo4jService.saveArticleEmbeddings(embeddings);\n                                    }\n                                i++;\n            } \n```", "```py\nif( inputData.size() > 0 ) {\n                                List<Embedding> embedList = embeddingModelService.generateEmbeddingBatch(inputData);\n                 neo4jService.saveArticleEmbeddings(embeddings);\n                            }\n            curStatus = \"100 %\";\n        }catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n} \n```", "```py\n    # Open AI LLM Integration for Generating Summary using Chat Model.\n    spring.ai.openai.api-key=`<OPEN_AI_KEY>` \n    ```", "```py\n    # Open AI LLM Integration for Generating Embeddings\n    spring.ai.openai.embedding.options.model=text-embedding-3-large \n    ```", "```py\n    # Neo4j Integration\n    neo4j.uri=bolt://localhost:7687\n    neo4j.user=neo4j\n    neo4j.password=test1234\n    neo4j.database=hmreco\n    config.batchSize=5 \n    ```", "```py\n@Service\npublic class OpenAIChatService {\n    private final ChatClient chatClient; \n```", "```py\n    private final String SYSTEM_PROMPT_TEMPLATE = \"\"\" \n    ```", "```py\n    ---Role---\n\n                 You are an helpful assistant with expertise in fashion for a clothing company. \n    ```", "```py\n    ---Goal---\n\n                Your goal is to generate a summary of the products purchased by the customers and descriptions of each of the products.\\s\n                Your summary should contain two sections -\\s\n                Section 1 - Overall summary outlining the fashion preferences of the customer based on the purchases. Limit the summary to 3 sentences\n                Section 2 - highlight 3-5 individual purchases.\n\n                You should use the data provided in the section below as the primary context for generating the response.\\s\n                If you don't know the answer or if the input data tables do not contain sufficient information to provide an answer, just say so.\\s\n                Do not make anything up.\n\n                 Data Description:\n                - Each Customer has an ID. Customer ID is a numeric value.\n                - Each Customer has purchased more than one clothing articles (products). Products have descriptions.\n                - The order of the purchases is very important. You should take into account the order when generating the summary. \n    ```", "```py\n    Response:\n                ---\n                # Overall Fashion Summary:\n\n                \\\\n\\\\n\n\n                # Individual Purchase Details:\n        --\n        \"\"\" ; \n    ```", "```py\n    private final String userMessage = \"\"\"\n                Data:\n                {text}\n                \"\"\" ; \n    ```", "```py\n    public OpenAIChatService(ChatClient.Builder chatClientBuilder) {\n            this.chatClient = chatClientBuilder.build();\n        }\n        public String getSummaryText(String input) \n    ```", "```py\n    ChatResponse response = chatClient\n                    .prompt()\n                    .system(SYSTEM_PROMPT_TEMPLATE)\n                    .user(p -> p.text(userMessage).param(\"data\", input))\n                    .call()\n                    .chatResponse() ;\n            return response.getResult().getOutput().getContent() ;\n        }\n    } \n    ```", "```py\n@Service\npublic class OpenAIEmbeddingModelService {\n    private EmbeddingModel embeddingModel ;\n    @Autowired\n    public OpenAIEmbeddingModelService(EmbeddingModel embeddingModel) {\n        this.embeddingModel = embeddingModel;\n    }\n    float[] generateEmbedding(String text) {\n        float[] response = embeddingModel.embed(text) ;\n        return  response ;\n    }\n    List<float[]> generateEmbeddingBatch(List<String> textList) {\n        List<float[]> responses = embeddingModel.embed(textList) ;\n        return responses ;\n    }\n} \n```", "```py\n2024-12-12T14:52:30.075+05:30  INFO 5296 --- [langchain_graphaugment] [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1271 ms\n2024-12-12T14:52:31.347+05:30  INFO 5296 --- [langchain_graphaugment] [           main] o.neo4j.driver.internal.DriverFactory    : Direct driver instance 1567253519 created for server address localhost:7687\n2024-12-12T14:52:31.388+05:30  INFO 5296 --- [langchain_graphaugment] [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'\n2024-12-12T14:52:31.398+05:30  INFO 5296 --- [langchain_graphaugment] [           main] g.h.l.g.LangchainGraphaugmentApplication : Started LangchainGraphaugmentApplication in 3.146 seconds (process running for 3.746) \n```", "```py\nCREATE VECTOR INDEX `article-embeddings` IF NOT EXISTS\nFOR (a:Article)\nON a.embedding\nOPTIONS { indexConfig: {\n `vector.dimensions`: 3072,\n `vector.similarity_function`: 'cosine'\n}} \n```", "```py\nCREATE VECTOR INDEX `summer-2019-embeddings` IF NOT EXISTS\nFOR ()-[r:SUMMER_2019]->() ON (r.embedding)\nOPTIONS { indexConfig: {\n `vector.dimensions`: 3072,\n `vector.similarity_function`: 'cosine'\n}} \n```", "```py\nMATCH (a:Article {id:'0748579001'})\nWITH a\nCALL db.index.vector.queryNodes('article-embeddings', 5, a.embedding)\nYIELD node, score\nRETURN score, node.id as id, node.desc as desc \n```", "```py\nMATCH (a:Article {id:'0748582008'})\nWITH a\nCALL db.index.vector.queryNodes('article-embeddings', 5, a.embedding)\nYIELD node, score\nRETURN score, node.id as id, node.desc as desc \n```", "```py\nMATCH (c:Customer)-[r:SUMMER_2019]->() WHERE c.id='0002b7a7ab270a638fcb2eb5899c58696db24d9d954ddb43683dd6b0ffa292f0'\nWITH r\nCALL db.index.vector.queryRelationships('summer-2019-embeddings', 5, r.embedding)\nYIELD relationship, score\nMATCH (oc)-[relationship]->()\nWITH oc, score, relationship\nWITH oc, score, split(relationship.summary, '\\n') as s\nWITH oc, score, CASE when s[2] <> '' THEN s[2] ELSE s[3] end as desc\nWITH score, oc.id as id, desc\nRETURN round(score,3) as score, substring(id,0,4)+\"..\"+substring(id,size(id)-4) as id, desc \n```", "```py\nMATCH (c:Customer)-[r:SUMMER_2019]->() WHERE c.id=' 0247b7b564909181b2e552fe3d5cec01056ebc1b3d61d38f1ff0658db69174b3'\nWITH r\nCALL db.index.vector.queryRelationships('summer-2019-embeddings', 5, r.embedding)\nYIELD relationship, score\nMATCH (oc)-[relationship]->()\nWITH oc, score, relationship\nWITH oc, score, split(relationship.summary, '\\n') as s\nWITH oc, score, CASE when s[2] <> '' THEN s[2] ELSE s[3] end as desc\nWITH score, oc.id as id, desc\nRETURN round(score,3) as score, substring(id,0,4)+\"..\"+substring(id,size(id)-4) as id, desc \n```", "```py\nMATCH (c:Customer)-[r:SUMMER_2019]->() WHERE c.id='0247b7b564909181b2e552fe3d5cec01056ebc1b3d61d38f1ff0658db69174b3'\nWITH c, r \n```", "```py\nCALL db.index.vector.queryRelationships('summer-2019-embeddings', 5, r.embedding)\nYIELD relationship, score\nMATCH (oc)-[relationship]->()\nWITH c, collect(oc) as others\nCALL { \n```", "```py\nWITH c\n    MATCH (c)-[:SUMMER_2019]->(start)\n    MATCH (c)-[:FALL_2019]->(end)\n    WITH start, end\n    MATCH p=(start)-[:NEXT*]->(end)\n    WITH p\n    WITH nodes(p) as txns\n    UNWIND txns as tx\n    MATCH (tx)-[:HAS_ARTICLE]->(a)\n    RETURN collect(a) as customerPurchases\n}\nWITH others, customerPurchases\nCALL { \n```", "```py\nWITH others\n    UNWIND others as a\n    MATCH (a:Customer)-[:SUMMER_2019]->(start)\n    MATCH (a)-[:FALL_2019]->(end)\n    WITH start, end\n    MATCH p=(start)-[:NEXT*]->(end)\n    WITH nodes(p) as txns\n    UNWIND txns as tx\n    MATCH (tx)-[:HAS_ARTICLE]->(a)\n    WITH DISTINCT a\n    RETURN collect(a) as otherPurchases\n}\nWITH customerPurchases, otherPurchases \n```", "```py\nWITH apoc.coll.subtract(otherPurchases, customerPurchases) as others\nUNWIND others as other\nRETURN other.id as id, other.desc as desc\nLIMIT 10 \n```"]