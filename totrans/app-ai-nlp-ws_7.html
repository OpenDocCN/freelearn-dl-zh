<html><head></head><body>
		<div><h1 id="_idParaDest-152"><a id="_idTextAnchor155"/>Appendix</h1>
		</div>
		<div><h1 id="_idParaDest-153"><a id="_idTextAnchor156"/>1. An Introduction to AWS</h1>
			<h2 id="_idParaDest-154"><a id="_idTextAnchor157"/>Activity 1.01: Putting the Data into S3 with the CLI</h2>
			<p><strong class="bold">Solution:</strong></p>
			<ol>
				<li>Verify the configuration is correct by executing <code>aws s3 ls</code> to output your bucket name (the bucket name will be unique):<div><img src="img/B16061_01_46.jpg" alt="Figure 1.46: Command line showing the list of files in an S3 bucket&#13;&#10;"/></div><p class="figure-caption">Figure 1.46: Command line showing the list of files in an S3 bucket</p><p class="callout-heading">Note</p><p class="callout">The list you will see maybe a little different from the preceding screenshot. It depends on what activities or exercises you have done; you might see a few more files in S3.</p></li>
				<li>Let's create a new S3 bucket. <code>mb</code> is the command for creating a bucket:<pre>aws s3 mb s3://lesson1-text-files-20200217</pre><div><img src="img/B16061_01_47.jpg" alt="Figure 1.47: Command to create an S3 bucket&#13;&#10;"/></div><p class="figure-caption">Figure 1.47: Command to create an S3 bucket</p><p>If it is successful, you will see the <code>make_bucket : message</code>.</p><p class="callout-heading">Note</p><p class="callout">Your bucket name needs to be unique, so it is easier to append YYYYMMDD to the name (or something similar) to make it so. You will see this technique in later chapters as well. If you take a look at the earlier <code>ls</code> command, you will see the bucket names used — even used YYYYMMDDHHMM to ensure the names were unique. Refer to the S3 "Rules for Bucket Naming" for specific details <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-s3-bucket-naming-requirements.html">https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-s3-bucket-naming-requirements.html</a>).</p></li>
				<li>Import your text file into the S3 bucket.<p>For these exercises, we have prepared some fun-sounding text excerpts for you from Dracula and Peter Pan. These files are on GitHub <a href="https://packt.live/31WESlK">https://packt.live/31WESlK</a> Assuming you have cloned the repository locally, navigate to the local directory using the command line. In our case, the files are in <code>~/Documents/aws-book</code>:</p><div><img src="img/B16061_01_48.jpg" alt="Figure 1.48: Navigating to the local directory in the command line&#13;&#10;"/></div><p class="figure-caption">Figure 1.48: Navigating to the local directory in the command line</p></li>
				<li>To copy the files from the local directory to S3, use the command <code>aws s3 cp pos_sentiment__leaves_of_grass.txt s3://lesson1-text-files-20200217</code> to import the text file into your S3 bucket as shown at the end of <em class="italic">Figure 1.48</em>:</li>
				<li>Similarly, export the <code>neg_sentiment__dracula.txt</code> and <code>peter_pan.txt</code> files to the S3 bucket:<div><img src="img/B16061_01_49.jpg" alt="Figure 1.49: Copying the file from the local directory in the command line&#13;&#10;"/></div><p class="figure-caption">Figure 1.49: Copying the file from the local directory in the command line</p></li>
				<li>Navigate to your desktop in the command line. Create a new local folder named <code>s3_exported_files</code> with the <code>mkdir s3_exported_files</code> command:<div><img src="img/B16061_01_50.jpg" alt="in"/></div><p class="figure-caption">Figure 1.50: Navigating to the desktop in the command line</p></li>
				<li>Next, recursively export both files (<code>neg_sentiment__dracula.txt</code> and <code>peter_pan.txt</code>) from the S3 bucket to your local directory with the <code>- -recursive</code> parameter. The following is the output of the command:<div><img src="img/B16061_01_51.jpg" alt="Figure 1.51: Command line to copy files from an S3 bucket&#13;&#10;"/></div><p class="figure-caption">Figure 1.51: Command line to copy files from an S3 bucket</p></li>
				<li>Verify the objects were exported successfully to your local folder with the <code>dir</code> or <code>ls</code> command, as shown in the following screenshot. This is the expected output:<div><img src="img/B16061_01_52.jpg" alt="Figure 1.52: Output of the multi-file copy from the S3 bucket&#13;&#10;"/></div></li>
			</ol>
			<p class="figure-caption">Figure 1.52: Output of the multi-file copy from the S3 bucket</p>
			<h1 id="_idParaDest-155"><a id="_idTextAnchor158"/>2. Analyzing Documents and Text with Natural Language Processing</h1>
			<h2 id="_idParaDest-156">Activity 2.01: Integra<a id="_idTextAnchor159"/>ting Lambda with Amazon Comprehend to Perform Text Analysis</h2>
			<p><strong class="bold">Solution</strong>:</p>
			<ol>
				<li value="1">Upload the <code>test_s3trigger_configured.txt</code> file to our S3 bucket to verify the Lambda <code>s3_trigger</code> function was configured successfully.</li>
				<li>Navigate to the S3 page: <a href="https://console.aws.amazon.com/s3/">https://console.aws.amazon.com/s3/</a>.</li>
				<li>Click the bucket name you are using to test the <code>s3_trigger</code> function (in my case, <code>aws-ml-s3-trigger-202001181023</code>):<div><img src="img/B16061_02_55.jpg" alt="Figure 2.55: S3 bucket list&#13;&#10;"/></div><p class="figure-caption">Figure 2.55: S3 bucket list</p></li>
				<li>Click <code>Upload</code>:<div><img src="img/B16061_02_56.jpg" alt="Figure 2.56: S3 bucket list upload screen&#13;&#10;"/></div><p class="figure-caption">Figure 2.56: S3 bucket list upload screen</p><p>The following screen will display:</p><div><img src="img/B16061_02_57.jpg" alt="Figure 2.57: S3 Upload bucket Add files screen&#13;&#10;"/></div><p class="figure-caption">Figure 2.57: S3 Upload bucket Add files screen</p></li>
				<li>Click <code>Add files</code>:<div><img src="img/B16061_02_58.jpg" alt="Figure 2.58: S3 Add files selection screen&#13;&#10;"/></div><p class="figure-caption">Figure 2.58: S3 Add files selection screen</p></li>
				<li>Navigate to the <code>test_s3trigger_configured.txt</code> file location. Select the file.<p>The file contains the following text:</p><pre>I am a test file to verify the s3 trigger was successfully configured on 1/20/2020 at 1:34 PM and tried 3 times!</pre><p>Before we execute the <code>s3_trigger</code>, consider the output based on the following aspects of the text: sentiment (positive, negative, or neutral), entities (quantity, person, place, and so on), and key phrases.</p><p class="callout-heading">Note</p><p class="callout"><code>test_s3trigger_configured.txt</code> is available at the following GitHub repository: <a href="https://packt.live/3gAxqku">https://packt.live/3gAxqku</a>.</p></li>
				<li>Click <code>Upload</code>, then <code>Next</code>:<div><img src="img/B16061_02_59.jpg" alt="Figure 2.59: S3 file added to the bucket for the Lambda trigger test&#13;&#10;"/></div><p class="figure-caption">Figure 2.59: S3 file added to the bucket for the Lambda trigger test</p></li>
				<li>Click <code>Next</code> in the Set Permissions tab:<div><img src="img/B16061_02_60.jpg" alt="Figure 2.60: S3 file added to the bucket for the Lambda trigger test—object permissions&#13;&#10;"/></div><p class="figure-caption">Figure 2.60: S3 file added to the bucket for the Lambda trigger test—object permissions</p></li>
				<li>Keep the default <code>Standard</code> <code>Storage class</code> and click <code>Next</code>:<div><img src="img/B16061_02_61.jpg" alt="Figure 2.61: S3 file added to the bucket for the Lambda trigger test—Storage class&#13;&#10;"/></div><p class="figure-caption">Figure 2.61: S3 file added to the bucket for the Lambda trigger test—Storage class</p></li>
				<li>Select <code>Upload</code>:<div><img src="img/B16061_02_62.jpg" alt="Figure 2.62: S3 file added to the bucket for the Lambda trigger test—Upload&#13;&#10;"/></div><p class="figure-caption">Figure 2.62: S3 file added to the bucket for the Lambda trigger test—Upload</p></li>
				<li>You will see the file in the file list:<div><img src="img/B16061_02_63.jpg" alt="Figure 2.63: S3 file added to the bucket for the Lambda trigger test – file list&#13;&#10;"/></div><p class="figure-caption">Figure 2.63: S3 file added to the bucket for the Lambda trigger test – file list</p></li>
				<li>Now let's see if our Lambda was triggered. Navigate back to the Lambda via <code>Services&gt;Compute&gt;Lambda&gt;Functions&gt;s3_trigger</code>. Click <code>Monitoring</code>:<div><img src="img/B16061_02_64.jpg" alt="Figure 2.64: Select the Monitoring tab&#13;&#10;"/></div><p class="figure-caption">Figure 2.64: Select the Monitoring tab</p></li>
				<li>Click <code>View logs in CloudWatch</code>:<div><img src="img/B16061_02_65.jpg" alt="Figure 2.65: Select View logs in CloudWatch&#13;&#10;"/></div><p class="figure-caption">Figure 2.65: Select View logs in CloudWatch</p></li>
				<li>Click the log stream:<div><img src="img/B16061_02_66.jpg" alt="Figure 2.66: Select the log stream&#13;&#10;"/></div><p class="figure-caption">Figure 2.66: Select the log stream</p></li>
				<li>Select the radio button next to <code>Text</code> to expand the output:<div><img src="img/B16061_02_67.jpg" alt="Figure 2.67: Click the radio button to expand the Lambda output&#13;&#10;"/></div><p class="figure-caption">Figure 2.67: Click the radio button to expand the Lambda output</p><p>The following is the first few lines of the output. To see the entire output, you need to scroll down to view all of the results (see the following). We will interpret the total output in the next step:</p><div><img src="img/B16061_02_68.jpg" alt="Figure 2.68: The top portion of the s3_trigger output&#13;&#10;"/></div><p class="figure-caption">Figure 2.68: The top portion of the s3_trigger output</p><p class="callout-heading">Note</p><p class="callout">If you encounter permission errors, check the permissions for <code>s3TriggerRole</code> from <code>Services&gt;Security, Identity, &amp; Compliance-IAM-Roles</code>. The policy list should look as follows. If one of them is missing, you can add them.</p></li>
				<li>Also, if you delete and recreate your Lambda, you can reuse the role—just select <code>Use an existing role</code> instead of <code>Create a new role</code>. It is always good to play around with the various configurations and understand how they all fit together:<div><img src="img/B16061_02_69.jpg" alt="Figure 2.69: The policies for s3TriggerRole&#13;&#10;"/></div><p class="figure-caption">Figure 2.69: The policies for s3TriggerRole</p></li>
				<li>Now let's examine the results of our Lambda from AWS Comprehend. You might see slightly different confidence levels because Amazon trains its algorithms periodically.<p><code>Sentiment_response</code> -&gt; Classified as <code>51.0</code>% likely to be neutral. This is a statement, so neutral is fine.</p><p><code>Sentiment_response</code>:</p><pre>{ {'Sentiment': 'NEUTRAL', 
   'SentimentScore': {'Positive': 0.21022377908229828, 
                      'Negative': 0.27646979689598083, 
                      'Neutral': 0.5132954716682434, 
                      'Mixed': 1.0932244549621828e-05},</pre><p><code>entity_response</code> -&gt; It did find the date and the quantity from the text</p><p><code>entity_response</code>:</p><pre>{ 'Entities': [{'Score': 0.9891313314437866, 
                'Type': 'DATE', 'Text': '1/20/2020 at 1:34 PM', 
                'BeginOffset': 76, 'EndOffset': 96}, 
               {'Score': 0.9999986290931702, 'Type': 'QUANTITY', 
                'Text': '3 times', 'BeginOffset': 107, 
                'EndOffset': 114}], </pre><p><code>key_phases_response</code> -&gt; It found the key phrases and the scores are close to 100% confidence</p><p><code>key_phases_response</code>:</p><pre>{'KeyPhrases': [{'Score': 0.9992266297340393, 
                 'Text': 'a test file', 'BeginOffset': 8, 
                 'EndOffset': 19}, 
                {'Score': 0.9999999403953552, 
                 'Text': 'the s3 trigger', 'BeginOffset': 30, 
                 'EndOffset': 44}, 
                {'Score': 0.9999963045120239, 
                 'Text': '1/20/2020', 'BeginOffset': 76, 
                 'EndOffset': 85}, 
                {'Score': 0.9960731863975525, 
                 'Text': '1:34 PM', 'BeginOffset': 89, 
                 'EndOffset': 96}, 
                {'Score': 0.9999966621398926, 'Text': '3 times', 
                 'BeginOffset': 107, 'EndOffset': 114}],</pre></li>
			</ol>
			<h1 id="_idParaDest-157"><a id="_idTextAnchor160"/>3. Topic Modeling and Theme Extraction</h1>
			<h2 id="_idParaDest-158"><a id="_idTextAnchor161"/>Activity 3.01: Performing Topic Modeling on a Set of Documents with Unknown Topics</h2>
			<p><strong class="bold">Solution</strong>:</p>
			<ol>
				<li value="1">For this activity, we are going to use 1,000 movie review files. Navigate to the following link (or to your local directory where you have downloaded the GitHub files) to obtain the text data files that contain movie review comments: <a href="https://packt.live/3gISDZL">https://packt.live/3gISDZL</a>. It is definitely better to download the GitHub repository rather than download 1,000 files by hand.</li>
				<li>Navigate to the S3 dashboard at <a href="https://s3.console.aws.amazon.com/s3/home">https://s3.console.aws.amazon.com/s3/home</a>.</li>
				<li>Click the bucket that you created earlier (in my case, it is "<code>aws-ml-input-for-topic-modeling-20200301</code>"):<div><img src="img/B16061_03_50.jpg" alt="Figure 3.50: The S3 home screen for ‘input-for-topic-modeling’&#13;&#10;"/></div><p class="figure-caption">Figure 3.50: The S3 home screen for 'input-for-topic-modeling'</p></li>
				<li>Click <code>Create folder</code>:<div><img src="img/B16061_03_51.jpg" alt="Figure 3.51: Clicking on Create folder&#13;&#10;"/></div><p class="figure-caption">Figure 3.51: Clicking on Create folder</p></li>
				<li>Type <code>movie_review_files</code> and click <code>Save</code>:<div><img src="img/B16061_03_52.jpg" alt="Figure 3.52: Clicking Save&#13;&#10;"/></div><p class="figure-caption">Figure 3.52: Clicking Save</p><p class="callout-heading">Note</p><p class="callout">For this step, you may either follow along with the exercise and type in the code in a Jupyter notebook or obtain the notebook file (<code>text_files_to_s3.ipynb</code>) from the source code folder for this chapter: <a href="https://packt.live/2W077MR">https://packt.live/2W077MR</a>. Copy the file and paste it into the editor. </p></li>
				<li>First, you will import the <code>os</code> and <code>boto3</code> packages using the following command:<pre>import os
import boto3</pre></li>
				<li>Create an S3 client:<pre># Create an S3 client
s3 = boto3.client('s3')</pre></li>
				<li>Next, type in your unique bucket name in the highlighted space:<pre>BUCKET_NAME = '<strong class="bold">&lt;insert a unique bucket name&gt;</strong>'
BUCKET_FOLDER = 'movie_review_files/'</pre></li>
				<li>Next, get the working directory of the local path to the text files:<pre>LOCAL_PATH = os.getcwd() +'\\<code>os.getcwd()</code> command will get the current path. Ensure that the movie review files are in a folder located at the same path. Based on the folder name, you have to change the highlighted value. Alternatively, you can assign a custom path to <code>LOCAL_PATH</code> as well.</p></li>
				<li>Create a list of all the text files:<pre>text_files_list = [f for f in os.listdir(LOCAL_PATH) \
                   if f.endswith('.txt')]</pre></li>
				<li>Iterate on all files, and upload each to <code>s3</code>:<pre>file_count = 0
for filename in text_files_list:
  # print(filename)
  file_count += 1
s3.upload_file(LOCAL_PATH + filename, BUCKET_NAME, \
               BUCKET_FOLDER + filename)
print(F"Completed uploading {file_count} files.")</pre></li>
				<li>Press <em class="italic">Shift </em>+ <em class="italic">Enter</em> to run the cell.</li>
				<li>This will take a few minutes. The result is 1,000 text files uploaded to the S3 <code>movie_review_files</code> folder:<div><img src="img/B16061_03_53.jpg" alt="Figure 3.53: movie_review_files uploaded to S3&#13;&#10;"/></div><p class="figure-caption">Figure 3.53: movie_review_files uploaded to S3</p></li>
				<li>Refer to the following figure for the top few lines of the S3 output:<div><img src="img/B16061_03_54.jpg" alt="Figure 3.54: movie_review_files in S3&#13;&#10;"/></div><p class="figure-caption">Figure 3.54: movie_review_files in S3</p></li>
				<li>Next, navigate to AWS Comprehend via the Comprehend link: <a href="https://aws.amazon.com/comprehend/">https://aws.amazon.com/comprehend/</a>. You can also get there from <a href="https://aws.amazon.com/">https://aws.amazon.com/</a>, then clicking <code>My account</code> and selecting <code>AWS Management Console</code>. In the console, select <code>services</code> and then click <code>Amazon Comprehend</code> in the machine learning category.</li>
				<li>Then, click <code>Launch Amazon Comprehend</code>:<div><img src="img/B16061_03_55.jpg" alt="Figure 3.55: The Amazon Comprehend home screen&#13;&#10;"/></div><p class="figure-caption">Figure 3.55: The Amazon Comprehend home screen</p></li>
				<li>Now, click <code>Analysis jobs</code>, the first item on the left-hand toolbar:<div><img src="img/B16061_03_56.jpg" alt="Figure 3.56: Selecting Analysis jobs&#13;&#10;"/></div><p class="figure-caption">Figure 3.56: Selecting Analysis jobs</p></li>
				<li>Now, click <code>Create job</code>:<div><img src="img/B16061_03_57.jpg" alt="Figure 3.57: Clicking Create job&#13;&#10;"/></div><p class="figure-caption">Figure 3.57: Clicking Create job</p></li>
				<li>Now, type <code>unknown_topic_structure_job</code> in the <code>Name</code> input field:<div><img src="img/B16061_03_58.jpg" alt="Figure 3.58: Entering unknown_topic_structure_job&#13;&#10;"/></div><p class="figure-caption">Figure 3.58: Entering unknown_topic_structure_job</p></li>
				<li>Select <code>Topic modeling</code> in the analysis type drop-down box:<div><img src="img/B16061_03_59.jpg" alt="Figure 3.59: Choosing the Topic Modeling analysis type&#13;&#10;"/></div><p class="figure-caption">Figure 3.59: Choosing the Topic Modeling analysis type</p></li>
				<li>Now, scroll down to the <code>Input data</code> section and click <code>Browse S3</code>:<div><img src="img/B16061_03_60.jpg" alt="Figure 3.60: Selecting the Browse S3 button&#13;&#10;"/></div><p class="figure-caption">Figure 3.60: Selecting the Browse S3 button</p></li>
				<li>Click the radio button next to the bucket you selected to input files for Topic Modeling (<code>aws-ml-input-for-topic-modeling-20200301</code>) and then click the bucket name:<div><img src="img/B16061_03_61.jpg" alt="Figure 3.61: Expanding the S3 bucket sub-folders&#13;&#10;"/></div><p class="figure-caption">Figure 3.61: Expanding the S3 bucket sub-folders</p></li>
				<li>Click the radio button next to the "<code>movie_review_files</code>" folder:<div><img src="img/B16061_03_62.jpg" alt="Figure 3.62: Selecting the movie_review_files folder&#13;&#10;"/></div><p class="figure-caption">Figure 3.62: Selecting the movie_review_files folder</p></li>
				<li>Now, click the <code>Choose</code> button.<p>The following figure shows the S3 location for the input data selected:</p><div><img src="img/B16061_03_63.jpg" alt="Figure 3.63: S3 location for the input data selected&#13;&#10;"/></div><p class="figure-caption">Figure 3.63: S3 location for the input data selected</p></li>
				<li>Select <code>One document per file</code> from the <code>Input format</code> dropdown:<div><img src="img/B16061_03_64.jpg" alt="Figure 3.64: Selecting the One document per file option&#13;&#10;"/></div><p class="figure-caption">Figure 3.64: Selecting the One document per file option</p></li>
				<li>Next, enter <code>40</code> in the <code>Number of topics</code> input field:<div><img src="img/B16061_03_65.jpg" alt="Figure 3.65: Entering 40 topics&#13;&#10;"/></div><p class="figure-caption">Figure 3.65: Entering 40 topics</p></li>
				<li>Scroll down to choose the output location, and then click <code>Browse S3</code>:<div><img src="img/B16061_03_66.jpg" alt="Figure 3.66: Clicking Browse S3&#13;&#10;"/></div><p class="figure-caption">Figure 3.66: Clicking Browse S3</p></li>
				<li>Select the output bucket you uniquely named for the Topic Modeling output and click on <code>Choose</code>:<div><img src="img/B16061_03_67.jpg" alt="Figure 3.67: Selecting the S3 bucket for the Topic Modeling output&#13;&#10;"/></div><p class="figure-caption">Figure 3.67: Selecting the S3 bucket for the Topic Modeling output</p></li>
				<li>Scroll down to <code>Access Permissions</code> and select <code>Use an existing IAM role</code>, as shown:<div><img src="img/B16061_03_68.jpg" alt="Figure 3.68: Selecting Use an existing IAM role in Access permissions&#13;&#10;"/></div><p class="figure-caption">Figure 3.68: Selecting Use an existing IAM role in Access permissions</p></li>
				<li>In the <code>Role Name</code> dropdown, select <code>AmazonComprehendServiceRole-myTopicModelingRole</code>:<div><img src="img/B16061_03_69.jpg" alt="Figure 3.69: Selecting an existing IAM role&#13;&#10;"/></div><p class="figure-caption">Figure 3.69: Selecting an existing IAM role</p></li>
				<li>The final screen should look like the following:<div><img src="img/B16061_03_70.jpg" alt="Figure 3.70: Selecting an existing IAM role&#13;&#10;"/></div><p class="figure-caption">Figure 3.70: Selecting an existing IAM role</p></li>
				<li>Click the <code>Create job</code> button. The Topic Modeling job status will first display <code>Submitted</code>:<div><img src="img/B16061_03_71.jpg" alt="Figure 3.71: Status as Submitted&#13;&#10;"/></div><p class="figure-caption">Figure 3.71: Status as Submitted</p></li>
				<li>The Topic Modeling job status will next display <code>In progress</code>. The Topic Modeling job takes about 20 minutes:<div><img src="img/B16061_03_72.jpg" alt="Figure 3.72: Status as In progress&#13;&#10;"/></div><p class="figure-caption">Figure 3.72: Status as In progress</p></li>
				<li>When the status changes to <code>Completed</code>, click the <code>unknown_topic_structure_job</code> link:<div><img src="img/B16061_03_73.jpg" alt="Figure 3.73: Selecting the hyperlinked Topic Modeling link&#13;&#10;"/></div><p class="figure-caption">Figure 3.73: Selecting the hyperlinked Topic Modeling link</p><p class="callout-heading">Note</p><p class="callout">As you can see, we didn't get it right the first time and the status showed <code>Failed</code>. It might take a few attempts for you. If a job fails, click <code>Copy</code> (the button to the left of <code>Create job</code>) and then correct the errors. As you can't have duplicate jobs, a good process would be to append the job name with a sequence number, for example, <code>unknown_topic_structure_job_01</code>.</p></li>
				<li>Scroll down and click the Topic Modeling output hyperlink (yours will display a different unique Topic Modeling job alphanumeric character string):<div><img src="img/B16061_03_74.jpg" alt="Figure 3.74: Clicking the Topic Modeling output S3 location&#13;&#10;"/></div><p class="figure-caption">Figure 3.74: Clicking the Topic Modeling output S3 location</p></li>
				<li>You will be directed to the actual file in the S3 output folder for the Topic Modeling job. Click <code>Download</code>:<div><img src="img/B16061_03_75.jpg" alt="Figure 3.75: Clicking Download on the output file&#13;&#10;"/></div><p class="figure-caption">Figure 3.75: Clicking Download on the output file</p></li>
				<li>Save the file to a local directory; usually, the <code>Downloads</code> folder or the desktop is fine:<div><img src="img/B16061_03_76.jpg" alt="Figure 3.76: Saving the downloaded output file from S3&#13;&#10;"/></div><p class="figure-caption">Figure 3.76: Saving the downloaded output file from S3</p></li>
				<li>Navigate to the directory where you have downloaded the file and extract the CSV files by double-clicking. In Windows, right-click the <code>output.tar.gz</code> file and select <code>Extract Here</code>:<div><img src="img/B16061_03_77.jpg" alt="Figure 3.77: Selecting Extract Here&#13;&#10;"/></div><p class="figure-caption">Figure 3.77: Selecting Extract Here</p><p>The result is two CSV files: <code>doc-topics.csv</code> and <code>topic-terms.csv</code>.</p><p>For reference, the extracted CSV files are available in the following GitHub directories and where you downloaded them in the local directory (in my case, this is <code>/Users/ksankar/Documents/aws_book/The-Applied-AI-and-Natural-Language-Processing-with-AWS/Chapter03/Activity3.01</code>):</p><p><a href="https://packt.live/2AIccSw">https://packt.live/2AIccSw</a>.</p><p><a href="https://packt.live/3eaGdry">https://packt.live/3eaGdry</a>.</p><p>We have completed Part 1: Performing Topic Modeling, for this activity. Now, let's move to Part 2: Analysis of Unknown Topics.</p><p class="callout-heading">Note</p><p class="callout">For this step, you may either follow along with the exercise and type in the code on a Jupyter notebook or obtain the <code>local_csv_to_s3_for_analysis.ipynb</code> file from the GitHub folder where you have downloaded the repository and paste it into the Jupyter editor. For reference, the source code is available via GitHub in the following repository: <a href="https://packt.live/3gDErks">https://packt.live/3gDErks</a>.</p></li>
				<li>Firstly, we will import <code>boto3</code>:<pre>import boto3</pre></li>
				<li>Next, import <code>pandas</code>:<pre>import pandas as pd</pre></li>
				<li>Create the S3 client object.<pre>region = 'us-west-2'
s3 = boto3.client('s3',region_name = region)</pre></li>
				<li>Next, create a unique name for the S3 bucket to store your source CSV files. Here, the bucket is named <code>unknown-tm-analysis-20200302</code>, but you will need to create a unique name:<pre>#'&lt;insert a unique bucket name&gt;'
bucket_name = 'unknown-tm-analysis-20200302'</pre></li>
				<li>Next, create a new bucket:<pre># Create a location Constraint
location = {'LocationConstraint': region}
# Creates a new bucket 
s3.create_bucket(Bucket=bucket_name,\
                 CreateBucketConfiguration=location)</pre></li>
				<li>Create a list of the CSV filenames to import:<pre>filenames_list = ['doc-topics.csv', 'topic-terms.csv']</pre></li>
				<li>Iterate on each file to upload to S3:<pre>for filename in filenames_list: 
    s3.upload_file(filename, bucket_name, filename)</pre></li>
				<li>Next, check whether the filename is <code>'doc-topics.csv'</code>:<pre>if filename == 'doc-topics.csv':</pre></li>
				<li>Now, get the <code>doc-topics.csv</code> file object and assign it to the <code>obj</code> variable:<pre>obj = s3.get_object(Bucket=bucket_name, Key=filename)</pre></li>
				<li>Next, read the <code>csv</code> object and assign it to the <code>doc_topics variable</code>:<pre>doc_topics = pd.read_csv(obj['Body']) else:
obj = s3.get_object(Bucket=bucket_name, Key=filename) \
                    topic_terms = pd.read_csv(obj['Body'])</pre></li>
				<li>Merge files on the Topic column to obtain the most common terms for each document:<pre>merged_df = pd.merge(doc_topics, topic_terms, on='topic')</pre></li>
				<li>Print the <code>merged_df</code> to the console:<pre>print(merged_df)</pre></li>
				<li>Next, execute the notebook cells using <em class="italic">Shift </em>+ <em class="italic">Enter</em>.</li>
				<li>The console output is a merged DataFrame that provides the docnames with their respective terms and the terms' weights (refer to the following):<div><img src="img/B16061_03_78.jpg" alt="Figure 3.78: Output from the S3 Create bucket call&#13;&#10;"/></div></li>
			</ol>
			<p class="figure-caption">Figure 3.78: Output from the S3 Create bucket call</p>
			<div><div><img src="img/B16061_03_79.jpg" alt="Figure 3.79: Activity merged Topic Modeling output&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.79: Activity merged Topic Modeling output</p>
			<h1 id="_idParaDest-159"><a id="_idTextAnchor162"/>5. Using Speech with the Chatbot</h1>
			<h2 id="_idParaDest-160"><a id="_idTextAnchor163"/>Activity 5.01: Creating a Custom Bot and Connecting the Bot with Amazon Connect</h2>
			<p><strong class="bold">Solution:</strong></p>
			<p>This is an activity that combines what we learned in the previous chapters. Try to complete the activity on your own and refer to the solution as needed. You will make mistakes and will encounter things that do not seem to work. This is all part of learning an interesting domain. If you build and test it incrementally, the development will be easier and there will be fewer moving parts.</p>
			<p><strong class="bold">Step 1: Creating an S3 Bucket and storing balance.txt</strong></p>
			<ol>
				<li value="1">First, navigate to the Amazon S3 service from https://aws.amazon.com/, and then navigate to <code>My Account – AWS management Console-Services-Storage-S3</code>. Click <code>Create bucket</code>:<div><img src="img/B16061_05_35.jpg" alt="Figure 5.35: S3 bucket creation for user account balance&#13;&#10;"/></div><p class="figure-caption">Figure 5.35: S3 bucket creation for user account balance</p><p>For the <code>Bucket name</code>, type in <code>account-balance</code>, and then click <code>Create</code>.</p><p class="callout-heading">Note</p><p class="callout">The bucket names in AWS have to be unique. Otherwise, you will get a <code>Bucket name already exists</code> error. One easy way to get a unique name is to append the bucket name with today's date plus the time, say, YYYYMMDDHHMM. While writing this chapter, we created an <code>account-balance-202001241911</code> bucket and it worked.</p></li>
				<li>Your bucket will be created, and you will be redirected to the bucket list:<div><img src="img/B16061_05_36.jpg" alt="Figure 5.36: S3 bucket list screen&#13;&#10;"/></div><p class="figure-caption">Figure 5.36: S3 bucket list screen</p></li>
				<li>Click the bucket name you are using (in our case, <code>account-balance-202001241911</code>) and then click <code>Upload</code>:<div><img src="img/B16061_05_37.jpg" alt="Figure 5.37: S3 bucket list on the Upload screen&#13;&#10;"/></div><p class="figure-caption">Figure 5.37: S3 bucket list on the Upload screen</p><p>The following screen will display:</p><div><img src="img/B16061_05_38.jpg" alt="Figure 5.38: S3 Upload bucket Add files screen&#13;&#10;"/></div><p class="figure-caption">Figure 5.38: S3 Upload bucket Add files screen</p></li>
				<li>Click <code>Add files</code>:<div><img src="img/B16061_05_39.jpg" alt="Figure 5.39: S3 Add files selection screen&#13;&#10;"/></div><p class="figure-caption">Figure 5.39: S3 Add files selection screen</p></li>
				<li>Navigate to the <code>balance.txt</code> file location. Select the file.<p class="callout-heading">Note</p><p class="callout">The <code>balance.txt</code> file is available from the following GitHub repository: <a href="https://packt.live/38CipvB">https://packt.live/38CipvB</a>.</p><p>As we mentioned in <em class="italic">Chapter 1</em>, <em class="italic">An Introduction to AWS</em>, you should have downloaded the GitHub files into a local subdirectory.</p><p>As an example, download the files into the <code>Documents/aws-book/The-Applied-AI-and-Natural-Language-Processing-with-AWS</code> directory. As you might have guessed, the files for this exercise are in the <code>Chapter05</code> subdirectory.</p></li>
				<li>Once the files have been selected, click the <code>Open</code> button to upload the files:<div><img src="img/B16061_05_40.jpg" alt="Figure 5.40: File selection window in Explorer&#13;&#10;"/></div><p class="figure-caption">Figure 5.40: File selection window in Explorer</p></li>
				<li>Click <code>Next</code>:<div><img src="img/B16061_05_41.jpg" alt="Figure 5.41: S3 Select files tab&#13;&#10;"/></div><p class="figure-caption">Figure 5.41: S3 Select files tab</p></li>
				<li>Set the permissions to those that are shown in the following screenshot:<div><img src="img/B16061_05_42.jpg" alt="Figure 5.42: S3 Set permissions tab&#13;&#10;"/></div><p class="figure-caption">Figure 5.42: S3 Set permissions tab</p></li>
				<li>Keep the default <code>Standard</code> option under <code>Storage class</code> and click <code>Next</code>:<div><img src="img/B16061_05_43.jpg" alt="Figure 5.43: S3 Set properties tab&#13;&#10;"/></div><p class="figure-caption">Figure 5.43: S3 Set properties tab</p></li>
				<li>Select <code>Upload</code> in the <code>Review</code> tab:<div><img src="img/B16061_05_44.jpg" alt="Figure 5.44: S3 Review tab&#13;&#10;"/></div><p class="figure-caption">Figure 5.44: S3 Review tab</p></li>
				<li>You will see the file in the file list:<div><img src="img/B16061_05_45.jpg" alt="Figure 5.45: S3 file list&#13;&#10;"/></div></li>
			</ol>
			<p class="figure-caption">Figure 5.45: S3 file list</p>
			<p><strong class="bold">Step 2: Creating a Lambda function to access the S3 Bucket and read the account balance</strong></p>
			<ol>
				<li value="1">Navigate to Amazon Lambda, then <code>Services</code>, and click <code>Lambda</code> under <code>Compute</code>:<div><img src="img/B16061_05_46.jpg" alt="Figure 5.46: Services &gt; Compute &gt; Lambda&#13;&#10;"/></div><p class="figure-caption">Figure 5.46: Services &gt; Compute &gt; Lambda</p><p>You will see the <code>Lambda</code> console as follows:</p><div><img src="img/B16061_05_47.jpg" alt="Figure 5.47: Lambda console&#13;&#10;"/></div><p class="figure-caption">Figure 5.47: Lambda console</p></li>
				<li>On the <code>Lambda</code> console, click <code>Create function</code>.</li>
				<li>Choose <code>Author from scratch</code> from the available options. For <code>Function name</code>, type in <code>fetch_balance</code>:<div><img src="img/B16061_05_48.jpg" alt="Figure 5.48: AWS Lambda – creating a function with the Author from scratch selection&#13;&#10;"/></div><p class="figure-caption">Figure 5.48: AWS Lambda – creating a function with the Author from scratch selection</p></li>
				<li>For the <code>Runtime</code> option, choose <code>Python 3.6</code> from the list:<div><img src="img/B16061_05_49.jpg" alt="Figure 5.49: AWS Lambda—Python 3.6 selection&#13;&#10;"/></div><p class="figure-caption">Figure 5.49: AWS Lambda—Python 3.6 selection</p></li>
				<li>Click on <code>Choose or create an execution role</code> and select <code>Create a new role from AWS policy templates</code>. Then, enter the name <code>readBalanceRole</code> in the <code>Role name</code> field.</li>
				<li>Click the drop-down menu under <code>Policy templates</code> and select <code>Amazon S3 object read-only permissions</code>. </li>
				<li>Then, click the <code>Create function</code> button to create the Lambda function in AWS:<div><img src="img/B16061_05_50.jpg" alt="Figure 5.50: AWS Lambda—create function screen&#13;&#10;"/></div><p class="figure-caption">Figure 5.50: AWS Lambda—create function screen</p><p>You will see the Lambda function designer. There is a lot of information there. Let's focus on the essentials for this activity:</p><div><img src="img/B16061_05_51.jpg" alt="Figure 5.51: AWS Lambda—function designer&#13;&#10;"/></div><p class="figure-caption">Figure 5.51: AWS Lambda—function designer</p></li>
				<li>Next, scroll down the screen to the <code>Function code</code> section. The default code will be the same as, or similar to, the following:<div><img src="img/B16061_05_52.jpg" alt="Figure 5.52: AWS Lambda—the default lambda_function screen&#13;&#10;"/></div><p class="figure-caption">Figure 5.52: AWS Lambda—the default lambda_function screen</p></li>
				<li>Here, we can enter and edit our code entirely within the <code>lambda_function</code> tab (as long as <code>Code entry type</code> is set to <code>Edit code inline</code>, which is the default value in the drop-down menu):<p class="callout-heading">Note</p><p class="callout">For this step, you may either follow along and type in the code or you can obtain it from the source code folder in your local disk where you downloaded the files from GitHub or <a href="https://packt.live/2ZOSJbd">https://packt.live/2ZOSJbd</a>.</p><div><img src="img/B16061_05_53.jpg" alt="Figure 5.53: Function code for fetch_balance&#13;&#10;"/></div><p class="figure-caption">Figure 5.53: Function code for fetch_balance</p></li>
				<li>First, we import the <code>boto3</code>) from <a href="http://boto3.readthedocs.io/en/latest/">http://boto3.readthedocs.io/en/latest/</a>:<pre>import boto3</pre></li>
				<li>Next, create a function that takes two parameters—<code>event</code> and <code>context</code>:<pre>def Lambda_handler(event, context):</pre></li>
				<li>Next, create the <code>s3</code> client object:<pre>s3 = boto3.client("s3")</pre></li>
				<li>Next, replace <code>&lt;input Bucket name&gt;</code> with the bucket you created (<code>account-balance-202001241911</code>, in my example):<pre># e.g." account-balance-202001241911"
bucket = "&lt;input Bucket name&gt;"</pre></li>
				<li>Next, assign the <code>filename</code> to a variable, and then print the filename:<pre>filename = 'balance.txt'
print("filename: ", filename)</pre></li>
				<li>Next, create the file object by getting the <code>Bucket</code> and <code>Key</code>:<pre>file_obj = s3.get_object(Bucket = Bucket, Key = filename)</pre></li>
				<li>Extract the account balance from the file:<pre>account_balance =  (float(file_obj['Body'].read()))</pre></li>
				<li>Then, return the balance as a message:<pre>return close('Your balance is ' + str(account_balance))</pre></li>
				<li>We need the <code>close</code> function for our bot, which requires a well-formed JSON response:<pre>def close(message):
    return {
        'sessionAttributes': {},
        'dialogAction': {
            'type': 'Close',
            'fulfillmentState': 'Fulfilled',
            'message': {
                'contentType': 'PlainText',
                'content': message
            }
        }
    }</pre><p>Remember to <code>Save</code> the function frequently:</p><p class="callout-heading">Note</p><p class="callout">Use the <code>Test</code> button in the top-right corner to test and debug the code. You will see the results in <code>Execution Results</code> below the code pane.</p></li>
				<li>Click the <code>Test</code> button on the top-right corner:<div><img src="img/B16061_05_54.jpg" alt="Figure 5.54: Test Button for testing Lambda function&#13;&#10;"/></div><p class="figure-caption">Figure 5.54: Test Button for testing Lambda function</p></li>
				<li>For every test, we need to create at least one <code>Test Event</code>. If this is the first time you are running a test, you will see the <code>Configure test event</code> screen:<div><img src="img/B16061_05_55.jpg" alt="Figure 5.55: Configure Test Event to test a Lambda function&#13;&#10;"/></div><p class="figure-caption">Figure 5.55: Configure Test Event to test a Lambda function</p></li>
				<li>If the event expects values, for example a stock symbol or an account number, this is the place to create a valid JSON payload for the event. And, if you have multiple actions based on what the user asks for, you can have multiple events and then invoke the lambda with any of the events. In our case, to keep the interaction simple, we do not look for any information in the event payload. So just give the event a name – for example, type <code>getBalance</code> and then click the <code>Create</code> button.<div><img src="img/B16061_05_56.jpg" alt="Figure 5.56: Configure Test Event with name getBalance&#13;&#10;"/></div><p class="figure-caption">Figure 5.56: Configure Test Event with name getBalance</p></li>
				<li>You will see the results under the <code>Execution Results</code> tab:<div><img src="img/B16061_05_57.jpg" alt="Figure 5.57: Execution results of fetch_balance - Response&#13;&#10;"/></div><p class="figure-caption">Figure 5.57: Execution results of fetch_balance - Response</p></li>
				<li>If you scroll down in the Execution results window, you will see more details and the <code>Function Logs</code> where you will see the diagnostic prints that you have in your code. It is always good to print diagnostic messages while developing a lambda function:<div><img src="img/B16061_05_58.jpg" alt="Figure 5.58: Execution results of fetch_balance – Function Logs&#13;&#10;"/></div></li>
			</ol>
			<p class="figure-caption">Figure 5.58: Execution results of fetch_balance – Function Logs</p>
			<p><strong class="bold">Step 3: Creating a Lex bot to get the balance using the Lambda function</strong></p>
			<ol>
				<li value="1">The first step is to navigate to the <code>Amazon Lex</code> service within the AWS Console. You can do so by clicking on <code>Services</code> | <code>Machine Learning</code> | <code>Amazon Lex</code> or navigating to <a href="https://console.aws.amazon.com/lex">https://console.aws.amazon.com/lex</a>.</li>
				<li>The next step is to click on the <code>Create</code> button in order to get to the <code>Bots</code> creation screen:<div><img src="img/B16061_05_59.jpg" alt="Figure 5.59: The Amazon Lex console&#13;&#10;"/></div><p class="figure-caption">Figure 5.59: The Amazon Lex console</p></li>
				<li>At this point, you can create a custom bot by clicking on the <code>Custom bot</code> option. This reveals the bot's details, which can be filled out, as shown in the following screenshot:<div><img src="img/B16061_05_60.jpg" alt="Figure 5.60: The Custom bot option&#13;&#10;"/></div><p class="figure-caption">Figure 5.60: The Custom bot option</p></li>
				<li>The <code>Bot name</code> field can be set to <code>GetBalance</code>. The <code>Output voice</code> field is set to any of the voices, for example, you can select <code>Kendra</code>. This is because we will be interacting with the bot using voice.</li>
				<li><code>Session timeout</code> can be set to the default of <code>5</code> <code>min</code>. The <code>IAM role</code> field displays the name of the IAM role, which is automatically created by Lex for use by bot applications. Let's say <code>No</code> to <code>Sentiment analysis</code>.</li>
				<li>Finally, the <code>COPPA</code> field pertains to the <code>Children's Online Privacy Protection Act</code>, which online applications must conform with. Choose <code>Yes</code> or <code>No</code> depending on whether you want to have someone under the age of 13 using your chatbot. <p class="callout-heading">Note</p><p class="callout">A law was passed in 1998 to protect the privacy of children under 13. It states that online sites may not collect personal information from users who are younger than 13 years old without parental consent, among other provisions. You can learn more about COPPA at <a href="https://www.ftc.gov/enforcement/rules/rulemaking-regulatory-reform-proceedings/childrens-online-privacy-protection-rule">https://www.ftc.gov/enforcement/rules/rulemaking-regulatory-reform-proceedings/childrens-online-privacy-protection-rule</a>.</p></li>
				<li>Finally, clicking on the <code>Create</code> button will create the chatbot and bring you to the bot's <code>Editor</code> screen. This screen will allow you to create and define an intent for the bot, as well as a slot with a custom slot type.</li>
				<li>Click on the <code>Create Intent</code> button to bring up the <code>Add Intent</code> pop-up dialog window:<div><img src="img/B16061_05_61.jpg" alt="Figure 5.61: GetBalance bot’s Editor tab&#13;&#10;"/></div><p class="figure-caption">Figure 5.61: GetBalance bot's Editor tab</p></li>
				<li>Conversely, if you already have an intent defined, you can create a new one by clicking on the <code>+</code> sign next to the <code>Intents</code> heading in the left-hand side menu on the screen.</li>
				<li>The <code>Create Intent</code> window offers a few options to add an intent to the bot. The <code>Import intent</code> link allows you to import an intent from a <code>ZIP</code> file containing one or more <code>JSON</code> files with intents in the Lex format.</li>
				<li>The search for existing intents allows you to reuse the intents that you may have defined or imported previously, as well as the built-in intents defined by Amazon Lex.</li>
				<li>You should just click on the <code>Create Intent</code> link, however, to get to the following dialog box.</li>
				<li>In the <code>Create intent</code> dialog box, name your new intent <code>Balance</code>. The bot will recognize this intent when you let it know that you are interested in a market quote. Click on the <code>Add</code> button to complete this step:<div><img src="img/B16061_05_62.jpg" alt="Figure 5.62: The Create intent dialog box&#13;&#10;"/></div><p class="figure-caption">Figure 5.62: The Create intent dialog box</p><p>You should be back at the <code>Balance</code> intent in the left toolbar portion of the screen. The <strong class="bold">Editor</strong> screen also contains many fields that are used to define and customize the new intent.</p></li>
				<li>The first thing to do is to fill in some <code>Sample utterances</code> to train the NLU system behind Lex to recognize the utterances you will provide to the bot as signals from the user for the <code>Balance</code> intent:<div><img src="img/B16061_05_63.jpg" alt="Figure 5.63: Creation of the new intent&#13;&#10;"/></div><p class="figure-caption">Figure 5.63: Creation of the new intent</p></li>
				<li>After entering some sample utterances, you click on the <code>Build</code> button near the top of the page in order to kick off the training process for the bot:<div><img src="img/B16061_05_64.jpg" alt="Figure 5.64: Building the bot&#13;&#10;"/></div><p class="figure-caption">Figure 5.64: Building the bot</p></li>
				<li>There will be a follow-up dialog box with another <code>Build</code> button, which you should also click on:<div><img src="img/B16061_05_65.jpg" alt="Figure 5.65: Build confirmation&#13;&#10;"/></div><p class="figure-caption">Figure 5.65: Build confirmation</p></li>
				<li>After this, you should wait until you see the <code>GetBalance build was successful</code> message box. It might take between a few seconds and a couple of minutes:<div><img src="img/B16061_05_66.jpg" alt="Figure 5.66: Bot build is successful&#13;&#10;&#13;&#10;"/></div><p class="figure-caption">Figure 5.66: Bot build is successful</p><p>You can test your new intent within the bot in the <code>Test bot</code> pane, in the top-right corner of the screen.</p><p class="callout-heading">Note</p><p class="callout">If the <code>Test bot</code> pane is not visible, you may have to click on the arrow button in order to expand it and make it visible.</p><p>Type utterances into the pane to verify that the bot is able to recognize the correct intent from the utterances:</p><div><img src="img/B16061_05_67.jpg" alt="Figure 5.67: Test bot pane &#13;&#10;"/></div><p class="figure-caption">Figure 5.67: Test bot pane </p><p>You know that it has recognized the intent correctly when it returns the response: <code>Intent Balance is</code> <code>ReadyForFulfillment</code>. Feel free to experiment with different utterances, based on your sample utterances, in order to verify that the NLU engine is working correctly.</p><p>At this point, your bot does not do much, other than try to recognize the <code>Balance</code> intent and flag that it is ready for fulfillment.</p></li>
				<li>Let's now connect our Lambda function and see whether it works. Select <code>AWS Lambda function</code> in <code>Fulfillment</code> and then select the <code>fetch_balance</code> Lambda function:<div><img src="img/B16061_05_68.jpg" alt="Figure 5.68: Lambda initiation&#13;&#10;"/></div><p class="figure-caption">Figure 5.68: Lambda initiation</p></li>
				<li>Click <code>Build</code> and then test again. Now it should show the balance:<div><img src="img/B16061_05_69.jpg" alt="Figure 5.69: Testing the Lambda function&#13;&#10;"/></div></li>
			</ol>
			<p class="figure-caption">Figure 5.69: Testing the Lambda function</p>
			<p>We are making good progress.</p>
			<p><strong class="bold">Step 4: Connecting the Amazon Connect call center to the GetBalance bot</strong></p>
			<p>We will extend the call center created in <code>Exercise 5.01</code> to add this <code>GetBalance</code> feature.</p>
			<ol>
				<li value="1">From the <code>My Account</code> | <code>AWS Management Console</code>, go to <code>Services </code>|<code> Customer Engagement</code> |<code> Amazon Connect</code>. Select the instance you have created (<code>jarvis42</code>, in our case):<div><img src="img/B16061_05_70.jpg" alt="Figure 5.70: Amazon Connect contact flow configuration&#13;&#10;"/></div><p class="figure-caption">Figure 5.70: Amazon Connect contact flow configuration</p><p>We have two ways to connect — via Amazon Lex or AWS Lambda. We will use Lex, but feel free to try out Lambda.</p></li>
				<li>Add the <code>GetBalance</code> bot:<div><img src="img/B16061_05_71.jpg" alt="Figure 5.71: Amazon Connect contact flows&#13;&#10;"/></div><p class="figure-caption">Figure 5.71: Amazon Connect contact flows</p></li>
				<li>The next step is to create a contact flow. Go to the Dashboard, click <code>View Contact Flows</code> and <code>Create Contact Flow</code> in the upper-right corner:</li>
				<li>Name it <code>GetBalance</code> and wire it as follows:<div><img src="img/B16061_05_72.jpg" alt="Figure 5.72: Contact flow editor—add entry point&#13;&#10;"/></div><p class="figure-caption">Figure 5.72: Contact flow editor—add entry point</p></li>
				<li>Add <code>Get customer input</code> and a friendly message:<div><img src="img/B16061_05_73.jpg" alt="Figure 5.73: Get customer input details&#13;&#10;"/></div><p class="figure-caption">Figure 5.73: Get customer input details</p></li>
				<li>Connect it to our <code>GetBalance</code> Lex bot and the <code>Balance</code> intent:<div><img src="img/B16061_05_74.jpg" alt="Figure 5.74: Get customer input configurations&#13;&#10;"/></div><p class="figure-caption">Figure 5.74: Get customer input configurations</p><p>Then, connect all of them to hang up for now. It is a simple sequence. You can experiment with various flows:</p><div><img src="img/B16061_05_75.jpg" alt="Figure 5.75: Add a hang up flow&#13;&#10;"/></div><p class="figure-caption">Figure 5.75: Add a hang up flow</p><p>Now that we have created another contact flow, let's rewire our phone number to answer this.</p></li>
				<li>Go to <code>Overview</code> and click on <code>Login URL</code> and then enter your Amazon Connect credentials:<div><img src="img/B16061_05_76.jpg" alt="Figure 5.76: Overview screen&#13;&#10;"/></div><p class="figure-caption">Figure 5.76: Overview screen</p></li>
				<li>Click on <code>Routing</code> and <code>Phone numbers</code>:<div><img src="img/B16061_05_77.jpg" alt="Figure 5.77: Selecting the phone numbers&#13;&#10;"/></div><p class="figure-caption">Figure 5.77: Selecting the phone numbers</p></li>
				<li>Click on the phone number:<div><img src="img/B16061_05_78.jpg" alt="Figure 5.78: Manage Phone numbers screen&#13;&#10;"/></div><p class="figure-caption">Figure 5.78: Manage Phone numbers screen</p></li>
				<li>Select <code>GetBalance</code> from the drop-down list for <code>Contact flow/IVR</code>:<div><img src="img/B16061_05_79.jpg" alt="Figure 5.79: Add GetBalance to the phone number&#13;&#10;"/></div><p class="figure-caption">Figure 5.79: Add GetBalance to the phone number</p></li>
				<li>Click <code>Save</code>. Now you have wired your bot to a call center.</li>
				<li>Call the number. It will ask you <code>How may I help you?</code> You can say <code>How much money do I have?</code> and it will reply <code>You have 42.0!</code> Amazon has done a good job: when we activated the bot via the keyboard from the test console, it gave us a text message back. However, when we called it via Connect, it gave us a voice answer back.</li>
			</ol>
			<p>This is a good time to play around with different questions and even different people—your friends, your spouse, and others. With relatively very little work, the voice bot will understand what they are saying and answer this simple question. You can try different prompts, maybe even add a dollar sign and see whether it says it the right way.</p>
			<h1 id="_idParaDest-161"><a id="_idTextAnchor164"/>6. Computer Vision and Image Processing</h1>
			<h2 id="_idParaDest-162"><a id="_idTextAnchor165"/>Activity 6.01: Creating and Analyzing Different Faces in Rekognition</h2>
			<p><strong class="bold">Solution</strong>:</p>
			<ol>
				<li value="1">Navigate to the Amazon Rekognition service from the Amazon Management Console and choose <code>Face comparison</code> from the left toolbar.</li>
				<li>Upload the first set of images to Rekognition so that it can recognize and compare the faces, that is, <a href="https://packt.live/31X6IP6">https://packt.live/31X6IP6</a> and <a href="https://packt.live/2ZLseUd">https://packt.live/2ZLseUd</a>:<div><img src="img/B16061_06_56.jpg" alt="Figure 6.56: The first images provided for face comparison&#13;&#10;"/></div><p class="figure-caption">Figure 6.56: The first images provided for face comparison</p><p>Rekognition can recognize that the faces are of the same person with a <code>99.1</code>% degree of confidence, even with different angles, lighting, and shades:</p><div><img src="img/B16061_06_57.jpg" alt="Figure 6.57: Results for the first images provided for face comparison&#13;&#10;"/></div><p class="figure-caption">Figure 6.57: Results for the first images provided for face comparison</p><p><strong class="bold">Additional Challenge</strong></p></li>
				<li>The second set of images are <a href="https://images.unsplash.com/photo-1526510747491-58f928ec870f">https://images.unsplash.com/photo-1526510747491-58f928ec870f</a> and <a href="https://images.unsplash.com/photo-1529946179074-87642f6204d7">https://images.unsplash.com/photo-1529946179074-87642f6204d7</a>:</li>
			</ol>
			<div><div><img src="img/B16061_06_58.jpg" alt="Figure 6.58: The second images provided for face comparison&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.58: The second images provided for face comparison</p>
			<p>Once again, Rekognition recognizes the faces with a 99.4% degree of confidence, even at different angles:</p>
			<div><div><img src="img/B16061_06_59.jpg" alt="Figure 6.59: Results for the second images provided for face comparison&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.59: Results for the second images provided for face comparison</p>
			<p>With those impressive results, we conclude this activity. </p>
		</div>
		<div><div></div>
		</div>
	</body></html>