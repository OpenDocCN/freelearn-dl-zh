- en: '9'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '9'
- en: Upgrading the GenAISys with Data Security and Moderation for Customer Service
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 为客户服务升级GenAISys的数据安全和适度
- en: In this chapter, we will open up our GenAISys by integrating it with real-world
    online services—specifically, by connecting it to an online weather API. This
    will enable the fictional online travel agency that we’ve been supporting throughout
    the book to access real-time weather data. Weather reports for a specific location
    serve as an entry point for various tasks essential to the agency’s operations,
    such as marketing initiatives, recommendations for tourist activities, and coordinating
    product deliveries.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将通过将其与真实世界的在线服务集成来开放我们的GenAISys——具体来说，通过将其连接到在线天气API。这将使我们在整本书中一直支持的虚构在线旅行社能够访问实时天气数据。特定位置的天气预报是旅行社运营中各种必要任务的切入点，例如营销活动、旅游活动推荐和产品交付协调。
- en: 'Connecting our GenAISys to external online resources transitions our system
    from a controlled internal environment to the unpredictable realm of real-time
    data interactions. This transition, however, introduces critical security concerns.
    Opening a system without adequate protections can inadvertently expose sensitive
    data or cause security breaches, posing genuine risks both to users and the organization
    itself. As such, robust security measures are a prerequisite before fully integrating
    external services. Therefore, this chapter presents a threefold challenge: implementing
    the weather service using the OpenWeather API, building a moderation system leveraging
    OpenAI’s moderation capabilities, and developing a RAG-based data security function
    with Pinecone, which will detect and prevent sensitive-topic breaches. We will
    rely heavily on the flexible and powerful handler selection mechanism of our existing
    GenAISys architecture to seamlessly integrate these new functionalities. Our objective
    remains clear—minimal code enhancements with maximum functional impact.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 将我们的GenAISys连接到外部在线资源，使我们的系统从受控的内部环境过渡到不可预测的实时数据交互领域。然而，这种过渡引入了关键的安全问题。在没有足够保护的情况下打开系统可能会无意中暴露敏感数据或导致安全漏洞，对用户和整个组织都构成真正的风险。因此，在完全集成外部服务之前，强大的安全措施是必不可少的。因此，本章提出了三项挑战：使用OpenWeather
    API实现天气服务、利用OpenAI的适度能力构建适度系统，以及开发一个基于RAG的数据安全功能，使用Pinecone来检测和预防敏感主题的违规行为。我们将严重依赖现有GenAISys架构中灵活且强大的处理选择机制，以无缝集成这些新功能。我们的目标依然明确——最小化代码增强，最大化功能影响。
- en: The chapter begins by detailing how these additional components—moderation,
    data security, and real-time weather—fit into the overall architecture of the
    GenAISys. Then, we’ll dive under the surface to build the moderation function
    using OpenAI’s moderation endpoint. We will then construct a RAG-powered data
    security module, using Pinecone, to proactively detect and filter out sensitive
    or inappropriate inputs. By integrating these two security layers directly into
    the GenAISys’s handler selection mechanism, we ensure comprehensive protection
    against unwanted interactions.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本章首先详细介绍了这些额外组件——适度、数据安全和实时天气——如何融入GenAISys的整体架构。然后，我们将深入探讨，利用OpenAI的适度端点构建适度功能。接着，我们将构建一个由RAG驱动的数据安全模块，使用Pinecone来主动检测和过滤掉敏感或不适当的内容。通过将这些两层安全措施直接集成到GenAISys的处理选择机制中，我们确保了对不受欢迎的交互的全面保护。
- en: With security firmly in place, we will then implement the OpenWeather API. This
    integration allows us to retrieve live, real-time weather information to power
    a range of engaging, user-centric tasks. Finally, we will demonstrate the capabilities
    of the enhanced GenAISys through practical, multimodal, multi-user scenarios—such
    as generating weather-based activity recommendations, crafting customized promotional
    images for travel merchandise, and dynamically creating personalized weather-aware
    messages for travelers. By the end of this chapter, you’ll be fully equipped to
    adapt the core architecture and concepts we’ve explored in the GenAISys to real-world
    applications, confidently delivering a comprehensive, secure, and highly functional
    **proof of concept**.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 在安全措施得到巩固后，我们将实施 OpenWeather API。这种集成使我们能够检索实时天气信息，以支持一系列引人入胜、以用户为中心的任务。最后，我们将通过实际的多模式、多用户场景——例如基于天气的活动推荐、为旅游商品制作定制化的促销图片以及为旅行者动态创建个性化的天气感知信息——来展示增强型
    GenAISys 的功能。到本章结束时，你将完全准备好将我们在 GenAISys 中探索的核心架构和概念应用于现实世界应用，自信地交付一个全面、安全且高度功能性的
    **概念验证**。
- en: 'This chapter covers the following topics:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖以下主题：
- en: Enhancing the GenAISys
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 增强 GenAISys
- en: Adding a security function to the handler selection mechanism
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将安全功能添加到处理程序选择机制
- en: Building the weather forecast component
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建天气预报组件
- en: Running use cases in the GenAISys
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 GenAISys 中运行用例
- en: Let’s start by clearly mapping out how the new moderation, data security, and
    weather functions integrate into our GenAISys.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们先明确地绘制出新审查、数据安全和天气功能如何集成到我们的 GenAISys 中。
- en: Enhancing the GenAISys
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 增强 GenAISys
- en: Integrating moderation, data security, and real-time weather functionalities
    into our GenAISys will affect all three architectural layers, as illustrated in
    *Figure 9.1*. We will rely on the framework built around our handler selection
    mechanism to make this three-level, three-function implementation seamless.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 将审查、数据安全和实时天气功能集成到我们的 GenAISys 中将影响所有三个架构层，如图 9.1 所示。我们将依靠围绕我们的处理程序选择机制构建的框架来实现这一三级、三功能的无缝实施。
- en: '![Figure 9.1: Moderation, data security, and weather report integration](img/B32304_09_1.png)'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![图 9.1：审查、数据安全和天气预报集成](img/B32304_09_1.png)'
- en: 'Figure 9.1: Moderation, data security, and weather report integration'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.1：审查、数据安全和天气预报集成
- en: 'The implementation will impact all three layers as follows:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 实施将对所有三个层次产生以下影响：
- en: '**Layer 1 (IPython interface)**: We’ll introduce a new **Weather** option within
    the **Reasoning** drop-down menu of the IPython interface. Why place it here?
    Because in real-world project settings, the weather report function could easily
    be expanded into a more complex, multi-step **chain-of-thought** (**CoT**) pipeline,
    enabling the generation of sophisticated, context-aware outputs based on weather
    conditions.'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**层 1 (IPython 接口)**: 我们将在 IPython 接口的 **推理** 下拉菜单中引入一个新的 **天气** 选项。为什么放在这里？因为在现实世界的项目设置中，天气预报功能可以很容易地扩展成一个更复杂的多步骤
    **思维链** (**CoT**) 流程，从而根据天气条件生成复杂、上下文感知的输出。'
- en: '**Layer 2 (AI agent)**: The central orchestrator of our GenAISys, the handler
    selection mechanism, will now manage an additional component—the real-time weather
    forecasting capability. More critically, we’ll enhance the handler with an integrated
    moderation and data security mechanism that will function as an immediate *kill
    switch*, instantly terminating the process and returning a security warning to
    the user when inappropriate or sensitive content is detected.'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**层 2 (AI 代理)**: 我们 GenAISys 的核心协调器，即处理程序选择机制，现在将管理一个额外的组件——实时天气预报能力。更重要的是，我们将为处理程序集成一个综合的审查和数据安全机制，该机制将作为一个立即的
    *关闭开关*，一旦检测到不适当或敏感内容，将立即终止进程并向用户返回安全警告。'
- en: '**Layer 3 (functions and agents)**: Three new key functions—moderation, data
    security, and weather forecast retrieval—will be implemented at this level. The
    moderation and data security checks will reside outside the handler registry since
    their roles are not optional. As depicted in *Figure 9.2*, these two functions
    will form a mandatory global security barrier directly controlled by the handler
    selection mechanism, protecting users and company data before initiating any further
    tasks.'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第 3 层（功能和代理）**：将在这一层实现三个新的关键功能——审核、数据安全和天气预报检索。由于这些功能是必需的，因此审核和数据安全检查将位于处理程序注册表之外。如*图
    9.2*所示，这两个功能将形成一个强制性的全局安全屏障，直接由处理程序选择机制控制，在启动任何进一步任务之前保护用户和公司数据。'
- en: '![Figure 9.2: Security and moderation checks are directly managed within the
    handler selection mechanism](img/B32304_09_2.png)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![图 9.2：安全和审核检查直接在处理程序选择机制中管理](img/B32304_09_2.png)'
- en: 'Figure 9.2: Security and moderation checks are directly managed within the
    handler selection mechanism'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.2：安全和审核检查直接在处理程序选择机制中管理
- en: This security system will proactively intercept and evaluate each user input,
    blocking further processing and immediately alerting the user via the IPython
    interface if inappropriate or sensitive content is detected.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 此安全系统将主动拦截和评估每个用户输入，如果检测到不适当或敏感内容，将通过 IPython 接口阻止进一步处理并立即向用户发出警报。
- en: 'While building and showcasing your GenAISys as a flexible proof of concept,
    remember to demonstrate its scalability clearly. Highlight its potential for integration
    with additional AI functions, further security features, or alternative generative
    models. However, exercise caution: avoid prematurely adding functionalities without
    concrete project requirements, as this can lead to unnecessary complexity or overdeveloping
    your project. The goal is to clearly show the project’s potential without investing
    resources in unrequested developments.'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在构建和展示 GenAISys 作为灵活的证明概念时，请务必清楚地展示其可扩展性。突出其与附加 AI 功能、进一步的安全功能或替代生成模型的集成潜力。然而，要谨慎行事：避免在没有具体项目要求的情况下提前添加功能，因为这可能导致不必要的复杂性或过度开发项目。目标是清楚地展示项目的潜力，而不在未经请求的开发上投入资源。
- en: With this strategic clarity in mind, we will begin by constructing the security
    function.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 带着这种战略清晰度，我们将首先构建安全功能。
- en: Adding a security function to the handler selection mechanism
  id: totrans-25
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将安全功能添加到处理程序选择机制中
- en: 'In this section, we will build the **security function**, the **moderation
    function**, and the **data security function**, as illustrated in *Figure 9.3*:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将构建**安全功能**、**审核功能**和**数据安全功能**，如*图 9.3*所示：
- en: '![Figure 9.3: The handler selection mechanism directly calls the security function](img/B32304_09_3.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![图 9.3：处理程序选择机制直接调用安全功能](img/B32304_09_3.png)'
- en: 'Figure 9.3: The handler selection mechanism directly calls the security function'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.3：处理程序选择机制直接调用安全功能
- en: 'We’ll implement these functions as follows:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将按以下方式实现这些功能：
- en: The security function will call the moderation function
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安全功能将调用审核功能
- en: The security function will also call the data security function
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安全功能还将调用数据安全功能
- en: The moderation function will contain subfunctions
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 审核功能将包含子功能
- en: The data security function will ensure compliance with security standards
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据安全功能将确保符合安全标准
- en: Let’s first build the security function along with its calls.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们首先构建安全功能及其调用。
- en: Implementing the security function
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 实现安全功能
- en: The security function is directly integrated with the handler selection mechanism,
    as illustrated in *Figure 9.4*. It receives the user message directly, prior to
    any handler selection in the handler registry. If the user message violates the
    GenAISys content policy, the security function returns a `False` flag (indicating
    a content violation) to the IPython interface.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 安全功能直接集成到处理程序选择机制中，如*图 9.4*所示。它直接接收用户消息，在处理程序注册表中的任何处理程序选择之前。如果用户消息违反 GenAISys
    内容策略，安全功能将向 IPython 接口返回一个 `False` 标志（表示内容违规）。
- en: '![Figure 9.4: The security function is directly connected to the handler selection
    mechanism](img/B32304_09_4.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![图 9.4：安全功能直接连接到处理程序选择机制](img/B32304_09_4.png)'
- en: 'Figure 9.4: The security function is directly connected to the handler selection
    mechanism'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.4：安全功能直接连接到处理程序选择机制
- en: 'Open `GenAISys_Customer_Service.ipynb` and go to the *Security* section within
    the Chapter09 directory on GitHub ([https://github.com/Denis2054/Building-Business-Ready-Generative-AI-Systems/tree/main](https://github.com/Denis2054/Building-Business-Ready-Generative-AI-Systems/tree/main)).
    We first create the function that sets the `securitym` flag to `True`, signifying
    the content does not violate content policies. Also in this function, `securityd=True`
    shows that no sensitive topic has been detected and that the message is data security-compliant:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 打开 `GenAISys_Customer_Service.ipynb` 并转到GitHub上Chapter09目录中的*安全*部分 ([https://github.com/Denis2054/Building-Business-Ready-Generative-AI-Systems/tree/main](https://github.com/Denis2054/Building-Business-Ready-Generative-AI-Systems/tree/main))。我们首先创建一个函数，将
    `securitym` 标志设置为 `True`，表示内容不违反内容策略。在此函数中，`securityd=True` 表示未检测到敏感主题，消息符合数据安全标准：
- en: '[PRE0]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '![](img/3-PPMUMLAP0325.png)**Quick tip**: Enhance your coding experience with
    the **AI Code Explainer** and **Quick Copy** features. Open this book in the next-gen
    Packt Reader. Click the **Copy** button'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '![](img/3-PPMUMLAP0325.png)**快速提示**：使用**AI代码解释器**和**快速复制**功能增强您的编码体验。在下一代 Packt
    Reader 中打开此书。点击**复制**按钮'
- en: (**1**) to quickly copy code into your coding environment, or click the **Explain**
    button
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: （**1**）快速将代码复制到您的编码环境，或点击**解释**按钮
- en: (**2**) to get the AI assistant to explain a block of code to you.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: （**2**）让AI助手为您解释代码块。
- en: '![A white background with a black text  AI-generated content may be incorrect.](img/image_%282%29.png)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![白色背景，黑色文字  AI生成的内容可能不正确。](img/image_%282%29.png)'
- en: '![](img/4.png)**The next-gen Packt Reader** is included for free with the purchase
    of this book. Scan the QR code OR visit [packtpub.com/unlock](http://packtpub.com/unlock),
    then use the search bar to find this book by name. Double-check the edition shown
    to make sure you get the right one.'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '![](img/4.png)**下一代 Packt Reader** 在购买本书时免费提供。扫描二维码或访问 [packtpub.com/unlock](http://packtpub.com/unlock)，然后使用搜索栏通过名称查找本书。请仔细核对显示的版本，以确保您获得正确的版本。'
- en: '![A qr code on a white background  AI-generated content may be incorrect.](img/Unlock_Code1.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![白色背景上的二维码  AI生成的内容可能不正确。](img/Unlock_Code1.png)'
- en: 'The function begins by calling the moderation and content acceptability functions:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 函数开始时调用审核和内容可接受性函数：
- en: '[PRE1]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '`moderation(user_message)` invokes the OpenAI moderation API'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`moderation(user_message)` 调用 OpenAI 审核API'
- en: '`is_acceptable(user_message, response)` processes the moderation response'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`is_acceptable(user_message, response)` 处理审核响应'
- en: The debugging line (`print(securitym)`) can be uncommented during testing or
    troubleshooting
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在测试或故障排除期间可以取消注释调试行 (`print(securitym)`)
- en: 'Next, the security function calls the data security function, which checks
    for sensitive topics within the user message:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，安全函数调用数据安全函数，检查用户消息中的敏感主题：
- en: '[PRE2]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The `securityd` variable will store either `True` or `False`, depending on whether
    the message meets the data security criteria.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '`securityd` 变量将存储 `True` 或 `False`，具体取决于消息是否符合数据安全标准。'
- en: 'The final part of the function evaluates both flags (`securitym` and `securityd`)
    and returns the security status accordingly:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 函数的最后部分评估两个标志（`securitym` 和 `securityd`），并根据结果返回安全状态：
- en: '[PRE3]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: If you prefer not to activate the moderation or data security checks, you can
    comment out the relevant lines in the security function—specifically, the code
    between the assignments of `securitym=True` and `securityd=True`, and the `if
    securitym==False` or `securityd==False` conditional statement. This way, the function
    defaults to always returning `True`.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您不想激活审核或数据安全检查，可以在安全函数中取消注释相关行——特别是 `securitym=True` 和 `securityd=True` 赋值之间的代码，以及
    `if securitym==False` 或 `securityd==False` 条件语句。这样，函数默认始终返回 `True`。
- en: Let’s now examine how the handler selection mechanism interacts with the IPython
    interface.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看看处理器选择机制如何与IPython界面交互。
- en: Handler selection mechanism interactions
  id: totrans-59
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 处理器选择机制交互
- en: The handler selection mechanism and IPython interface interact closely, as shown
    in *Figure 9.5*. When the IPython interface sends a user message to the handler
    selection mechanism, it determines whether the message complies with security
    policies.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 处理器选择机制和IPython界面紧密交互，如*图9.5*所示。当IPython界面将用户消息发送到处理器选择机制时，它确定消息是否符合安全策略。
- en: '![Figure 9.5: Handler selection mechanism and IPython interactions](img/B32304_09_5.png)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![图9.5：处理器选择机制与IPython交互](img/B32304_09_5.png)'
- en: 'Figure 9.5: Handler selection mechanism and IPython interactions'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.5：处理器选择机制与IPython交互
- en: 'The primary structure of the handler selection mechanism function remains unchanged
    from previous chapters:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 处理程序选择机制函数的主要结构在之前的章节中保持不变：
- en: '[PRE4]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'However, at the start of this function, we now call the security function.
    It returns a security status (`True` for compliant or `False` for non-compliant):'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，在这个函数的开始，我们现在调用安全函数。它返回一个安全状态（对于合规的返回`True`，对于不合规的返回`False`）：
- en: '[PRE5]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: If the message is flagged as non-compliant, a clear message will be immediately
    returned to the user interface. We will test security function examples thoroughly
    in the *Running security checks* section later. Before that, let’s move forward
    by implementing the moderation function.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 如果消息被标记为不合规，将立即向用户界面返回一个清晰的消息。我们将在*运行安全检查*部分中彻底测试安全函数示例。在那之前，让我们通过实现审查功能来继续前进。
- en: Implementing the moderation function
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 实现审查功能
- en: 'We will use OpenAI Omni, which has a comprehensive range of categorization
    options, as the moderation model: [https://platform.openai.com/docs/guides/moderation](https://platform.openai.com/docs/guides/moderation).'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用OpenAI Omni，它具有全面的分类选项，作为审查模型：[https://platform.openai.com/docs/guides/moderation](https://platform.openai.com/docs/guides/moderation)。
- en: Open the `GenAISys_Customer_Service.ipynb` notebook and navigate to the *Moderation*
    subsection within the *Security* section. The moderation function will be directly
    invoked by the handler selection mechanism, as illustrated in *Figure 9.6*. It
    classifies user messages and provides details about any inappropriate content
    flagged during processing.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 打开`GenAISys_Customer_Service.ipynb`笔记本，并导航到*安全*部分内的*审查*子部分。审查功能将由处理程序选择机制直接调用，如图9.6所示。它将分类用户消息，并在处理过程中提供任何被标记为不适当内容的详细信息。
- en: '![Figure 9.6: Calling the moderation function](img/B32304_09_6.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![图9.6：调用审查函数](img/B32304_09_6.png)'
- en: 'Figure 9.6: Calling the moderation function'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.6：调用审查函数
- en: 'We will implement the moderation function with OpenAI Omni as follows:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将按照以下方式使用OpenAI Omni实现审查功能：
- en: '[PRE6]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'This function processes the user message and returns a moderation response.
    Once received by the security function, the response is sent to another function,
    `is_acceptable`, to evaluate whether the message is acceptable or not:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 此函数处理用户消息并返回一个审查响应。一旦被安全函数接收，响应将被发送到另一个函数`is_acceptable`以评估消息是否可接受：
- en: '[PRE7]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The response contains `response.results[0].flagged`, which provides a `True`
    value if the content is flagged or a `False` status if the response is acceptable.
    If the content is flagged, the details of the response will be saved in a timestamped
    JSON file:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 响应包含`response.results[0].flagged`，如果内容被标记，则提供`True`值，如果响应可接受，则提供`False`状态。如果内容被标记，响应的详细信息将被保存在一个带时间戳的JSON文件中：
- en: '[PRE8]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Finally, the function returns the flagged status as `not_flagged`:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，函数返回标记状态为`not_flagged`：
- en: '[PRE9]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'If the message is flagged, details are saved in a timestamped JSON file located
    within the `/logs` subdirectory. The resulting JSON file contains a unique ID,
    the model used, and the status of a wide range of categories:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 如果消息被标记，详细信息将被保存在位于`/logs`子目录中的带时间戳的JSON文件中。生成的JSON文件包含一个唯一ID、使用的模型以及一系列类别的状态：
- en: '[PRE10]'
  id: totrans-82
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'In this case, the `harassment` category has been flagged, for example. The
    file also contains a score for each category, as shown in this excerpt from the
    file:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，`骚扰`类别已被标记，例如。文件还包含每个类别的分数，如下面文件摘录所示：
- en: '[PRE11]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'To perform a quick quality control check or evaluate specific user messages
    manually, uncomment and use the following lines in your notebook:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行快速质量控制检查或手动评估特定用户消息，请在您的笔记本中取消以下行的注释：
- en: '[PRE12]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: The file containing the information can be processed further with other functions
    as required for your project. We could add the user to the file. We can also view
    the details of the dialogue to find which user entered the flagged message in
    the *Load and display the conversation history* section of the notebook. We will
    go through these features in the *Running security checks* section later.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 包含这些信息的文件可以根据您项目的需要使用其他功能进一步处理。我们可以将用户添加到文件中。我们还可以在笔记本的*加载和显示对话历史记录*部分查看对话的详细信息，以找出哪个用户输入了被标记的消息。我们将在*运行安全检查*部分中详细介绍这些功能。
- en: Let’s now build the data security function.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们构建数据安全函数。
- en: Building the data security function
  id: totrans-89
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 构建数据安全函数
- en: 'We will now build a data security function designed to detect whether a user
    message contains sensitive topics. This function covers a wide spectrum of security-related
    concerns, from safeguarding confidential information to preventing inappropriate
    or sensitive discussions through the GenAISys interface. The data security function
    comprises two components, as shown in *Figure 9.7*: the first component populates
    a Pinecone index with sensitive topics, and the second component queries this
    index to detect sensitive topics within user messages.'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将构建一个数据安全功能，用于检测用户消息是否包含敏感主题。此功能涵盖了广泛的与安全相关的问题，从保护机密信息到通过GenAISys界面防止不适当或敏感的讨论。数据安全功能包含两个组件，如图9.7所示：第一个组件将敏感主题填充到Pinecone索引中，第二个组件查询此索引以检测用户消息中的敏感主题。
- en: '![Figure 9.7: The two components of the data security function](img/B32304_09_7.png)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![图9.7：数据安全功能的两个组件](img/B32304_09_7.png)'
- en: 'Figure 9.7: The two components of the data security function'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.7：数据安全功能的两个组件
- en: Populating the Pinecone index
  id: totrans-93
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 填充Pinecone索引
- en: We will first populate the Pinecone index with sensitive topics. Open `Pinecone_Security.ipynb`.
    This notebook mirrors the structure of the earlier notebook from [*Chapter 3*](Chapter_3.xhtml#_idTextAnchor085)(`Chapter03/Pinecone_instruction_scenarios.ipynb`).
    We will simply adapt it here to accommodate sensitive topics. Feel free to revisit
    `Pinecone_instruction_scenarios.ipynb` for a detailed refresher if needed.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先将敏感主题填充到Pinecone索引中。打开`Pinecone_Security.ipynb`。这个笔记本反映了早期笔记本的结构[*第3章*](Chapter_3.xhtml#_idTextAnchor085)（`Chapter03/Pinecone_instruction_scenarios.ipynb`）。我们只需将其适应此处以容纳敏感主题。如有需要，请随时回顾`Pinecone_instruction_scenarios.ipynb`以进行详细的复习。
- en: 'We’ll briefly cover the code sections specifically adapted for this domain.
    The first step involves downloading our `sensitive_topics` dataset:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将简要介绍针对此领域特别适配的代码部分。第一步是下载我们的`sensitive_topics`数据集：
- en: '[PRE13]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The file, `sensitive_topics.csv`, contains 100 sensitive topics structured
    as follows:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 文件`sensitive_topics.csv`包含100个敏感主题，结构如下：
- en: '`id`: A unique identifier ranging from `1000` to `1099`'
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`id`：一个范围从`1000`到`1099`的唯一标识符'
- en: '`values`: Text descriptions of sensitive topics'
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`values`：敏感主题的文本描述'
- en: 'For example, the first topic is as follows:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，第一个主题如下：
- en: '[PRE14]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: If a user message contains content similar to this topic, for example, it will
    be flagged. Vector-based similarity searches provide more nuanced detection than
    traditional methods.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 如果用户消息包含与该主题类似的内容，例如，它将被标记。基于向量的相似性搜索比传统方法提供更细致的检测。
- en: 'The next step is to chunk the data from the `sensitive_topics.csv` file:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是从`sensitive_topics.csv`文件中分块数据：
- en: '[PRE15]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'We then create a namespace within Pinecone to hold this sensitive data. We
    will call this namespace `security`:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 我们然后在Pinecone中创建一个命名空间来存储这些敏感数据。我们将称此命名空间为`security`：
- en: '[PRE16]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'The upserting function remains unchanged, retaining the same column names as
    in the `.csv` file:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 插入更新函数保持不变，保留与`.csv`文件相同的列名：
- en: '[PRE17]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: With the data now populated in Pinecone, we’ll proceed to implement the query
    component.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 现在数据已填充到Pinecone中，我们将继续实现查询组件。
- en: Querying the Pinecone index
  id: totrans-110
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 查询Pinecone索引
- en: Open `GenAISys_Customer_Service.ipynb` and navigate to the *Data security* subsection
    in the *Security* section. The goal here is to determine whether a user message
    matches any sensitive topics stored in the Pinecone security index. If a match
    is found, the message will be flagged.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 打开`GenAISys_Customer_Service.ipynb`并导航到“安全”部分的“数据安全”子部分。此处的目标是确定用户消息是否与存储在Pinecone安全索引中的任何敏感主题匹配。如果找到匹配项，则消息将被标记。
- en: 'Initially, we set default security indicators:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 初始时，我们设置了默认的安全指标：
- en: '[PRE18]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: The default value, `sec`, is set to `True`, meaning that the user message is
    secure until found otherwise. Additionally, `target_id` is set to `0` to show
    that no record in the Pinecone index has been found yet. Additionally, we have
    a security level threshold, `security_level`, that can be set to the value deemed
    necessary in production. You can modify it here in the code or create a security
    interface once your strategy has been decided with your team. In this case, `security_level`
    is set to `0.30` to avoid filtering low-level security items in this educational
    example.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 默认值 `sec` 被设置为 `True`，这意味着用户消息在未发现其他情况之前是安全的。此外，`target_id` 被设置为 `0`，表示尚未在 Pinecone
    索引中找到记录。此外，我们有一个安全级别阈值 `security_level`，在生产中可以将其设置为认为必要的值。您可以在代码中修改它，或者一旦与团队决定策略，创建一个安全接口。在这种情况下，`security_level`
    被设置为 `0.30` 以避免在此教育示例中过滤低级别安全项。
- en: 'We then define our namespace for querying:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 我们随后定义我们的命名空间以进行查询：
- en: '[PRE19]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'We then query the Pinecone index to detect sensitive topics:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 我们随后查询 Pinecone 索引以检测敏感话题：
- en: '[PRE20]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'We now extract the score, which we will use as our security level threshold:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在提取分数，我们将将其用作安全级别阈值：
- en: '[PRE21]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Now, we can display the results:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以显示结果：
- en: '[PRE22]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'If a similar sensitive topic is found (indicated by a score that exceeds the
    threshold), we have a security logic process:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 如果发现类似敏感话题（通过得分超过阈值来指示），我们将启动安全逻辑流程：
- en: '[PRE23]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'The query results are tracked and the details are recorded:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 查询结果将被跟踪并记录详细信息：
- en: '[PRE24]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'The result, `True` (non-sensitive) or `False` (sensitive), is returned to the
    security function:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 结果，`True`（非敏感）或 `False`（敏感），被返回到安全功能：
- en: '[PRE25]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'To manually evaluate messages, you can uncomment the following code snippet:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 要手动评估消息，您可以取消注释以下代码片段：
- en: '[PRE26]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Let’s now run security checks for moderation and sensitive data classification.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们运行审查和敏感数据分类的安全检查。
- en: Running security checks
  id: totrans-132
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 正在运行安全检查
- en: 'We’ll perform two security evaluations: one for moderation (harassment) and
    another for sensitive data. Let’s first begin with a moderation user message.'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将执行两个安全评估：一个用于审查（骚扰）和一个用于敏感数据分类。让我们首先从审查用户消息开始。
- en: 'Consider a user message that contains harassment content, as shown here:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑一个包含骚扰内容的用户消息，如下所示：
- en: '![Figure 9.8: A harassing message](img/B32304_09_8.png)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![图 9.8：骚扰信息](img/B32304_09_8.png)'
- en: 'Figure 9.8: A harassing message'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.8：骚扰信息
- en: 'The moderation function detects the inappropriate content:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 审查功能检测到不适当的内容：
- en: '[PRE27]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'A JSON file containing the flagged message is created in the `/logs` directory:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `/logs` 目录中创建包含标记消息的 JSON 文件：
- en: '[PRE28]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'The file contains the moderation categories and has flagged the user message
    as `harassment`:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 该文件包含审查类别，并将用户消息标记为 `骚扰`：
- en: '[PRE29]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'The probability is also logged:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 概率也被记录：
- en: '[PRE30]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'We now have a data security function. When we run a security check for a sensitive
    topic, such as referring to mismanaged client funds, the output confirms the detection
    of a sensitive topic:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有一个数据安全功能。当我们对敏感话题进行安全检查，例如提及管理不善的客户资金时，输出确认检测到敏感话题：
- en: '[PRE31]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'A file containing the flagged message is created :'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 创建包含标记消息的文件：
- en: '[PRE32]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'This file contains a record of the flagged message in the Pinecone index:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 此文件包含在 Pinecone 索引中标记消息的记录：
- en: '[PRE33]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Both moderation and sensitive data checks have created detailed records. These
    logs can be further expanded with user profiles or additional data as your project
    needs evolve. Additionally, the GenAISys stores full dialogue histories (`conversation_history.json`)
    and summarizations for future reference and auditing. The conversation history
    is activated when we enter `exit`:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 审查和敏感数据检查都创建了详细的记录。这些日志可以根据项目需求的发展进一步扩展，包括用户配置文件或附加数据。此外，GenAISys 存储完整的对话历史记录
    (`conversation_history.json`) 和摘要，以供未来参考和审计。当我们输入 `exit` 时，会话历史记录被激活：
- en: '[PRE34]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'The *Load and display the conversation history* outputs contain the log of
    the conversation with the usernames and security flags:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '*加载并显示会话历史记录* 输出包含带有用户名和安全标志的会话日志：'
- en: '[PRE35]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'The raw log of the conversation is saved in `/content/conversation_history.json`
    for further use. The *Load and summarize the conversation history* section contains
    a summary of the dialogue, which includes the username, user messages, and assistant’s
    responses:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 会话的原始日志被保存在 `/content/conversation_history.json` 中，以供进一步使用。*加载并总结会话历史记录* 部分包含对话的摘要，包括用户名、用户消息和助手的回复：
- en: '[PRE36]'
  id: totrans-156
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: With these core functionalities in place, our system’s moderation and security
    measures can be easily adapted or expanded to meet your project-specific requirements.
    We’re now ready to move forward by integrating an external weather forecast component.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 在这些核心功能到位后，我们系统的审核和安全措施可以轻松调整或扩展以满足您项目的特定要求。我们现在可以继续前进，通过集成外部天气预报组件来整合。
- en: Building a weather forecast component
  id: totrans-158
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 构建天气预报组件
- en: In this section, we’ll cautiously open up the GenAISys by integrating a weather
    forecast library and building a dedicated weather forecast function using an external
    API. This integration allows our GenAISys to interact directly with real-time
    weather information, providing a pathway to more controlled interactions with
    external web services. After successfully implementing this functionality, the
    GenAISys could be authorized to interact with other websites as needed.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将通过集成天气预报库和构建使用外部 API 的专用天气预报功能来谨慎地打开 GenAISys。这种集成允许我们的 GenAISys 直接与实时天气信息交互，为与外部网络服务的更受控交互提供途径。在成功实现此功能后，GenAISys
    可以根据需要授权与其他网站交互。
- en: We’ll implement real-time weather forecasts for specific locations (cities in
    this case) to support marketing, production planning, deliveries, and customer
    service, as illustrated in the upcoming *Running the GenAISys* section.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将为特定位置（例如城市）实现实时天气预报，以支持市场营销、生产计划、配送和客户服务，如即将到来的 *运行 GenAISys* 部分所示。
- en: Open the `GenAISys_Customer_Service.ipynb` notebook. The notebook uses the OpenWeather
    API, available at [https://home.openweathermap.org/](https://home.openweathermap.org/).
    OpenWeather provides a wide range of weather forecasting services, but we will
    focus specifically on real-time forecasts suitable for our use case.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 打开 `GenAISys_Customer_Service.ipynb` 笔记本。该笔记本使用 OpenWeather API，可在 [https://home.openweathermap.org/](https://home.openweathermap.org/)
    找到。OpenWeather 提供了广泛的天气预报服务，但我们将专注于适合我们用例的实时预报。
- en: To use the OpenWeather API, sign up for an account, obtain your API key, and
    carefully review their pricing plans at [https://openweathermap.org/price](https://openweathermap.org/price).
    At the time of writing, the API calls required for our examples are available
    under their free tier, subject to request limits. Please confirm the cost and
    limits before proceeding.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用 OpenWeather API，请注册账户，获取您的 API 密钥，并仔细查看他们的定价计划 [https://openweathermap.org/price](https://openweathermap.org/price)。在撰写本文时，我们示例中所需的
    API 调用可在其免费层中获取，但受请求限制。请在继续之前确认费用和限制。
- en: 'We will seamlessly integrate our weather forecast function into the GenAISys
    framework using the handler selection mechanism, as depicted in *Figure 9.9*:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用处理选择机制，如图 *图 9.9* 所示，无缝地将我们的天气预报功能集成到 GenAISys 框架中：
- en: '![Figure 9.9: Integrating a weather forecast API in the GenAISys framework](img/B32304_09_9.png)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![图 9.9：在 GenAISys 框架中集成天气预报 API](img/B32304_09_9.png)'
- en: 'Figure 9.9: Integrating a weather forecast API in the GenAISys framework'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.9：在 GenAISys 框架中集成天气预报 API
- en: 'Once we set the OpenWeather environment up, we will integrate the weather forecast
    function seamlessly with the handler selection mechanism framework:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们设置了 OpenWeather 环境，我们将无缝地将天气预报功能与处理选择机制框架集成：
- en: '**IPython interface**: Add a **Weather forecast** option to the interface.'
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**IPython 接口**：在界面中添加 **天气预报** 选项。'
- en: '**Handler selection mechanism**: No change.'
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**处理选择机制**：无变化。'
- en: '**Handler registry**: Include a dedicated weather forecast handler.'
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**处理注册表**：包含一个专门的天气预报处理程序。'
- en: '**AI functions**: Develop a specific weather forecast function.'
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**AI 功能**：开发特定的天气预报功能。'
- en: Let’s first set up the OpenWeather environment.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们先设置 OpenWeather 环境。
- en: Setting up the OpenWeather environment
  id: totrans-172
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 设置 OpenWeather 环境
- en: In `GenAISys_Customer_Service.ipynb`, go to the *Weather* subsection under the
    *Setting up the environment* section.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `GenAISys_Customer_Service.ipynb` 中，转到 *设置环境* 部分的 *天气* 子部分。
- en: 'First, download the script for retrieving your OpenWeather API key from Google
    Secrets:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，从 Google Secrets 下载获取您的 OpenWeather API 密钥的脚本：
- en: '[PRE37]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'The notebook then runs the API key initialization function:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 笔记本随后运行 API 密钥初始化函数：
- en: '[PRE38]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'Then, initialize the API key using this function:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，使用此函数初始化 API 密钥：
- en: '[PRE39]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'You can also set the API key with another method, depending on the environment
    you are running the notebook in. We begin by double-checking that `api_key` is
    set:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 您也可以使用另一种方法设置 API 密钥，具体取决于您在哪个环境中运行笔记本。我们首先确保 `api_key` 已设置：
- en: '[PRE40]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: This double-check is not obligatory; it just ensures that the code is robust
    if the session is interrupted by micro web interruptions, for example. Feel free
    to remove the redundant check if your environment is stable.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 这种双重检查不是强制性的；它只是确保如果会话因微网页中断而中断，代码仍然是健壮的。如果您的环境稳定，请随意删除冗余检查。
- en: 'The OpenWeather call is remarkably simple. It requires only your API key and
    the city name:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: OpenWeather的调用非常简单。它只需要您的API密钥和城市名称：
- en: '[PRE41]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: Note that `metric` is a specific keyword defined by the OpenWeatherMap API,
    meaning degrees **Celsius** (**C**), and also provides the wind speed in **meters
    per second** (**m/s**). If you want US customary units, change metric to imperial,
    `&units=imperial`, and you will obtain degrees **Fahrenheit** (**°F**) and windspeed
    in **miles per hour** (**mph**).
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，`metric`是OpenWeatherMap API定义的特定关键字，表示摄氏度**C**，同时也提供风速为**米/秒**（**m/s**）。如果您想使用美国习惯单位，将`metric`改为`imperial`，`&units=imperial`，您将获得华氏度**F**和风速为**英里/小时**（**mph**）。
- en: 'We now just have to make the request and retrieve the response:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在只需发出请求并检索响应：
- en: '[PRE42]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'We will now extract and return the real-time weather information we need for
    our use case. We will use the current temperature, a brief weather description,
    and the wind speed:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将提取并返回我们用例所需的实时天气信息。我们将使用当前温度、简短的天气描述和风速：
- en: '[PRE43]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: Note that we only provided the name of the city, not the country. The OpenWeatherMap
    API has a smart system for handling requests for cities with the same name in
    different locations. When it searches for “Paris,” it defaults to the most prominent
    and well-known location, which is Paris, France.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，我们只提供了城市名称，没有提供国家。OpenWeatherMap API有一个智能系统来处理不同位置具有相同名称的城市的请求。当它搜索“巴黎”时，默认选择最突出和最知名的位置，即法国巴黎。
- en: 'When the API receives a request with just a city name (`q={city_name}`), it
    uses an internal algorithm to determine the most likely intended location. This
    algorithm prioritizes several factors:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 当API收到仅包含城市名称的请求（`q={city_name}`）时，它使用一个内部算法来确定最可能意图的位置。此算法优先考虑几个因素：
- en: '**Population**: Larger, more populous cities are often ranked higher'
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**人口**：更大、人口更多的城市通常排名更高'
- en: '**Significance**: Capital cities and major cultural or economic hubs are given
    preference'
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**重要性**：首都和主要文化或经济中心被优先考虑'
- en: '**Internal Ranking**: OpenWeatherMap maintains its own database and ranking
    system for locations'
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**内部排名**：OpenWeatherMap维护自己的数据库和位置排名系统'
- en: Because Paris, France, is a major global capital with a significantly larger
    population and international recognition than Paris, Texas, the API defaults to
    the French capital.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 由于法国巴黎是一个具有比德克萨斯州巴黎更大的人口和国际知名度的全球首都，API默认选择法国首都。
- en: 'Since we are building an educational example using major tourist locations,
    such as Paris, the algorithm easily defaults to Paris, France. If needed in production,
    you could modify the function to include the country and country code, as in the
    following example:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们正在使用主要旅游地点构建一个教育示例，例如巴黎，算法很容易默认选择法国巴黎。如果在生产中需要，您可以修改函数以包括国家和国家代码，如下例所示：
- en: '[PRE44]'
  id: totrans-197
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: The information that we are returning is sufficient for a generative AI model
    to interpret the real-time weather forecast and make decisions based on it. With
    that, we are now ready to add a weather forecast option to the IPython interface.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 我们返回的信息足以让生成式AI模型解释实时天气预报并据此做出决策。有了这个，我们现在准备向IPython界面添加天气预报选项。
- en: Adding a weather widget to the interface
  id: totrans-199
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在界面中添加天气小部件
- en: We will now add a **Weather** option to the instruction drop-down list as shown
    in *Figure 9.10*. Why add a weather forecast option to a reasoning list? The motivation
    comes from the fact that we are building a GenAISys proof of concept. We could
    imagine several CoT scenarios based on the use cases we will run in our GenAISys.
    However, if we write these pipelines before having workshops with the end users,
    they might find the system too rigid.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将在指令下拉列表中添加一个**天气**选项，如图9.10所示。为什么要在推理列表中添加天气预报选项？这种动机源于我们正在构建一个GenAISys原型。我们可以基于我们将在GenAISys中运行的用例想象几个CoT场景。然而，如果我们在与最终用户进行研讨会之前编写这些管道，他们可能会觉得系统过于僵化。
- en: '![Figure 9.10: Add a weather forecast option to the IPython interface](img/B32304_09_10.png)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![图9.10：向IPython界面添加天气预报选项](img/B32304_09_10.png)'
- en: 'Figure 9.10: Add a weather forecast option to the IPython interface'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.10：向IPython界面添加天气预报选项
- en: The best approach is to have some CoT and pipeline scenarios to demonstrate
    the capabilities of the GenAISys, but leave room for flexibility until the users
    suggest that we automate some of the CoT scenarios they performed while running
    the GenAISys.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 最佳做法是提供一些CoT和管道场景来展示GenAISys的能力，但留出灵活性，直到用户建议我们自动化他们在运行GenAISys时执行的某些CoT场景。
- en: 'We will thus add the option to the IPython interface, in `instruct_selector`,
    leaving the way it is used open to discussion:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们将此选项添加到IPython界面中的`instruct_selector`，使其使用方式保持开放，供讨论：
- en: '[PRE45]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: When running forecasts, users select **Weather** and simply enter a city name.
    Although adding a city selector or location autocomplete could improve the user
    experience, a simple text input is more practical for this real-time use case,
    especially since tourists typically know their exact destination names.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 当运行预报时，用户选择**天气**并简单地输入一个城市名称。尽管添加城市选择器或位置自动完成可以提高用户体验，但对于这种实时用例来说，简单的文本输入更为实用，尤其是对于游客来说，通常知道他们确切的目的地名称。
- en: That is all we need at **Layer 1** in the IPython interface. The handler selection
    mechanism remains unchanged, so we move directly on to the handler registry.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是我们在IPython界面中**层1**所需的所有内容。处理程序选择机制保持不变，所以我们直接进入处理程序注册表。
- en: Adding a handle to the handler registry
  id: totrans-208
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将处理程序添加到处理程序注册表
- en: 'The weather handler in our registry only requires a one-word location in the
    user message and the `"Weather"` instruction in this implementation of OpenWeather:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 我们注册表中的天气处理程序只需要用户消息中的一个单词位置和在这个OpenWeather实现中使用的“Weather”指令：
- en: '[PRE46]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'Why not use keywords? Using `"weather"` as a keyword instead of an instruction
    could be confused with a follow-up question in the following context, as follows:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 为什么不使用关键词呢？使用“weather”作为关键词而不是指令，可能会在以下语境中被误认为是后续问题，如下所示：
- en: 'User 1 could ask: `What is the weather in Paris?` The assistant would answer:
    `20°C, clear skies, 5m/s wind speed`.'
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户1可能会问：“巴黎的天气怎么样？”助手会回答：“20°C，晴朗，风速5m/s”。
- en: 'User 2 could ask: `What can I visit in this weather?` In this case, `weather`
    could trigger an API weather call that would fail because no location is provided.'
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户2可能会问：“在这种天气下我能参观什么？”在这种情况下，“weather”可能会触发一个API天气调用，但由于没有提供位置，这个调用会失败。
- en: 'At the time of writing this chapter, even ChatGPT Plus has options before submitting
    a request, as follows:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 在撰写本章时，即使ChatGPT Plus在提交请求之前也有选项，如下所示：
- en: The choice between multiple models such as GPT-4o for general purpose tasks,
    DALL-E for images, o1-mini for reasoning, o3-mini for high reasoning, GPT-4.5,
    and more
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在通用任务、图像的DALL-E、推理的o1-mini、高推理的o3-mini、GPT-4.5等多个模型之间进行选择
- en: A button to activate web search and another one for **Deep Research**
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个用于激活网络搜索的按钮，另一个用于**深度研究**
- en: Manual file uploads
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 手动文件上传
- en: These multiple interactive choices make the interface flexible. However, as
    we work on user interfaces, we will see a progressive automation of many of these
    options, along with new generative AI models that encompass the functionality
    of several former models. It’s an ongoing accelerated generative AI evolution!
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 这些多个交互式选择使界面灵活。然而，当我们致力于用户界面时，我们将看到许多这些选项的逐步自动化，以及包含多个旧模型功能的新生成AI模型。这是一场持续加速的生成AI进化！
- en: We will now add the weather function to the AI functions library.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将天气预报功能添加到AI功能库中。
- en: Adding the weather forecast function to AI functions
  id: totrans-220
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将天气预报功能添加到AI功能
- en: 'The real-time weather forecast function first checks whether `api_key` is still
    active during the session. This additional check ensures that the API call remains
    stable with no disconnection if there is a micro-interruption of the session in
    the VM we are using:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 实时天气预报功能首先检查在会话期间`api_key`是否仍然有效。这个额外的检查确保了在我们在使用的虚拟机中会话出现微中断时，API调用仍然稳定，不会断开连接：
- en: '[PRE47]'
  id: totrans-222
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'The city name is the user message; the weather forecast will be requested;
    and the temperature, description, and wind speed will be returned:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 城市名称是用户消息；将请求天气预报；并返回温度、描述和风速：
- en: '[PRE48]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: We could add a keyword search to a longer user message.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以在较长的用户消息中添加关键词搜索。
- en: 'At this stage, the constraint is that the user message must only contain the
    city’s name. However, the functionality can be expanded in various ways based
    on user feedback gathered during project workshops, such as the following:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个阶段，约束是用户消息必须只包含城市的名称。然而，根据在项目研讨会期间收集到的用户反馈，功能可以以各种方式扩展，如下所示：
- en: Scan a user message for the location if the weather option is activated.
  id: totrans-227
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果启用了天气选项，扫描用户消息以获取位置。
- en: 'Limitation: Only the name of the city is necessary.'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 局限性：只需要城市的名称。
- en: Have a drop-down list of all the possible city locations.
  id: totrans-229
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有一个包含所有可能城市位置的下拉列表。
- en: 'Limitation: The list could contain hundreds of cities.'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 局限性：列表可能包含数百个城市。
- en: Have a country selection list, then choose a region (or administrative name
    for a region), then choose the city.
  id: totrans-231
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有一个国家选择列表，然后选择一个地区（或地区的行政名称），然后选择城市。
- en: 'Limitation: A customer might not know the name of the region or state. Also,
    this takes longer than just entering the city.'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 局限性：客户可能不知道地区的名称或州名。此外，这比只输入城市名称要花更长的时间。
- en: Automatically detect where the customer is.
  id: totrans-233
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自动检测客户的位置。
- en: 'Limitation: The query might be for another city and not the one the customer
    is in.'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 局限性：查询可能是另一个城市，而不是客户所在的城市。
- en: Just enter the city and nothing else, as we are doing now.
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 只输入城市名称，不要输入其他内容，就像我们现在这样做的一样。
- en: 'Limitation: We might need to enhance the function with a city keyword search
    just in case the user enters more words than just the name of the city. Also,
    the customer might misspell the name of the location.'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 局限性：我们可能需要增强功能，以城市关键词搜索来应对用户输入的不仅仅是城市名称的情况。此外，客户可能拼错了位置名称。
- en: As you can see, there are several ways to implement the real-time weather forecast
    request at the user level. The best approach is to initially showcase the basic
    capabilities of the system clearly and then adapt and extend the interface based
    on the feedback you receive from workshops with a customer panel.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，在用户层面实现实时天气预报请求有几种方法。最佳做法是首先清楚地展示系统的基本功能，然后根据从客户小组讨论中获得的反馈来调整和扩展界面。
- en: Now that we’ve built and integrated the weather forecast functionality into
    the handler selection mechanism framework, we’re ready to demonstrate real-world
    use cases within the GenAISys.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经将天气预报功能集成到处理选择机制框架中，我们准备在GenAISys中展示实际应用案例。
- en: Running the GenAISys
  id: totrans-239
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 运行GenAISys
- en: In this section, we will run multi-user, cross-domain, multimodal interactions
    using the GenAISys for real-time tourism-related services. Typically, when tourists
    visit a city, they check weather forecasts in one app and decide on their activities
    in another. Here, we’re merging these domains into one seamless experience. Users
    will request real-time weather forecasts, and the GenAISys will suggest suitable
    activities—indoor, outdoor, or both—based on the current weather conditions. This
    integrated, cross-domain approach can be extended beyond tourism into areas such
    as construction planning, delivery scheduling, and nearly any scenario where multiple
    applications are traditionally needed to support user decisions.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将使用GenAISys进行多用户、跨领域、多模态交互，以提供实时旅游相关服务。通常，当游客访问一个城市时，他们会在一个应用程序中查看天气预报，并在另一个应用程序中决定他们的活动。在这里，我们将这些领域合并为一个无缝体验。用户将请求实时天气预报，GenAISys将根据当前天气条件建议合适的活动——室内、室外或两者兼有。这种集成、跨领域的做法可以扩展到建筑规划、配送调度以及几乎任何需要多个应用程序来支持用户决策的场景。
- en: 'The main objective of this section is to demonstrate the cross-domain capabilities
    of the GenAISys in a flexible manner, illustrating how the system can adapt to
    various domain-specific scenarios. Specifically, we will focus on the following:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 本节的主要目标是灵活地展示GenAISys的跨领域能力，说明系统如何适应各种特定领域的场景。具体来说，我们将关注以下方面：
- en: Activating and deactivating the weather forecast functionality
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 激活和停用天气预报功能
- en: Activating and deactivating the file display option
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 激活和停用文件显示选项
- en: We aim to present a clear and practical proof of concept, highlighting potential
    workflows before automation decisions are finalized in user workshops. By not
    prematurely automating too many scenarios, the GenAISys maintains flexibility,
    allowing actual users first to experiment freely and determine which features
    should be automated. Remember, the more automation you introduce, the less flexibility
    you retain in user interactions—though, with careful planning, it is possible
    to balance both automation and interactivity.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的目标是展示一个清晰且实用的概念验证，在用户工作坊中自动化决策最终确定之前突出潜在的工作流程。通过不提前自动化太多场景，GenAISys保持了灵活性，允许实际用户首先自由实验，并确定哪些功能应该自动化。记住，你引入的自动化越多，你在用户交互中保留的灵活性就越少——尽管通过仔细规划，可以在自动化和交互性之间取得平衡。
- en: As emphasized earlier, an effective strategy begins with supporting interactive,
    manual workflows, then progressively automating some or all tasks as users gain
    familiarity and provide feedback. *Time is not the objective; user maturity is*.
    Interactive scenarios can transition into fully automated pipelines or CoT processes
    at the users’ pace. By letting user feedback shape development, adoption rates
    naturally improve.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，一个有效的策略始于支持交互式、手动工作流程，然后随着用户熟悉程度和反馈的提供，逐步自动化某些或所有任务。*时间不是目标；用户的成熟度是*。交互式场景可以按照用户的步伐过渡到完全自动化的管道或
    CoT 流程。通过让用户反馈塑造开发，采用率自然会提高。
- en: Generative AI systems rely on probabilistic responses, meaning outputs can vary
    slightly with each run. This stochastic behavior ensures responses remain dynamic
    rather than rigid or repetitive.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 生成式 AI 系统依赖于概率性响应，这意味着输出可能会随着每次运行而略有变化。这种随机行为确保响应保持动态，而不是僵化或重复。
- en: 'At the beginning of the notebook (`GenAISys_Customer_Service.ipynb`), you have
    the option to activate or deactivate the DeepSeek model:'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 在笔记本的起始部分（`GenAISys_Customer_Service.ipynb`），您可以选择激活或停用 DeepSeek 模型：
- en: '[PRE49]'
  id: totrans-248
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: For this chapter, `deepseek` is set to `False`, and we will rely on OpenAI for
    running our use cases.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 对于本章，`deepseek`设置为`False`，我们将依赖 OpenAI 来运行我们的用例。
- en: With all necessary functions ready for weather-based decision-making, let’s
    now explore interactive use cases in the GenAISys.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 在所有必要的基于天气的决策功能准备就绪后，现在让我们探索 GenAISys 中的交互式用例。
- en: A multi-user, cross-domain, and multimodal dialogue
  id: totrans-251
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 多用户、跨领域和跨模态的对话
- en: We’ll run an interactive scenario with the GenAISys, simulating a tourist seeking
    real-time, weather-based recommendations in a specific city—whether the weather
    is cloudy with possible rain or clear. The GenAISys must thus adapt its suggestions
    to real-time weather forecasts in that specific location.
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将运行一个与 GenAISys 的交互式场景，模拟一个寻求特定城市实时、基于天气的建议的游客——无论天气是多云并有雨的可能还是晴朗。因此，GenAISys
    必须调整其建议以适应该特定位置的实时天气预报。
- en: 'The dialogue will be multi-user between the following users:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 以下用户之间的对话将是多用户的：
- en: '`User01`: A tourist who expects weather-dependent suggestions on what to do'
  id: totrans-254
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`User01`：一个期望根据天气提供建议的游客'
- en: '`User02`: A customer service agent who provides support'
  id: totrans-255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`User02`：一个提供支持的客户服务代理'
- en: '`User03`: A decision-maker who coordinates marketing, product design, production,
    deliveries, and customer service'
  id: totrans-256
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`User03`：一个协调营销、产品设计、生产、交付和客户服务的决策者'
- en: Each interaction in this dialogue is clearly labeled, indicating the user initiating
    the request. If a new session starts, it will be prefixed by `New Session`.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 此对话中的每次交互都明确标记，表明是用户发起的请求。如果启动新的会话，它将以`New Session`为前缀。
- en: 'The interface actions will be as follows:'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 界面操作将如下所示：
- en: Writing and submitting a prompt
  id: totrans-259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 编写和提交提示
- en: Activating or deactivating the weather forecast function
  id: totrans-260
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 激活或停用天气预报功能
- en: Activating or deactivating file displays
  id: totrans-261
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 激活或停用文件显示
- en: There are many enhancements, improvements, additional functions, CoT processes,
    and pipelines we could add to expand our GenAISys. However, this should be done
    in collaboration with a customer/user panel.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以向 GenAISys 添加许多增强功能、改进、附加功能、CoT 流程和管道，以扩展我们的系统。然而，这应该与客户/用户小组合作完成。
- en: Let’s start the dialogue in Paris.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们在巴黎开始对话。
- en: '[PRE50]'
  id: totrans-264
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'The customer activated the **Weather** function and entered **Paris**, knowing
    that in this proof of concept, those are the instructions to follow, as shown
    here:'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 客户激活了**天气**功能并输入了**巴黎**，知道在这个概念验证中，这些是必须遵循的指令，如下所示：
- en: '![Figure 9.11: Asking for a real-time weather forecast](img/B32304_09_11.png)'
  id: totrans-266
  prefs: []
  type: TYPE_IMG
  zh: '![图 9.11：请求实时天气预报](img/B32304_09_11.png)'
- en: 'Figure 9.11: Asking for a real-time weather forecast'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.11：请求实时天气预报
- en: 'The GenAISys agent provides the requested information:'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: GenAISys 代理提供所需的信息：
- en: '[PRE51]'
  id: totrans-269
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'Note that the weather response will continually change, and thus, the whole
    dialogue that follows will take a different turn. Different locations, different
    weather conditions, and different points of interest for the customer will take
    this dialogue in unique directions. The customer now asks for recommendations:'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，天气响应将不断变化，因此，接下来的整个对话将采取不同的方向。不同的地点、不同的天气条件和客户的不同兴趣点将使此对话走向独特的方向。客户现在请求建议：
- en: '[PRE52]'
  id: totrans-271
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'With the **Reasoning** option set to **None**, the GenAI provides personalized
    suggestions:'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 将**推理**选项设置为**无**时，GenAI 提供个性化建议：
- en: '![Figure 9.12: Asking what activities to do in this weather](img/B32304_09_12.png)'
  id: totrans-273
  prefs: []
  type: TYPE_IMG
  zh: '![图9.12：询问在这种天气下做什么活动](img/B32304_09_12.png)'
- en: 'Figure 9.12: Asking what activities to do in this weather'
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.12：询问在这种天气下做什么活动
- en: 'The GenAI suggests some engaging activities based on the weather:'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: GenAI根据天气建议一些吸引人的活动：
- en: '[PRE53]'
  id: totrans-276
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: 'The user finds the response useful but would also like to visit a museum:'
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 用户觉得这个回应很有用，但也想参观博物馆：
- en: '[PRE54]'
  id: totrans-278
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: 'Without changing the interface configuration, the agent provides a tailored
    itinerary:'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 在不改变界面配置的情况下，代理提供定制行程：
- en: '[PRE55]'
  id: totrans-280
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'Now, the customer service agent steps in to augment the personalized experience
    of the customer:'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，客户服务代理介入以增强客户的个性化体验：
- en: '[PRE56]'
  id: totrans-282
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: This kind of multi-user interface could easily be built into a website with
    features such as text and image generation, customer profiles, and conversation
    history—your imagination is the only limit.
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 这种多用户界面可以轻松地集成到一个具有文本和图像生成、客户资料和对话历史等功能的网站中——你的想象力是唯一的限制。
- en: 'In this case, ensure **Files** is checked to display the image, as shown here:'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，确保**文件**被勾选以显示图像，如图所示：
- en: '![Figure 9.13: Creating a custom image for the visit](img/B32304_09_13.png)'
  id: totrans-285
  prefs: []
  type: TYPE_IMG
  zh: '![图9.13：为参观创建自定义图像](img/B32304_09_13.png)'
- en: 'Figure 9.13: Creating a custom image for the visit'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.13：为参观创建自定义图像
- en: 'The GenAISys generates a captivating image representing the recommended custom
    visit, as displayed here:'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: GenAISys生成一个代表推荐定制参观的吸引人图像，如图所示：
- en: '![Figure 9.14: A custom image for a customized visit](img/B32304_09_14.png)'
  id: totrans-288
  prefs: []
  type: TYPE_IMG
  zh: '![图9.14：为定制参观创建的自定义图像](img/B32304_09_14.png)'
- en: 'Figure 9.14: A custom image for a customized visit'
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.14：为定制参观创建的自定义图像
- en: Our GenAISys could be expanded to send the image to the tourist’s smartphone,
    or even better, the GenAISys could be developed as a smartphone app connecting
    with the GenAISys server.
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的GenAISys可以扩展到将图像发送到游客的手机上，或者更好的是，GenAISys可以开发成一个与GenAISys服务器连接的手机应用程序。
- en: 'The image is great and the weather fine. Pleased, `User02` requests a promotional
    offer:'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 图像很棒，天气很好。满意的`User02`要求促销优惠：
- en: '[PRE57]'
  id: totrans-292
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: '**Files** is unchecked so the GenAI can craft a text-based promotional message,
    as shown here:'
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: '**文件**未被勾选，以便GenAI可以制作基于文本的促销信息，如图所示：'
- en: '![Figure 9.15: A custom image for a customized visit](img/B32304_09_15.png)'
  id: totrans-294
  prefs: []
  type: TYPE_IMG
  zh: '![图9.15：为定制参观创建的自定义图像](img/B32304_09_15.png)'
- en: 'Figure 9.15: A custom image for a customized visit'
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.15：为定制参观创建的自定义图像
- en: 'The model generates an engaging message:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 模型生成一个吸引人的信息：
- en: '[PRE58]'
  id: totrans-297
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: 'The river cruise offer is great, but now `User03` steps in with a cutting-edge
    idea to enhance customer engagement:'
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 河流游轮优惠很棒，但现在`User03`提出一个前沿的想法来增强客户参与度：
- en: '[PRE59]'
  id: totrans-299
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: '**Files** is checked again so the agent can produce the requested image, as
    shown:'
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: '**文件**再次被勾选，以便代理可以生成所需图像，如图所示：'
- en: '![Figure 9.16: Checking files to display an image](img/B32304_09_16.png)'
  id: totrans-301
  prefs: []
  type: TYPE_IMG
  zh: '![图9.16：检查文件以显示图像](img/B32304_09_16.png)'
- en: 'Figure 9.16: Checking files to display an image'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.16：检查文件以显示图像
- en: 'The result is the eye-catching design displayed here:'
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 结果是这里显示的引人注目的设计：
- en: '![Figure 9.17: A customized travel bag image](img/B32304_09_17.png)'
  id: totrans-304
  prefs: []
  type: TYPE_IMG
  zh: '![图9.17：定制的旅行包图像](img/B32304_09_17.png)'
- en: 'Figure 9.17: A customized travel bag image'
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.17：定制的旅行包图像
- en: The manager forwards this custom design immediately to a local printing partner
    that maintains travel bag stock and specialized printing equipment. The travel
    bag will be printed and delivered to the customer’s hotel within half an hour—a
    service as convenient and timely as ordering a pizza! This represents the future
    of real-time customer service.
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 经理立即将这个定制设计转发给一个维护旅行包库存和专用印刷设备的本地印刷合作伙伴。旅行包将在半小时内打印并送到客户的酒店——这就像订购披萨一样方便和及时！这代表了实时客户服务的未来。
- en: 'For a final touch, the manager asks for an engaging email to be sent to the
    customer:'
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 为了最后的润色，经理要求发送一封吸引人的电子邮件给客户：
- en: '[PRE60]'
  id: totrans-308
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: The message could be a notification in an app, a text message, and/or part of
    the online conversation on a cutting-edge, multi-user, cross-domain, multimodal
    website!
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 消息可以是应用中的通知、短信，以及/或在一个前沿的、多用户、跨领域、多模态网站上的在线对话的一部分！
- en: 'In this case, **Files** is unchecked to make room for the GenAI to generate
    the text, as shown here:'
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，**文件**未被勾选，为GenAI生成文本腾出空间，如图所示：
- en: '![Figure 9.18: Unchecking files to send a message](img/B32304_09_18.png)'
  id: totrans-311
  prefs: []
  type: TYPE_IMG
  zh: '![图9.18：取消勾选文件以发送消息](img/B32304_09_18.png)'
- en: 'Figure 9.18: Unchecking files to send a message'
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.18：取消勾选文件以发送消息
- en: If the manager wished, **Files** could have remained checked, and the image
    could have been processed to be attached to the message.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 如果经理希望的话，**文件**可以保持勾选，图像可以被处理并附加到信息中。
- en: 'The message is engaging and highlights the exceptional level of customer service
    offered by the travel agency:'
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 信息吸引人并突出了旅行社提供的卓越客户服务级别：
- en: '[PRE61]'
  id: totrans-315
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: The “P.S.” message is important in a real-time delivery context, as it encourages
    customers to share their positive experiences on social media. This kind of user-generated
    content helps brands extend their reach and strengthen their market differentiation
    as competition intensifies across nearly every industry.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 在实时交付的背景下，“P.S.”信息很重要，因为它鼓励客户在社交媒体上分享他们的积极体验。这种用户生成的内容有助于品牌扩大其影响力并加强市场差异化，尤其是在几乎所有行业竞争加剧的情况下。
- en: 'Now let’s move to another location, using a different approach. Restart the
    session by entering `Exit` and rerunning the notebook’s cell. The customer service
    agent will now explore options for customers visiting Tokyo:'
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们转到另一个地点，采用不同的方法。通过输入`退出`并重新运行笔记本的单元格来重启会话。客户服务代表将现在探索为访问东京的客户提供的选项：
- en: '[PRE62]'
  id: totrans-318
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: In this session, `User02`, the customer service agent, and `User03`, the manager,
    are trying to figure out what to suggest to their customers who have arrived in
    Tokyo. They want to customize the experience to make sure they keep ahead of the
    competition. They first want to know the weather for that day, so they select
    **Weather** (as in *Figure 9.19*) and enter `Tokyo`.
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: 在这次会话中，`User02`（客户服务代表），`User03`（经理）正在试图弄清楚向到达东京的客户建议什么。他们希望定制体验以确保他们保持竞争优势。他们首先想知道当天的天气，因此选择**天气**（如图9.19所示）并输入`东京`。
- en: '![Figure 9.19: Files is unchecked, and Weather is selected](img/B32304_09_19.png)'
  id: totrans-320
  prefs: []
  type: TYPE_IMG
  zh: '![图9.19：文件未勾选，天气被选中](img/B32304_09_19.png)'
- en: 'Figure 9.19: Files is unchecked, and Weather is selected'
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.19：文件未勾选，天气被选中
- en: 'The GenAISys returns the weather in real time:'
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: GenAISys实时返回天气信息：
- en: '[PRE63]'
  id: totrans-323
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: 'Now, `User02` would like to know what to suggest for this weather:'
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，`User02`想知道针对这种天气应该建议什么：
- en: '[PRE64]'
  id: totrans-325
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: The **Weather** function is deactivated (see *Figure 9.11*). The GenAI must
    analyze the weather and then suggest activities.
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: '**天气**功能已禁用（见*图9.11*）。GenAI必须分析天气然后建议活动。'
- en: '![Figure 9.20: Files is unchecked, and Reasoning is set to None](img/B32304_09_20.png)'
  id: totrans-327
  prefs: []
  type: TYPE_IMG
  zh: '![图9.20：文件未勾选，推理设置为无](img/B32304_09_20.png)'
- en: 'Figure 9.20: Files is unchecked, and Reasoning is set to None'
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.20：文件未勾选，推理设置为无
- en: 'The agent takes the weather into account and makes interesting suggestions:'
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: 代理考虑了天气因素并提出了有趣的建议：
- en: '[PRE65]'
  id: totrans-330
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: We can see that the GenAISys is adapting to different scenarios in an acceptable
    way.
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到GenAISys以可接受的方式适应不同的场景。
- en: Now, `User02` is getting some ideas from the response. Since the weather is
    rainy, why not suggest a bus tour?
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，`User02`正在从响应中获得一些想法。由于天气下雨，为什么不建议巴士之旅呢？
- en: '[PRE66]'
  id: totrans-333
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: 'The configuration (**Files** unchecked, **Reasoning** set to **None**) does
    not change. The GenAISys makes an engaging offer for a bus tour:'
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 配置（**文件**未勾选，**推理**设置为**无**）不会改变。GenAISys提供了一个吸引人的巴士之旅报价：
- en: '[PRE67]'
  id: totrans-335
  prefs: []
  type: TYPE_PRE
  zh: '[PRE67]'
- en: '`User03` steps in and asks the GenAISys to write an engaging message for food
    and beverages:'
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: '`User03`介入并要求GenAISys为食品和饮料撰写一条吸引人的信息：'
- en: '[PRE68]'
  id: totrans-337
  prefs: []
  type: TYPE_PRE
  zh: '[PRE68]'
- en: The configuration (**Files** unchecked, **Reasoning** set to **None**) does
    not change. The GenAISys makes an engaging offer for food and beverages during
    the bus tour. The idea is to show the customers that the travel agency is taking
    care of them in great detail.
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 配置（**文件**未勾选，**推理**设置为**无**）没有改变。GenAISys在巴士之旅期间为食品和饮料提供了一个吸引人的报价。目的是向客户展示旅行社在细节上非常关心他们。
- en: 'The GenAISys understands the situation and provides an engaging message:'
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: GenAISys理解情况并提供了一条吸引人的信息：
- en: '[PRE69]'
  id: totrans-340
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: We can see that the GenAISys is flexible and leverages the generative AI models
    efficiently.
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到GenAISys具有灵活性并有效地利用生成式AI模型。
- en: Let’s end our travelling journey experience in New York. Exit the session and
    rerun the IPython cell.
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们在纽约结束我们的旅行体验。退出会话并重新运行IPython单元格。
- en: '`User02` wants to anticipate activities in New York:'
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: '`User02`想要预测纽约的活动：'
- en: '[PRE70]'
  id: totrans-344
  prefs: []
  type: TYPE_PRE
  zh: '[PRE70]'
- en: 'In this session, `User02` (customer service agent) and `User03` (manager) are
    brainstorming personalized recommendations for tourists arriving in Tokyo. They
    want to tailor the experience to stay ahead of competitors. First, they check
    the current weather by selecting the **Weather** option (*Figure 9.21*) and entering
    `Tokyo`:'
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个环节中，`User02`（客户服务代表）和`User03`（经理）正在为即将抵达东京的游客头脑风暴个性化的推荐。他们希望定制体验以领先竞争对手。首先，他们通过选择**天气**选项（*图9.21*）并输入`东京`来查看当前天气：
- en: '![Figure 9.21: Files is unchecked and Weather is selected](img/B32304_09_21.png)'
  id: totrans-346
  prefs: []
  type: TYPE_IMG
  zh: '![图9.21：未勾选文件且选择天气](img/B32304_09_21.png)'
- en: 'Figure 9.21: Files is unchecked and Weather is selected'
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.21：未勾选文件且选择天气
- en: 'The agent provides the weather in real time:'
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 代理实时提供天气信息：
- en: '[PRE71]'
  id: totrans-349
  prefs: []
  type: TYPE_PRE
  zh: '[PRE71]'
- en: '`User02` thinks that misty weather is not the best day to take customers on
    a tour of Central Park. What can the GenAISys come up with?'
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: '`User02`认为雾蒙蒙的天气不是带客户游览中央公园的最佳日子。GenAISys能想出什么？'
- en: '[PRE72]'
  id: totrans-351
  prefs: []
  type: TYPE_PRE
  zh: '[PRE72]'
- en: '`User02` runs the GenAISys with **Files** unchecked and no **Reasoning** instruction
    (*Figure 9.22*). The situation is not that easy because we want the customers
    to visit new places and possibly surprise them a bit:'
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: '`User02`在未勾选**文件**且没有**推理**指令的情况下运行GenAISys（*图9.22*）。情况并不那么简单，因为我们希望顾客参观新地方，并可能给他们一点惊喜：'
- en: '![Figure 9.22: Files is unchecked and Weather is not selected](img/B32304_09_22.png)'
  id: totrans-353
  prefs: []
  type: TYPE_IMG
  zh: '![图9.22：未勾选文件且未选择天气](img/B32304_09_22.png)'
- en: 'Figure 9.22: Files is unchecked and Weather is not selected'
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.22：未勾选文件且未选择天气
- en: 'The GenAISys finds an interesting program that can add a cultural touch to
    the trip:'
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: GenAISys找到一个有趣的程序，可以为旅行增添文化气息：
- en: '[PRE73]'
  id: totrans-356
  prefs: []
  type: TYPE_PRE
  zh: '[PRE73]'
- en: 'At the end of the trip to New York, `User03`, the manager, steps in to offer
    the customers a souvenir T-shirt:'
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: 在纽约之行的最后，经理`User03`介入，向顾客提供纪念品T恤：
- en: '[PRE74]'
  id: totrans-358
  prefs: []
  type: TYPE_PRE
  zh: '[PRE74]'
- en: '`User03` decides to activate a full-scale GenAISys CoT generation to analyze
    customer feedback and produce a nice T-shirt. **Files** is checked and **Generation**
    is activated, as shown:'
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: '`User03`决定激活全面的GenAISys CoT生成来分析客户反馈并制作一件漂亮的T恤。**文件**被勾选，**生成**被激活，如图所示：'
- en: '![Figure 9.23: Files is checked and Generation is selected](img/B32304_09_23.png)'
  id: totrans-360
  prefs: []
  type: TYPE_IMG
  zh: '![图9.23：勾选文件且选择生成](img/B32304_09_23.png)'
- en: 'Figure 9.23: Files is checked and Generation is selected'
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.23：勾选文件且选择生成
- en: 'Our GenAISys begins the generation process step by step:'
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的GenAISys开始逐步进行生成过程：
- en: '[PRE75]'
  id: totrans-363
  prefs: []
  type: TYPE_PRE
  zh: '[PRE75]'
- en: 'It first performs a memory and sentiment analysis of the feedback the tour
    guide detected:'
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 它首先对导游检测到的反馈进行记忆和情感分析：
- en: '[PRE76]'
  id: totrans-365
  prefs: []
  type: TYPE_PRE
  zh: '[PRE76]'
- en: 'It then extracts the scores from the content it analyzed:'
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 然后它从分析的内容中提取分数：
- en: '[PRE77]'
  id: totrans-367
  prefs: []
  type: TYPE_PRE
  zh: '[PRE77]'
- en: 'It then performs a statistical analysis to provide an overall rating:'
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 然后它进行统计分析，提供整体评分：
- en: '[PRE78]'
  id: totrans-369
  prefs: []
  type: TYPE_PRE
  zh: '[PRE78]'
- en: 'The score is not 4 or 5 because they would like a souvenir, a T-shirt, and
    they don’t have it yet! So, the GenAISys now creates a prompt for image generation:'
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: 分数不是4或5，因为他们想要一个纪念品，一件T恤，但他们还没有得到！所以，GenAISys现在创建了一个用于图像生成的提示：
- en: '[PRE79]'
  id: totrans-371
  prefs: []
  type: TYPE_PRE
  zh: '[PRE79]'
- en: 'The GenAISys now creates an image for the prompt (*Figure 9.24*):'
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: GenAISys现在为提示创建了一个图像（*图9.24*）：
- en: '[PRE80]'
  id: totrans-373
  prefs: []
  type: TYPE_PRE
  zh: '[PRE80]'
- en: '![Figure 9.24: A custom T-shirt](img/B32304_09_24.png)'
  id: totrans-374
  prefs: []
  type: TYPE_IMG
  zh: '![图9.24：定制T恤](img/B32304_09_24.png)'
- en: 'Figure 9.24: A custom T-shirt'
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.24：定制T恤
- en: 'The GenAISys now creates a message for the customer:'
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: GenAISys现在为顾客创建了一条信息：
- en: '[PRE81]'
  id: totrans-377
  prefs: []
  type: TYPE_PRE
  zh: '[PRE81]'
- en: For the New York trip, the manager will now instruct the local printer to print
    the custom image onto a batch of T-shirts already stocked at the printer’s site.
    The shirts will be produced and delivered to the tourist’s hotel within the hour.
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: 对于纽约之行，经理将指示当地印刷商将定制图像打印到印刷商现场已备好的T恤批量上。T恤将在一小时内生产和交付到游客的酒店。
- en: The travel agency is extremely satisfied with the GenAISys proof of concept
    and is now preparing to organize workshops with all team members to take the system
    to the next level.
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: 旅行社对GenAISys的概念验证非常满意，现在正在准备与所有团队成员一起组织研讨会，将系统提升到下一个水平。
- en: Let’s now summarize our journey—and get ready to explore what’s next!
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们现在总结我们的旅程——并准备好探索接下来是什么！
- en: Summary
  id: totrans-381
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: The acceleration of modern markets has led to the extinction of waiting times.
    *Real-time responsiveness is now the default*. The use case explored in this chapter
    demonstrates that a business-ready GenAISys proof of concept must be able to provide
    immediate, real-world services. We implemented a real-time travel agency scenario—one
    that can easily be adapted to other domains once you enter project mode.
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: 现代市场的加速导致了等待时间的灭绝。*实时响应现在是默认的*。本章探讨的使用案例表明，一个商业就绪的 GenAISys 概念验证必须能够提供即时、现实世界的服务。我们实施了一个实时旅行社场景——一旦进入项目模式，它就可以轻松地适应其他领域。
- en: To make our proof of concept suitable for live demonstration to a team, customer,
    or investor, we first integrated a moderation component into GenAISys. We implemented
    OpenAI’s Omni model to detect and flag multiple categories of content policy violations.
    This moderation function is embedded at the handler selection mechanism level,
    ensuring that inappropriate user messages are flagged and rejected before any
    further processing. To further reassure stakeholders, we added a data security
    layer. Using vector similarity search, we built a function that detects whether
    a user message aligns with sensitive topics. We created a dedicated Pinecone namespace
    to store these topics and queried it against every incoming user message. If a
    match was found, the system flagged the content, displayed a warning, and rejected
    the request.
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使我们的概念验证适合向团队、客户或投资者进行现场演示，我们首先将审查组件集成到 GenAISys 中。我们实施了 OpenAI 的 Omni 模型来检测和标记多个类别的内容政策违规。此审查功能嵌入在处理程序选择机制级别，确保在进一步处理之前标记并拒绝不适当的用户消息。为了进一步让利益相关者放心，我们添加了一个数据安全层。使用向量相似性搜索，我们构建了一个检测用户消息是否与敏感话题一致的功能。我们创建了一个专门的
    Pinecone 命名空间来存储这些话题，并针对每个传入的用户消息进行查询。如果找到匹配项，系统将标记内容，显示警告，并拒绝请求。
- en: All flagged moderation and security violations were logged in separate files,
    and the full conversation history can be traced to individual users. With these
    essential safeguards in place, we proceeded to implement a real-time weather forecasting
    feature using OpenWeather—tightly integrated into GenAISys for weather-aware decision-making.
    Finally, we walked through a complete GenAISys dialogue, showcasing the system’s
    ability to support real-time, multi-user, cross-domain, multimodal interactions—a
    powerful illustration of what generative AI can achieve in production settings.
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: 所有标记的审查和安全违规都记录在单独的文件中，完整的对话历史可以追溯到单个用户。有了这些基本的安全保障，我们继续实施实时天气预报功能，使用 OpenWeather—紧密集成到
    GenAISys 中以进行天气感知决策。最后，我们走过了完整的 GenAISys 对话，展示了系统支持实时、多用户、跨领域、多模态交互的能力——这是生成式
    AI 在生产环境中所能实现的有力证明。
- en: The next step? Presenting your GenAISys proof of concept to secure the resources
    needed to expand and scale the system. But such a presentation must be carefully
    crafted—and that’s exactly what we’ll focus on in the next chapter.
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是什么？展示你的 GenAISys 概念验证以获得扩展和扩展系统所需的资源。但这样的展示必须精心制作——这正是我们将在下一章中关注的。
- en: Questions
  id: totrans-386
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: Sensitive topics can be detected with vector similarity searches. (True or False)
  id: totrans-387
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 可以通过向量相似性搜索检测敏感话题。（对或错）
- en: A flagged user message containing a sensitive topic in the GenAISys does not
    stop the dialogue. (True or False)
  id: totrans-388
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 包含 GenAISys 中敏感话题的标记用户消息不会停止对话。（对或错）
- en: The OpenAI moderation tool only has one category for foul language. (True or
    False)
  id: totrans-389
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: OpenAI 的审查工具只为粗俗语言提供了一个类别。（对或错）
- en: A flagged user message containing content that violates the content policy of
    the GenAISys does not stop the dialogue. (True or False)
  id: totrans-390
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 包含违反 GenAISys 内容政策内容的标记用户消息不会停止对话。（对或错）
- en: Weather forecasting in real time to automatically suggest activities can give
    a company a competitive advantage. (True or False)
  id: totrans-391
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 实时天气预报以自动建议活动可以给公司带来竞争优势。（对或错）
- en: A multi-user, cross-domain, multimodal GenAISys is the future of apps. (True
    or False)
  id: totrans-392
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 多用户、跨领域、多模态的 GenAISys 是应用的未来。（对或错）
- en: Multi-user, cross-domain, multimodal apps don’t exist yet. (True or False)
  id: totrans-393
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 多用户、跨领域、多模态的应用程序还不存在。（对或错）
- en: Adding GenAISys to apps will significantly boost productivity and engage users.
    (True or False)
  id: totrans-394
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 GenAISys 添加到应用中将显著提高生产力和吸引用户。（对或错）
- en: A GenAISys should be developed with a customer panel. (True or False)
  id: totrans-395
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: GenAISys 应该与客户小组一起开发。（对或错）
- en: References
  id: totrans-396
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考文献
- en: 'OpenAI moderation: [https://platform.openai.com/docs/guides/moderation](https://platform.openai.com/docs/guides/moderation)'
  id: totrans-397
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: OpenAI 审查：[https://platform.openai.com/docs/guides/moderation](https://platform.openai.com/docs/guides/moderation)
- en: 'The OpenAI Moderation object: [https://platform.openai.com/docs/api-reference/moderations/object](https://platform.openai.com/docs/api-reference/moderations/object)'
  id: totrans-398
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: OpenAI 审查对象：[https://platform.openai.com/docs/api-reference/moderations/object](https://platform.openai.com/docs/api-reference/moderations/object)
- en: 'OpenWeather: [https://openweathermap.org/](https://openweathermap.org/)'
  id: totrans-399
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: OpenWeather：[https://openweathermap.org/](https://openweathermap.org/)
- en: Further reading
  id: totrans-400
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'OpenWeather’s solar radiance research: [https://home.openweathermap.org/solar_irradiance_history_bulks/new](https://home.openweathermap.org/solar_irradiance_history_bulks/new)'
  id: totrans-401
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: OpenWeather 的太阳辐射研究：[https://home.openweathermap.org/solar_irradiance_history_bulks/new](https://home.openweathermap.org/solar_irradiance_history_bulks/new)
- en: '|'
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: '|'
- en: Unlock this book’s exclusive benefits now
  id: totrans-403
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 现在解锁这本书的独家优惠
- en: Scan this QR code or go to [packtpub.com/unlock](http://packtpub.com/unlock),
    then search for this book by name. | ![A qr code on a white background  AI-generated
    content may be incorrect.](img/Unlock.png) |
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描此二维码或访问 [packtpub.com/unlock](http://packtpub.com/unlock)，然后通过书名搜索这本书。 | ![白色背景上的二维码
    AI生成的内容可能不正确](img/Unlock.png) |
- en: '| *Note: Keep your purchase invoice ready before you start.* |'
  id: totrans-405
  prefs: []
  type: TYPE_TB
  zh: '| *注意：在开始之前，请准备好您的购买发票。* |'
